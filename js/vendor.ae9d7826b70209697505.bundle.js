/*! For license information please see vendor.ae9d7826b70209697505.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[502],{377(t,e,i){Object.defineProperty(e,"o",{value:!0});var s=i(568),r=i(570),n=function(t){if(t&&t.o)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}(s),o=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(r);class a{constructor(){this.u=!0}S(){return this.u}}class h extends a{constructor(t,e){super(),this.M=t,this._=t,this.u=e}C(t){return t!==this.M&&(this._=this.M,this.M=t,this.u=!0),this}T(){return this.M}S(){return super.S()}}const l=(t,e)=>({x:t,y:e}),c=(t,e)=>({x:t,y:e}),u=(t,e,i)=>({position:t,high:e,low:i}),d=(t,e,i)=>({x:t,y:e,z:i}),f=t=>{const e=Array(0),i=Array(0);return t.length>0&&t.forEach(t=>{e.push(l(t.position,t.high)),i.push(l(t.position,t.low))}),[e,i]},g=(t,e)=>({min:t,max:e}),p=(t,e,i,s)=>({x:t,y:e,width:i,height:s}),m=(t,e=!0)=>new h(t,e),y=(t=0,e=0,i=0,s=0)=>({left:t,top:e,right:i,bottom:s}),x=y,v=(t,e)=>({left:void 0!==e.left?e.left:t.left,top:void 0!==e.top?e.top:t.top,right:void 0!==e.right?e.right:t.right,bottom:void 0!==e.bottom?e.bottom:t.bottom}),A=s.Record({type:"color",r:1,g:1,b:1,a:1});class S extends A{constructor(t){super(t)}toUint32(){return void 0!==this.F||(this.F=F(this.getR(),this.getG(),this.getB(),this.getA())),this.F}toString(){return`color:${this.r},${this.g},${this.b},${this.a}`}setA(t){return this.set("a",t/255)}setR(t){return this.set("r",t/255)}setG(t){return this.set("g",t/255)}setB(t){return this.set("b",t/255)}getA(){return 255*this.get("a")}getR(){return 255*this.get("r")}getG(){return 255*this.get("g")}getB(){return 255*this.get("b")}getHighlight(){return this.I||(this.I=new S({r:this.r+.45*(1-this.r),g:this.g+.45*(1-this.g),b:this.b+.45*(1-this.b),a:this.a<1?this.a+.45*(1-this.a):1})),this.I}getLighter(){return this.L||(this.L=new S({r:this.r+.4*(1-this.r),g:this.g+.4*(1-this.g),b:this.b+.4*(1-this.b),a:this.a})),this.L}getDarker(){return this.P||(this.P=new S({r:this.r-.4*(1-this.r),g:this.g-.4*(1-this.g),b:this.b-.4*(1-this.b),a:this.a})),this.P}toRGBAString(){return`rgba(${(255*this.r).toFixed(0)},${(255*this.g).toFixed(0)},${(255*this.b).toFixed(0)},${this.a})`}}const b=t=>!(!t||"object"!=typeof t||!("type"in t)||"color"!==t.type),M=(t,e,i,s=255)=>new S({r:t/255,g:e/255,b:i/255,a:s/255}),E=t=>{const e=t.startsWith("#")?t.substring(1):t.startsWith("0x")?t.substr(2):t;switch(e.length){case 8:return new S({r:Number(`0x${e.substring(0,2)}`)/255,g:Number(`0x${e.substring(2,4)}`)/255,b:Number(`0x${e.substring(4,6)}`)/255,a:Number(`0x${e.substring(6,8)}`)/255});case 6:return new S({r:Number(`0x${e.substring(0,2)}`)/255,g:Number(`0x${e.substring(2,4)}`)/255,b:Number(`0x${e.substring(4,6)}`)/255});case 4:return new S({r:Number(`0x${e.charAt(0)}${e.charAt(0)}`)/255,g:Number(`0x${e.charAt(1)}${e.charAt(1)}`)/255,b:Number(`0x${e.charAt(2)}${e.charAt(2)}`)/255,a:Number(`0x${e.charAt(3)}${e.charAt(3)}`)/255});case 3:return new S({r:Number(`0x${e.charAt(0)}${e.charAt(0)}`)/255,g:Number(`0x${e.charAt(1)}${e.charAt(1)}`)/255,b:Number(`0x${e.charAt(2)}${e.charAt(2)}`)/255});default:throw new Error(`ColorHEX parsing error | input: ${t}`)}},k=(t,e=1,i=1)=>{let s,r,n;t/=360;const o=Math.floor(6*t),a=6*t-o,h=i*(1-e),l=i*(1-a*e),c=i*(1-(1-a)*e);switch(o%6){case 0:s=i,r=c,n=h;break;case 1:s=l,r=i,n=h;break;case 2:s=h,r=i,n=c;break;case 3:s=h,r=l,n=i;break;case 4:s=c,r=h,n=i;break;default:s=i,r=h,n=l}return new S({r:s,g:r,b:n})},T=t=>M(255&t,255&(t>>=8),255&(t>>=8),255&(t>>=8)),w={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},C=new S({}),B=M(0,0,0,0),F=(t,e,i,s=255)=>(s<<24|i<<16|e<<8|t)>>>0,D=s.Record({type:"font",size:14,family:"Arial",weight:"normal",style:"normal",variant:!1});class I extends D{constructor(t){super(t)}setSize(t){return this.set("size",t)}setFamily(t){return this.set("family",t)}setWeight(t){return this.set("weight",t)}setStyle(t){return this.set("style",t)}setVariant(t){return this.set("variant",t)}getSize(){return this.get("size")}getFamily(){return this.get("family")}getWeight(){return this.get("weight")}getStyle(){return this.get("style")}getVariant(){return this.get("variant")}}const R=t=>!(!t||"object"!=typeof t||!("type"in t)||"font"!==t.type),L=new I;var P,z;e.GradientShape=void 0,(P=e.GradientShape||(e.GradientShape={})).circle="circle",P.ellipse="ellipse",e.GradientExtent=void 0,(z=e.GradientExtent||(e.GradientExtent={})).closestSide="closest-side",z.closestCorner="closest-corner",z.farthestSide="farthest-side",z.farthestCorner="farthest-corner";const _=s.Record({type:"fillstyle",fillType:"radial-gradient",ditheringEnabled:!0,stops:[{color:E("#f00"),offset:0},{color:E("#0f0"),offset:1}],position:l(.5,.5),shape:e.GradientShape.ellipse,extent:e.GradientExtent.farthestCorner});class V extends _{constructor(t){if(super(t),null===t||t&&null===t.stops||t&&t.stops&&!Array.isArray(t.stops)||t&&t.stops&&Array.isArray(t.stops)&&t.stops.length<2)throw new Error("RadialGradientFill requires minimum two color stops to be defined.")}toString(){return`radialGradientFill:${this.shape},${this.ditheringEnabled},${this.extent},${this.position.x},${this.position.y},${this.stops.map(t=>`${t.offset},${t.color.toString()}`).join(",")}`}toCSS(){return`radial-gradient(${this.shape} ${this.extent} at ${100*this.position.x}% ${100*this.position.y}%, ${this.stops.map(t=>`${t.color.toString()} ${100*t.offset}%`).join(", ")})`}setColorStops(t){if(t.length<2)throw new Error("Minimum of two color stops required");return this.set("stops",t)}getColorStops(){return this.get("stops")}setPosition(t){return this.set("position",t)}getPosition(){return this.get("position")}setShape(t){return this.set("shape",t)}getShape(){return this.get("shape")}setExtent(t){return this.set("extent",t)}getExtent(){return this.get("extent")}setDitheringEnabled(t){return this.set("ditheringEnabled",t)}getDitheringEnabled(){return this.get("ditheringEnabled")}}const N=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"radial-gradient"===t.fillType),O=s.Record({type:"fillstyle",fillType:"linear-gradient",stops:[{color:E("#f00"),offset:0},{color:E("#0f0"),offset:1}],angle:0});class U extends O{constructor(t){if(super(t),null===t||t&&null===t.stops||t&&t.stops&&!Array.isArray(t.stops)||t&&t.stops&&Array.isArray(t.stops)&&t.stops.length<2)throw new Error("LinearGradientFill requires minimum two color stops to be defined.")}toString(){return`linearGradientFill:${this.angle},${this.stops.map(t=>`${t.offset},${t.color.toString()}`).join(",")}`}toCSS(){return`linear-gradient(${this.angle}deg, ${this.stops.map(t=>`${t.color.toString()} ${100*t.offset}%`).join(", ")})`}setColorStops(t){if(t.length<2)throw new Error("Minimum of two color stops required");const e=t.sort((t,e)=>t.offset-e.offset);return this.set("stops",e)}getColorStops(){return this.get("stops")}setAngle(t,e){return this.set("angle",e?function(t){return 180*t/Math.PI}(t):t)}getAngle(t){return t?Ui(this.get("angle")):this.get("angle")}}const G=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"linear-gradient"===t.fillType);class Y{constructor(t,e,i,s){this.D=new vt,this.cellIndex=t,this.cellSpan=e,this.cellsAmount=i,this.observedAmount=s,this.x=new Z,this.y=new Z,this.z=new Z;const r={...t},n={...e};if(s){const t=t=>{const e=t.value;this.cellsAmount.x=e.reduce(gi,0),this.cellIndex.x=e.reduce((t,e,i)=>i>=r.x?t:t+e,0),this.cellSpan.x=e.reduce((t,e,i)=>i>=r.x&&i<r.x+n.x?t+e:t,0),this.D.R("cellresize",{})};s.x.O("change",t),t({value:s.x.T()});const e=t=>{const e=t.value;this.cellsAmount.y=e.reduce(gi,0),this.cellIndex.y=e.reduce((t,e,i)=>i>=r.y?t:t+e,0),this.cellSpan.y=e.reduce((t,e,i)=>i>=r.y&&i<r.y+n.y?t+e:t,0),this.D.R("cellresize",{})};s.y.O("change",e),e({value:s.y.T()}),this.V=()=>{s.x.N("change",t),s.y.N("change",e)}}}G(){return this.V&&(this.V(),this.V=void 0),this}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Z extends a{constructor(){super(...arguments),this.$=0,this.U=10,this.Y=1}j(){return this.u=!1,this}H(){return this.u=!0,this}getInnerStart(){return this.$}getInnerEnd(){return this.U}getInnerInterval(){return Math.abs(this.getInnerEnd()-this.getInnerStart())}W(t,e){return this.$=t,this.U=e,this.X(),this}Z(t){return this.Y=t,this.X(),this}J(t){return t/this.Y}X(){const t=this.J(this.U-this.$),e=this.Y;void 0!==this.K&&!1!==Ht(t,this.K)||(this.u=!0,this.q=e,this.K=t)}tt(){return this.K}it(){return this.q}st(){return this.U<this.$}et(t,e){return!0}}class W{constructor(){this.rt=!0}getInnerStart(){return this.$}getInnerEnd(){return this.U}getInnerInterval(){return Math.abs(this.U-this.$)}W(t,e){return this.rt=t!==this.$||e!==this.U,this.$=t,this.U=e,this}j(){return this.rt=!1,this}H(){return this.rt=!0,this}}class j extends W{constructor(t,e,i,s){if(super(),this.ht=!0,this.nt=!0,this.ot=[0,0],this.ut=!0,this.ct=t,this.dt=e,this.ft=i,this.At=t,this.vt=e,s){const t=t=>{this.yt(t.value)};s.O("change",t),this.yt(s.T()),this.xt=()=>s.N("change",t)}}Z(t){return this.Y=t,this.nt=!0,this}St(t){return this.ot=t.map(Math.abs),this.ut=!0,this}bt(){return this.ct/this.ft*this.Y+this.ot[0]}Mt(){return(this.ct+this.dt)/this.ft*this.Y-this.ot[1]}wt(){return this.getCellSize()-this._t()}kt(){return this.Y}getCellSize(){return this.Ct(this.Y)}_t(){return this.ot[0]+this.ot[1]}Tt(){return this.ot}yt(t){this.ft=t.reduce(gi,0),this.ct=t.reduce((t,e,i)=>i>=this.At?t:t+e,0),this.dt=t.reduce((t,e,i)=>i>=this.At&&i<this.At+this.vt?t+e:t,0),this.ht=!0,this.Ft()}Ct(t){return t*this.dt/this.ft}j(){return super.j(),this.nt=!1,this.ut=!1,this.ht=!1,this}H(){return super.H(),this.nt=!0,this.ut=!0,this.ht=!0,this}}class H extends j{constructor(t,e,i,s){super(t,e,i,s),this.It=!1,this.Lt=!1,this.Pt=0,this.Y=1e3,this.W(0,10),this.X()}Bt(){return this.Lt}et(t,e,i,s,r){if(t===e)return!1;const n=Math.abs(s-i),o=Math.abs(e-t);if(!this.It){const i=Me(t,e,this.getCellSize());if(void 0===i)return!1;if(o>i)return!0;const s=(e+t)/2,a=(r?i/2:n/2)*(t>e?-1:1);return{start:s-a,end:s+a}}const a=10**-(12-Math.log10(Math.max(Math.abs(t),1)));if(o>a)return!0;const h=(e+t)/2,l=(r?a/2:n/2)*(t>e?-1:1);return{start:h-l,end:h+l}}Ft(){this.X()}Dt(t){return this.bt()+(t-this.$)/(this.U-this.$)*(this.Mt()-this.bt())}Et(t){return this.$+(t-this.bt())/(this.Mt()-this.bt())*(this.U-this.$)}W(t,e){return super.W(t,e),this.X(),this}St(t){return super.St(t),this.X(),this}Z(t){return super.Z(t),this.Rt=$(this.U-this.$,this.ot,this.Y,this.dt,this.ft),this.X(),this}Ot(){return this.It=!0,this}zt(){return this.It}Vt(){return Math.abs(this.Nt)}Gt(){return this.Vt()/this.Rt}$t(){return this.Ut}Yt(){return this.jt}getPixelSize(){return this.Rt}Ht(){return this.Wt}H(){return super.H(),this.Lt=!0,this}j(){return super.j(),this.Lt=!1,this}Xt(t,e=Qi.Numeric){return e(t,{start:this.$,end:this.U})}Zt(){const t=Math.abs(this.getInnerEnd()).toString().length,e=Math.abs(this.getInnerStart()).toString().length;return t>e?t:e}Jt(t){return $(t,this.ot,this.Y,this.dt,this.ft)}X(){let t=this.$,e=this.U,i=0;this.It&&(t=0,e=this.U-this.$,i=this.$);const s=e-t,r=$(s,this.ot,this.Y,this.dt,this.ft);this.jt=t-this.ot[0]*r,this.Ut=e+this.ot[1]*r;const n=this.Ut-this.jt,o=n-this.Nt,a=Math.abs(o/r),h=s-this.Pt,l=Math.abs(h/r);(!this.Wt||a>=.4||l>=.4)&&(this.Pt=s,this.Nt=n,this.Rt=r,this.Lt=!0);const c=this.Nt*this.ft/(2*this.dt),u=-(this.jt-this.Nt*this.ct/this.dt)-c,d=2*this.bt()/this.Y-1,f=2*this.Mt()/this.Y-1-d;this.Wt={displacement:u,scaling:c,highPrecisionOffset:i,viewportStart:d,viewportSize:f,scaleStartLog:0,scaleIntervalLog:0}}Qt(t,e){return t+this.Rt*e}}const $=(t,e,i,s=1,r=1)=>t/(i*s/r-(e[0]+e[1]));class X{Kt(t,e){return"x"in t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this}j(){return this.x.j(),this.y.j(),this}H(){return this.x.H(),this.y.H(),this}Z(t,e){return"object"==typeof t?(this.x.Z(t.x),this.y.Z(t.y)):(this.x.Z(t),this.y.Z(e)),this}kt(){return l(this.x.kt(),this.y.kt())}qt(t){return this.x.St(t),this}ti(t){return this.y.St(t),this}_t(){return l(this.x._t(),this.y._t())}ii(t,e){return this.x.W(t,e),this}si(t,e){return this.y.W(t,e),this}getInnerIntervalPixels(){const t=this.x.getCellSize(),e=this.y.getCellSize();return{x:t-this.x._t(),y:e-this.y._t()}}ei(){return this.x.Bt()||this.y.Bt()}}class q extends X{constructor(){super(...arguments),this.ri="LinearScaleXY"}hi(t,e,i,s){return this.x=new H(t.x,e.x,i.x,s?s.x:void 0),this.y=new H(t.y,e.y,i.y,s?s.y:void 0),this}zt(){return this.x.zt()||this.y.zt()}ni(){return l(this.x.getPixelSize(),this.y.getPixelSize())}Ht(){return{x:this.x.Ht(),y:this.y.Ht()}}Qt(t,e){const i=this.ni();return{x:t.x+e.x*i.x,y:t.y+e.y*i.y}}oi(t,e,i,s){const r=this.ni(),n=Di(t,e);return n.x*=s,n.y*=s,{x:t.x+i*r.x*n.x,y:t.y+i*r.y*n.y}}}class K extends X{constructor(){super(...arguments),this.ri="MixedScaleXY"}zt(){return!1}Qt(t,e){const i=this.x.Dt(t.x),s=this.y.Dt(t.y),r={x:i+e.x,y:s+e.y};return{x:this.x.Et(r.x),y:this.y.Et(r.y)}}oi(t,e,i,s){const r={x:this.x.Dt(t.x),y:this.y.Dt(t.y)},n={x:this.x.Dt(e.x),y:this.y.Dt(e.y)},o=Fi(Pi(n,r)),a=Di(n,r),h={x:r.x+o.x*s+a.x*i,y:r.y+o.y*s+a.y*i};return{x:this.x.Et(h.x),y:this.y.Et(h.y)}}Ht(){const t=this.x.Ht(),e=this.y.Ht();return{uScaleStart:[this.x.$,this.y.$],uScaleInterval:[this.x.U-this.x.$,this.y.U-this.y.$],uScaleStartLog:[t.scaleStartLog,e.scaleStartLog],uScaleIntervalLog:[t.scaleIntervalLog,e.scaleIntervalLog],uViewportStart:[t.viewportStart,e.viewportStart],uViewportSize:[t.viewportSize,e.viewportSize]}}}const J={d1:t=>new t.scale1DConstructor(0,1,1,void 0),d2:t=>(new t.scaleXYConstructor).hi({x:0,y:0},{x:1,y:1},{x:1,y:1},void 0),d3:()=>new Y({x:0,y:0},{x:1,y:1},{x:1,y:1},void 0)},Q=(t,e,i)=>e===i?t:i.Et(e.Dt(t)),tt=(t,e,i)=>{if(e===i)return t;const s=e instanceof X?e.x:e.x instanceof X?e.x.x:e.x.ai,r=e instanceof X?e.y:e.y instanceof X?e.y.y:e.y.ai,n=i instanceof X?i.x:i.x instanceof X?i.x.x:i.x.ai,o=i instanceof X?i.y:i.y instanceof X?i.y.y:i.y.ai;return{...t,x:Q(t.x,s,n),y:Q(t.y,r,o)}},et=(...t)=>{if(0===t.length)return{remove:jt};let e=!1;const i=t.map(i=>{const s=s=>{((i,s,r)=>{e||(e=!0,t.filter(t=>t!==i).forEach(t=>t.li(s,r,!1,i.getStopped(),"synchronizedAxis")),e=!1)})(i,s.start,s.end)};return i.addEventListener("intervalchange",s),s});let s=!1;const r=t.map(e=>{const i=i=>{((e,i)=>{s||(s=!0,t.filter(t=>t!==e).forEach(t=>t.setStopped(i)),s=!1)})(e,i.isStopped)};return e.addEventListener("stoppedchange",i),i});return{remove:()=>{t.forEach((t,e)=>{t.removeEventListener("intervalchange",i[e]),t.removeEventListener("stoppedchange",r[e])})}}},it=t=>t&&"object"==typeof t&&"column"in t&&"row"in t,st=t=>t&&"object"==typeof t&&"z"in t&&"column"in t&&"row"in t,rt=t=>t&&"object"==typeof t&&"annulus"in t&&"sector"in t,nt=t=>t&&"object"==typeof t&&"index"in t,ot=t=>t&&"object"==typeof t&&"x"in t&&"y"in t,at=(t,e,i,s)=>i<0?t:i>1?e:M(t.getR()+i*(e.getR()-t.getR()),t.getG()+i*(e.getG()-t.getG()),t.getB()+i*(e.getB()-t.getB()),void 0===s?t.getA()+i*(e.getA()-t.getA()):s);var ht;!function(t){t[t.Nearest=0]="Nearest",t[t.NearestX=1]="NearestX",t[t.NearestY=2]="NearestY"}(ht||(ht={}));const lt=(t,e,i,s,r,n,o,a,h,l)=>{const c=t.length;if(0===c)return;const u=s?1:0,d=c-(r?2:1);if(i===ht.Nearest)return ct(t,e,n,o,u,d);if(i===ht.NearestX||i===ht.NearestY){if("boolean"==typeof l&&("x"===h&&i===ht.NearestX||"y"===h&&i===ht.NearestY))return ft(t,tt(e,o,n),h,l,u,d);if(i===ht.NearestX)return ut(t,tt(e,o,n),a,u,d);if(i===ht.NearestY)return dt(t,tt(e,o,n),a,u,d)}},ct=(t,e,i,s,r,n)=>{let o,a=Number.MAX_VALUE;for(let h=r;h<=n;h+=1){const r=t[h];if(!Number.isNaN(r.x)&&!Number.isNaN(r.y)){const t=tt(r,i,s),n=(t.x-e.x)**2+(t.y-e.y)**2;n<a&&(a=n,o=h)}}return o},ut=(t,e,i,s,r)=>{if(e.x<i.min.x||e.x>i.max.x)return;let n,o=Number.MAX_VALUE;for(let i=s;i<=r;i+=1){const s=t[i],r=s.x>e.x?s.x-e.x:e.x-s.x;r<o&&!Number.isNaN(s.x)&&!Number.isNaN(s.y)&&(o=r,n=i)}return n},dt=(t,e,i,s,r)=>{if(e.y<i.min.y||e.y>i.max.y)return;let n,o=Number.MAX_VALUE;for(let i=s;i<=r;i+=1){const s=t[i],r=s.y>e.y?s.y-e.y:e.y-s.y;r<o&&!Number.isNaN(s.x)&&!Number.isNaN(s.y)&&(o=r,n=i)}return n},ft=(t,e,i,s,r,n)=>{const o="x"===i,a=o?e.x:e.y,h=t[r],l=t[n],c=h.x<l.x?h.x:l.x,u=h.y<l.y?h.y:l.y,d=h.x>l.x?h.x:l.x,f=h.y>l.y?h.y:l.y;if(o&&(a<c||a>d)||!o&&(a<u||a>f))return;let g=r,p=Math.floor((r+n)/2),m=n,y=-1;for(;;){const e=a-(o?t[p].x:t[p].y);if(e*(s?-1:1)>0)g=Math.min(p+1,m),y=Math.floor((g+m)/2);else{if(0===Math.abs(e))return p;m=Math.max(p-1,g),y=Math.floor((g+m)/2)}if(y===p){const i=p>r?Math.abs(a-(o?t[p-1].x:t[p-1].y)):ni,s=p<n?Math.abs(a-(o?t[p+1].x:t[p+1].y)):ni,h=Math.abs(e);switch(Math.min(h,i,s)){case i:return p-1;case s:return p+1;default:return p}}else p=y}},gt=(t,e,i,s,r,n)=>{const o="x"===i,a=o?e.x:e.y,h=t[r],l=t[n],c=h.x<l.x?h.x:l.x,u=h.y<l.y?h.y:l.y,d=h.x>l.x?h.x:l.x,f=h.y>l.y?h.y:l.y;if(o&&(a<c||a>d)||!o&&(a<u||a>f))return;let g=r,p=Math.floor((r+n)/2),m=n,y=-1;for(;;){const i=a-(o?t[p].x:t[p].y);if(i*(s?-1:1)>0)g=Math.min(p+1,m),y=Math.floor((g+m)/2);else{if(0===Math.abs(i))return{a:p,b:p,lerpAmount:0};m=Math.max(p-1,g),y=Math.floor((g+m)/2)}if(y===p){if(i*(s?-1:1)<0&&p>r){const i=t[p-1],s=t[p];return{a:p-1,b:p,lerpAmount:o?(e.x-i.x)/(s.x-i.x):(e.y-i.y)/(s.y-i.y)}}if(p<n){const i=t[p],s=t[p+1];return{a:p,b:p+1,lerpAmount:o?(e.x-i.x)/(s.x-i.x):(e.y-i.y)/(s.y-i.y)}}return{a:p,b:p,lerpAmount:0}}p=y}};let pt=0;class mt{constructor(t,e,i){this.ui=m(!0),this.ci=!1,this.di=!0,this.fi=!1,this.Ai=void 0,this.gi=0,this.D=new vt,this.pi=t,this.yi=e,this.mi=i,this.xi=pt,pt+=1,this.Si=t.bi.highlightColorOffset}Mi(){let t;return this.wi("DataPattern",e=>(t=e.pattern,!0)),"ProgressiveX"===t||"RegressiveX"===t?ht.NearestX:"ProgressiveY"===t||"RegressiveY"===t?ht.NearestY:ht.Nearest}_i(){}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}R(t,e,i,s){this.D.R(t,e,{collectionMember:i,info:s})}removeEventListener(t,e){this.D.removeEventListener(t,e)}ki(t){return void 0!==this.mi.find(e=>e.type===t)}wi(t,e){var i;return!!this.ki(t)&&!0===e(null===(i=this.mi.find(e=>e.type===t))||void 0===i?void 0:i.args)}dispose(){return this.ci||(this.pi.Ci(this),this.ci=!0,this.yi(this),this.D.R("dispose",{})),this}isDisposed(){return this.ci}setVisible(t){const e=this.di;return this.di=t,!t&&e&&this.ui.T()&&this.pi.Ci(this),this}getVisible(){return this.di}setPointerEvents(t){const e=this.ui.T();return this.ui.C(t),t||e&&this.pi.Ci(this),this}getPointerEvents(){return this.ui.T()}Ti(t){return this.Ai=t,this}Fi(){return this.Ai?this.Ai:yt}Ii(t){return this.gi=t,this}Li(){return this.gi}Pi(t){return this.Si=t,this}Bi(){return this.Si}}const yt=g(l(0,0),l(0,0)),xt={click:!0,contextmenu:!0,dblclick:!0,gotpointercapture:!0,lostpointercapture:!0,pointercancel:!0,pointerdown:!0,pointerenter:!0,pointerleave:!0,pointermove:!0,pointerout:!0,pointerover:!0,pointerup:!0,touchcancel:!0,touchend:!0,touchmove:!0,touchstart:!0,wheel:!0,drag:!0,dragend:!0,dragenter:!0,dragleave:!0,dragover:!0,dragstart:!0,drop:!0};class vt{constructor(){this.Di=new Array,this.Ei=[],this.ui=!0,this.Ri=!1,this.Oi=new Map}setPointerEvents(t){this.ui=t,this.Ei.forEach(e=>e.setPointerEvents(t))}getPointerEvents(){return this.ui}addEventListener(t,e,i){this.Di.push({listener:e,key:t,options:i||{}})}removeEventListener(t,e){const i=this.Di.findIndex(t=>t.listener===e);i>=0&&this.Di.splice(i,1)}set draggable(t){this.Ri=t,this.Ei.forEach(e=>{e.fi=t})}get draggable(){return this.Ri}R(t,e,i=void 0){const s=this.Di.slice();for(let r=s.length-1;r>=0;r-=1){const n=s[r];n.key===t&&(n.listener(e,i),!0===n.options.once&&this.removeEventListener(t,n.listener))}}zi(t,e){const i=[];Object.keys(xt).forEach(s=>{const r=(t,i)=>{const r=At(t)?{clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY}:t,n=(null==e?void 0:e.getExtraData)&&void 0!==r.clientX?e.getExtraData(r,i.collectionMember,i.info):{};this.R(s,t,n),!t.defaultPrevented&&(null==e?void 0:e.continueIfNotPrevented)&&e.continueIfNotPrevented(s,t,n)};t.addEventListener(s,r),i.push(()=>t.removeEventListener(s,r))}),this.Ei.push(t);const s=()=>{const e=this.Ei.indexOf(t);e>=0&&this.Ei.splice(e,1)};t.addEventListener("dispose",s),i.push(()=>t.removeEventListener("dispose",s)),this.Oi.set(t,()=>{i.forEach(t=>t())}),t.fi=this.Ri,t.setPointerEvents(this.ui)}Vi(){this.Oi.forEach(t=>t()),this.Oi.clear(),this.Ei.length=0}Ni(t,e){const i=[];Object.keys(xt).forEach(s=>{const r=(t,i)=>{const r=e(i.collectionMember);r&&this.R(s,t,r)};t.addEventListener(s,r),i.push(()=>t.removeEventListener(s,r))}),this.Ei.push(t);const s=()=>{const e=this.Ei.indexOf(t);e>=0&&this.Ei.splice(e,1)};t.addEventListener("dispose",s),i.push(()=>t.removeEventListener("dispose",s)),this.Oi.set(t,()=>{i.forEach(t=>t())}),t.setPointerEvents(this.ui),t.fi=this.Ri}Gi(t){Object.keys(xt).forEach(e=>{t.addEventListener(e,(t,i)=>{this.R(e,t,i)})}),t.setPointerEvents(this.ui),t.draggable=this.Ri}}const At=t=>!(!t||"object"!=typeof t||!("touches"in t)),St={linear:(t,e,i)=>{const s=e-t;return r=>r<i?t+s/i*r:e},easeIn:(t,e,i)=>s=>s<i?t+Math.abs(2*(Math.sqrt(.5)*s/i)**2)*(e-t):e,easeOut:(t,e,i)=>s=>s<i?t+Math.abs(1-2*(Math.sqrt(.5)*(1-s/i))**2)*(e-t):e,ease:(t,e,i)=>s=>s<i?t+(s<i/2?.5*(s/i*2)**2.5:.5+.5*(1-(1-2*(s/i-.5))**2.5))*(e-t):e,logarithmic:t=>{const e=ke(t);return(i,s,r)=>{const n=e(i),o=e(s);return e=>e<r?t**(n+Math.abs(1-2*(Math.sqrt(.5)*(1-e/r))**2)*(o-n)):s}}};class bt{constructor(t,e,i,s=St.linear,r){this.delta=0,this.nextAnimations=new Array,this.$i=!1,this.easing=St.linear,this.isOver=()=>(this.delta===this.duration||this.$i)&&0===this.nextAnimations.length,this.D=new vt,this.values=t,this.action=e,this.duration=i,this.easing=s,this.Ui=r,this.eases=t.map(([t,e])=>s(t,e,i))}Yi(){this.D.R("start",{})}start(){return this.Ui.includes(this)||this.Ui.push(this),this}addNextAnimations(t){return t instanceof Array?t.forEach(t=>this.nextAnimations.push(t)):this.nextAnimations.push(t),this}NextAnimation(t,e,i=this.duration,s=this.easing){const r=new bt(t,e,i,s,this.Ui);return this.nextAnimations.push(r),r}finish(t=!0){if(this.$i=!0,this.Ui.splice(this.Ui.indexOf(this),1),this.nextAnimations.length>0){const e=this.nextAnimations[0];return t&&this.D.Di.forEach(t=>{"allAnimationEnd"===t.key&&e.addEventListener("allAnimationEnd",t.listener),"everyAnimationEnd"===t.key&&e.addEventListener("everyAnimationEnd",t.listener)}),e.addNextAnimations(this.nextAnimations.slice(1)),e.start(),t&&(this.D.R("end",{nextAnimation:e}),this.D.R("everyAnimationEnd",{nextAnimation:e})),e}t&&(this.D.R("end",{nextAnimation:void 0}),this.D.R("everyAnimationEnd",{nextAnimation:void 0}),this.D.R("allAnimationEnd",{}))}finishAll(t=!0){let e=this;for(;e;)e=e.finish(t)}getFinalValues(){return this.nextAnimations.length>0?this.nextAnimations[this.nextAnimations.length-1].values.map(Zt):this.values.map(Zt)}getTimeUntilFinish(){let t=this.duration-this.delta;for(let e=0;e<this.nextAnimations.length;e+=1)t+=this.nextAnimations[e].duration-this.nextAnimations[e].delta;return t}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Mt=(t,e=60)=>{e>60&&console.log("Note: Animator FPS is usually capped at 60 by the browser!");const i=[];let s,r,n=0;const o=()=>{s=void 0;const a=Date.now();r=r||a,n=a-r,n/1e3>=1/e&&(r=Date.now()-n%(1e3/e),i.forEach(t=>{0===t.delta&&t.Yi(),t.delta+=n-n%(1e3/e),t.delta>t.duration&&(t.delta=t.duration),t.action(t.eases.map(e=>e(t.delta))),t.delta===t.duration&&t.finish()}),t()),i.length>0?s=Ut.requestAnimationFrame(o):(s=void 0,r=void 0)};return(t=1e3,e=St.linear)=>(r,n,a=t)=>{const h=new bt(r,n,a,e,i).start();return s||(s=Ut.requestAnimationFrame(o)),h}};var Et;e.ImageFitMode=void 0,(Et=e.ImageFitMode||(e.ImageFitMode={}))[Et.Fill=0]="Fill",Et[Et.Fit=1]="Fit",Et[Et.Stretch=2]="Stretch",Et[Et.Center=3]="Center",Et[Et.Tile=4]="Tile";const kt=s.Record({type:"fillstyle",fillType:"image",source:void 0,surroundingColor:M(0,0,0,0),sourceMissingColor:M(0,0,0,0),fitMode:e.ImageFitMode.Fill});class Tt extends kt{constructor(t){super(t)}setSource(t){return this.set("source",t)}getSource(){return this.get("source")}setSurroundingColor(t){return b(t)?this.set("surroundingColor",t):this.set("surroundingColor",t(this.get("surroundingColor")))}getSurroundingColor(){return this.get("surroundingColor")}setSourceMissingColor(t){return b(t)?this.set("sourceMissingColor",t):this.set("sourceMissingColor",t(this.get("sourceMissingColor")))}getSourceMissingColor(){return this.get("sourceMissingColor")}setFitMode(t){return this.set("fitMode",t)}getFitMode(){return this.get("fitMode")}toString(){return`imagefill:${this.fitMode}`}toCSS(){return`url(${this.getSource().src})`}}const wt=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"image"===t.fillType),Ct=s.Record({type:"linestyle",lineType:"empty"}),Bt=new class extends Ct{constructor(){super(...arguments),this.thickness=0}setThickness(t){return this}getThickness(){return 0}ji(){return 0}setFillStyle(t){return this}getFillStyle(){return ls}},Ft=t=>!(!t||"object"!=typeof t||!("lineType"in t)||"empty"!==t.lineType),Dt=-34028234663852886e22,It="-340282346638528859811704183484516925440.0";var Rt,Lt,Pt,zt;e.UISpace=void 0,(Rt=e.UISpace||(e.UISpace={}))[Rt.Content=0]="Content",Rt[Rt.PaddedContent=1]="PaddedContent",Rt[Rt.PaddedBackground=2]="PaddedBackground",Rt[Rt.Everything=3]="Everything",e.UIVisibilityModes=void 0,(Lt=e.UIVisibilityModes||(e.UIVisibilityModes={}))[Lt.never=0]="never",Lt[Lt.always=1]="always",Lt[Lt.whenHovered=2]="whenHovered",Lt[Lt.whenDragged=3]="whenDragged",Lt[Lt.whenNotDragged=4]="whenNotDragged",Lt[Lt.whenHoveredOrDragged=5]="whenHoveredOrDragged",e.UIDraggingModes=void 0,(Pt=e.UIDraggingModes||(e.UIDraggingModes={}))[Pt.notDraggable=0]="notDraggable",Pt[Pt.draggable=1]="draggable",Pt[Pt.onlyHorizontal=2]="onlyHorizontal",Pt[Pt.onlyVertical=3]="onlyVertical",e.UIDirections=void 0,(zt=e.UIDirections||(e.UIDirections={}))[zt.Up=0]="Up",zt[zt.Right=1]="Right",zt[zt.Down=2]="Down",zt[zt.Left=3]="Left";const _t=t=>"getHighlight"in t&&"setHighlight"in t,Vt=(t,e,i)=>void 0===t||"number"==typeof t?t:Array.isArray(t)?t.slice(e,i):t.subarray(e,i),Nt=(...t)=>{const e=t=>t&&"object"==typeof t&&!Array.isArray(t);return t.reduce((t,i)=>i?(Object.keys(i).forEach(s=>{const r=t[s],n=i[s];e(r)&&e(n)?t[s]=Nt(r,n):t[s]=n}),t):t,{})},Ot=t=>{if(t.resourcesBaseUrl){const e=t.styleFactory(t.resourcesBaseUrl),i=wt(e)&&e.getSource(),s=i&&i instanceof Image?i:void 0;return null==s||s.addEventListener("error",()=>{je(t.resourcesBaseUrl,s.src,"Theme resource",{shouldCrash:!1})}),e}const e=`${Ut.location.origin}/resources`,i=t.styleFactory(e);if(wt(i)){const e=i.getSource();e instanceof Image&&e.addEventListener("error",()=>{const i=t.styleFactory("https://lcjs-resources.lightningchart.com/v1"),s=wt(i)&&i.getSource(),r=s&&s instanceof Image?s:void 0;Ut.console.warn("LightningChart JS warning | fallbacking to publicly hosted asset resources.\nFor more information, please see https://lightningchart.com/js-charts/docs/troubleshooting/warning-using-publicly-hosted-resources/"),null==r||r.addEventListener("load",()=>{t.apply(i)}),null==r||r.addEventListener("error",()=>{je(t.resourcesBaseUrl,e.src,"Theme resource",{shouldCrash:!1})})})}return i},Ut="undefined"!=typeof window?window:void 0!==i.g&&i.g._lcjs?i.g._lcjs:{},Gt=(t,e)=>t.x===e.x&&t.y===e.y,Yt=t=>t!==ni&&t!==oi&&!Number.isNaN(t)&&Number.isFinite(t)&&t!==1/0&&t!==-1/0,Zt=t=>t[1],Wt=t=>t.dispose(),jt=()=>{},Ht=(t,e)=>t===e,$t=(t,e,i)=>i>e?Math.min(Math.max(t,e),i):Math.min(Math.max(t,i),e),Xt=t=>Array.prototype.concat.apply([],t),qt=(t,e)=>void 0===t||Number.isNaN(t)?e:t,Kt=t=>t.Hi(),Jt=t=>t.Wi(),Qt=t=>t.Xi(),te=t=>t.Zi(),ee=t=>t.min.x,ie=t=>t.max.x,se=t=>t.min.y,re=t=>t.max.y,ne=(t,e,i,s,r)=>{if(t.length>0){let n=r?s(r):void 0;for(let s=0;s<t.length;s+=1){const r=e(t[s]);void 0!==r&&(n=void 0!==n?i(n,r):r)}return n}if(r)return s(r)},oe=l(0,1),ae=l(1,0),he=l(0,-1),le=l(-1,0),ce=l(0,0),ue=t=>{switch(t){case e.UIDirections.Up:return oe;case e.UIDirections.Right:return ae;case e.UIDirections.Down:return he;case e.UIDirections.Left:return le;default:return ce}},de=t=>t===e.UIDirections.Left||t===e.UIDirections.Right,fe=t=>{t.stopPropagation(),t.preventDefault()},ge=(t,e)=>{if(!e)return t;const i=t.length,s=new Float32Array(2*i);let r=0;for(let e=0;e<i;e+=1){const i=t[e],n=Math.fround(i);s[r+0]=n,s[r+1]=i-n,r+=2}return s},pe=(t,e,i=Float32Array)=>{if(!e){const e=t.length,s=new i(2*e);let r=0;for(let i=0;i<e;i+=1){const e=t[i];s[r+0]=e.x,s[r+1]=e.y,r+=2}return s}const s=t.length,r=new i(4*s);let n=0;for(let e=0;e<s;e+=1){const i=t[e],s=Math.fround(i.x),o=Math.fround(i.y);r[n+0]=s,r[n+1]=o,r[n+2]=i.x-s,r[n+3]=i.y-o,n+=4}return r},me=t=>{const e=t.length,i=new Float32Array(3*e);let s=0;for(let r=0;r<e;r+=1){const e=t[r];i[s+0]=e.x,i[s+1]=e.y,i[s+2]=e.z,s+=3}return i},ye=(t,e,i,s)=>t||e||i||s?!t||e||i||s?t||!e||i||s?t||e||!i||s?t||e||i||!s?(r,n,o)=>{const a=3+(t?4:0)+(e?1:0)+(i?1:0)+(s?3:0),h=r.length,l=new Float32Array(h*a);let c=0,u=c;for(let t=0;t<h;t+=1){const e=r[t];l[u+0]=e.x,l[u+1]=e.y,l[u+2]=e.z,u+=a}if(c+=3,t){const t=o&&ms(o)&&o.getFallbackColor()||C;u=c;for(let e=0;e<h;e+=1){const i=r[e].color||t;l[u+0]=i.r,l[u+1]=i.g,l[u+2]=i.b,l[u+3]=i.a,u+=a}c+=4}if(e){const t=n&&n.getSize();let e=1;"number"==typeof t&&(e=t),u=c;for(let t=0;t<h;t+=1){const i=r[t],s=void 0!==i.size?i.size:e;l[u+0]=s,u+=a}c+=1}if(i){u=c;for(let t=0;t<h;t+=1){const e=r[t];l[u+0]=void 0!==e.value?e.value:Dt,u+=a}c+=1}if(s){const t=n&&n.getSize();let e={x:1,y:1,z:1};"object"==typeof t&&(e=t),u=c;for(let t=0;t<h;t+=1){const i=r[t],s=void 0!==i.sizeAxisX?i.sizeAxisX:e.x,n=void 0!==i.sizeAxisY?i.sizeAxisY:e.y,o=void 0!==i.sizeAxisZ?i.sizeAxisZ:e.z;l[u+0]=s,l[u+1]=n,l[u+2]=o,u+=a}c+=3}return l}:(t,e,i)=>xe(t,e):(t,e,i)=>Se(t):(t,e,i)=>Ae(t,e):(t,e,i)=>ve(t,i):(t,e,i)=>me(t),xe=(t,e)=>{const i=e&&e.getSize();let s={x:1,y:1,z:1};"object"==typeof i&&(s=i);const r=t.length,n=new Float32Array(6*r);let o=0;for(let e=0;e<r;e+=1){const i=t[e];n[o+0]=i.x,n[o+1]=i.y,n[o+2]=i.z;const r=void 0!==i.sizeAxisX?i.sizeAxisX:s.x,a=void 0!==i.sizeAxisY?i.sizeAxisY:s.y,h=void 0!==i.sizeAxisZ?i.sizeAxisZ:s.z;n[o+3]=r,n[o+4]=a,n[o+5]=h,o+=6}return n},ve=(t,e)=>{const i=e&&ms(e)&&e.getFallbackColor()||C,s=t.length,r=new Float32Array(7*s);for(let e=0,n=0;e<s;e+=1){const s=t[e];r[n+0]=s.x,r[n+1]=s.y,r[n+2]=s.z;const o=s.color||i;r[n+3]=o.r,r[n+4]=o.g,r[n+5]=o.b,r[n+6]=o.a,n+=7}return r},Ae=(t,e)=>{const i=e&&e.getSize();let s=1;"number"==typeof i&&(s=i);const r=t.length,n=new Float32Array(4*r);for(let e=0,i=0;e<r;e+=1){const r=t[e];n[i+0]=r.x,n[i+1]=r.y,n[i+2]=r.z;const o=void 0!==r.size?r.size:s;n[i+3]=o,i+=4}return n},Se=t=>{const e=t.length,i=new Float32Array(4*e);for(let s=0,r=0;s<e;s+=1){const e=t[s];i[r+0]=e.x,i[r+1]=e.y,i[r+2]=e.z,i[r+3]=void 0!==e.value?e.value:Dt,r+=4}return i},be=t=>e=>{const i=t.indexOf(e);i>=0&&t.splice(i,1)},Me=(t,e,i)=>{const s=((t,e)=>{if(e<ni&&e>oi&&t<ni&&t>oi){const i=Math.abs(t/2**23),s=Math.abs(e/2**23),r=Math.min(i,s);return 10**Math.floor(Math.log10(r))}})(t,e);if(void 0!==s)return s*i},Ee=t=>{let e=t.length;for(let i=0;i<e-1;i+=1)t[i].x===t[i+1].x&&t[i].y===t[i+1].y&&(t.splice(i,1),i-=1,e-=1);return t},ke=t=>{const e=Math.log(t);return t=>Math.log(t)/e},Te=ke(Math.E),we=(t,e)=>{const i=e[t];return i?i():void 0},Ce=(t,e)=>{let i;if(e)i=e;else{const e={x:0,y:0};for(let i=0;i<t.length;i+=1)e.x+=t[i].x/t.length,e.y+=t[i].y/t.length;i=e}return t.sort((t,e)=>Gi(Pi(t,i))-Gi(Pi(e,i)))},Be=(t,e,i)=>{if(0===t.length)return!1===i.canReturnB?e.slice():e;const s=e.length;if(s<1e5)return t.push.apply(t,e),t;for(let i=0;i<s;i+=1)t.push(e[i]);return t},Fe=t=>255===t.getA()?t:t.setA(255),De=(()=>{const t=M(0,0,0);return e=>(e=Fe(e),new U({angle:180,stops:[{offset:0,color:e},{offset:1,color:at(e,t,.5)}]}))})(),Ie=(()=>{const t=(t,e)=>{var i;if(t){if(gs(t)){if(0===t.getColor().getA())return;return t.getColor()}if(N(t)||G(t)){const e=t.getColorStops();return 2===e.length?e[1].color:null===(i=e[0])||void 0===i?void 0:i.color}return vs(t)&&void 0!==e?t.lut.getColors(e,void 0):void 0}};return(e,i,s)=>{var r;const n=[];if(s.fill&&n.push(s.fill),s.fill2&&n.push(s.fill2),s.stroke){const t=s.stroke.getFillStyle();t!==ls&&("stroke"===(null===(r=s.behavior)||void 0===r?void 0:r.priority)?n.unshift(t):n.push(t))}if(s.point3D){const t=s.point3D;n.push(t.getFillStyle())}let o;if(s.behavior&&!0===s.behavior.colorStep){const[i,r]=n.reduce((e,i)=>{if(e[0]&&e[1])return e;const r=t(i,s.lutValue);return r&&(void 0===e[0]?e[0]=r:e[1]=r),e},[void 0,void 0]);o=i&&r?(a=i)===(h=r)||a.getR()===h.getR()&&a.getG()===h.getG()&&a.getB()===h.getB()?De(a):(a=Fe(a),h=Fe(h),new U({angle:0,stops:[{offset:0,color:h},{offset:.5,color:h},{offset:.5,color:a},{offset:1,color:a}]})):e.uiButtonFillStyle}else{const r=n.reduce((e,i)=>e||t(i,s.lutValue),void 0);o=r?i?new fs({color:r}):De(r):e.uiButtonFillStyle}var a,h;return o}})(),Re=(t,e)=>{const i=t;if(vs(i))return{lut:i.getPalette(),lookUpProperty:i.getLookUpProperty(),valueRange:e}},Le=t=>{let e=0;return()=>(e+=1,`${t}-${e}`)},Pe=(t,e)=>{let i="string"==typeof t?t:String(t);const s=i.indexOf(".");let r=s>=0?s:i.length;for(;r<e;r+=1)i=`0${i}`;return i},ze=(t,e)=>"function"==typeof t?t(e):t,_e=(t,e)=>e(),Ve=()=>new Error("LightningChart JS encountered an unexpected error.\nPlease report this issue to https://lightningchart.com/js-charts/docs/contact"),Ne=t=>t===ai||t.min.x===ai.min.x&&t.max.x===ai.max.x&&t.min.y===ai.min.y&&t.max.y===ai.max.y,Oe=t=>Array.from(new Set(t)),Ue=t=>t.filter(t=>void 0!==t),Ge=t=>"boolean"==typeof t?t?1:0:t>1?1:t<0?0:t,Ye=(t,e)=>{throw new Error(e)},Ze=t=>{let e;return()=>e||(e=t(),e)},We=t=>{if(t===Bt)return 0;const e=t.getThickness();return e<0?1:1*e},je=(t,e,i,s)=>{const r=`LightningChart JS Resources not found.\nresourcesBaseUrl: "${t}"\ninitiator: ${i}\nresource url: ${e}\nFor more information, please see https://lightningchart.com/js-charts/docs/troubleshooting/error-resources-not-found/`;if(s.shouldCrash)throw Ut.alert(r),new Error(r);Ut.console.warn(r)},He=(t,e,i,s=0)=>{if(t<i(s)||i(e)<t)return;const r=e;for(;s!==e;){const r=Math.ceil((s+e)/2);t<i(r)?e=r-1:s=r}const n=Math.abs(t-i(s));return s<r&&Math.abs(t-i(s+1))<n?s+1:s},$e=()=>{const t=new Map;return{Ji:e=>(Object.keys(xt).forEach(i=>{e.addEventListener(i,(e,s)=>{const r=s.collectionMember&&t.get(s.collectionMember);if(!r)return;const n=At(e)?{clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY}:e,o=r.Qi(s.info,n,s.collectionMember);r.D.R(i,e,o)})}),e),Ki:(e,i)=>{t.set(e,i)},Vi:()=>{t.clear()}}},Xe={left:0,right:0,top:0,bottom:0},qe=()=>Math.round(Math.random()*Number.MAX_SAFE_INTEGER),Ke=(t,e,i)=>{e&&e.qi();const s=i();return Object.keys(s).forEach(e=>{const i=e,r=s[i];t.addEventListener(i,r)}),{ts:t,qi:()=>{Object.entries(s).forEach(([e,i])=>{const s=e,r=i;t.removeEventListener(s,r)})}}},Je=(t,e,i)=>{let s;const r=()=>(s=i(),s),n={...t,resolve:()=>s||r()};for(const t of Object.keys(e))Object.defineProperty(n,t,{get:function(){return s?s[t]:r()[t]}});return n},Qe=t=>{if(t)return"resolve"in t?t.resolve():t},ti=t=>{let e=t;return{ss:t=>{const i=e;return e=i+t,[i,t]}}},ei=t=>{const e=Date.now();Ut.document.body.addEventListener(t,t=>{Date.now()-e>500||(t.stopPropagation(),t.preventDefault())},{once:!0,capture:!0})},ii=()=>{const t=Ut.performance.now();Ut.document.body.addEventListener("contextmenu",e=>{Ut.performance.now()-t>5e3||e.preventDefault()},{once:!0})},si=()=>{const t=Ut.performance.now();Ut.document.body.addEventListener("touchstart",e=>{Ut.performance.now()-t>5e3||e.preventDefault()},{once:!0})},ri={add:(t,e)=>d(t.x+e,t.y+e,t.z+e),addVec(t,...e){const i={x:t.x,y:t.y,z:t.z};for(const t of e)i.x+=t.x,i.y+=t.y,i.z+=t.z;return i},subtract:(t,e)=>d(t.x-e,t.y-e,t.z-e),subtractVec(t,...e){const i={x:t.x,y:t.y,z:t.z};for(const t of e)i.x-=t.x,i.y-=t.y,i.z-=t.z;return i},multiply:(t,e)=>d(t.x*e,t.y*e,t.z*e),divide:(t,e)=>d(t.x/e,t.y/e,t.z/e),multiplyVec(t,...e){const i={x:t.x,y:t.y,z:t.z};for(const t of e)i.x*=t.x,i.y*=t.y,i.z*=t.z;return i},divideVec(t,...e){const i={x:t.x,y:t.y,z:t.z};for(const t of e)i.x/=t.x,i.y/=t.y,i.z/=t.z;return i},length:t=>Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),normalize:t=>ri.divide(t,ri.length(t)),dot:(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,cross:(t,e)=>d(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x),angle:(t,e)=>Math.acos(ri.dot(t,e)/(ri.length(t)*ri.length(e))),rotateAroundAxis(t,e,i){const s=Math.cos(i),r=Math.sin(i),n=ri.dot(e,t),o=ri.cross(e,t);return ri.addVec(ri.multiply(t,s),ri.addVec(ri.multiply(e,(1-s)*n),ri.multiply(o,r)))},lerp:(t,e,i)=>(i=$t(i,0,1),ri.addVec(ri.multiply(t,1-i),ri.multiply(e,i))),equals:(t,e)=>Ht(t.x,e.x)&&Ht(t.y,e.y)&&Ht(t.z,e.z),abs:t=>({x:Math.abs(t.x),y:Math.abs(t.y),z:Math.abs(t.z)}),sign:t=>({x:Math.sign(t.x),y:Math.sign(t.y),z:Math.sign(t.z)})},ni=Number.MAX_VALUE,oi=-Number.MAX_VALUE,ai=g(l(ni,ni),l(oi,oi)),hi=g(d(ni,ni,ni),d(oi,oi,oi)),li=(t,e)=>{const i=Math.log(t)/Math.log(e);return Math.floor((t=>(Math.ceil(t)-t<1e-4?t=Math.ceil(t):t-Math.floor(t)<1e-4&&(t=Math.floor(t)),t))(i))},ci=(t,e)=>!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y),ui=(t,e)=>!(t[1].x<e[0].x||t[0].x>e[1].x||t[3].y<e[0].y||t[0].y>e[3].y),di=(t,e)=>({min:{x:Math.min(t[0].x,e[0].x),y:Math.min(t[0].y,e[0].y)},max:{x:Math.max(t[2].x,e[2].x),y:Math.max(t[2].y,e[2].y)}}),fi=t=>{const e=t.length;for(let i=0;i<e;i+=1)for(let s=i+1;s<e;s+=1)if(ci(t[i],t[s]))return!0;return!1},gi=(t,e)=>e+t,pi=(t,e,i)=>{const s=Pi(e,t),r=s.x*s.x+s.y*s.y;if(0===r)return t;const n=Pi(i,t),o=(n.x*s.x+n.y*s.y)/r;return o<=0?t:o>=1?e:l(t.x+o*s.x,t.y+o*s.y)},mi=(t,e,i)=>i>e?t>=e&&t<=i:t>=i&&t<=e,yi=(t,e)=>{const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)},xi=(t,e)=>{const i=t.x-e.x,s=t.y-e.y;return i*i+s*s},vi=(t,e,i)=>{let s=i.x-e.x,r=i.y-e.y;const n=s*s+r*r;if(n<.01)return Number.MAX_VALUE;const o=((t.x-e.x)*s+(t.y-e.y)*r)/n,a=e.x+o*s,h=e.y+o*r;return s=t.x-a,r=t.y-h,s*s+r*r},Ai=(t,e,i)=>Li(t,Ri(Pi(e,t),i)),Si=(t,e,i)=>ri.addVec(t,ri.multiply(ri.subtractVec(e,t),i));function bi(t){const e=t.length;if(e>0){let i=t[0].x,s=t[0].x,r=t[0].y,n=t[0].y;for(let o=1;o<e;o+=1){const e=t[o];e.x>i&&(i=e.x),e.x<s&&(s=e.x),e.y>r&&(r=e.y),e.y<n&&(n=e.y)}return g(l(s,n),l(i,r))}return ai}function Mi(t){const e=t.length;if(e>0){let i=t[0].x,s=t[0].x,r=t[0].y,n=t[0].y,o=t[0].z,a=t[0].z;for(let h=0;h<e;h+=1){const e=t[h];e.x>i&&(i=e.x),e.x<s&&(s=e.x),e.y>r&&(r=e.y),e.y<n&&(n=e.y),e.z>o&&(o=e.z),e.z<a&&(a=e.z)}return g(d(s,n,a),d(i,r,o))}return hi}const Ei=(...t)=>{const e={min:{x:ni,y:ni},max:{x:oi,y:oi}};for(const i of t)e.min.x=e.min.x<i.min.x?e.min.x:i.min.x,e.max.x=e.max.x>i.max.x?e.max.x:i.max.x,e.min.y=e.min.y<i.min.y?e.min.y:i.min.y,e.max.y=e.max.y>i.max.y?e.max.y:i.max.y;return e},ki=(t,e)=>g(d(t.min.x<e.min.x?t.min.x:e.min.x,t.min.y<e.min.y?t.min.y:e.min.y,t.min.z<e.min.z?t.min.z:e.min.z),d(t.max.x>e.max.x?t.max.x:e.max.x,t.max.y>e.max.y?t.max.y:e.max.y,t.max.z>e.max.z?t.max.z:e.max.z));function Ti(t,e,i,s){const r=t.x-s.x,n=t.y-s.y,o=s.x-i.x,a=i.y-s.y,h=a*r+o*n,l=(s.y-e.y)*r+(e.x-s.x)*n,c=a*(e.x-s.x)+o*(e.y-s.y);return c<0?h<=0&&l<=0&&h+l>=c:h>=0&&l>=0&&h+l<=c}const wi=(t,e,i)=>!(t.x>i.x||t.y>i.y||t.x<e.x||t.y<e.y);function Ci(t,e,i){return l(Math.cos(i)*(t.x-e.x)+Math.sin(i)*(t.y-e.y)+e.x,-Math.sin(i)*(t.x-e.x)+Math.cos(i)*(t.y-e.y)+e.y)}function Bi(t,e){return l(t.x-e.x,t.y-e.y)}function Fi(t){const e=Ii(t);return 0===e?l(0,0):l(t.x/e,t.y/e)}function Di(t,e){let i={x:e.x-t.x,y:e.y-t.y};i=Fi(i);const s=Math.PI/2,r=i.x;return i.x=-Math.sin(s)*i.y,i.y=r*Math.sin(s),i}function Ii(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function Ri(t,e){return l(t.x*e,t.y*e)}function Li(t,e){return l(t.x+e.x,t.y+e.y)}function Pi(t,e){return l(t.x-e.x,t.y-e.y)}function zi(t,e){return l(t.x*e.x,t.y*e.y)}function _i(t,e){return l(t.x/e.x,t.y/e.y)}function Vi(t){return Ri(t,-1)}function Ni(t,e){return t.x*e.x+t.y*e.y}const Oi=(t,e,i)=>{const s=(i.y-e.y)/(i.x-e.x),r=e.y+(t-e.x)*s;return l(t,r)};function Ui(t){return t*Math.PI/180}function Gi(t){return 180*Math.atan2(t.y,t.x)/Math.PI}function Yi(t){return l(Math.cos(t),Math.sin(t))}const Zi=(t,e,i,s)=>{let r,n,o,a;if(e.x-t.x!=0||s.x-i.x!=0)return e.x-t.x==0?(o=e.x,n=(s.y-i.y)/(s.x-i.x),a=n*(o-i.x)+i.y):s.x-i.x==0?(o=s.x,r=(e.y-t.y)/(e.x-t.x),a=r*(o-t.x)+t.y):(r=(e.y-t.y)/(e.x-t.x),n=(s.y-i.y)/(s.x-i.x),o=(i.y-n*i.x+r*t.x-t.y)/(r-n),a=r*(o-t.x)+t.y),l(o,a)},Wi=(t,e)=>{const i=t.length,s=e.length,r=new Uint16Array(i+s);return r.set(t,0),r.set(e,i),r};class ji extends j{constructor(t,e,i,s){super(t,e,i,s),this.es={internal:10,function:Hi(10),number:10},this.Y=1e3,this.W(1,1e3),this.Wt=this.rs()}et(t,e,i,s,r){if(t===e)return!1;const n=Math.min(t,e)<Xi,o=Math.max(t,e)>qi;return!n&&!o||!!r&&(e>t?{start:n?Xi:t,end:o?qi:e}:{start:o?qi:t,end:n?Xi:e})}Dt(t){const e=this.bt(),i=this.Mt(),s=Math.max(t,Xi);return e+(this.es.function(s)-this.Wt.scaleStartLog)/this.Wt.scaleIntervalLog*(i-e)}Et(t){const e=this.bt(),i=(t-e)/(this.Mt()-e),s=this.Wt.scaleStartLog+i*this.Wt.scaleIntervalLog;return this.es.number**s}Ft(){this.es&&this.rs()}W(t,e){return super.W(t,e),this.es&&this.rs(),this}St(t){return super.St(t),this.es&&this.rs(),this}Z(t){return super.Z(t),this.es&&this.rs(),this}hs(t){return this.es={internal:t,function:Hi(t),number:$i(t)},this}ns(){return this.es.internal}Qt(t,e){const i=this.Dt(t)+e;return this.Et(i)}Bt(){return this.nt||this.rt||this.ut||this.ht}rs(){const t=this.es.function(this.$),e=this.es.function(this.U)-t,i=2*this.bt()/this.Y-1,s=2*this.Mt()/this.Y-1-i;return this.Wt={scaleStartLog:t,scaleIntervalLog:e,viewportStart:i,viewportSize:s},this.Wt}Ht(){return this.Wt}}const Hi=t=>"e"===t?Te:ke(t),$i=t=>"e"===t?Math.E:t,Xi=.9*10**-20,qi=1.1*10**25,Ki=[{prefix:"T",unit:10**12},{prefix:"B",unit:10**9},{prefix:"M",unit:1e6},{prefix:"K",unit:1e3}],Ji=(t,e,i)=>{const s=Math.abs(i-e);if(0===s)return t.toFixed(0);const r=Math.max(2-li(s,10),0);return t.toFixed(r)},Qi={Numeric:(t,e)=>{const{start:i,end:s}=e;return Ji(t,i,s)},NumericUnits:(t,e)=>{const{start:i,end:s}=e,r=Math.abs(s-i),n=t<0;t=Math.abs(t);let o="",a="";if(r>=1e3&&t>1e3){let e="";for(const i of Ki){const s=Math.round(1e3*t/i.unit)/1e3;if(s>=1){e=s.toString(),a=i.prefix;break}}o=(n?"-":"")+e}else{let e=String(Math.floor(t));const i=li(t,1e3);for(let t=1;t<=i;t+=1){const i=e.length-(3*t+(t-1));e=`${e.substring(0,i)} ${e.substring(i,e.length)}`}o=(n?"-":"")+e+(r<=10?((t,e)=>{if(0===e)return"";let i=(Math.abs(t)-Math.abs(Math.floor(t))).toString().substring(1);return i.length>e&&(i=i.substring(0,e+1)),i})(t,2-li(r,10)):"")}return o+=a,o},LogarithmicExponentsRounded:(t,e,i,s=10)=>{const r=Hi(s)(t);return`${s}${ts(r)}`},LogarithmicExponents:(t,e,i,s=10)=>{const r=Hi(s),n=Math.floor(r(t)),o=t/$i(s)**n;return`${Math.round(o)}×${s}${ts(n)}`},LogarithmicExtreme:(t,e,i,s=10)=>{const r=Hi(s),n=Math.floor(r(t));return`${(t/$i(s)**n).toFixed(2)}×${s}${ts(n)}`},LogarithmicNoExponents:(t,e,i,s=10)=>{const r=Hi(s);if("e"===s)return`${Math.floor(r(t))}e`;const n=t.toString();if(t>1)return n;const o=Math.floor(r(t));return t.toFixed(Math.abs(o))},Scientific:(t,e)=>{const{start:i,end:s}=e,r=Math.max(Math.abs(i),Math.abs(s)),n=Math.floor(Math.log10(r));return 0===t?`0.00e${n<0?"":"+"}${n}`:t.toExponential(2)}},ts=t=>Math.round(t).toString().split("").map(t=>{switch(t){case"0":return"⁰";case"1":return"¹";case"2":return"²";case"3":return"³";case"4":return"⁴";case"5":return"⁵";case"6":return"⁶";case"7":return"⁷";case"8":return"⁸";case"9":return"⁹";case"-":return"⁻";default:return t}}).join(""),es=(t,e)=>t.value-e.value,is=s.Record({type:"lut",steps:[],title:"",units:"",interpolate:!0,color:M(0,0,0,255),length:0,min:0,max:0,subranges:[],isValid:!1,percentageValues:!1,formatter:(t,e)=>Ji(t,e.min,e.max)}),ss=t=>{const{steps:e}=t,i=e.length;e.sort(es);const[s,r]=i>0?[e[0].value,e[i-1].value]:[0,0],n=i>0?i-1:0,o=Array(n);for(let t=0;t<n;t+=1)o[t]={min:e[t],max:e[t+1]};return{min:s,max:r,length:i,steps:e,subranges:o,isValid:i>0&&s!==r}};class rs extends is{constructor(t){super(((t,e)=>({steps:t.steps,title:t.title,units:t.units,interpolate:t.interpolate,percentageValues:t.percentageValues,color:t.color,formatter:t.formatter,length:e.length,min:e.min,max:e.max,subranges:e.subranges,isValid:e.isValid}))(t,ss(t)))}toString(){return`LUT:interpolate=${this.interpolate},steps=${this.steps.length},percentage=${this.percentageValues}`}setSteps(t){return this.merge(ss({...this,steps:t}))}getSteps(){return this.get("steps")}setTitle(t){return this.set("title",t)}getTitle(){return this.get("title")}setUnits(t){return this.set("units",t)}getUnits(){return this.get("units")}setInterpolation(t){return this.set("interpolate",t)}getInterpolation(){return this.get("interpolate")}setFallbackColor(t){return this.set("color",t)}getFallbackColor(){return this.get("color")}setPercentageValues(t){return this.set("percentageValues",t)}getPercentageValues(){return this.get("percentageValues")}setFormatter(t){return this.set("formatter",t)}getFormatter(){return this.get("formatter")}getColors(t,e){if(Array.isArray(t)){if(Array.isArray(t[0])){const i=t,s=i.length,r=i[0].length,n=[...Array(s)].map(()=>Array(r));for(let t=0;t<s;t+=1)for(let s=0;s<r;s+=1)n[t][s]=this.ls(i[t][s],e);return n}const i=t,s=i.length,r=Array(s);for(let t=0;t<s;t+=1)r[t]=this.ls(i[t],e);return r}return this.ls(t,e)}ls(t,e){const{steps:i}=this,s=i.length;if(0===s)return this.getFallbackColor();if(1===s)return i[0].color||this.color;if(this.percentageValues,this.percentageValues&&e&&(t=Math.max(Math.min((t-e.min)/(e.max-e.min),1),0)),this.interpolate){for(let e=0;e<s-1;e+=1){const s=i[e],a=i[e+1],h=Math.min(s.value,a.value),l=Math.max(s.value,a.value);if(t>=h&&t<=l){if(h===l)return s.color;const e=(t-s.value)/(a.value-s.value);return r=s.color,n=a.color,o=e,new S({r:r.r+(n.r-r.r)*o,g:r.g+(n.g-r.g)*o,b:r.b+(n.b-r.b)*o,a:r.a+(n.a-r.a)*o})}}return t<i[0].value?i[0].color:i[s-1].color}var r,n,o;for(let e=s-1;e>=0;e-=1)if(t>=i[e].value)return i[e].color;return i[0].color}}const ns=t=>!(!t||"object"!=typeof t||!("type"in t)||"lut"!==t.type),os=(t,e)=>t.formatter(e,{min:t.min,max:t.max,percentageValues:t.percentageValues}),as=s.Record({type:"fillstyle",fillType:"empty"});class hs extends as{toString(){return"emptyFill"}toCSS(){return"transparent"}}const ls=new hs,cs=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"empty"===t.fillType),us=s.Record({type:"fillstyle",fillType:"solid",color:M(255,255,255)});class ds extends us{}class fs extends ds{constructor(t){super({...t,fillType:"solid"})}toString(){return`solidFill:${this.color.toString()}`}toCSS(){return this.color.toRGBAString()}setColor(t){return b(t)?this.set("color",t):this.set("color",t(this.get("color")))}getColor(){return this.get("color")}setA(t){return this.setColor(this.getColor().setA(t))}setR(t){return this.setColor(this.getColor().setR(t))}setG(t){return this.setColor(this.getColor().setG(t))}setB(t){return this.setColor(this.getColor().setB(t))}}const gs=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"solid"===t.fillType);class ps extends ds{constructor(t){super({...t,fillType:"individual"})}toString(){return`individualPointFill:${this.color.toString()}`}toCSS(){return this.getFallbackColor().toRGBAString()}setFallbackColor(t){return b(t)?this.set("color",t):this.set("color",t(this.get("color")))}getFallbackColor(){return this.get("color")}}const ms=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"individual"===t.fillType),ys=s.Record({type:"fillstyle",fillType:"palette",lut:new rs({steps:[]}),lookUpProperty:"value"});class xs extends ys{constructor(t){super({...t,fillType:"palette"})}toString(){return`palettedFill:lut=${this.lut.toString()},lookUpProperty=${this.lookUpProperty}`}toCSS(){return`linear-gradient(${this.lut.getSteps().map(t=>t.color.toRGBAString()).join(", ")})`}getPalette(){return this.get("lut")}setLookUpProperty(t){return"function"==typeof t?this.set("lookUpProperty",t(this.get("lookUpProperty"))):this.set("lookUpProperty",t)}getLookUpProperty(){return this.get("lookUpProperty")}}const vs=t=>!!(t&&"object"==typeof t&&"type"in t&&"fillstyle"===t.type&&"fillType"in t&&"palette"===t.fillType),As=(t,e)=>t instanceof ji||e instanceof ji?(new K).Kt(t,e):(new q).Kt(t,e),Ss=t=>"client"===t,bs=t=>!!(t&&"object"==typeof t&&"clientX"in t&&"number"==typeof t.clientX&&"clientY"in t&&"number"==typeof t.clientY),Ms=t=>"relative"===t,Es=t=>!!(t&&"object"==typeof t&&"x"in t&&"number"==typeof t.x&&"y"in t&&"number"==typeof t.y),ks=(t,e,i,s)=>{let r,n,o=Number.MAX_VALUE;for(let a=0;a<e.length;a+=1){const h=e[a],l=i(h,t);if(l){const e=s(t,l);(void 0===r||e<o)&&(r=l,n=h,o=e)}}return r&&n?[r,n]:void 0},Ts=(t,e,i,s,r,n)=>{if(!t)return;let o=t;const a="button"in i?i:void 0;if(a&&"wheel"!==i.type)if(0===a.button){if(!1===t.lmb)return;void 0!==t.lmb&&(o=Nt(o,t.lmb))}else if(1===a.button){if(!1===t.mmb)return;void 0!==t.mmb&&(o=Nt(o,t.mmb))}else if(2===a.button){if(!1===t.rmb)return;void 0!==t.rmb&&(o=Nt(o,t.rmb))}if(s){if(!1===t.shift)return;o=Nt(o,t.shift)}if(r){if(!1===t.ctrl)return;o=Nt(o,t.ctrl)}if(n){if(!1===t.alt)return;o=Nt(o,t.alt)}if(!e)return o;const h=o[e];return h?!0===h?o:Nt(o,h):void 0},ws=t=>{const e=[];return{push:t=>{e.push(t)},end:()=>{e.length>1&&t&&Ut.console.warn("LightningChart JS warning | event handler triggered more than 1 interaction.\nThis likely means that your `chart.setUserInteractions` configuration either enables conflicting interactions or more likely doesn't disable conflicting default interactions."),e.forEach(t=>t())}}},Cs=(t,e,i)=>{if(t){const t={x:i.x.bt(),y:i.y.bt(),width:i.x.wt(),height:i.y.wt()};e.forEach(e=>{e.us=t})}else e.forEach(t=>{t.us=void 0})},Bs=(t,e)=>{var i;return e?"string"==typeof e?`${t} ${e}`:!1!==(null===(i=e.cs)||void 0===i?void 0:i.displayInCursor)&&e.getUnits()?`${t} ${e.getUnits()}`:t:t},Fs=t=>{let e=!1,i={type:"linear"};if(t&&(void 0!==t.opposite&&(e=t.opposite),t.type&&"linear-highPrecision"===t.type&&(i={type:"linear-highPrecision"}),t.type&&"logarithmic"===t.type)){let s=10;if(t.base)if("E"===t.base||"e"===t.base||"natural"===t.base)s="e";else if("number"==typeof t.base)s=t.base;else if("string"==typeof t.base)try{s=Number(t.base)}catch(e){console.warn(`Unidentified logarithmic base "${t.base}"`)}i={base:s,type:"logarithmic"}}return{opposite:e,type:i}},Ds=(t,e,i,s=1)=>$t(t+.1*s*(e-t)+.5*s*Math.abs(i.getPixelSize())*Math.sign(e-t),t,e),Is=(t,e,i,s=1)=>{const r=i.Dt(t),n=i.Dt(e);return $t(i.Et(r+.1*s*(n-r)+.5*s*Math.sign(n-r)),t,e)};var Rs,Ls;e.HighlightModes=void 0,(Rs=e.HighlightModes||(e.HighlightModes={}))[Rs.noHighlighting=0]="noHighlighting",Rs[Rs.onHover=1]="onHover",Rs[Rs.onHoverIndividual=2]="onHoverIndividual";class Ps{constructor(t,i,s,r){this.ds=e.HighlightModes.onHover,this.ci=!1,this.di=!0,this.fs=[],this.chart=t,this.As=i,this.bi=s,this.gs=new Map,this.ps=r,this.vs=this.ps.ys(this,{xs:{themeEffectEnabled:this.bi.effectsText},Ss:{}}),this.chart.pi.Ms.bs(this,t=>{this.gs.forEach((e,i)=>i.Ii(t)),this.fs.forEach(e=>e.Ii(t))},{animationEnabled:this.chart.getAnimationsEnabled()}),Ut.requestAnimationFrame(()=>{this.ci||(this.addEventListener("pointerenter",()=>{this.ds===e.HighlightModes.onHover&&this.setHighlight(!0)}),this.addEventListener("pointerleave",()=>{this.ds===e.HighlightModes.onHover&&this.setHighlight(!1)}))})}ws(){}_s(t,e){const i=void 0===(null==e?void 0:e.setEventHandlers)||e.setEventHandlers,s=void 0!==(null==e?void 0:e.pointerEventsDisabled)&&e.pointerEventsDisabled,r=void 0!==(null==e?void 0:e.isText)&&e.isText;this.gs.set(t,{isText:r,pointerEventsDisabled:s});const n=Array.from(this.gs);this.vs.xs.ks(n.filter(t=>t[1].isText).map(t=>t[0])),this.vs.Ss.ks(n.filter(t=>!t[1].isText).map(t=>t[0])),t.setVisible(this.di).Ii(this.chart.pi.Ms.Cs(this,!0)),Ut.requestAnimationFrame(()=>{this.ci||t.isDisposed()||(t.setPointerEvents(!0!==(null==e?void 0:e.pointerEventsDisabled)&&this.getPointerEvents()),i&&this.D.zi(t,{getExtraData:(t,e,i)=>this.Qi(i,t,e)}))});const o=e=>{t.removeEventListener("dispose",o),this.gs.delete(t)};t.addEventListener("dispose",o)}Ts(t){this.fs=t;const e=this.chart.pi.Ms.Cs(this,!0);t.forEach(t=>{t.Ii(e).Fs(this.di)})}Qi(t,e,i){}Is(t){const e=this.chart.pi.Ls(t);if(e&&Array.from(this.gs.keys()).includes(e.entity))return this.Qi(e.info,t,e.collectionMember)}setEffect(t){return this.vs.xs.Ps(t&&this.bi.effectsText),this.vs.Ss.Ps(t),this.chart.pi.Bs(),this}getEffect(){return this.vs.xs.Ds()||this.vs.Ss.Ds()}setIcon(t){return this.Es=t,this.chart.pi.Bs(),this}getIcon(){return this.Es}setName(t){return this.Rs=t,this}getName(){return this.Rs||"Component"}dispose(){return this.ci||(this.ci=!0,this.gs.forEach((t,e)=>e.dispose()),this.As(this),this.D.R("dispose",{}),this.chart.legend.remove(this),this.chart.pi.Bs()),this}setVisible(t){return t===this.di||(this.di=t,this.gs.forEach((e,i)=>i.setVisible(t)),this.fs.forEach(e=>e.Fs(t)),this.D.R("visiblechange",{isVisible:t}),this.chart.Os.forEach(t=>t.zs()),this.chart.pi.Bs()),this}getVisible(){return this.di}setHighlight(t){return this.chart.pi.Ms.Vs(this,t),this.D.R("highlightchange",{highlight:Ge(t)}),this}getHighlight(){return this.chart.pi.Ms.Cs(this)}setAnimationHighlight(t){return this.chart.pi.Ms.Ns(this,t),this}getAnimationHighlight(){return this.chart.pi.Ms.Gs(this)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}getPointed(){if(!this.chart.pi.$s())return!1;for(const t of this.gs)if(this.chart.pi.Us(t[0]))return!0;for(const t of this.fs)if(this.chart.pi.Us(void 0,t))return!0;return!1}setHighlightOnHover(t){return this.ds="boolean"==typeof t?t?e.HighlightModes.onHover:e.HighlightModes.noHighlighting:t,this.ds===e.HighlightModes.noHighlighting&&this.getHighlight()>0&&this.setHighlight(!1),this}getHighlightOnHover(){return this.ds!==e.HighlightModes.noHighlighting}Ys(){}js(){return this.Es}isDisposed(){return this.ci}set draggable(t){this.D.draggable=t}get draggable(){return this.D.draggable}}class zs extends Ps{constructor(t,e,i,s,r,n,o,a){super(e,i,o,a),this.Hs=!0,this.Ws=t,this.axis=s,this.ai=r,this.Xs=n,Ut.requestAnimationFrame(()=>this.Zs())}setClipping(t){return this.Hs=t,this.Ws.Bs(),this}getClipping(){return this.Hs}}e.TextObjectIdentifier=void 0,(Ls=e.TextObjectIdentifier||(e.TextObjectIdentifier={}))[Ls.Other=0]="Other",Ls[Ls.CursorResultTable=1]="CursorResultTable",Ls[Ls.CursorTickMarker=2]="CursorTickMarker",Ls[Ls.ChartTitle=3]="ChartTitle",Ls[Ls.AxisTitle=4]="AxisTitle";const _s=t=>"object"==typeof t&&null!==t&&"setCornerRadius"in t;var Vs;e.PointShape=void 0,(Vs=e.PointShape||(e.PointShape={}))[Vs.Square=0]="Square",Vs[Vs.Circle=1]="Circle",Vs[Vs.HollowCircle=2]="HollowCircle",Vs[Vs.Triangle=3]="Triangle",Vs[Vs.Cross=4]="Cross",Vs[Vs.Diamond=5]="Diamond",Vs[Vs.Plus=6]="Plus",Vs[Vs.Minus=7]="Minus",Vs[Vs.Arrow=8]="Arrow",Vs[Vs.Star=9]="Star";const Ns=t=>"ProgressiveX"===t||"RegressiveX"===t?"x":"y",Os=t=>"ProgressiveX"===t||"ProgressiveY"===t,Us=(t,e,i)=>t*(1-i)+e*i,Gs=(t,e,i,s,r)=>{if(void 0===e.value||void 0===i.value||void 0===s.value||void 0===r.value)return;const n=(t.x-i.point.x)/(r.point.x-i.point.x),o=(r.point.y-i.point.y)*n+i.point.y,a=(t.x-e.point.x)/(s.point.x-e.point.x),h=(s.point.y-e.point.y)*a+e.point.y,l=(t.y-h)/(o-h),c=Us(i.value,r.value,n),u=Us(e.value,s.value,a);return Us(u,c,l)},Ys={warm:t=>e=>k(60/(t-1)*e,.8,.8),cold:t=>e=>k(60/(t-1)*e+180,.8,.8),fullSpectrum:t=>e=>k(360/t*e,.8,.8),reverseSpectrum:t=>e=>k(360/t*(t-e),.8,.8),flatUI:t=>e=>k(360/t*e+8,.8,.8-.15/t*e),arction:t=>e=>{const i=1-.2/t*e;return k(360/t*e+51,i,i)},arctionWarm:t=>e=>{const i=t-1,s=1-.2/i*e;return k(46-46/i*e+4,s,s)},sunset:t=>e=>{const i=[170,320];return k(e%2?i[0]:i[1],.8,.5+.5/(t-1)*e)},dynamic:t=>e=>{const i=e%2,s=[234,346];return k(i?s[0]:s[1],i?.3:.9,.5+.5/(t-1)*e)},magenta:t=>e=>{const i=[.9,.6];return k(354,e%2?i[0]:i[1],.5+.5/(t-1)*e)},greyscale:t=>e=>k(0,0,.25+.5/(t-1)*e),frozen:t=>e=>{const i=[.8,.6];return k(160+80/(t-1)*e,.6,e%2?i[0]:i[1])},retro:t=>e=>{const i=[6,183];return k(e%2?i[0]:i[1],.7,.5+.5/(t-1)*e)},crayons:t=>e=>{let i=180+230/(t-1)*e;return i>360&&(i-=360),k(i,.9,.8)},custom:(t,e)=>i=>{const s=.25+.5/(t-1)*i;if(!e)return k(0,0,s);const r=e.getR()/255,n=e.getG()/255,o=e.getB()/255,a=Math.max(r,n,o),h=Math.min(r,n,o);let l=0;if(a!==h){const t=a-h;switch(a){case r:l=(n-o)/t+(n<o?6:0);break;case n:l=(o-r)/t+2;break;case o:l=(r-n)/t+4;break;default:l=0}return l=l/6*360,k(l,.8,s)}return k(0,0,s)},sector:(t,e,i=.8,s=.8)=>r=>n=>k(t+(e-t)/r*n,i,s),auroraBorealis:t=>e=>Zs([{value:0,hex:"#23FF7A"},{value:1/9,hex:"#03E65D"},{value:2/9,hex:"#04D155"},{value:3/9,hex:"#00B849"},{value:4/9,hex:"#00A869"},{value:5/9,hex:"#008F68"},{value:6/9,hex:"#00815E"},{value:7/9,hex:"#017153"},{value:8/9,hex:"#704A85"},{value:1,hex:"#743A70"}],t,e),blueSciFi:t=>e=>Zs([{value:0,hex:"#FFFFFF"},{value:1/9,hex:"#E2E7FF"},{value:2/9,hex:"#ACB9F8"},{value:3/9,hex:"#889DFF"},{value:4/9,hex:"#547EEF"},{value:5/9,hex:"#4068D8"},{value:6/9,hex:"#2B50B7"},{value:7/9,hex:"#1B3E9F"},{value:8/9,hex:"#8D1395"},{value:1,hex:"#780A74"}],t,e),light:t=>e=>Zs([{value:0,hex:"#FECC00"},{value:1/9,hex:"#F7B300"},{value:2/9,hex:"#EF9900"},{value:3/9,hex:"#E88000"},{value:4/9,hex:"#E06600"},{value:5/9,hex:"#DD5A00"},{value:6/9,hex:"#D94D00"},{value:7/9,hex:"#D13300"},{value:8/9,hex:"#C91A00"},{value:1,hex:"#C10000"}],t,e),monochrome:t=>e=>Zs([{value:0,hex:"#FFFFFF"},{value:1/9,hex:"#EEEEEE"},{value:2/9,hex:"#DCDCDC"},{value:3/9,hex:"#C1C1C1"},{value:4/9,hex:"#A4A2A2"},{value:5/9,hex:"#8B8B8B"},{value:6/9,hex:"#787878"},{value:7/9,hex:"#656565"},{value:8/9,hex:"#565555"},{value:1,hex:"#434343"}],t,e),night:t=>e=>Zs([{value:0,hex:"#F0F9E0"},{value:1/9,hex:"#C9DFA4"},{value:2/9,hex:"#B5C796"},{value:3/9,hex:"#8998B7"},{value:4/9,hex:"#6E7E9E"},{value:5/9,hex:"#5C6D8F"},{value:6/9,hex:"#47587A"},{value:7/9,hex:"#374B72"},{value:8/9,hex:"#273C65"},{value:1,hex:"#192847"}],t,e),sunset2:t=>e=>Zs([{value:0,hex:"#22334D"},{value:1/9,hex:"#82062C"},{value:2/9,hex:"#AB001D"},{value:3/9,hex:"#D80428"},{value:4/9,hex:"#CF5D1B"},{value:5/9,hex:"#CF8229"},{value:6/9,hex:"#CF9D29"},{value:7/9,hex:"#C4BE25"},{value:8/9,hex:"#E1DC49"},{value:1,hex:"#FFFA67"}],t,e)},Zs=(t,e,i)=>{const s=js(e,i),[r,n]=Hs(s,t),o=Ws(t[r]),a=Ws(t[n]),h=0!==o.value?(a.value-s)/o.value:0,l={value:h,h:Us(o.h,a.h,h),s:Us(o.s,a.s,h),v:Us(o.v,a.v,h)};return k(l.h,l.s,l.v)},Ws=t=>{const e=(t=>{const e=t.r,i=t.g,s=t.b,r=Math.max(e,i,s),n=Math.min(e,i,s);let o=0;const a=r,h=r-n,l=0===r?0:h/r;if(r===n)o=0;else{switch(r){case e:o=(i-s)/h+(i<s?6:0);break;case i:o=(s-e)/h+2;break;case s:o=(e-i)/h+4}o/=6}return[360*o,l,a]})(E(t.hex));return{value:t.value,h:e[0],s:e[1],v:e[2]}},js=(t,e)=>{const i=e/t;return i<0?0:i>1?1:i},Hs=(t,e)=>{if(e.length<2)throw new Error("Invalid palette size");for(let i=0;i<e.length;i+=1)if(t<e[i].value)return[i-1,i];return[e.length-2,e.length-1]};class $s{constructor(){this.type="simple"}}const Xs=new $s;class qs{constructor(t){this.type="phong",this.ambientReflection=1,this.specularReflection=.1,this.diffuseReflection=1,this.ambientColor=E("#000"),this.specularColor=E("#fff"),this.shininess=32,t&&(this.ambientReflection=Number.isNaN(Number(t.ambientReflection))?this.ambientReflection:Number(t.ambientReflection),this.specularReflection=Number.isNaN(Number(t.specularReflection))?this.specularReflection:Number(t.specularReflection),this.diffuseReflection=Number.isNaN(Number(t.diffuseReflection))?this.diffuseReflection:Number(t.diffuseReflection),this.ambientColor=t.ambientColor||this.ambientColor,this.specularColor=t.specularColor||this.specularColor,this.shininess=t.shininess||this.shininess)}}const Ks=new qs,Js={Simple:$s,Phong:qs};class Qs{getFillStyle(){return ls}}const tr=new Qs,er=s.Record({type:"triangulated-points-3d",shape:"sphere",size:10,fillStyle:new fs,wireframeStyle:Bt});class ir extends er{constructor(t){super(t)}setSize(t){return this.set("size",t)}getSize(){return this.get("size")}setFillStyle(t){return"function"==typeof t?this.set("fillStyle",t(this.get("fillStyle"))):this.set("fillStyle",t)}getFillStyle(){return this.get("fillStyle")}setWireframeStyle(t){return"function"==typeof t?this.set("wireframeStyle",t(this.get("wireframeStyle"))):this.set("wireframeStyle",t)}getWireframeStyle(){return this.get("wireframeStyle")}setShape(t){return this.set("shape",t)}getShape(){return this.get("shape")}}const sr=t=>!(!t||"object"!=typeof t||!("type"in t)||"triangulated-points-3d"!==t.type),rr=s.Record({type:"pixelated-points-3d",size:5,fillStyle:new fs});class nr extends rr{constructor(t){super(t)}setSize(t){return this.set("size",t)}getSize(){return this.get("size")}setFillStyle(t){return"function"==typeof t?this.set("fillStyle",t(this.get("fillStyle"))):this.set("fillStyle",t)}getFillStyle(){return this.get("fillStyle")}}const or=t=>!(!t||"object"!=typeof t||!("type"in t)||"pixelated-points-3d"!==t.type),ar={Triangulated:ir,Pixelated:nr},hr=s.Record({type:"linestyle",lineType:"solid",fillStyle:new fs({color:M(255,255,255)}),thickness:1});class lr extends hr{constructor(t){super({...t,lineType:"solid"})}setFillStyle(t){return"function"==typeof t?this.set("fillStyle",t(this.getFillStyle())):this.set("fillStyle",t)}getFillStyle(){return this.get("fillStyle")}setThickness(t){return"function"==typeof t?this.set("thickness",t(this.getThickness())):this.set("thickness",t)}getThickness(){return this.get("thickness")}ji(){const t=this.getThickness();return t<0?1:t}}const cr=t=>!(!t||"object"!=typeof t||!("lineType"in t)||"solid"!==t.lineType),ur={Dotted:[1,3],DottedDense:[1,1],Dashed:[3,1],DashedEqual:[2,2],DashedLoose:[2,4],DashDotted:[3,2,1,2]},dr=s.Record({type:"linestyle",lineType:"dashed",pattern:ur.DashedEqual,fillStyle:new fs({color:M(255,255,255)}),thickness:1,patternScale:3});class fr extends dr{constructor(t){super({...t,lineType:"dashed"})}setFillStyle(t){return"function"==typeof t?this.set("fillStyle",t(this.getFillStyle())):this.set("fillStyle",t)}getFillStyle(){return this.get("fillStyle")}setThickness(t){return"function"==typeof t?this.set("thickness",t(this.getThickness())):this.set("thickness",t)}getThickness(){return this.get("thickness")}ji(){const t=this.getThickness();return t<0?1:t}setPattern(t){return"function"==typeof t?this.set("pattern",t(this.getPattern())):this.set("pattern",t)}getPattern(){return this.get("pattern")}setPatternScale(t){return"function"==typeof t?this.set("patternScale",t(this.getPatternScale())):this.set("patternScale",t)}getPatternScale(){return this.get("patternScale")}}const gr=t=>!(!t||"object"!=typeof t||!("lineType"in t)||"dashed"!==t.lineType),pr=s.Record({type:"icon",width:void 0,height:void 0,Js:void 0,Qs:jt,Ks:jt});class mr extends pr{constructor(t,e,i,s){super({...s,Js:t,Qs:e,Ks:i})}dispose(){return this.Ks(this),this}setWidth(t){const e=this.set("width",t);return this.Qs(e),e}getWidth(){return this.get("width")}setHeight(t){const e=this.set("height",t);return this.Qs(e),e}getHeight(){return this.get("height")}setSize(t,e){const i=this.withMutations(i=>{i.set("width",t).set("height",e)});return this.Qs(i),i}kt(){if(!this.Js)return{x:0,y:0};const t=this.Js.width,e=this.Js.height;if(0===t||0===e)return{x:0,y:0};const i=this.width,s=this.height;return"number"==typeof i&&"number"==typeof s?{x:i,y:s}:"number"==typeof i?{x:i,y:e*i/t}:"number"==typeof s?{x:t*s/e,y:s}:{x:t,y:e}}}const yr=t=>!(!t||"object"!=typeof t||!("type"in t)||"icon"!==t.type),xr=s.Record({type:"glow",color:M(255,255,255,50),spread:1,blur:4,offset:{x:0,y:0}});class vr extends xr{constructor(t){super(t)}setSpread(t){return this.set("spread","function"==typeof t?t(this.get("spread")):t)}getSpread(){return this.get("spread")}setBlur(t){return this.set("blur","function"==typeof t?t(this.get("blur")):t)}getBlur(){return this.get("blur")}setColor(t){return this.set("color","function"==typeof t?t(this.get("color")):t)}getColor(){return this.get("color")}setOffset(t){return this.set("offset","function"==typeof t?t(this.get("offset")):t)}getOffset(){return this.get("offset")}}class Ar extends X{constructor(){super(...arguments),this.ri="RadialScale",this.qs={start:0,end:1},this.te=!1,this.ie=0,this.Y=l(0,0),this.se=[0,0],this.ee=[0,0],this.u=!0,this.Lt=!0,this.re=!0,this.he=!0,this.ne={x:0,y:0},this.Wt={x:{displacement:0,scaling:0,highPrecisionOffset:0},y:{displacement:0,scaling:0,highPrecisionOffset:0}}}oe(t,e){return t===this.qs.start&&e===this.qs.end||(this.qs={start:t,end:e},this.re=!0,this.ae()),this}le(){return this.qs}ue(){return this.qs.end>=this.qs.start}ce(t){this.te=t,this.he=!0}de(){return!1===this.te}fe(t){this.ie=t,this.he=!0}Ae(){return this.ie}Bt(){return this.Lt}zt(){return!1}hi(t,e,i,s){return this.x=new H(t.x,e.x,i.x,s?s.x:void 0),this.y=new H(t.y,e.y,i.y,s?s.y:void 0),this}Ht(){return this.Wt}ge(){return this.re}pe(){return this.he}ni(){return this.ne}j(){return this.u=!1,this.Lt=!1,this.re=!1,this.he=!1,this}H(){return this.u=!0,this.Lt=!0,this.re=!0,this.he=!0,this}Z(t,e){return"object"==typeof t?(this.Y.x=t.x,this.Y.y=t.y):(this.Y.x=t,this.Y.y=e),this.ae(),this}qt(t){return this.se=t,this.ae(),this}ti(t){return this.ee=t,this.ae(),this}_t(){return l(this.se[0]+this.se[1],this.ee[0]+this.ee[1])}kt(){return this.Y}ae(){const t=this.qs,e=l(this.x.Ct(this.Y.x),this.y.Ct(this.Y.y)),i=this.se[0]+this.se[1],s=this.ee[0]+this.ee[1],r=Math.max(e.x-i,0),n=Math.max(e.y-s,0),o=.5*(r>n?n:r),a=[this.se[0]+Math.max((r-2*o)/2,0),this.se[1]+Math.max((r-2*o)/2,0)],h=[this.ee[0]+Math.max((n-2*o)/2,0),this.ee[1]+Math.max((n-2*o)/2,0)],c=Math.abs(t.end-t.start);this.x.Z(this.Y.x).St(a).W(-c,c),this.y.Z(this.Y.y).St(h).W(-c,c),this.ne={x:this.x.getPixelSize(),y:this.y.getPixelSize()},this.Wt={x:this.x.Ht(),y:this.y.Ht()},this.H()}Qt(t,e){const i=this.ni();return{x:t.x+e.x*i.x,y:t.y+e.y*i.y}}oi(t,e,i,s){const r=this.ni(),n=Di(t,e);return n.x*=s,n.y*=s,{x:t.x+i*r.x*n.x,y:t.y+i*r.y*n.y}}}const Sr=t=>{if(t instanceof q||t instanceof Ar)return t.zt()?"linear-highPrecision":"linear";if(t instanceof K){const e={};return t.x instanceof ji&&(e.x={base:t.x.ns()}),t.y instanceof ji&&(e.y={base:t.y.ns()}),["logarithmic",e]}return"linear"},br=(t,e,i)=>{if(0===i||360===i||180===i||i%180==0)return{x:t,y:e};if(90===i||-90===i||(i+90)%180==0)return{x:e,y:t};const s=i*Math.PI/180,r=Math.cos(s),n=Math.sin(s);return{x:Math.abs(t*r)+Math.abs(e*n),y:Math.abs(t*n)+Math.abs(e*r)}},Mr=t=>{const e=Object.keys(t),i={};return e.forEach(e=>{const s=t[e];let r=!1;i[e]=t=>{if(!t)return r;const e=s();return r=e,e}}),i},Er=(t,e,i)=>"value"===t.getLookUpProperty()?i:"x"===t.getLookUpProperty()?{min:e.Hi(),max:e.Wi()}:"y"===t.getLookUpProperty()?{min:e.Xi(),max:e.Zi()}:"z"===t.getLookUpProperty()?{min:e.ve(),max:e.ye()}:void 0,kr=t=>!(!t||"value"!==t.lookUpProperty||!t.lut.percentageValues),Tr={init:t=>(t=>{const i=new Map;t.engine.addEventListener("locationchange",()=>{i.forEach(t=>{t.bounds=void 0})});const s=e=>{let s=i.get(e.uid);if(!s){const r=document.createElement("p");r.className="lcjs-text",t.engine.container.append(r),r.style.userSelect="none",r.style.whiteSpace="nowrap",r.style.margin="0px",s={span:r,active:!0},i.set(e.uid,s),r.addEventListener("pointerenter",i=>t.handleEvent(e,i)),r.addEventListener("pointermove",i=>t.handleEvent(e,i)),r.addEventListener("pointerleave",i=>t.handleEvent(e,i))}if(s.text!==e.text&&(((t,e)=>{const i=t.includes("latex:"),s=!i&&t.includes("tex:");let r=!0;if(i||s)try{Ut.MathJax&&i?(r=!1,e.innerHTML=t.replace(/latex:/g,""),Ut.MathJax.typesetPromise([e]).catch(t=>Ut.console.error(t.message))):Ut.katex&&s&&(r=!1,Ut.katex.render(t.replace(/tex:/g,""),e,{throwOnError:!1}))}catch(t){r=!0}r&&(e.innerHTML=t)})(e.text,s.span),s.bounds=void 0),s.font!==e.font&&(s.span.style.font=e.font,s.bounds=void 0),s.position!==e.position&&(s.span.style.position=e.position,s.bounds=void 0),s.color!==e.color&&(s.span.style.color=e.color),s.padding!==e.padding&&(s.span.style.padding=e.padding,s.bounds=void 0),s.rotation!==e.rotation&&(s.span.style.transform=`rotate(${e.rotation}deg)`,s.bounds=void 0),s.span.style.lineHeight="80%",s.text!==e.text||s.left!==e.left||s.top!==e.top||s.alignmentX!==e.alignmentX||s.alignmentY!==e.alignmentY||s.padding!==e.padding||s.rotation!==e.rotation||s.font!==e.font){s.span.style.width="unset",s.span.style.height="unset";const t=s.span.clientWidth,i=s.span.clientHeight,r=br(t,i,e.rotation),n={x:(r.x-t)/2,y:(r.y-i)/2};s.span.style.left=`${e.left+(-.5*e.alignmentX-.5)*r.x+n.x}px`,s.span.style.top=`${e.top+(.5*e.alignmentY-.5)*r.y+n.y}px`,s.bounds=void 0}return s.text=e.text,s.font=e.font,s.position=e.position,s.color=e.color,s.padding=e.padding,s.rotation=e.rotation,s.left=e.left,s.top=e.top,s.alignmentX=e.alignmentX,s.alignmentY=e.alignmentY,s},r=t=>{const e=s(t);let i=e.bounds;return i||(i=e.span.getBoundingClientRect(),e.bounds=i),i},n="polygon(0 0, 0 0, 0 0, 0 0)";return{update:t=>{i.forEach(t=>t.active=!1),t.textList.forEach(t=>{const i=s(t);i.active=!0,i.span.style.clipPath="unset",t.identifier,e.TextObjectIdentifier.Other}),t.obstructingOverlays.forEach(e=>{const s=Math.min(e.p1.clientX,e.p2.clientX)-0,o=Math.min(e.p1.clientY,e.p2.clientY)-0,a=Math.max(e.p1.clientX,e.p2.clientX)+0,h=Math.max(e.p1.clientY,e.p2.clientY)+0;t.textList.forEach(t=>{if(e.blacklist.includes(t.identifier))return;const l=i.get(t.uid),c=r(t);var u,d,f,g,p,m,y,x;if(u=s,d=o,f=a,g=h,p=c.left-0,m=c.top-0,y=c.right+0,x=c.bottom+0,!((u>=f?u:f)<(p<y?p:y)||(u<f?u:f)>(p>=y?p:y)||(d>=g?d:g)<(m<x?m:x)||(d<g?d:g)>(m>=x?m:x))&&l)if(0!==t.rotation)l.span.style.clipPath=n;else{const t=((t,e,i,s,r,n,o,a)=>{const h=t<i?t:i,l=t>=i?t:i,c=e<s?e:s,u=e>=s?e:s,d=r<o?r:o,f=r>=o?r:o,g=n<a?n:a,p=n>=a?n:a;if(d<h&&f>l&&g<c&&p>u)return[];if(d>=h&&f<=l&&g>=c&&p<=u){const t=.5*(u+c);return[{x:h,y:c},{x:l,y:c},{x:l,y:t},{x:f,y:t},{x:f,y:g},{x:d,y:g},{x:d,y:p},{x:f,y:p},{x:f,y:t},{x:l,y:t},{x:l,y:u},{x:h,y:u}]}if(h<d&&l>d&&l<f){if(c<g&&p<u)return[{x:h,y:c},{x:l,y:c},{x:l,y:g},{x:d,y:g},{x:d,y:p},{x:l,y:p},{x:l,y:u},{x:h,y:u}];if(c>g&&c<p&&u>p)return[{x:h,y:c},{x:d,y:c},{x:d,y:p},{x:l,y:p},{x:l,y:u},{x:h,y:u}];if(g<c&&p>u)return[{x:h,y:c},{x:d,y:c},{x:d,y:u},{x:h,y:u}];if(g<u)return[{x:h,y:c},{x:l,y:c},{x:l,y:g},{x:d,y:g},{x:d,y:u},{x:h,y:u}]}if(d<h&&f>h&&f<l){if(c<g&&p<u)return[{x:h,y:c},{x:l,y:c},{x:l,y:u},{x:h,y:u},{x:h,y:p},{x:f,y:p},{x:f,y:g},{x:h,y:g}];if(p>c&&g<c&&p<u)return[{x:l,y:c},{x:l,y:u},{x:h,y:u},{x:h,y:p},{x:f,y:p},{x:f,y:c}];if(g<c&&p>u)return[{x:f,y:c},{x:l,y:c},{x:l,y:u},{x:f,y:u}];if(g<u)return[{x:h,y:c},{x:l,y:c},{x:l,y:u},{x:f,y:u},{x:f,y:g},{x:h,y:g}]}if(h>d&&l<f){if(g<c&&p>c&&p<u)return[{x:h,y:p},{x:l,y:p},{x:l,y:u},{x:h,y:u}];if(c<g&&g<u&&p>u)return[{x:h,y:c},{x:l,y:c},{x:l,y:g},{x:h,y:g}];if(c<g&&p<u)return[{x:h,y:c},{x:l,y:c},{x:l,y:g},{x:h,y:g},{x:h,y:p},{x:l,y:p},{x:l,y:u},{x:h,y:u}]}if(h<d&&l>f){if(c<g&&u>g)return[{x:h,y:c},{x:l,y:c},{x:l,y:u},{x:f,y:u},{x:f,y:g},{x:d,y:g},{x:d,y:u},{x:h,y:u}];if(g<c&&p>c&&p<u)return[{x:h,y:c},{x:d,y:c},{x:d,y:p},{x:f,y:p},{x:f,y:c},{x:l,y:c},{x:l,y:u},{x:h,y:u}];if(g<c&&g<u&&p>u)return[{x:h,y:c},{x:d,y:c},{x:d,y:u},{x:f,y:u},{x:f,y:c},{x:l,y:c},{x:l,y:u},{x:h,y:u}]}return[{x:h,y:c},{x:l,y:c},{x:l,y:u},{x:h,y:u}]})(c.left-0,c.top-0,c.right+0,c.bottom+0,s,o,a,h);l.span.style.clipPath=0===t.length?n:`polygon(${t.map(t=>`${100*(t.x-c.left)/c.width}% ${100*(t.y-c.top)/c.height}%`).join(", ")})`}})}),i.forEach((t,e)=>{t.active||(t.span.remove(),i.delete(e))})},measureText:t=>{if(!t.visible)return{x:0,y:0};const e=r(t);return{x:e.width,y:e.height}},getTextBoundingBox:t=>{if(t.visible)return r(t)},dispose:()=>{i.forEach(t=>{t.span.remove()})}}})(t)};class wr{constructor(t,e){this.me=t,this.xe=e,this.Se=e.rows*rn,this.be=e.columns*nn}}var Cr,Br;e.OnScreenMenuButtonType=void 0,(Cr=e.OnScreenMenuButtonType||(e.OnScreenMenuButtonType={}))[Cr.ZoomIn=0]="ZoomIn",Cr[Cr.ZoomInX=1]="ZoomInX",Cr[Cr.ZoomInY=2]="ZoomInY",Cr[Cr.ZoomOut=3]="ZoomOut",Cr[Cr.ZoomOutX=4]="ZoomOutX",Cr[Cr.ZoomOutY=5]="ZoomOutY",Cr[Cr.ZoomToFit=6]="ZoomToFit",Cr[Cr.ToggleAnimations=7]="ToggleAnimations",e.OnScreenMenuButtonShape=void 0,(Br=e.OnScreenMenuButtonShape||(e.OnScreenMenuButtonShape={}))[Br.Circle=0]="Circle",Br[Br.Rectangle=1]="Rectangle",Br[Br.RoundedRectangle=2]="RoundedRectangle";const Fr={x:-43,y:0},Dr={x:-65,y:0},Ir={x:-86,y:0},Rr={x:-107,y:-1},Lr={x:-128,y:-3},Pr={x:-150,y:0},zr={x:-171,y:0},_r={x:-276,y:0},Vr={x:-298,y:0},Nr={x:0,y:0},Or={x:-21,y:0};class Ur extends wr{constructor(t,e,i,s){super(t,i),this.Me=Ut.document.createElement("button"),this.we=Ut.document.createElement("div"),this._e=Ut.document.createElement("label"),this.xe=i,this.ke=e,this.Ce=s}Te(t,e,i,s){this.Fe(t,s),this.Ie(),this.Le(e),this.Pe(),this._e.textContent=i||"";const r=Ut.document.createElement("div");this.Be(r),this.Me.onclick=this.onClick.bind(this),r.appendChild(this.we),r.appendChild(this._e),this.Me.appendChild(r)}Pe(){this.Me.style.cursor="pointer"}Be(t){t.style.display="flex",t.style.justifyContent="center",t.style.alignContent="center",t.style.flexDirection="column"}Le(t){"string"==typeof t?(this.we.style.backgroundImage=`url(${t})`,this.we.style.backgroundSize="100%",this.we.style.backgroundRepeat="no-repeat",this.we.style.backgroundPosition="center",this.we.style.width="20px",this.we.style.height="20px"):this.applyStyleForSprite(t),this.we.style.margin="auto"}Ie(){switch(this.ke){case e.OnScreenMenuButtonShape.RoundedRectangle:this.Me.style.borderRadius="10px";break;case e.OnScreenMenuButtonShape.Rectangle:this.Me.style.borderRadius="0px";break;case e.OnScreenMenuButtonShape.Circle:default:this.Me.style.borderRadius="31px"}}Fe(t,e){this.Me.style.width=`${this.be.toString()}px`,this.Me.style.height=`${this.Se.toString()}px`,this.Me.style.backgroundColor=t,this.Me.style.opacity=e||on,this.Me.style.alignItems="center",this.Me.style.border="2px solid #707070",this.Me.style.transition="background-color .8s ease"}applyStyleForSprite(t){this.we.style.backgroundImage=`url(${this.me}/${an})`,this.we.style.backgroundPositionX=`${t.x}px`,this.we.style.backgroundPositionY=`${t.y}px`,this.we.style.backgroundSize="1600%",this.we.style.backgroundRepeat="no-repeat",this.we.style.width="20px",this.we.style.height="20px"}De(t){return t.appendChild(this.Me),t}Ee(){return this.Me}}class Gr extends Ur{constructor(t,e,i,s){super(t,e,i,s),this.Re="",this.Oe="",this.ze=!1,this.Ce=s}Ve(){this.Ne(),this.onToggledStateAction()}Ge(){this.$e(),this.onInitialStateAction()}$e(){this.Ue(this.Re)}Ne(){this.Ue(this.Oe)}Ue(t){"string"==typeof t?this.we.style.background=t:(this.we.style.backgroundImage=`url(${this.me}/${an})`,this.we.style.backgroundPositionX=`${t.x}px`,this.we.style.backgroundPositionY=`${t.y}px`)}onClick(){this.ze?this.Ge():this.Ve(),this.ze=!this.ze}}class Yr extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),Fr)}onClick(){const t=this.Ce.Ye();t&&this.Ce.zoom(t,{x:-1,y:-1})}}class Zr extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),Rr)}onClick(){const t=this.Ce.Ye();t&&this.Ce.zoom(t,{x:-1,y:0})}}class Wr extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),Pr)}onClick(){const t=this.Ce.Ye();t&&this.Ce.zoom(t,{x:0,y:-1})}}class jr extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),Dr)}onClick(){const t=this.Ce.Ye();t&&this.Ce.zoom(t,{x:1,y:1})}}class Hr extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),Lr)}onClick(){const t=this.Ce.Ye();t&&this.Ce.zoom(t,{x:1,y:0})}}class $r extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),zr)}onClick(){const t=this.Ce.Ye();t&&this.Ce.zoom(t,{x:0,y:1})}}class Xr extends Gr{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Re=_r,this.Oe=Vr,this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),this.Re)}onToggledStateAction(){this.Ce.setAnimationsEnabled(!1)}onInitialStateAction(){this.Ce.setAnimationsEnabled(!0)}}class qr extends Ur{constructor(t,e,i){super(t,i,{rows:1,columns:1},e),this.Ce=e;const s=this.Ce.getTheme();this.Te(s.onScreenMenuBackgroundColor.toRGBAString(),Ir)}onClick(){this.Ce.forEachAxis(t=>{t.fit(!0)})}}class Kr extends Ur{constructor(t,e,i){super(t,e.shape||hn,e.dimensions||{rows:1,columns:1},i);const s=i.getTheme(),r=e.color||s.onScreenMenuBackgroundColor.toRGBAString(),n=e.icon||"",o=e.label||"",a=e.opacity||"";this.Te(r,n,o,a),this.je=e.action}onClick(){this.je(this.Ce)}}class Jr extends Gr{constructor(t,e,i,s){super(t,e,{rows:1,columns:1},i),this.Ce=i,this.He=s,this.Re=Or,this.Oe=Nr,this.Te(ln,this.Re)}$e(){this.Ue(this.Re),this.Me.style.backgroundColor=ln,this.Me.style.border="2px solid #707070",this.Me.style.margin="0px"}Ne(){this.Ue(this.Oe),this.Me.style.background="#FECC00 0% 0% no-repeat padding-box",this.Me.style.border="10px solid #BCBCBC12",this.Me.style.margin="1px"}onToggledStateAction(){var t;null===(t=this.He)||void 0===t||t.style.setProperty("display","block")}onInitialStateAction(){var t;null===(t=this.He)||void 0===t||t.style.setProperty("display","none")}}var Qr;e.MouseStyles=void 0,(Qr=e.MouseStyles||(e.MouseStyles={})).Move="move",Qr.ResizeColumn="col-resize",Qr.ResizeRow="row-resize",Qr.Horizontal="ew-resize",Qr.Vertical="ns-resize",Qr.NorthWest="nw-resize",Qr.NorthEast="ne-resize",Qr.Copy="copy",Qr.CrossHair="crosshair",Qr.Default="default",Qr.Help="help",Qr.Restricted="not-allowed",Qr.None="none",Qr.Point="pointer",Qr.Text="text",Qr.Wait="wait",Qr.ZoomIn="zoom-in",Qr.ZoomOut="zoom-out",Qr.Grab="grab",Qr.Grabbing="grabbing";const tn={LeftBottom:l(-1,-1),CenterBottom:l(0,-1),RightBottom:l(1,-1),LeftCenter:l(-1,0),Center:l(0,0),RightCenter:l(1,0),LeftTop:l(-1,1),CenterTop:l(0,1),RightTop:l(1,1)},en=new fs({color:M(255,255,255,0)}),sn=new lr({thickness:1,fillStyle:en}),rn=60,nn=60,on="1.0",an="osm/osm-sprite-transparent.png",hn=e.OnScreenMenuButtonShape.Circle,ln="#363636";var cn;e.OSMPosition=void 0,(cn=e.OSMPosition||(e.OSMPosition={}))[cn.TopRight=0]="TopRight",cn[cn.TopLeft=1]="TopLeft",cn[cn.BottomLeft=2]="BottomLeft",cn[cn.BottomRight=3]="BottomRight";class un extends zs{constructor(t,e,i,s,r,n,o,a){super(t,e,i,s,r,n,o,a),this.Rs="Band",this.We=0,this.Xe=1,this.Ze=this.bi.bandFillStyle,this.Je=this.bi.bandStrokeStyle,this.D=new vt,this.Qe=this.Ws.tr(this.ai).qe(this.Ze).Ke(this.Je).Ii(this.getHighlight()),this._s(this.Qe)}setValueStart(t){return this.We=t,this.D.R("valuechange",{start:this.We,end:this.Xe}),this.Ws.Bs(),this}getValueStart(){return this.We}setValueEnd(t){return this.Xe=t,this.D.R("valuechange",{start:this.We,end:this.Xe}),this.Ws.Bs(),this}getValueEnd(){return this.Xe}setFillStyle(t){this.Ze="function"==typeof t?t(this.Ze):t;const e=this.Ze;return this.Qe.qe(e),this.Ws.Bs(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){this.Je="function"==typeof t?t(this.Je):t;const e=this.Je;return this.Qe.Ke(e),this.Ws.Bs(),this}getStrokeStyle(){return this.Je}ir(){return this.Qe.sr(this.Xs.toVec2(this.We,this.Xs.getHeight(this.ai).getInnerStart())).Z(this.Xs.toVec2(this.Xe-this.We,this.Xs.getHeight(this.ai).getInnerInterval())),Cs(this.Hs,[this.Qe],this.ai),this}er(){return{fill:this.Ze,stroke:this.Je}}rr(t,e){t.Ii(e),this.Ws.Bs()}Zs(){let t,i,s;const r=(e,r,n)=>{const o=tt(this.Ws.pi.hr(e.clientX,e.clientY),this.Ws.pi.ai,this.ai),a=this.Xs.getWidth(o),h=this.axis.ai.Dt(this.We),l=this.axis.ai.Dt(this.Xe),c=(this.axis.ai.Dt(a)-h)/(l-h);t=r&&(!(c<.1||c>.9)||!n),i=n&&!t,i&&(s=c<.5)},n=s=>{const n=this.getUserInteractions(),o=Ts(n.move,"drag",s,s.shiftKey,s.ctrlKey,s.altKey),a=Ts(n.scale,"drag",s,s.shiftKey,s.ctrlKey,s.altKey);r(s,!!(null==o?void 0:o.drag),!!(null==a?void 0:a.drag));const h=t?e.MouseStyles.Point:i?this.Xs.getWidth({x:e.MouseStyles.Horizontal,y:e.MouseStyles.Vertical}):e.MouseStyles.Default;this.nr=this.chart.engine.setMouseStyle(h,this.nr)},o=t=>{this.nr=this.chart.engine.restoreMouseStyle(this.nr)};this.addEventListener("pointermove",n),this.addEventListener("pointerleave",o);const a=(e,r,n,o)=>{const a=this.Xs.getWidth(e);if(t){this.We=this.axis.ai.Qt(this.We,a),this.Xe=this.axis.ai.Qt(this.Xe,a);const t=null==n?void 0:n.on;t&&t({event:r})}else if(i&&s){this.We=this.axis.ai.Qt(this.We,a);const t=null==o?void 0:o.on;t&&t({event:r})}else if(i&&!s){this.Xe=this.axis.ai.Qt(this.Xe,a);const t=null==o?void 0:o.on;t&&t({event:r})}fe(r),this.D.R("valuechange",{start:this.We,end:this.Xe}),this.Ws.Bs()};this.addEventListener("pointerdown",e=>{const s=this.getUserInteractions(),r=Ts(s.move,"drag",e,e.shiftKey,e.ctrlKey,e.altKey),h=Ts(s.scale,"drag",e,e.shiftKey,e.ctrlKey,e.altKey);if(!(null==r?void 0:r.drag)&&t)return;if(!(null==h?void 0:h.drag)&&i)return;fe(e);let l=e;const c=t=>{if(t.pointerId!==e.pointerId)return;const i={x:t.clientX-l.clientX,y:l.clientY-t.clientY};a(i,t,r,h),l=t},u=t=>{t.pointerId===e.pointerId&&(this.addEventListener("pointermove",n),this.addEventListener("pointerleave",o),Ut.removeEventListener("pointermove",c),Ut.removeEventListener("pointerup",u),ii())};this.removeEventListener("pointermove",n),this.removeEventListener("pointerleave",o),Ut.addEventListener("pointermove",c),Ut.addEventListener("pointerup",u)})}setUserInteractions(t){return this.ar=void 0===t?{move:!1,scale:!1}:t,this}getUserInteractions(){return Nt({move:{drag:!0},scale:{drag:!0}},this.ar)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class dn extends zs{constructor(t,e,i,s,r,n,o,a){super(t,e,i,s,r,n,o,a),this.Rs="Constant Line",this.M=0,this.Je=this.bi.constantLineStrokeStyle,this.lr=!0,this.D=new vt,this.ur=this.Ws.dr(this.ai).cr(this.Je).Ii(this.getHighlight()),this._s(this.ur)}setValue(t){return this.M=t,this.D.R("valuechange",{value:this.M}),this.Ws.Bs(),this}getValue(){return this.M}setStrokeStyle(t){this.Je="function"==typeof t?t(this.Je):t;const e=this.Je;return this.ur.cr(e),this.Ws.Bs(),this}getStrokeStyle(){return this.Je}ir(){return this.ur.gr(this.Xs.toVec2(this.M,this.Xs.getHeight(this.ai).getInnerStart())).Ar(this.Xs.toVec2(this.M,this.Xs.getHeight(this.ai).getInnerEnd())),Cs(this.Hs,[this.ur],this.ai),this}er(){return{stroke:this.Je}}rr(t,e){t.Ii(e),this.Ws.Bs()}setUserInteractions(t){return this.ar=void 0===t?{move:!1}:t,this}getUserInteractions(){return Nt({move:{drag:!0}},this.ar)}Zs(){this.addEventListener("pointerenter",t=>{const i=this.getUserInteractions();if(Ts(i.move,"drag",t,t.shiftKey,t.ctrlKey,t.altKey)){const t=this.Xs.getWidth({x:e.MouseStyles.Horizontal,y:e.MouseStyles.Vertical});this.nr=this.chart.engine.setMouseStyle(t,this.nr)}}),this.addEventListener("pointerleave",t=>{this.nr=this.chart.engine.restoreMouseStyle(this.nr)}),this.addEventListener("pointerdown",t=>{const e=this.getUserInteractions(),i=Ts(e.move,"drag",t,t.shiftKey,t.ctrlKey,t.altKey);if(i){fe(t),ii();let e=t;const s=t=>{const s={x:t.clientX-e.clientX,y:e.clientY-t.clientY};e=t,this.M=this.axis.ai.Qt(this.M,this.Xs.getWidth(s)),this.D.R("valuechange",{value:this.M}),this.Ws.Bs();const r=i.on;r&&r({event:t})},r=e=>{e.pointerId===t.pointerId&&(Ut.removeEventListener("pointermove",s),Ut.removeEventListener("pointerup",r))};Ut.addEventListener("pointermove",s),Ut.addEventListener("pointerup",r)}})}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const fn="fitting",gn="expansion",pn="progressive",mn="regressive",yn={fitting:t=>{const e=void 0===(null==t?void 0:t.start)||t.start,i=void 0===(null==t?void 0:t.end)||t.end,s=void 0===(null==t?void 0:t.considerVisibleRangeOnly)||t.considerVisibleRangeOnly;return{id:fn,init:t=>{t.axis.pr(t=>t.curEnd>t.curStart?{startMin:t.dataMin,endMax:t.dataMax}:{endMin:t.dataMin,startMax:t.dataMax})},considerVisibleRangeOnly:s,apply:t=>{if(t.seriesDataRange)return{start:e?t.curEnd>=t.curStart?t.seriesDataRange.min:t.seriesDataRange.max:t.curStart,end:i?t.curEnd>=t.curStart?t.seriesDataRange.max:t.seriesDataRange.min:t.curEnd,allowIntervalLengthChange:!0}}}},scrolling:t=>{const e=void 0!==(null==t?void 0:t.progressive)&&!t.progressive,i=!0===(null==t?void 0:t.realTime)?{}:null==t?void 0:t.realTime;if(i){const t=void 0!==i.catchUpThresholdMs?i.catchUpThresholdMs:3e3;let s;const r=t=>{t.isStopped&&(s=void 0)};return{id:e?mn:pn,init:t=>{t.axis.pr(t=>e?t.curEnd>t.curStart?{startMin:t.dataMin}:{endMin:t.dataMin}:t.curEnd>t.curStart?{endMax:t.dataMax}:{startMax:t.dataMax}),t.axis.addEventListener("stoppedchange",r)},dispose:t=>{t.axis.removeEventListener("stoppedchange",r)},considerVisibleRangeOnly:!0,apply:i=>{if(!i.seriesDataRange)return;const r=Ut.performance.now();if(void 0!==s){const n=(r-s)*(e?-1:1);let o=i.curStart+n,a=i.curEnd+n;const h=i.axis.vr({forStart:o,forEnd:a,allowIntervalLengthChange:!1});if(!e&&h&&i.curEnd>i.curStart&&h.end-a>=t){const t=h.end-a;a+=t,o+=t}if(!e&&h&&i.curEnd<i.curStart&&h.start-o>=t){const t=h.start-o;a+=t,o+=t}return s=r,{start:o,end:a,allowIntervalLengthChange:!1,keepScrolling:!0,allowAnimation:!1}}return s=r,{keepScrolling:!0,start:i.curStart,end:i.curEnd,allowIntervalLengthChange:!1,allowAnimation:!1}}}}return{id:e?mn:pn,init:t=>{t.axis.pr(t=>e?t.curEnd>t.curStart?{startMin:t.dataMin}:{endMin:t.dataMin}:t.curEnd>t.curStart?{endMax:t.dataMax}:{startMax:t.dataMax})},considerVisibleRangeOnly:!0,apply:t=>{if(void 0!==t.seriesDataRange){if(Math.sign(t.curEnd-t.curStart)*Math.sign(e?-1:1)>0){const i=e?t.seriesDataRange.min:t.seriesDataRange.max;return{end:i,start:i+(t.curStart-t.curEnd),allowIntervalLengthChange:!1}}{const i=e?t.seriesDataRange.min:t.seriesDataRange.max;return{start:i,end:i+(t.curEnd-t.curStart),allowIntervalLengthChange:!1}}}}}},expansion:t=>{const e=void 0===(null==t?void 0:t.start)||t.start,i=void 0===(null==t?void 0:t.end)||t.end;return{id:gn,considerVisibleRangeOnly:!0,apply:t=>{if(void 0!==t.seriesDataRange)return{start:e?t.curEnd>=t.curStart?t.seriesDataRange.min<t.curStart?t.seriesDataRange.min:t.curStart:t.seriesDataRange.max>t.curStart?t.seriesDataRange.max:t.curStart:t.curStart,end:i?t.curEnd>=t.curStart?t.seriesDataRange.max>t.curEnd?t.seriesDataRange.max:t.curEnd:t.seriesDataRange.min<t.curEnd?t.seriesDataRange.min:t.curEnd:t.curEnd,allowIntervalLengthChange:!0}}}},nextPowerOf10:{id:fn,start:(t,e,i,s)=>e>=t?i:s,end:(t,e,i,s)=>e>=t?10**Math.ceil(Math.log10(s)):10**Math.ceil(Math.log10(i)),allowIntervalLengthChange:!0},fittingStepped:t=>{const e=void 0===(null==t?void 0:t.start)||t.start,i=void 0===(null==t?void 0:t.end)||t.end;return{id:fn,considerVisibleRangeOnly:!0,apply:t=>{if(void 0===t.seriesDataRange)return;let s,r;if(e)if(t.curEnd>=t.curStart)if(t.seriesDataRange.min<t.curStart)s=t.curStart-(t.curEnd-t.curStart);else{const e=t.curStart+.5*(t.curEnd-t.curStart);s=t.seriesDataRange.min>e?e:t.curStart}else if(t.seriesDataRange.max>t.curStart)s=t.curStart+(t.curStart-t.curEnd);else{const e=t.curStart-.5*(t.curStart-t.curEnd);s=t.seriesDataRange.max<e?e:t.curStart}else s=t.curStart;if(i)if(t.curEnd>=t.curStart)if(t.seriesDataRange.max>t.curEnd)r=t.curEnd+(t.curEnd-t.curStart);else{const e=t.curEnd-.5*(t.curEnd-t.curStart);r=t.seriesDataRange.max<e?e:t.curEnd}else if(t.seriesDataRange.min<t.curEnd)r=t.curEnd-(t.curStart-t.curEnd);else{const e=t.curEnd+.5*(t.curStart-t.curEnd);r=t.seriesDataRange.min>e?e:t.curEnd}else r=t.curEnd;return{start:s,end:r,allowIntervalLengthChange:!0}}}}},xn={Empty:"Empty",Numeric:"Numeric",DateTime:"DateTime",Time:"Time"},vn=t=>void 0!==t.yr,An=t=>void 0!==t.mr,Sn=t=>void 0!==t.Sr,bn=(t,e,i,s,r,n,o)=>[n,o],Mn=(t,e,i,s)=>{const r=[],n=Math.round(Math.abs((t-e)/i));for(let o=1;o<n;o+=1){let n=t+i*o;void 0!==s&&(n=Math.round(n*s)/s),n<e&&r.push(n)}return r},En=(t,e,i,s,r)=>{Ht(t,0)&&(t=0),Ht(e,0)&&(e=0);const n=[],o=void 0!==s?((t,e,i)=>t-(t-i)%e)(t,i,s):t;let a=o;if(i<=0)throw new Error(`_getRegularGreatKeyValues unit less than or equal to 0, unit: ${i}`);let h=0;for(;(a-t)/(e-t)<.98;)n.push(a),h+=1,a=o+h*i,void 0!==r&&(a=Math.round(a*r)/r);return n.push(a),n},kn=(t,e,i,s)=>{const r=[];let n=i(t),o=0;for(;n<e&&!1===Ht(n,e);)if(r.push(n),n=s(n),o+=1,o>1e3)throw new Error("Infinite loop in Axis tick key values logic.");return r.push(n),r},Tn=(t,...e)=>{const i=e.length>0?e.length:t?1:0;return(s,r,n,o,a,h)=>{if(r>=i)return;const l=e[r]||1;let c=!1,u=!1,d=1;return t&&(c="ignore"in t?"first"===t.ignore||"both"===t.ignore:c,u="ignore"in t?"last"===t.ignore||"both"===t.ignore:u,d="offset"in t&&void 0!==t.offset?t.offset:d),((t,e,i,s,r)=>(i&&(t=t.filter((t,e)=>e>0)),s&&(t=t.filter((e,i)=>i<t.length-1)),t.filter((t,i)=>(i+r)%e==0)))(s,l,c,u,d)}},wn=(...t)=>{const e=t.length>0?t.length:0;return(i,s,r,n,o,a)=>{if(s>=e)return;const h=t[s]||1;return i.filter((t,e)=>e%h==0)}},Cn=s.Record({cursorFormatter:void 0});class Bn extends Cn{br(t){return{Mr:[],wr:[],_r:this.cursorFormatter?this.cursorFormatter:Qi.Numeric,kr:void 0,Cr:void 0}}setCursorFormatter(t){return this.set("cursorFormatter",t)}getCursorFormatter(){return this.get("cursorFormatter")}}const Fn=t=>t&&"function"==typeof t?t():t,Dn=(t,e,i,s,r,n,o,a,h,l,c)=>{let u=h.get(o);if(u||(u=new Map,h.set(o,u)),u.has(t))return u.get(t);if(0===e.length)return ai;const d=c.Tr(e,o.Fr.labelFont,r),f=a.Qt(i,{x:-(s.x/2+.5)*d.x+n.x-l,y:-(s.y/2+.5)*d.y+n.y-l}),g=a.Qt(f,{x:d.x+l,y:d.y+l}),p={min:{x:Math.min(f.x,g.x),y:Math.min(f.y,g.y)},max:{x:Math.max(f.x,g.x),y:Math.max(f.y,g.y)}};return u.set(t,p),p},In=(new Bn).br({type:"linear"});class Rn{constructor(t,i,s,r,n,o,a){this.Ir=In,this.Lr=xn.Empty,this.Pr=new Map,this.Br=!0,this.Dr=Mt(()=>this.chart.pi.Bs())(300,St.linear),this.Er=!0,this.di=!0,this.Rr=!1,this.Or=oi,this.zr=!1,this.Vr=!1,this.Nr=oi,this.Gr=oi,this.$r=oi,this.Ur=!1,this.Yr="",this.jr=!1,this.Hr=!1,this.Wr=!1,this.Xr=()=>{this.Jr.Zr=e.TextObjectIdentifier.AxisTitle,this.Jr.setPointerEvents(!0),this.title.zi(this.Jr),this.Xr=void 0},this.Qr=(t,e,i,s,r,n,o,a,h,l,c)=>{const u=this.Kr(),d=[],f=t.filter(t=>this.qr(t.keyValue,t.labelText,e)),g=[...f,...h.filter(t=>this.qr(t.keyValue,t.labelText,t.tickLevel)),...l.filter(t=>t.labelText.length>0)];for(let t=0;t<f.length;t+=1){const h=f[t];let l,p=[];if(this.qr(h.keyValue,h.labelText,e)){const t=Dn(h.keyValue,h.labelText,h.labelPosition,h.labelAlignment,h.labelRotation,h.labelOffset,e,u,a,c,this.chart.pi.th);p=Ue(g.map(e=>e&&e!==h&&ci(t,Dn(e.keyValue,e.labelText,e.labelPosition,e.labelAlignment,e.labelRotation,e.labelOffset,e.tickLevel,u,a,c,this.chart.pi.th))?e:void 0)),l=p.length>0}else l=!1;if(l){let a=!0;if(a&&p.every(t=>vn(t.tickLevel))&&(a=!1),a&&e.ih&&e.ih.eh&&!1===e.ih.eh(h.keyValue,i,s,r,n,o)&&(a=!1),!1===a){f.splice(t,1),t-=1;continue}return!0}d.push(h)}return d},this.formatValue=t=>this.Ir._r(t,{start:this.ai.getInnerStart(),end:this.ai.getInnerEnd()}),this.rh=!0,this.hh=!0,this.title=new vt,this.chart=t,this.oh=i,this.bi=r,this.ah=o,this.ai=s,this.uh=a,"logarithmic"===a.type&&this.setAnimationZoom(St.logarithmic($i(a.base))),this.dh=o.numeric,this.fh("Numeric"),this.Ah=s.getInnerStart(),this.gh=s.getInnerEnd(),this.setAnimationsEnabled(n),this.setScrollStrategy(yn.fitting)}setUnits(t,e={}){return this.ph=t,this.cs=e,this.mh(),this}getUnits(){return this.ph}setDefaultInterval(t,e){return this.Sh=t,!1!==(null==e?void 0:e.applyImmediately)&&(this.Ur=!0,this.chart.pi.Bs()),this.bh=void 0!==(null==e?void 0:e.skipIntervalRestrictions)?e.skipIntervalRestrictions:void 0,this}getDefaultInterval(){return this.Sh}getTitle(){return this.Yr}setTitle(t){return this.Yr=t,this.mh(),this}getTitleFillStyle(){return this.Jr.Mh()}setIntervalRestrictions(t){return this.wh=t,this.jr=!0,this.chart.pi.Bs(),this}getIntervalRestrictions(){if("function"==typeof this.wh){const t=this._h();return this.wh({curStart:this.Ah,curEnd:this.gh,dataMin:null==t?void 0:t.min,dataMax:null==t?void 0:t.max})}return this.wh}pr(t){this.jr||this.Hr||(this.wh=t)}setTitleFillStyle(t){return this.Jr.qe(t),this.chart.pi.Bs(),this}getTitleFont(){return this.Jr.kh()}setTitleFont(t){return this.Jr.Ch(t),this.chart.pi.Bs(),this}setTitleRotation(t){return this.Jr.Th(t),this.chart.pi.Bs(),this.Wr=!0,this}getTitleRotation(){return this.Jr.Fh()}setTitleEffect(t){return this.Ih.Ps(t),this.chart.pi.Bs(),this}getTitleEffect(){return this.Ih.Ds()}fh(t,e){if(this.Pr.size>0&&this.Lh(),"Empty"===t){const i=e||(t=>t);this.dh=i(new Bn),this.Ir=this.dh.br(this.uh),this.Lr=t}else if("Numeric"===t){"Numeric"!==this.Lr&&(this.dh=this.ah.numeric);const i=e||(t=>t);this.dh=i(this.dh),this.Ir=this.dh.br(this.uh),this.Lr=t}else if("DateTime"===t){"DateTime"!==this.Lr&&(this.dh=this.ah.datetime);const i=e||(t=>t);this.dh=i(this.dh),this.Ir=this.dh.br(this.uh),this.Lr=t}else if("Time"===t){"Time"!==this.Lr&&(this.dh=this.ah.time);const i=e||(t=>t);this.dh=i(this.dh),this.Ir=this.dh.br(this.uh),this.Lr=t}return this.chart.pi.Bs(),this}Ph(){return this.Ir}Bh(t,e){this.Ir=t,this.Lr=e,this.chart.pi.Bs()}setInterval(t){const{start:e,end:i,animate:s,stopAxisAfter:r}=t;return this.jr||(this.Hr=!0,this.wh=void 0),this.li(void 0!==e?e:this.Ah,void 0!==i?i:this.gh,void 0!==s&&s,void 0===r||r,"userSetInterval"),this}li(t,e,i=!1,s=!0,r){let n={start:t,end:e};const o="synchronizedAxis"===r||"setDefaultInterval"===r&&!1!==this.bh,a="setDefaultInterval"!==r,h=Math.abs(e-t),l=Math.abs(this.gh-this.Ah);if(void 0!==this.Ir.kr&&this.Ir.kr>h){const i=(e+t)/2,s=(a?this.Ir.kr/2:l/2)*(t>e?-1:1);n={start:i-s,end:i+s}}if(void 0!==this.Ir.Cr&&this.Ir.Cr<h){const i=(e+t)/2,s=(a?this.Ir.Cr/2:l/2)*(t>e?-1:1);n={start:i-s,end:i+s}}const c=this.ai.et(n.start,n.end,this.Ah,this.gh,a);if(!1===c)return this;if(!0===c);else if(n=c,"zoomBandChartOther"===r)return this;let u;switch(r){case"userSetInterval":case"userFit":case"interactionSetInterval":case"interactionZoom":case"setDefaultInterval":case"zoomBandChartClick":u=!0;break;case"zoomBandChartOther":case"synchronizedAxis":u=!1;break;default:return Ye(0,""),this}if(this.Dh&&this.Dh.finishAll(!1),this.Dr&&(!0===i||i>0)){this.setStopped(!0);const t=!0===i?void 0:i,e=!this.Dh||this.Dh.isOver()?this.Dr:this.Dh.NextAnimation.bind(this);this.Dh=e([[this.Ah,n.start],[this.gh,n.end]],([t,e])=>{this.Eh(t,e,{allowIntervalLengthChange:a,skipIntervalRestriction:o})},t),this.Dh.addEventListener("end",()=>{this.Dh=void 0,u&&(this.$r=Ut.performance.now())}),this.Dh.addEventListener("end",()=>{this.setStopped(s)})}else this.Eh(n.start,n.end,{allowIntervalLengthChange:a,skipIntervalRestriction:o}),this.setStopped(s),u&&(this.$r=Ut.performance.now());return this}getInterval(){return{start:this.Ah,end:this.gh}}setStopped(t){return t===this.Rr||(t&&(this.Dh&&this.Dh.finishAll(!1),this.Dh=void 0),this.Rr=t,this.D.R("stoppedchange",{isStopped:this.Rr}),this.Or=Ut.performance.now(),this.chart.pi.Bs()),this}getStopped(){return this.Rr}fit(t,e){const i=this._h(),s=this.Sh||Vn,r="function"==typeof s?s({curStart:this.Ah,curEnd:this.gh,dataMin:null==i?void 0:i.min,dataMax:null==i?void 0:i.max}):s;return this.li(void 0!==r.start?r.start:this.Ah,void 0!==r.end?r.end:this.gh,void 0!==t?t:void 0!==r.animate?r.animate:this.Er,void 0!==e?e:void 0===r.stopAxisAfter||r.stopAxisAfter,this.Sh?"setDefaultInterval":"userFit"),this}setScrollStrategy(t){var e,i;return(null===(e=this.Rh)||void 0===e?void 0:e.dispose)&&this.Rh.dispose({axis:this}),this.Rh=Fn(t),this.jr||(this.wh=void 0),(null===(i=this.Rh)||void 0===i?void 0:i.init)&&this.Rh.init({axis:this}),this.chart.pi.Bs(),this}getScrollStrategy(){return this.Rh}setAnimationScroll(t){return this.Br=Boolean(t),this.chart.pi.Bs(),this}setAnimationZoom(t,e=300){return this.Dh&&(this.Dh.finishAll(!1),this.Dh=void 0),this.Dr=t?Mt(()=>this.chart.pi.Bs())(e,t):void 0,this}setAnimationsEnabled(t){return this.Er=t,t?(this.setAnimationScroll(!0),this.setAnimationZoom(St.ease,void 0)):(this.setAnimationScroll(void 0),this.setAnimationZoom(void 0)),this}getAnimationsEnabled(){return this.Er}setVisible(t){const e=this.di!==t;return this.di=t,this.Jr.setVisible(t),this.Oh(e=>{e.zh.setVisible(t)}),e&&this.D.R("visiblechange",{isVisible:this.di}),this}getVisible(){return this.di}Vh(t){return!1}Nh(t){this.Xr&&this.Xr(),this.title.setPointerEvents(this.title.Di.length>0);const e=this.Gh(),i=e.min,s=e.max;if(!this.Vh(t)||!this.$h||this.Wr){const e=new Map,r=new Map,n=Pn(this.Ir,i,s,this.Ah,this.gh,t.physicalAxisSize,Math.min(this.Ah,this.gh),Math.max(this.Ah,this.gh));this.Uh();const o=Us(3,20,$t((t.physicalAxisSize-30)/270,0,1)),a={...t,...this.Yh(t)},h=this.jh(this.Ir,Math.min(i,this.Ah,this.gh),Math.max(s,this.Ah,this.gh),n,e,a,r,o),l=this.Hh(this.Ir,Math.min(i,this.Ah,this.gh),Math.max(s,this.Ah,this.gh),n,e,a,h,r,o),c=new Map([...h,...l]),u=this.Ir.Wh,d=void 0!==this.Ir.wr.find(t=>An(t)&&!cs(t.Fr.labelFillStyle));if(u&&d&&Array.from(c).reduce((t,e)=>t+(e[1].labelText.length>0&&!cs(e[0].zh.Mh())?1:0),0)<=1){this.Uh(),c.clear();const e=[Math.min(this.Ah,this.gh),Math.max(this.Ah,this.gh)],i={start:this.ai.getInnerStart(),end:this.ai.getInnerEnd()};e.forEach(e=>{const s=this.Xh(e,u,u.mr(e,i),t,a),r=this.Zh(s.keyValue,u,a,s,s.labelText);c.set(r,s)})}return this.Jh(),this.$h={...a,...this.Qh(t,c,!0),min:i,max:s},this.$h}let r=!1;return this.Pr.forEach(t=>{t.forEach((e,n)=>{(n<i||n>s)&&(e.dispose(),t.delete(n),r=!0)})}),{...this.$h,updatedTicks:r}}Kh(t,e,i){const s=e.Fr;i.length>0?t.zh.qe(s.getLabelFillStyle()).Ch(s.getLabelFont()).tn(i).setVisible(this.getVisible()).qh(s.getLabelShadow()):t.zh.setVisible(!1)}Zh(t,e,i,s,r){const n=this.Pr.get(e)||new Map;this.Pr.set(e,n);let o=n.get(t);return o||(o=this.sn(t,e,i,s),n.set(t,o)),this.Kh(o,e,r),o.en=!1,o}jh(t,e,i,s,r,n,o,a){const h=new Map,l=this.Kr(),c=[];for(const u of t.Mr){const t=s.get(u).filter(t=>t>=e&&t<=i),d=t.map(t=>this.Xh(t,u,u.mr(t,{start:this.ai.getInnerStart(),end:this.ai.getInnerEnd()}),n,n));for(let e=0;e<t.length;e+=1){const i=t[e],s=d[e],f=this.Zh(i,u,n,s,s.labelText),g=Dn(f.M,f.zh.rn(),s.labelPosition,s.labelAlignment,s.labelRotation,{x:0,y:0},u,l,r,a,this.chart.pi.th);c.find((t,e)=>{const i=d[e];return ci(g,Dn(t.M,t.zh.rn(),i.labelPosition,i.labelAlignment,i.labelRotation,{x:0,y:0},u,l,r,a,this.chart.pi.th))})&&f.zh.setVisible(!1),f.en=!1,o.set(f,s),c.push(f),h.set(f,s)}}return h}Hh(t,e,i,s,r,n,o,a,h){var l;const c={start:this.ai.getInnerStart(),end:this.ai.getInnerEnd()},u=new Map,d=Array.from(o.values());let f,g=[];for(const p of t.wr){const m=p===t.wr[t.wr.length-1],y=s.get(p);if(!y)break;let x;if(void 0===f)x=[{start:e,end:i,keyValues:y}];else{x=[];for(let t=0;t<f.length-1;t+=1){const s=f[t],r=f[t+1],n={start:s,end:r,keyValues:[]};for(const t of y)t>=s&&t<r&&n.keyValues.push(t);n.end<e||n.start>i||x.push(n)}}if(f=y,Sn(p))continue;let v,A=0,S=!1,b=-1,M=!0,E=[];for(let t=0;t<x.length;t+=1){const e=x[t].keyValues.map(t=>this.Xh(t,p,p.mr(t,c),n,n));E=E.concat(e)}if(p.Fr.getLabelFillStyle()!==ls)for(v=[];++b<x.length;){const t=x[b],s=t.start,n=t.end;let a=t.keyValues;if(A>0){if(void 0===p.ih){M=!1;break}if(a=(0,p.ih.hn)(t.keyValues,A-1,s,n,e,i),void 0===a)break}const l=Ue(a.map(t=>E.find(e=>e.keyValue===t)));if(S)v=v.concat(l);else{const t=this.Qr(l,p,A,s,n,e,i,r,d,g,h);if(!0===t){A+=1,b=-1,v=[];continue}v=v.concat(t)}t!==x[x.length-1]||o.size+v.reduce((t,s)=>t+(mi(s.keyValue,e,i)?1:0),0)>=2||m||S||(S=!0,A-=1,b=-1,v=[])}else v=E;const k=v.reduce((t,s)=>t+(mi(s.keyValue,e,i)?1:0),0);void 0!==p.nn&&k<p.nn&&(v.length=0);const T=[];for(const t of E){if(t.keyValue<e||t.keyValue>i)continue;const s=v.includes(t);if(!s&&"hide-tick"===(null===(l=p.ih)||void 0===l?void 0:l.an))continue;t.labelText=s?t.labelText:"";const r=this.Zh(t.keyValue,p,n,t,t.labelText);a.set(r,t),T.push(t),u.set(r,t)}if(g=T,!M)break}return u}Oh(t){for(const e of this.Pr.values())for(const i of e.values())t(i)}ln(t,e){for(const i of this.Pr.values())for(const s of i.values())e=t(e,s);return e}Lh(){this.Pr.forEach((t,e)=>{t.forEach(t=>{t.dispose()})}),this.Pr.clear()}Uh(){for(const t of this.Pr.values())for(const e of t.values())e.en=!0}Jh(){for(const t of this.Pr.values()){const e=Array.from(t.entries());for(let i=0;i<e.length;i+=1){const[s,r]=e[i];r.en&&(r.dispose(),t.delete(s))}}}Gh(){const t=this.ai.getInnerStart()<this.ai.getInnerEnd()?this.ai.getInnerStart():this.ai.getInnerEnd(),e=this.ai.getInnerEnd()>this.ai.getInnerStart()?this.ai.getInnerEnd():this.ai.getInnerStart();return g(t,e)}qr(t,e,i){return 0!==e.length&&(!vn(i)||!0===i.un)}cn(t,e){return"Empty"===this.Lr||(this.Ir.Mr.forEach(i=>{e=t(e,i.Fr)}),this.Ir.wr.forEach(i=>{An(i)&&(e=t(e,i.Fr))})),e}getSeriesDataRange(){const t=this._h();if(t&&!0!==t.emptyBounds)return t}vr(t){const e=void 0!==t.forStart?t.forStart:this.Ah,i=void 0!==t.forEnd?t.forEnd:this.gh,s=this._h();if(s)return _n(this.wh,s,{start:i>e?s.min:s.max,end:i>e?s.max:s.min},{start:e,end:i},!0)}_h(){const t=!this.Rh||this.Rh.considerVisibleRangeOnly;let e=this.oh.dn(t);const i=this.oh.fn(t);let s;if(void 0!==e&&Yt(e)&&void 0!==i&&Yt(i)&&("logarithmic"===this.uh.type&&(0===e&&(e=Math.min(1,i)),Math.sign(e)!==Math.sign(i)&&(e=Math.min(1,i-.1))),s?(s.min=Math.min(s.min,e),s.max=Math.max(s.max,i)):s=g(e,i)),s&&Yt(s.min)&&Yt(s.max))return Ht(s.min,s.max)?{min:s.min-1,max:s.max+1,emptyBounds:!0}:s}An(){if(!1===this.rh)return{start:0,end:0};if("object"==typeof this.rh)return this.rh;let t=0;const e=this.oh.gn();return e&&(t=Math.max(t,e)),{start:t,end:t}}setScrollMargins(t){return this.rh=void 0!==t&&("number"==typeof t?{start:t,end:t}:t),this.chart.pi.Bs(),this}getScrollMargins(){return this.rh}setAutoRegionsEnabled(t){return this.setScrollMargins(t),this}pn(){const t=this.zr;let e=!1;if(this.Ur&&this.Sh){const t=this._h();if(t){const e="function"==typeof this.Sh?this.Sh({curStart:this.Ah,curEnd:this.gh,dataMin:null==t?void 0:t.min,dataMax:null==t?void 0:t.max}):this.Sh;if("object"==typeof this.Sh&&!this.jr){const i=_n(this.wh,t,{start:void 0!==e.start?e.start:this.Ah,end:void 0!==e.end?e.end:this.gh},this.getInterval(),!0);i.start===e.start&&i.end===e.end||(this.Hr=!0,this.wh=void 0)}this.li(void 0!==e.start?e.start:this.Ah,void 0!==e.end?e.end:this.gh,void 0!==e.animate&&e.animate,void 0===e.stopAxisAfter||e.stopAxisAfter,"setDefaultInterval"),this.Ur=!1,this.bh=void 0}}if(this.Rh&&!this.Rr){let t=this._h();(null==t?void 0:t.emptyBounds)&&this.Rh.id===gn&&(t=void 0);const i=this.Ah,s=this.gh,r=this.Rh.apply({axis:this,curStart:i,curEnd:s,seriesDataRange:t});if(r){const n=_n(this.wh,t,{start:r.start,end:r.end},{start:i,end:s},r.allowIntervalLengthChange);let o=n.start,a=n.end;const h=!1===Ht(i,o)||r.keepScrolling,l=!1===Ht(s,a)||r.keepScrolling;if(o=h?o:i,a=l?a:s,h||l){let t=!1;if(this.Br&&!this.hh&&!1!==r.allowAnimation)if(this.Br){t=!0;const n=h?this.vn(i,o):i,c=l?this.vn(s,a):s;if(!0===this.Eh(n,c,{allowIntervalLengthChange:r.allowIntervalLengthChange,skipIntervalRestriction:!1})&&(h&&!1===Ht(n,o)||l&&!1===Ht(c,a))||!0===r.keepScrolling){this.chart.pi.Bs(!0),e=!0;let t=Math.abs(a-o)/Math.abs(n-c);t<1&&(t=1/t),this.Vr=t>=1.4}}else t=!1;t||(this.Eh(o,a,{allowIntervalLengthChange:r.allowIntervalLengthChange,skipIntervalRestriction:!1}),!0===r.keepScrolling&&this.chart.pi.Bs(!0)),this.hh=!1}}}return e?(this.zr!==e&&(this.zr=e,this.Nr=Ut.performance.now()),this.yn&&(clearTimeout(this.yn),this.yn=void 0)):!0===t&&void 0===this.yn&&(this.Vr=!1,this.yn=setTimeout(()=>{!1!==this.zr&&(this.zr=!1,this.Nr=Ut.performance.now()),this.yn=void 0,this.chart.pi.Bs()},200)),this}mn(){const t=this.getInterval(),e=this._h();return"function"==typeof this.wh?this.wh({curStart:t.start,curEnd:t.end,dataMin:null==e?void 0:e.min,dataMax:null==e?void 0:e.max}):this.wh}Eh(t,e,i){let s={start:t,end:e};const{allowIntervalLengthChange:r,skipIntervalRestriction:n}=i;let o=!0;if(this.wh&&!n){const t=this._h();s=_n(this.wh,t,s,{start:this.Ah,end:this.gh},r)}const a=Math.abs(e-t),h=Math.abs(this.gh-this.Ah);if(void 0!==this.Ir.kr&&this.Ir.kr>a){const i=(e+t)/2,n=(r?this.Ir.kr/2:h/2)*(t>e?-1:1);s={start:i-n,end:i+n},o=!1}if(void 0!==this.Ir.Cr&&this.Ir.Cr<a){const i=(e+t)/2,n=(r?this.Ir.Cr/2:h/2)*(t>e?-1:1);s={start:i-n,end:i+n},o=!1}let l=this.ai.et(s.start,s.end,this.Ah,this.gh,r);if(!1===l)return!1;!0!==l&&(s=l);const c=this.An(),u=this.xn(s.start,s.end,c);return l=this.ai.et(u.start,u.end,this.Ah,this.gh,!1),!!l&&(!0===l?this.ai.W(u.start,u.end):this.ai.W(s.start,s.end),this.Ah=s.start,this.gh=s.end,this.D.R("intervalchange",{start:s.start,end:s.end}),this.Gr=Ut.performance.now(),this.chart.pi.Bs(),o)}Sn(){return this.zr}bn(){return void 0!==this.Dh}mh(){var t;const e=!1!==(null===(t=this.cs)||void 0===t?void 0:t.displayOnAxis);this.Jr.tn(this.ph&&e&&this.Yr?`${this.Yr} (${this.ph})`:this.Yr),this.chart.pi.Bs()}}class Ln{constructor(t,e,i,s,r=i._n(s).wn(Xe).Mn(Xe).setPointerEvents(!1)){this.en=!1,this.ci=!1,this.gs=[],this.kn=t,this.M=e,this.Cn=i,this.Tn=s,this.zh=r,this.gs.push(r)}Fs(t){this.gs.forEach(e=>e.setVisible(t))}dispose(){return this.ci||(this.ci=!0,this.gs.forEach(t=>t.dispose())),this}}const Pn=(t,e,i,s,r,n,o,a,h=!1)=>{const l=new Map;for(const h of t.Mr){let t=h.Fn(e,i,s,r,n,o,a);t=zn(t),l.set(h,t)}let c;for(const s of t.wr){let r;if(void 0===c)r=s.Fn(e,i,e,i,n);else{if(h&&s===t.wr[t.wr.length-1])break;let o=[];const a=c.filter(t=>e<=t&&t<=i).length;if(a>0){const t=n/(a-1);if(void 0!==s.In&&s.In>t)break}for(let t=0;t<c.length-1;t+=1){const r=s.Fn(c[t],c[t+1],e,i,n);o=o.concat(r)}r=o}r=zn(r),l.set(s,r),c=r}return l},zn=t=>Array.from(new Set(t)),_n=(t,e,i,s,r)=>{const n="function"==typeof t?t({curStart:s.start,curEnd:s.end,dataMin:null==e?void 0:e.min,dataMax:null==e?void 0:e.max}):t;if(!n)return i;const o={start:i.start,end:i.end};let a=Math.abs(i.end-i.start);if(void 0!==n.intervalMin&&a<n.intervalMin){const t=(o.start+o.end)/2;o.start=t+.5*Math.sign(i.start-t)*n.intervalMin,o.end=t+.5*Math.sign(i.end-t)*n.intervalMin}if(a=Math.abs(i.end-i.start),void 0!==n.intervalMax&&a>n.intervalMax){const t=(o.start+o.end)/2;o.start=t+.5*Math.sign(i.start-t)*n.intervalMax,o.end=t+.5*Math.sign(i.end-t)*n.intervalMax}return a=Math.abs(i.end-i.start),void 0!==n.startMin&&(o.start=Math.max(o.start,n.startMin),r||Ht(Math.abs(o.start-o.end),a)||(o.end=o.start+Math.sign(i.end-i.start)*a)),a=Math.abs(i.end-i.start),void 0!==n.startMax&&(o.start=Math.min(o.start,n.startMax),r||Ht(Math.abs(o.start-o.end),a)||(o.end=o.start+Math.sign(i.end-i.start)*a)),a=Math.abs(i.end-i.start),void 0!==n.endMin&&(o.end=Math.max(o.end,n.endMin),r||Ht(Math.abs(o.start-o.end),a)||(o.start=o.end+Math.sign(i.start-i.end)*a)),a=Math.abs(i.end-i.start),void 0!==n.endMax&&(o.end=Math.min(o.end,n.endMax),r||Ht(Math.abs(o.start-o.end),a)||(o.start=o.end+Math.sign(i.start-i.end)*a)),Math.sign(o.end-o.start)!==Math.sign(i.end-i.start)?{end:o.start,start:o.end}:o},Vn=t=>{if(void 0===t.dataMin||void 0===t.dataMax)return{stopAxisAfter:!1};const e=t.curEnd>=t.curStart;return{start:e?t.dataMin:t.dataMax,end:e?t.dataMax:t.dataMin,stopAxisAfter:!1}},Nn=t=>{const i=t.getDraggingMode();return void 0!==i&&i!==e.UIDraggingModes.notDraggable?i===e.UIDraggingModes.draggable?e.MouseStyles.Move:i===e.UIDraggingModes.onlyHorizontal?e.MouseStyles.Horizontal:e.MouseStyles.Vertical:void 0};class On{constructor(){this.di=!0}set draggable(t){this.D.draggable=t}get draggable(){return this.D.draggable}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}setVisible(t){const e=this.di!==t;return this.di=t,e&&this.D.R("visiblechange",{isVisible:this.di}),this}getVisible(){return this.di}}class Un extends On{constructor(t,i,s,r,n){super(),this.D=new vt,this.Ln=l(50,50),this.origin=l(0,0),this.size=l(0,0),this.ci=!1,this.Pn=void 0,this.Bn=void 0,this.Dn=Nn,this.En=void 0,this.ot=y(0,0,0,0),this.Ws=t,this.renderingScale=i,this.scale=s,this.yi=r,this.bi=n,this.Ws.Bs(),this.bi=n,this.addEventListener("pointerenter",()=>{const t="function"==typeof this.Dn?this.Dn(this):this.Dn;t&&(this.Bn=this.Ws.pi.Rn(t))}),this.addEventListener("pointerleave",()=>{this.Ws.pi.On(this.Bn)});const o=t=>{const i=this.getDraggingMode();if(i===e.UIDraggingModes.notDraggable)return;fe(t);let s=t;const r=t=>{const r={x:t.clientX-s.clientX,y:t.clientY-s.clientY};s=t;const n=this.scale.Qt(this.getPosition(),{x:i!==e.UIDraggingModes.onlyVertical?r.x:0,y:i!==e.UIDraggingModes.onlyHorizontal?-r.y:0}),o=this.scale,a=this.getSize(),h=this.getOrigin(),l=o.Qt({x:o.x.getInnerStart(),y:o.y.getInnerStart()},zi({x:(1+h.x)/2,y:(1+h.y)/2},a)),c=o.Qt({x:o.x.getInnerEnd(),y:o.y.getInnerEnd()},zi({x:(h.x-1)/2,y:(h.y-1)/2},a)),u={x:Math.min(Math.max(n.x,l.x),c.x),y:Math.min(Math.max(n.y,l.y),c.y)};this.setPosition(u)},n=t=>{this.Ws.pi.zn.removeEventListener("pointermove",r),this.Ws.pi.zn.removeEventListener("pointerup",n),this.addEventListener("pointerdown",o)};this.removeEventListener("pointerdown",o),this.Ws.pi.zn.addEventListener("pointermove",r),this.Ws.pi.zn.addEventListener("pointerup",n)};this.addEventListener("pointerdown",o)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}setEffect(t){return this.vs=this.vs||this.Ws.pi.vs.ys(this,{Vn:{shapes:this.Nn()}}),this.vs.Vn.Ps(t),this}getEffect(){return!!this.vs&&this.vs.Vn.Ds()}setAutoDispose(t){return this.En=t,this.Ws.Bs(),this}getAutoDispose(){return this.En}getSize(t=e.UISpace.Everything){return t===e.UISpace.Everything?l(this.size.x+(this.ot.left+this.ot.right),this.size.y+(this.ot.bottom+this.ot.top)):this.size}setContentSize(t){this.size=t}setMargin(t){return this.ot="object"==typeof t?v(this.ot,t):{left:t,top:t,right:t,bottom:t},this.Ws.Bs(),this}getMargin(){return this.ot}ir(){if(this.En){const t=this.size,e=this.renderingScale.kt(),i={x:t.x/e.x,y:t.y/e.y};("max-width"===this.En.type&&i.x>=this.En.maxWidth||"max-height"===this.En.type&&i.y>=this.En.maxHeight)&&this.dispose()}return this}Nh(){return this}dispose(){return this.ci||(this.Ws.Bs(),this.ci=!0,this.yi(this),this.D.R("dispose",{}),this.Nn().forEach(t=>t.dispose())),this}setVisible(t){return super.setVisible(t),this.Nn().forEach(e=>e.setVisible(t)),this.Ws.Bs(),this}isDisposed(){return this.ci}setPosition(t){return this.Ln=t,this.Ws.Bs(),this}getPosition(t=this.origin,i=e.UISpace.Everything){const s=this.getSize(e.UISpace.Everything),r=this.scale.Qt(this.Ln,zi({x:-(this.origin.x+1)/2,y:-(this.origin.y+1)/2},s));if(i===e.UISpace.Everything)return this.scale.Qt(r,zi({x:(t.x+1)/2,y:(t.y+1)/2},s));const n=this.scale.Qt(r,{x:this.ot.left,y:this.ot.bottom}),o=this.getSize(e.UISpace.Content);return this.scale.Qt(n,zi({x:(t.x+1)/2,y:(t.y+1)/2},o))}setOrigin(t){return this.origin=t,this.Ws.Bs(),this}getOrigin(){return this.origin}setDraggingMode(t=e.UIDraggingModes.notDraggable){return this.Pn=t,this.Ws.Bs(),this}getDraggingMode(){return void 0!==this.Pn?this.Pn:e.UIDraggingModes.notDraggable}setMouseStyle(t){return this.Dn=t,this}getMouseStyle(){return this.Dn}}class Gn extends Un{constructor(t,e,i,s,r,n){super(t,e,i,r,n),this.Gn=y(),this.$n=0,this.Un=s,this.backgroundElement=new this.Un(this.Ws,this.renderingScale,this.scale,jt,n),this.D.Gi(this.backgroundElement)}setPointerEvents(t){return super.setPointerEvents(t),this.backgroundElement.setPointerEvents(t),this}Nn(){return this.backgroundElement.Nn()}setBackground(t){return t(this.backgroundElement),this}getBackground(){return this.backgroundElement}ir(){return super.ir(),this.ci||(void 0!==this.Yn&&(this.backgroundElement.Yn=this.Yn-.01),this.backgroundElement.setOrigin(this.origin).setPosition(this.getPosition(this.origin,e.UISpace.PaddedBackground)).ir()),this}Nh(){const t=this.getSize(e.UISpace.PaddedContent);return this.backgroundElement.jn(t).Nh(),super.Nh()}dispose(){return super.dispose(),this.backgroundElement.dispose(),this}setVisible(t){return super.setVisible(t),this.backgroundElement.setVisible(t),this}setPadding(t){return this.Gn="object"==typeof t?v(this.Gn,t):{left:t,top:t,right:t,bottom:t},this.Ws.Bs(),this}getPadding(){return this.Gn}getSize(t=e.UISpace.Everything){let i=super.getSize(t);return t>=e.UISpace.PaddedContent&&(i=l(i.x+this.Gn.left+this.Gn.right,i.y+this.Gn.bottom+this.Gn.top)),t>=e.UISpace.PaddedBackground&&(i=l(i.x+this.backgroundElement.Hn()+this.backgroundElement.Wn(),i.y+this.backgroundElement.Xn()+this.backgroundElement.Zn())),i}getPosition(t=this.origin,i=e.UISpace.Everything){if(i===e.UISpace.Everything)return super.getPosition(t,i);const s=super.getPosition(l(-1,-1),e.UISpace.Everything),r=this.getMargin(),n=this.scale.Qt(s,{x:r.left,y:r.bottom});if(i===e.UISpace.PaddedBackground){const i=this.getSize(e.UISpace.PaddedBackground);return this.scale.Qt(n,zi({x:(t.x+1)/2,y:(t.y+1)/2},i))}const o=this.scale.Qt(n,{x:this.backgroundElement.Hn(),y:this.backgroundElement.Xn()});if(i===e.UISpace.PaddedContent){const i=this.getSize(e.UISpace.PaddedContent);return this.scale.Qt(o,zi({x:(t.x+1)/2,y:(t.y+1)/2},i))}const a=this.getPadding(),h=this.scale.Qt(o,{x:a.left,y:a.bottom}),c=this.getSize(e.UISpace.Content);return this.scale.Qt(h,zi({x:(t.x+1)/2,y:(t.y+1)/2},c))}getHighlight(){return this.$n}setHighlight(t){return this.$n=Ge(t),this.backgroundElement.setHighlight(t),this.D.R("highlightchange",{highlight:this.$n}),this}}const Yn=t=>"setBackground"in t,Zn=t=>{const i=t.getPosition({x:-1,y:-1},e.UISpace.PaddedBackground),s=t.getSize(e.UISpace.PaddedBackground),r=t.scale.Qt(i,s),n=tt(i,t.scale,t.Ws.pi.ai),o=tt(r,t.scale,t.Ws.pi.ai),a=t.Ws.pi.Jn(n.x,n.y),h=t.Ws.pi.Jn(o.x,o.y);return{p1:{clientX:a.x,clientY:a.y},p2:{clientX:h.x,clientY:h.y}}};class Wn extends On{constructor(t,e,i,s,r,n,o,a,h,l,c){super(),this.M=0,this.Qn=1,this.Kn=!0,this.qn=new I,this.io=!0,this.ci=!1,this.D=new vt,this.axisScale=s,this.renderingScale=r,this.so=o,this.eo=a,this.ro=h,this.yi=l,this.ho=e,this.no=i,this.oo=this.ho.dr(this.renderingScale),this.D.zi(this.oo),this.bi=c,this.ao=this.ro.setDirection(this.eo).lo(this.no,this.renderingScale,n,jt,this.bi,!1).setOrigin(ue(this.eo)),this.D.Gi(this.ao),this.axis=t,this.setPointerEvents(!1),"major"===this.ao.uo?this.oo.cr(c.xAxisNumericTicks.majorTickStyle.gridStrokeStyle):"minor"===this.ao.uo?this.oo.cr(c.xAxisNumericTicks.minorTickStyle.gridStrokeStyle):"other"===this.ao.uo&&this.oo.cr(c.cursorGridStrokeStyleX)}setValue(t){return this.M=t,this.no.Bs(),this.D.R("valuechange",{value:this.M}),this}getValue(){return this.M}setTextFormatter(t){return this.co=t,this.no.Bs(),this}setTickLength(t){return this.ao.setPointerLength(t),this.ho.Bs(),this}getTickLength(){return this.ao.getPointerLength()}setTickLabelAlignment(t,e){return this.ao.setTickLabelAlignment(t,e),this.ho.Bs(),this}getTickLabelAlignment(){return this.ao.getTickLabelAlignment()}setTickLabelPadding(t){return this.ao.setTickLabelPadding(t),this.ho.Bs(),this}setTickLabelRotation(t){return this.ao.setTextRotation(t),this.ho.Bs(),this}getTickLabelRotation(){return this.ao.getTextRotation()}getTickLabelPadding(){return this.ao.getTickLabelPadding()}setGridStrokeLength(t){return this.Qn=t,this.ho.Bs(),this}getGridStrokeLength(){return this.Qn}setGridStrokeStyle(t){return this.oo.cr(t),this.ho.Bs(),this}getGridStrokeStyle(){return this.oo.do()}dispose(){return this.ci||(this.ci=!0,this.oo.dispose(),this.ao.dispose(),this.yi(this),this.ho.pi.Bs(),this.D.R("dispose",{})),this}setMarkerVisible(t){return this.Kn=t,this.no.Bs(),this}getMarkerVisible(){return this.Kn}setMarker(t){return t(this.ao),this.no.Bs(),this}getMarker(){return this.ao}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}setAllocatesAxisSpace(t){return this.io=t,this.no.Bs(),this}getAllocatesAxisSpace(){return this.io}isInScale(){return mi(this.M,this.axisScale.getInnerStart(),this.axisScale.getInnerEnd())}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class jn extends Wn{constructor(t,e,i,s,r,n,o,a,h,l,c){super(t,e,i,s,r,n,o,a,c,h,l),this.fo=!1,this.yi=h,this.ho=e,this.no=i}dispose(){return this.fo=!1,super.dispose()}update(){return this}plot(t,e,i,s,r){if(this.isInScale()&&this.getVisible()&&t){this.fo=!1;const t=Q(this.M,this.axisScale,this.so.getWidth(this.renderingScale));this.oo.setVisible(!0).gr(this.so.toPoint(t,e)).Ar(this.so.toPoint(t,e-(s+i*this.Qn))),this.Kn?(this.co&&this.ao.setText(this.co(this.M,this)),this.ao.setVisible(!0).setPosition(this.so.toPoint(t,r))):this.ao.setVisible(!1)}else this.oo.setVisible(!1),this.ao.setVisible(!1);return this.ao.Nh().ir(),this}Ao(){this.Kn?(this.co&&this.ao.setText(this.co(this.M,this)),this.ao.setVisible(!0)):this.ao.setVisible(!1);const t=this.ao.Nh().getSize();return this.so.getHeight(t)}}const Hn={po:"X0Z1bGxBY2Nlc3M=",vo:"X0Jhc2VDaGFydHM=",yo:"RGF0YSBHcmlk",mo:"X0hhc0hhcmRFeHBpcmF0aW9u",xo:"X0lzVHJpYWw=",So:"X0lzQ29tbXVuaXR5",bo:"T0hMQyBTZXJpZXM=",Mo:"QmFyIENoYXJ0",wo:"c2xpY2VkIGNoYXJ0cw==",_o:"R2F1Z2UgQ2hhcnQ=",ko:"U3BpZGVyIENoYXJ0",Co:"UG9sYXIgQ2hhcnQ=",To:"M0QgQ2hhcnQ=",Fo:"Wm9vbSBCYW5kIENoYXJ0",Io:"TWFwIENoYXJ0",Lo:"WFkgQ2hhcnQ=",Po:"WFkgU2VyaWVz",Bo:"SGVhdG1hcCBTZXJpZXM=",Do:"RmlndXJlIFNlcmllcw==",Eo:"bG9nYXJpdGhtaWMgYXhpcw==",Ro:"cmVhbC10aW1lIHZpc3VhbGl6YXRpb24=",Oo:"aW5kaXZpZHVhbCBwb2ludCBzaXpl",zo:"aW5kaXZpZHVhbCBwb2ludCBjb2xvcg==",Vo:"VHJlZU1hcCBDaGFydA==",No:"UGFyYWxsZWwgQ29vcmRpbmF0ZSBDaGFydA==",Go:"X1B5dGhvbkxpY2Vuc2U=",$o:"X1N0dWRlbnRMaWNlbnNl"},$n=(t,e)=>t.setTextFillStyle(e.uiTextFillStyle).setTextFont(e.uiTextFont),Xn=(t,e,i)=>{i&&Yn(t)&&t.setBackground(t=>t.setFillStyle(e.uiBackgroundFillStyle).setStrokeStyle(e.uiBackgroundStrokeStyle)).setEffect(!0)},qn={uiElement:void 0,stylers:n.List(),addStyler(t){return{...this,stylers:this.stylers.push(t)}},applyStylers(t,e){return this.stylers.forEach(i=>void 0!==i?i(t,e):void 0),t}},Kn={background:void 0,setBackground(t){return{...this,background:t}}},Jn={lo(t,e,i,s,r,n){const o=this.applyStylers(new this.uiElement(t,e,i,s,r),r);return Xn(o,r,n),o}},Qn={lo(t,e,i,s,r,n){const o=this.applyStylers(new this.uiElement(t,e,i,this.background,s,r),r);return Xn(o,r,n),o}};class to extends Un{constructor(){super(...arguments),this.Uo=!0}ir(){return super.ir(),this}setPointerEvents(t){return this.Uo=t,this}getPointerEvents(){return this.Uo}Nn(){return[]}}class eo extends to{jn(t){return this.size=t,this}Hn(){return 0}Wn(){return 0}Zn(){return 0}Xn(){return 0}setHighlight(t){return this}getHighlight(){return 0}setFillStyle(){return this}getFillStyle(){return ls}setStrokeStyle(){return this}getStrokeStyle(){return Bt}setStrokeThickness(){return this}getStrokeThickness(){return 0}}class io{constructor(t){this.Yo=new Map,this.pi=t}bs(t,e,i){const s=i.animationEnabled;this.Yo.set(t,{applyHighlight:e,curUnanimatedHighlightValue:0,curAnimationPositionMillis:0,animationEnabled:s,curAnimatedHighlightValue:0});const r=()=>{this.Yo.delete(t),t.removeEventListener("dispose",r)};Ut.requestAnimationFrame(()=>{t.addEventListener("dispose",r)})}jo(t,e){let i=e.animationEnabled;const s=[],r=()=>{s.forEach(t=>{this.Yo.delete(t)}),t.removeEventListener("dispose",r)};return Ut.requestAnimationFrame(()=>{t.addEventListener("dispose",r)}),{Ho:(t,e)=>{const r={applyHighlight:e,curUnanimatedHighlightValue:0,curAnimationPositionMillis:0,animationEnabled:i,curAnimatedHighlightValue:0};s.push(t),this.Yo.set(t,r)},Wo:()=>{s.forEach(t=>{this.Yo.delete(t)}),s.length=0},Xo:t=>{i=t,s.forEach(t=>{this.Ns(t,i)})},Zo:()=>i}}Vs(t,e){const i=this.Yo.get(t);i&&(i.curUnanimatedHighlightValue=Ge(e),this.pi.Bs())}Cs(t,e=!1){const i=this.Yo.get(t);return i?e?i.curAnimatedHighlightValue:i.curUnanimatedHighlightValue:0}Ns(t,e){const i=this.Yo.get(t);i&&(i.animationEnabled=e)}Gs(t){const e=this.Yo.get(t);return!!e&&e.animationEnabled}Nh(t){let e=!1;this.Yo.forEach((i,s)=>{let r;if(i.animationEnabled){const s=1e3;if(i.curUnanimatedHighlightValue>0){const n=i.curAnimationPositionMillis/s;r=i.curUnanimatedHighlightValue*Math.abs(Math.sin(n*Math.PI/2+.5));const o=0===i.curAnimatedHighlightValue?1:t;i.curAnimationPositionMillis+=o,e=!0}else i.curAnimatedHighlightValue>0&&0===i.curUnanimatedHighlightValue?(r=Math.max(i.curAnimatedHighlightValue-t/s,0),e=e||r>0):r=0,i.curAnimationPositionMillis=0}else r=i.curUnanimatedHighlightValue;r!==i.curAnimatedHighlightValue&&(i.applyHighlight(r),i.curAnimatedHighlightValue=r)}),e&&this.pi.Bs(!0)}}const so=new Map,ro=(t,e)=>{const i=t.getSize(),s=t.getFamily(),r=t.getWeight(),n=t.getStyle(),o=t.getVariant(),a=`${n} ${o?"small-caps":"normal"} ${r} ${i}px ${s}`,h=`${a} ${e.toFixed(2)}`;let l=so.get(h);return l||(l=((t,e,i,s)=>({font:t,properties:e,dpr:i,id:s}))(a,{type:"font",size:i,family:s,style:n,variant:o,weight:r},e,h),so.set(h,l)),l},no=t=>({container:t.zn,setMouseStyle:(e,i)=>t.Rn(e,i),restoreMouseStyle:e=>t.On(e),clearMouseStyle:()=>t.Jo(),captureFrame:(e,i,s,r)=>t.Qo(e,i,s,r),renderFrame:(e,i,s=!1)=>t.Ko(e,i,s),layout:()=>{t.qo(),t.ta(),t.sa.ia(),t.Bs()},setBackgroundFillStyle(e){return t.setBackgroundFillStyle(e),this},setBackgroundStrokeStyle(e){return t.setBackgroundStrokeStyle(e),this},getBackgroundFillStyle:()=>t.getBackgroundFillStyle(),getBackgroundStrokeStyle:()=>t.getBackgroundStrokeStyle(),addCustomIcon:(e,i)=>t.ea(e,i),addEventListener:(e,i,s)=>t.O(e,i,s),removeEventListener:(e,i)=>t.N(e,i)}),oo=[];let ao;const ho=()=>{if(void 0!==ao){const t=Ut.getComputedStyle(Ut.document.body),e=Number(t.getPropertyValue("margin-top").replace("px",""))+Number(t.getPropertyValue("margin-bottom").replace("px",""));ao.style.height=Ut.innerHeight-e+"px",(()=>{for(let t=0;t<oo.length;t+=1)oo[t]()})()}},lo=new fs({color:M(255,255,255)}),co={font:ro(L,0),fillStyle:lo,lineStyle:new lr({fillStyle:lo,thickness:1}),pointStyle3D:new ar.Triangulated};class uo{constructor(t,e,i){this.ai=J.d2({scaleXYConstructor:q}),this.ra=new Map,this.ha=Mt(()=>this.Bs(),60),this.na=l(0,0),this.oa=!1,this.aa=jt,this.la=()=>{},this.ua=[],this.ca=-1,this.da=[],this.ci=!1,this.fa=!1,this.Aa=t=>{t.dataTransfer&&t.dataTransfer.setDragImage(new Image,0,0)},this.ga=new Map,this.pa=(t,e)=>{var i,s,r;const n=e instanceof PointerEvent&&e,o=At(e)?{clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY}:{clientX:e.clientX,clientY:e.clientY};if(n){if(!n.pointerType)return;this.va=e}const a=this.Ls({x:o.clientX,y:o.clientY});if(("pointermove"===t||"pointerenter"===t)&&a&&n){const t=this.ga.get(n.pointerId);let s=t;s||(s={lastEvent:n,entity:a.entity,collectionMember:a.collectionMember,info:a.info},this.ga.set(n.pointerId,s));const r=void 0===t||t.entity!==a.entity||t.collectionMember!==a.collectionMember;r&&t&&t.entity.R("pointerleave",e,t.collectionMember,t.info),r&&a&&a.entity.R("pointerenter",e,a.collectionMember,a.info),a&&(a.entity.R("pointermove",e,a.collectionMember,a.info),this.zn.draggable=null!==(i=a.entity.fi)&&void 0!==i&&i),s.lastEvent=n,s.entity=a.entity,s.collectionMember=a.collectionMember,s.info=a.info}else if("pointerleave"===t&&n){const t=this.ga.get(n.pointerId);t&&(t.entity.R("pointerleave",e,t.collectionMember,t.info),this.ga.delete(n.pointerId))}else if("click"===t&&n){const t=(null===(s=this.ya)||void 0===s?void 0:s.event)instanceof PointerEvent&&this.ya.event.pointerId===n.pointerId&&this.ya;t&&t.entity.R("click",n,t.collectionMember,t.info)}else if("dblclick"===t&&e instanceof MouseEvent){const t="click"===(null===(r=this.ya)||void 0===r?void 0:r.event.type)&&this.ya;t&&t.entity.R("dblclick",e,t.collectionMember,t.info)}else{const i=e instanceof PointerEvent?this.ga.get(e.pointerId):a;null==i||i.entity.R(t,e,i.collectionMember,i.info)}e&&a&&!["touchend"].includes(t)&&(this.ya={...a,event:e})},this.ta=()=>{const{bottom:t,left:e}=this.zn.getBoundingClientRect(),i=l(Math.floor(e),Math.floor(t));return i.x===this.na.x&&i.y===this.na.y||this.D.R("locationchange",{}),this.na=i,this.ma=Ut.performance.now(),this},this.qo=()=>{this.xa&&this.xa()},this.Rn=(t,e)=>{if(void 0!==e){const i=this.da.find(t=>t[0]===e);return i&&(i[1]=t,this.da.indexOf(i)===this.da.length-1&&(this.zn.style.cursor=t)),e}const i=this.ca;return this.ca+=1,this.da.push([i,t]),this.zn.style.cursor=t,i},this.On=t=>{var e;const i=this.da.find(e=>e[0]===t);if(i){const t=this.da.indexOf(i),s=t===this.da.length-1;if(this.da.splice(t,1),s){const t=(null===(e=this.da[this.da.length-1])||void 0===e?void 0:e[1])||"default";this.zn.style.cursor=t}}},this.Sa=t=>(this.ba.C(t),this),this.Ma=()=>this.ba.T(),this.wa=()=>{this.aa&&this.aa(1e3/60),this._a(),this.ka(),this.la&&this.la()},this.Ca=t=>(this.ra.set(t.Ta(),t),this.ra=new Map([...this.ra.entries()].sort((t,e)=>t[0]-e[0])),t),this.Fa=t=>(this.ra.delete(t),this),this.j=()=>(this.ba.u=!1,this),this.H=()=>(this.ba.u=!0,this),this.Ia=()=>this.va,this.D=new vt,this.sa=t,this.bi=e.theme,this.La=i.La,this.Pa=i.Ba,this.Da={me:e&&void 0!==e.resourcesBaseUrl&&null!==e.resourcesBaseUrl?e.resourcesBaseUrl:void 0,Ea:!e||!("warnings"in e)||"boolean"!=typeof e.warnings||e.warnings,Ra:(()=>{const t=null==e?void 0:e.pickingPrecision;if("string"==typeof t){const e=t.toLowerCase();if("best"===e)return 1;if("high"===e)return.5;if("low"===e)return 1/8}return 1/4})(),Oa:void 0===(null==e?void 0:e.interactable)||e.interactable,za:void 0===e.textPixelSnappingEnabled||e.textPixelSnappingEnabled};const s=e?e.container:void 0;if(s){if("string"==typeof s){const t=Ut.document.getElementById(s);if(!t)throw new Error(`Container "${s}" doesn't exist.`);this.zn=t}else this.zn=s;Ut.addEventListener("resize",this.qo),this.ua.push(()=>{Ut.removeEventListener("resize",this.qo)})}else{if(void 0===ao){const t=Ut.document.createElement("div");t.id="lcjs-auto-flexbox",t.style.position="relative",t.style.width="100%",t.style.display="flex",t.style.flexDirection="column",Ut.document.body.appendChild(t),ao=t,Ut.addEventListener("resize",ho)}let t=1;for(;null!==Ut.document.getElementById(`chart-${t}`);)t+=1;this.zn=Ut.document.createElement("div"),this.zn.id=`chart-${t}`,this.zn.style.flex="1",this.zn.style.height="100%",ao.appendChild(this.zn),ho(),oo.push(this.qo),this.ua.push(()=>{ao&&ao.removeChild(this.zn),oo.includes(this.qo)&&oo.splice(oo.indexOf(this.qo),1),0===oo.length&&ao&&(Ut.document.body.removeChild(ao),ao=void 0,Ut.removeEventListener("resize",ho))})}if(Ut.ResizeObserver){const t=t=>{for(const e of t)e.target===this.zn&&this.qo()};this.Va=new Ut.ResizeObserver(t.bind(this)),this.Va.observe(this.zn)}this.zn.style.position="relative",this.zn.style.boxSizing="content-box",!1!==this.Da.Oa&&(this.zn.style.touchAction="none"),this.zn.style.overflow="hidden",this.zn.addEventListener("fullscreenchange",this.qo),this.zn.addEventListener("webkitfullscreenchange",this.qo),this.zn.addEventListener("dragstart",this.Aa);const r=e?e.maxFps:void 0;this.Na=r?-1===r?-1:0!==r?1e3/r:0:0,Object.keys(xt).forEach(t=>{const e=e=>{this.pa(t,e)};this.zn.addEventListener(t,e),this.ua.push(()=>{this.zn.removeEventListener(t,e)})}),Ut.addEventListener("scroll",this.ta,{passive:!0}),this.ba=m(new S({r:0,g:0,b:0,a:0})),this.Ms=new io(this)}Ga(t,e,i){this.$a=t?{entity:t,timestamp:i,pointed:e}:void 0}Ua(t,e){const i=Array.from(this.ga.values()).find(e=>e.entity===t.entity&&(void 0===t.collectionMember||t.collectionMember===e.collectionMember));i&&(i.entity=e.entity,i.collectionMember=e.collectionMember)}Ci(t,e=void 0){const i=Array.from(this.ga.values()).find(i=>i.entity===t&&(void 0===e||e===i.collectionMember));i&&(t.R("pointerleave",i.lastEvent,i.collectionMember,i.info),this.ga.delete(i.lastEvent.pointerId))}Ya(){this.fa=!0,this.aa=void 0,this.la=void 0}Jo(){this.da.length=0,this.zn.style.cursor="unset"}ja(){return this.Ha}Wa(){return this.Xa}setBackgroundFillStyle(t){return this.Za.qe(t),this.Bs(),this}getBackgroundFillStyle(){return this.Za.Mh()}setBackgroundStrokeStyle(t){return this.Za.Ke(t),this.Bs(),this}getBackgroundStrokeStyle(){return this.Za.Ja()}Qa(t){return this.la=t,this}Ka(t){return this.aa=t,this}qa(t){return this.ra.get(t)}tl(){return Array.from(this.ra.keys()).reverse().reduce((t,e)=>e!==Number.MAX_SAFE_INTEGER&&e>t?e:t,0)+1}G(){if(!this.ci){if(this.ci=!0,this.ra)for(const t of this.ra.values())t.G();this.aa=void 0,this.la=void 0,Ut.removeEventListener("scroll",this.ta),this.zn.removeEventListener("fullscreenchange",this.qo),this.zn.removeEventListener("webkitfullscreenchange",this.qo),this.zn.removeEventListener("dragstart",this.Aa),this.Va&&(this.Va.disconnect(),this.Va=void 0),this.ua.forEach(t=>{t()}),this.ua.length=0}}hr(t,e){return l(t-this.na.x,this.na.y-e)}Jn(t,e){return l(t+this.na.x,this.na.y-e)}il(t){const e=this.hr(t.clientX,t.clientY);return{engineX:e.x,engineY:e.y}}sl(t){const e=this.Jn(t.engineX,t.engineY);return{clientX:e.x,clientY:e.y}}el(t,e,i,s){const r=tt(t,i,this.ai),n=tt(e,i,this.ai),o=this.sl({engineX:r.x,engineY:r.y}),a=this.sl({engineX:n.x,engineY:n.y});return{p1:{clientX:Math.min(o.clientX,a.clientX)-s.left,clientY:Math.min(o.clientY,a.clientY)-s.top},p2:{clientX:Math.max(o.clientX,a.clientX)+s.right,clientY:Math.max(o.clientY,a.clientY)+s.bottom}}}O(t,e,i){this.D.addEventListener(t,e,i)}N(t,e){this.D.removeEventListener(t,e)}}class fo extends mt{constructor(t,e,i,s){super(t,i,s),this.Yn=0,this.Ws=e,this.Ws.rl=!0}hl(){}nl(t){return this.Yn===t||(this.Yn=t,this.Ws.rl=!0),this}ol(){return this.Yn}}class go extends fo{constructor(t,e,i,s,r){super(t,e,s,r),this.al=!0,this.ai=i}}const po=(t,e,i)=>{if(i instanceof q){const s=i.ni(),r=zi(e,{x:Math.abs(s.x),y:Math.abs(s.y)});return g(l(t.min.x-r.x,t.min.y-r.y),l(t.max.x+r.x,t.max.y+r.y))}return g(i.Qt(l(t.min.x,t.min.y),Ri(e,-1)),i.Qt(l(t.max.x,t.max.y),e))},mo=(t,e)=>"function"==typeof e?e(t):e,yo=(t,e)=>!t||t!==e,xo=t=>t!==ls;class vo extends go{constructor(t,e,i,s,r){super(t,e,i,s,r),this.Ze=co.fillStyle,this.pi=t}qe(t){return this.Ze=mo(this.Ze,t),this}Mh(){return this.Ze}ll(){return yo(this.ul,this.Ze)}cl(){return((t,e)=>t===ls&&e!==ls)(this.ul,this.Ze)}dl(){return xo(this.Ze)}fl(t){this.ul=t}}class Ao extends vo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.Je=co.lineStyle,this.pi=t}Ke(t){return this.Je="function"==typeof t?t(this.Je):t,this}Ja(){return this.Je}Al(){return!this.pl||this.pl!==this.Je}vl(t){return!this.pl||this.pl.getThickness()!==t}dl(){return this.Je!==Bt||super.dl()}cl(){return(this.Je!==Bt||this.Ze!==ls)&&this.pl===Bt&&this.ul===ls}yl(t){this.pl=t}}class So extends vo{constructor(t,e,i,s,r,n=m(co.font)){super(t,e,i,s,r),this.ml=m(""),this.xl=!1,this.Sl={x:1,y:-1},this.Ln=m(l(0,0)),this.bl=m(0),this.Ml=m(0),this.wl=m(l(0,0)),this._l=m(0),this.kl=m(L),this.Cl=l(0,0),this.ot=m(y(1,1,1,1)),this.Gn=m(x(4,4,4,4)),this.font=m(co.font),this.Tl=!1,this.font=n}dl(){return xo(this.Ze)&&this.ml.T().length>0}cl(){return!1===this.Tl&&this.dl()}tn(t){return this.ml.C(t),this}rn(){return this.ml.T()}Ch(t){return R(t)?this.kl.C(t):this.kl.C(t(this.kl.T())),this}kh(){return this.kl.T()}Fl(t){return this.kl.C(this.kl.T().setFamily(t)),this}Il(){return this.kl.T().getFamily()}Ll(t){return this.kl.C(this.kl.T().setSize(t)),this}Pl(){return this.kl.T().getSize()}Bl(t){return this.kl.C(this.kl.T().setWeight(t)),this}Dl(){return this.kl.T().getWeight()}El(t){return this.kl.C(this.kl.T().setStyle(t)),this}Rl(){return this.kl.T().getStyle()}Ol(t){return this.kl.C(this.kl.T().setVariant(t)),this}zl(){return this.kl.T().getVariant()}sr(t){return this.Ln.C(t),this}Vl(){return this.Ln.T()}Th(t){return this._l.C(t),this}Fh(){return this._l.T()}qh(t){return this.Nl=t,this}Gl(){return this.Nl}$l(t,e){return this.wl.C(l(t,e)),this}Ul(){return this.wl.T()}Yl(t){return this.Ml.C(t),this}jl(){return this.Ml.T()}Hl(){return{x:this.Ml.T(),y:this.bl.T()}}Wl(t){return this.bl.C(t),this}Xl(){return this.bl.T()}Zl(t){return this.Ml.C(t.x),this.bl.C(t.y),this}Mn(t){return this.ot.C(t),this}Jl(){return this.ot.T()}wn(t){return this.Gn.C(t),this}Ql(){return this.Gn.T()}}class bo extends Ao{constructor(t,e,i,s,r){super(t,e,i,s,r),this.Ln=m(l(0,0)),this.Y=m(l(100,100)),this._l=m(0),this.Cl=m(l(0,0)),this.Kl=!1}Nh(){return this.ql(),this}sr(t){const e=this.Ln.T();return t.x===e.x&&t.y===e.y||(this.Ln.C(t),this.ql()),this}Vl(){return this.Ln.T()}tu(t){const e=this.Ln.T();return t!==e.x&&(this.Ln.C(l(t,e.y)),this.ql()),this}iu(t){const e=this.Ln.T();return t!==e.y&&(this.Ln.C(l(e.x,t)),this.ql()),this}Z(t){const e=this.Y.T();return t.x===e.x&&t.y===e.y||(this.Y.C(l(t.x,t.y)),this.ql()),this}kt(){return this.Y.T()}su(t){const e=this.Y.T();return t!==e.x&&(this.Y.C(l(t,e.y)),this.ql()),this}eu(t){const e=this.Y.T();return t!==e.x&&(this.Y.C(l(e.x,t)),this.ql()),this}Th(t){return this._l.C(t),this}Fh(){return this._l.T()}ru(t){const e=this.Cl.T();return t===e&&e.x===t.x&&e.y===t.y||(void 0===t?(this.Kl=!1,this.ql()):(this.Kl=!0,this.Cl.C(t))),this}ql(){if(!this.Kl){const t=this.Ln.T(),e=this.Y.T(),i=l(t.x+e.x/2,t.y+e.y/2),s=this.Cl.T();i.x===s.x&&i.y===s.y||this.Cl.C(i)}}}class Mo extends Ao{constructor(){super(...arguments),this.hu=[],this.Ln=m(l(0,0)),this.nu=ai,this.ou=!1}au(t){return t=Ee(t),this.hu=t,this.ou=!0,this}lu(){return this.hu}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return 0}cu(){return 0}}class Eo extends vo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.du=new Array,this.fu=new Array,this.nu=ai,this.Au=0,this.gu=!1,this.pu=[Array(),Array()],this.vu=!1,this.yu=(new fs).setColor(M(42,171,240)),this.mu=!1,this.xu=!1,this.Su=!1}bu(t,e){const i=this.Au-1,s=i>0&&!this.vu;let[r,n]=s?[[this.du[i]],[this.fu[i]]]:[[],[]];if(t instanceof Array){const[e,i]=f(t);r=Be(r,e,{canReturnB:!0}),n=Be(n,i,{canReturnB:!0})}else{const e=t.position;r.push(l(e,t.high)),n.push(l(e,t.low))}return this.vu?(this.pu[0]=Be(this.pu[0],r,{canReturnB:!0}),this.pu[1]=Be(this.pu[1],n,{canReturnB:!0})):(this.pu=[r,n],this.vu=!0),this.nu=Ei(this.nu,e||Ei(bi(r),bi(n))),this}Vi(){return this.mu=!0,this.du.length=0,this.fu.length=0,this.Au=0,this.nu=ai,this}Mu(){return[this.du,this.fu]}wu(){return[this.pu[0],this.pu[1]]}_u(t){return this.yu="function"==typeof t?t(this.yu):t,this}ku(){return this.yu}Cu(){return this.Au-(Number(this.xu)+Number(this.Su))}Tu(){return this.pu.length}Fu(t){return this.xu=t,this}Iu(){return this.xu}Lu(t){return this.Su=t,this}Pu(){return this.Su}cl(){return this.ul===ls&&this.Bu===ls&&(this.Ze!==ls||this.yu!==ls)}Du(t){this.Bu=t}dl(){return this.yu!==ls||super.dl()}ll(){return super.ll()||!this.Bu||this.Bu!==this.yu}}class ko extends Ao{constructor(t,e,i,s,r){super(t,e,i,s,r),this.Ln=m(l(0,0)),this.Eu=m(0),this.Ut=m(360),this.Ru=m(100),this.Ou=m(100),this.zu=m(0),this.Vu=m(void 0),this.Nu=l(0,0),this.Gu=l(0,0),this.$u=l(0,0)}Uu(){return this.Ru.T()}Yu(){return this.Ou.T()}Vl(){return this.Ln.T()}ju(){return this.Eu.T()}$t(){return this.Ut.T()}Hu(){return this.zu.T()}Wu(){return this.Vu.T()}Xu(){return this.Nu}Zu(){return this.Gu}Ju(){return this.$u}sr(t){return this.Ln.C(t),this}Qu(t){return this.Eu.C(t),this}Ar(t){return this.Ut.C(t),this}Ku(t){return this.Ou.C(t),this.Ru.C(t),this}qu(t){return this.Ru.C(t),this}tc(t){return this.Ou.C(t),this}sc(t){return this.zu.C(t<0?0:t),this}rc(t){return this.Vu.C(void 0!==t&&t<=0?void 0:t),this}}var To;!function(t){t[t.Complex=0]="Complex",t[t.Simple=1]="Simple"}(To||(To={}));class wo extends go{constructor(t,e,i,s,r){super(t,e,i,s,r),this.hc=co.lineStyle,this.engine=t,this.nc=i instanceof K}cr(t){return this.hc=((t,e)=>"function"==typeof e?e(t):e)(this.hc,t),this.nc&&gr(this.hc)&&(Ut.console.error("LightningChart JS error | DashedLine is not supported together with logarithmic axis"),this.hc=co.lineStyle),this}do(){return this.hc}Al(){return((t,e)=>!t||t!==e)(this.oc,this.hc)}ac(t){return((t,e)=>!t||t.getThickness()!==e)(this.oc,t)}cl(){return((t,e)=>t===Bt&&e!==Bt)(this.oc,this.hc)}dl(){return(t=>t!==Bt&&t.getFillStyle()!==ls)(this.hc)}lc(t){this.oc=t}}class Co extends wo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.jt=l(0,0),this.Ut=l(0,0),this.uc=!1}C({min:t,max:e}){return t.x===this.jt.x&&t.y===this.jt.y&&e.x===this.Ut.x&&e.y===this.Ut.y||(this.uc=!0,this.jt=t,this.Ut=e),this}Yt(){return this.jt}$t(){return this.Ut}gr(t){return t.x===this.jt.x&&t.y===this.jt.y||(this.uc=!0,this.jt=t),this}Ar(t){return t.x===this.Ut.x&&t.y===this.Ut.y||(this.uc=!0,this.Ut=t),this}}class Bo extends wo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.cc=void 0,this.dc=0}}class Fo extends wo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.fc=[],this.nu=ai,this.pu=new Array,this.Ac=0,this.mu=!1,this.gc=m(void 0),this.xu=!1,this.Su=!1}wu(){return this.pu}Mu(){return this.fc}Vi(){return this.mu=!0,this.fc.length=0,this.Ac=0,this.pu=[],this.nu=ai,this}Cu(){return this.Ac-(Number(this.xu)+Number(this.Su))}Tu(){return this.pu.length}Fu(t){return this.xu=t,this}Iu(){return this.xu}Lu(t){return this.Su=t,this}Pu(){return this.Su}}class Do extends So{constructor(t,i,s,r,n){super(t,i,s,r,[]),this.vc={uid:n,text:"",font:"",color:"",position:"absolute",left:0,top:0,padding:"",alignmentX:0,alignmentY:0,rotation:0,identifier:e.TextObjectIdentifier.Other,visible:!0}}yc(){var t;if(!this.getVisible()||0===this.ml.T().length||cs(this.Ze))return this.vc.visible=!1,this.vc;this.vc.visible=!0;const i=ro(this.kl.T(),devicePixelRatio);this.vc.identifier=null!==(t=this.Zr)&&void 0!==t?t:e.TextObjectIdentifier.Other,this.vc.text=this.ml.T(),this.vc.font=i.font,this.vc.color=gs(this.Ze)?`rgba(${255*this.Ze.color.r},${255*this.Ze.color.g},${255*this.Ze.color.b},${this.Ze.color.a})`:this.vc.color;const s=this.Ln.T(),r=tt(s,this.ai,this.pi.ai),n=Math.round(10*r.x)/10,o=Math.round(10*(this.pi.kt().y-r.y))/10;this.vc.top=o,this.vc.left=n,this.vc.alignmentX=this.Ml.T(),this.vc.alignmentY=this.bl.T(),this.vc.rotation=this._l.T();const a=this.ot.T(),h=this.Gn.T();return this.vc.padding=`${a.top+h.top}px ${a.right+h.right}px ${a.bottom+h.bottom}px ${a.left+h.left}px`,this.vc}mc(){var t;this.yc();const e=null===(t=this.pi.xc)||void 0===t?void 0:t.Sc.getTextBoundingBox;if(e){const t=e(this.vc);if(t){const e=this.pi.il({clientX:t.left,clientY:t.top}),i=this.pi.il({clientX:t.left+t.width,clientY:t.top+t.height}),s=tt({x:e.engineX,y:e.engineY},this.pi.ai,this.ai),r=tt({x:i.engineX,y:i.engineY},this.pi.ai,this.ai);return{min:{x:Math.min(s.x,r.x),y:Math.min(s.y,r.y)},max:{x:Math.max(s.x,r.x),y:Math.max(s.y,r.y)}}}}return ai}bc(){var t;this.yc();const e=null===(t=this.pi.xc)||void 0===t?void 0:t.Sc.measureText;if(e){const t=e(this.vc);if(t)return t}return this.pi.Mc.th.Tr(this.ml.T(),this.kl.T(),this._l.T())}kt(){if(!(this.ai instanceof q))return{x:0,y:0};const t=this.ai.ni(),e=this.bc();return{x:e.x*t.x,y:e.y*t.y}}Nh(){return this}Wi(){return 0}Hi(){return 0}Zi(){return 0}Xi(){return 0}uu(){return 0}cu(){return 0}wc(t,e){return{}}_c(){return this}kc(t,e,i,s,r){return{}}}class Io extends Un{constructor(){super(...arguments),this.$n=0}getHighlight(){return this.$n}setHighlight(t){return this.$n=t,this.Nn().forEach(e=>e.Ii(t)),this.D.R("highlightchange",{highlight:t}),this.Ws.Bs(),this}}class Ro extends Io{}class Lo extends Ro{constructor(t,e,i,s,r,n){super(t,e,i,r,n),this.Cc=this.Ws.Tc(this.renderingScale,To.Simple).setVisible(!1).qe(ls).Ke(Bt),this.D.zi(this.Cc)}Fc(){const t=this.Ic();if(t.length>2){const e=bi(t),i=l(e.max.x-e.min.x,e.max.y-e.min.y);this.setContentSize(i);const s=t.map(t=>{const s=Li(t,Ri(e.min,-1));return this.scale.Qt(this.Ln,Li(s,zi(Ri(Li(this.origin,l(1,1)),-.5),i)))}).map(t=>tt(t,this.scale,this.renderingScale));this.Cc.au(s).setVisible(this.getVisible()).setVisible(this.getVisible())}else this.Cc&&this.Cc.setVisible(!1),this.setContentSize(l(0,0))}ir(){return super.ir(),this.ci||(this.Fc(),void 0!==this.Yn&&this.Cc.nl(this.Yn)),this}Nh(){return this.Fc(),super.Nh()}setVisible(t){return super.setVisible(t),this.Cc.setVisible(t),this}}const Po=t=>!(!t||"object"!=typeof t||!("elementAt"in t)),zo=t=>{if("srcLoopArray"in t){const{srcLoopArray:e,dataRanges:i,NewArray:s}=t;return{length:i.reduce((t,e)=>t+e.count,0),elementAt:t=>{let s=0;for(const r of i){if(s+r.count-1>=t){const i=r.offset+(t-s);return e[i]}s+=r.count}return _e(0,()=>{}),-1},toArray:(t,r)=>{const n=r-t+1;if(1===i.length){const s=i[0],n=s.offset+t,o=s.offset+r;return e.subarray(n,o+1)}{const o=i[0],a=i[1],h=0,l=h+o.count-1,c=l+1,u=c+a.count-1,d=new s(n);let f=0;if(!(r<h||t>l)){const i=Math.max(h,t),s=Math.min(l,r)-i+1,n=o.offset+(t+f-h);d.set(e.subarray(n,n+s),f),f+=s}if(!(r<c||t>u)){const i=Math.max(c,t),s=Math.min(u,r)-i+1,n=a.offset+(t+f-c);d.set(e.subarray(n,n+s),f),f+=s}return d}}}}return{length:t.length,elementAt:e=>t[e],toArray:(e,i)=>Vt(t,e,i+1)}},_o=(t,e)=>Object.keys(t).length===Object.keys(e).length&&!Object.keys(t).find(t=>void 0===e[t])&&!Object.entries(t).find(([t,i])=>e[t]!==i);class Vo{constructor(t){if(this.Lc=0,this.Pc=0,this.Bc=0,this.Dc=!1,this.Ec=!0,this.Rc=!1,this.Oc={warningDisplayed:!1,expandEvents:[]},this.D=new vt,this.Ec=!t||void 0===t.autoSortingEnabled||t.autoSortingEnabled,this.zc=!1!==(null==t?void 0:t.allowInputModification),this.Vc=void 0===(null==t?void 0:t.includesNaN)||t.includesNaN,this.Nc=void 0!==(null==t?void 0:t.strictMode)&&t.strictMode,this.Ea=void 0===(null==t?void 0:t.warnings)||t.warnings,this.Gc=void 0===(null==t?void 0:t.autoDetectPatterns)||t.autoDetectPatterns,null==t?void 0:t.schema){const e={};Object.entries(t.schema).forEach(([t,i])=>{var s;if(!i)return;let r=void 0!==i.pattern?i.pattern:void 0;i.auto&&(r=("object"==typeof i.auto&&null!==(s=i.auto.step)&&void 0!==s?s:1)>0?"progressive":"regressive");const n={dataStorage:i.storage,$c:{effective:r,userSpecified:r},auto:i.auto,cache:void 0,ensureNoDuplication:void 0!==i.ensureNoDuplication&&i.ensureNoDuplication};if(this.Nc&&void 0===i.pattern)throw new Error(`LightningChart JS error - DataSetXY property ('${t}') data pattern not specified. This is not allowed when strict mode is enabled.`);e[t]=n}),this.Uc=e}if(this.Nc&&!this.Uc)throw new Error("LightningChart JS error - DataSetXY schema not defined. This is not allowed when strict mode is enabled.")}appendJSON(t,e,i){if(!Array.isArray(t))return this.appendJSON([t]);const s=t.length;if(0===s)return this;const r=Object.keys(t[0]).filter(t=>(!(null==e?void 0:e.whitelist)||e.whitelist.includes(t))&&(!(null==e?void 0:e.blacklist)||!e.blacklist.includes(t)));if(0===r.length)return this;const n=t[0],o=Object.fromEntries(r.map(t=>{if("number"!=typeof n[t])return[t,[]];const e=this.Uc&&this.Uc[t];return[t,new((null==e?void 0:e.dataStorage)||Float64Array)(s)]}));for(let e=0;e<s;e+=1){const i=t[e];for(const t of r)o[t][e]=i[t]}return i&&Object.entries(i).forEach(([t,e])=>{o[t]=e}),this.appendSamples(o,e),this}appendSample(t,e){const i=Object.keys(t).filter(t=>(!(null==e?void 0:e.whitelist)||e.whitelist.includes(t))&&(!(null==e?void 0:e.blacklist)||!e.blacklist.includes(t)));if(0===i.length)return this;const s=Object.fromEntries(i.map(e=>{var i,s;return[e,jo(t[e],this.Uc&&null!==(s=null===(i=this.Uc[e])||void 0===i?void 0:i.dataStorage)&&void 0!==s?s:Float64Array)]})),r=this.Yc({appendCount:1,keys:i,parsedDataArrs:s,opts:e});if(!r.incomingDataReplacedCache&&this.Ec){let t=this.jc(s);if(t=t&&t.filter(t=>this.Uc&&this.Uc[t].$c&&!("autoDetectResult"in this.Uc[t].$c)),t&&t.length>0)if(this.Rc);else{t.length>1&&this.Ea&&Ut.console.warn("LightningChart JS warning - DataSetXY data pushed in order that doesn't match data pattern. Automatic sorting is attempted, but there is more than 1 data pattern mismatch. Behavior may be compromised.");for(const e of t){const t=this.Uc?this.Uc[e]:void 0;if(!(t&&t.$c&&"autoDetectResult"in t.$c))return this.Hc(e,{parsedDataArrs:Object.fromEntries(r.keys.map(t=>[t,"number"==typeof s[t]?new Array(1).fill(s[t]):s[t]])),offset:0,count:1}),this}Ut.console.error(`LightningChart JS error - data is arriving in wrong order and auto sorting is either disabled or not applicable. Chart functionality is compromised. Following data properties didn't match their configured pattern: ${t.map(t=>`'${t}'`).join(", ")}`)}}for(const t of r.keys){const e=r.buckets[t].cache;if(!e)continue;const i=s[t];e[this.Lc]="number"==typeof i?i:i[0]}return this.D.R("change",{type:"change",iDataStart:this.Lc,iDataEnd:this.Lc}),this.Lc+=1,this.Lc>r.maxSampleCount-1&&void 0!==this.Wc&&(this.Lc=0,this.Dc=!0,this.D.R("loop",{type:"loop"})),this.Pc=Math.min(this.Pc+1,r.maxSampleCount),this.Bc+=1,this}appendSamples(t,e){const i=Object.entries(t).filter(([,t])=>void 0!==t).map(t=>t[0]);if(0===i.length)return this;const s=Object.entries(t).filter(([,t])=>"object"==typeof t&&"length"in t).map(t=>t[0]),r=s.reduce((e,i)=>Math.min(e,t[i].length),Number.MAX_SAFE_INTEGER);s.forEach(e=>{const i=t[e];i.length>r&&(Ut.console.warn(`LightningChart JS warning - insymmetric DataSetXY input (${e}). Extra measurements will be dropped`),Array.isArray(i)?this.zc?i.length=r:t[e]=i.slice(0,r):t[e]=i.subarray(0,r))});let n=null==e?void 0:e.offset,o=null==e?void 0:e.count;if(n=void 0!==n?n:0,o=void 0!==o?o:r-n,o<=0)return this;const a=Object.fromEntries(i.map(e=>{var i,s;const r=t[e];return this.Uc&&this.Uc[e]&&void 0!==this.Uc[e].dataStorage||this.Nc||!$o(r)?[e,jo(t[e],this.Uc&&null!==(s=null===(i=this.Uc[e])||void 0===i?void 0:i.dataStorage)&&void 0!==s?s:Float64Array)]:[e,r]})),h=this.Yc({appendCount:o,keys:i,parsedDataArrs:a,opts:e});if(Object.entries(h.buckets).forEach(([t,e])=>{if(0===this.Pc&&e.ensureNoDuplication){const i=a[t],s=e.cache;if(Array.isArray(i)||s!==i)throw new Error(`LightningChart JS error | DataSetXY ensureNoDuplication check failed for '${t}'`)}}),!h.incomingDataReplacedCache&&this.Ec){let t=this.jc(a);if(t=t&&t.filter(t=>this.Uc&&this.Uc[t].$c&&!("autoDetectResult"in this.Uc[t].$c)),t&&t.length>0)if(this.Rc);else{t.length>1&&this.Ea&&Ut.console.warn("LightningChart JS warning - DataSetXY data pushed in order that doesn't match data pattern. Automatic sorting is attempted, but there is more than 1 data pattern mismatch. Behavior may be compromised.");for(const e of t){const t=this.Uc?this.Uc[e]:void 0;if(!(t&&t.$c&&"autoDetectResult"in t.$c))return this.Hc(e,{parsedDataArrs:Object.fromEntries(i.map(t=>[t,"number"==typeof a[t]?new Array(o).fill(a[t]):a[t]])),offset:n,count:o}),this}Ut.console.error(`LightningChart JS error - data is arriving in wrong order and auto sorting is either disabled or not applicable. Chart functionality is compromised. Following data properties didn't match their configured pattern: ${t.map(t=>`'${t}'`).join(", ")}`)}}const l=h.maxSampleCount-this.Lc,c=Math.min(o,l);if(c>0){if(!h.incomingDataReplacedCache)for(const t of h.keys){const e=h.buckets[t].cache,i=a[t];Go(e,i,n,c,this.Lc)}this.D.R("change",{type:"change",iDataStart:this.Lc,iDataEnd:this.Lc+c-1}),this.Lc+=c,this.Lc>h.maxSampleCount-1&&(this.Lc=0,this.Dc=!0,this.D.R("loop",{type:"loop"}))}if(this.Pc=Math.min(this.Pc+c,h.maxSampleCount),this.Bc+=c,o-c>0&&!h.incomingDataReplacedCache){const t={};for(const e of h.keys)t[e]=Vt(a[e],n+c,void 0);this.appendSamples(t,e)}else this.Xc();return this}fill(t){return this.Uc?(Object.keys(t).forEach(t=>{this.Uc&&!this.Uc[t]&&this.Ea&&Ut.console.warn(`LightningChart JS warning - DataSetXY.fill() tried to fill data property that doesn't exist in schema ("${t}")`)}),Object.entries(this.Uc).forEach(([e,i])=>{let s=t[e];i.cache&&void 0!==s&&(b(s)&&(s=s.toUint32()),i.cache.fill(s))}),this.D.R("clear",{type:"clear"}),this):this}setSamples(t,e){return this.clear().appendSamples(t,e)}alterSamplesStartingFrom(t,e,i){var s,r,n;const o=Object.values(e).find(t=>"number"!=typeof t);let a=null==i?void 0:i.offset,h=null==i?void 0:i.count;const l=o?o.length:1;if(a=void 0!==a?a:0,h=void 0!==h?h:l-a,h<=0)return this;const c=Object.keys(e),u=Object.fromEntries(c.map(t=>{var i,s;return[t,jo(e[t],this.Uc&&null!==(s=null===(i=this.Uc[t])||void 0===i?void 0:i.dataStorage)&&void 0!==s?s:Float64Array)]})),d=this.Bc-1,f=void 0!==this.Wc?Math.max(this.Bc-this.Wc,0):0,g=t+h-1,p=Math.max(t,f),m=Math.min(g,d),y=m-p+1;if(this.Bc>0&&y>0){const e=this.Yc({appendCount:0,keys:c,parsedDataArrs:u,opts:i}),o=null!==(n=null===(r=null===(s=Object.values(e.buckets).find(t=>t.cache))||void 0===s?void 0:s.cache)||void 0===r?void 0:r.length)&&void 0!==n?n:0;if(void 0!==this.Wc&&this.Dc&&this.Bc%this.Wc!=0){const i=this.Bc-this.Bc%this.Wc,s=this.Bc-1,r=this.Bc-this.Pc,n=i-1,h=Math.max(p,r),l=Math.min(m,n)-h+1;if(l>0){const i=h-t,s=No(h,this.Bc,o,this.Lc);for(const t of e.keys){const r=e.buckets[t].cache,n=u[t];Go(r,n,a+i,l,s)}}const c=Math.max(p,i),d=Math.min(m,s)-c+1;if(d>0){const i=c-t,s=No(c,this.Bc,o,this.Lc);for(const t of e.keys){const r=e.buckets[t].cache,n=u[t];Go(r,n,a+i,d,s)}}}else{const t=p-f;for(const i of e.keys){const s=e.buckets[i].cache,r=u[i];Go(s,r,a,y,t)}}this.D.R("clear",{type:"clear"})}const x=t+h-1-d;if(x>0){const i=m+1-t;this.appendSamples(e,{offset:a+i,count:x})}return this}alterSamplesByIndex(t,e){var i;if(!this.Uc)return this;const s=t.length,r=Object.keys(e),n=Object.fromEntries(r.map(t=>{var i,s;return[t,jo(e[t],this.Uc&&null!==(s=null===(i=this.Uc[t])||void 0===i?void 0:i.dataStorage)&&void 0!==s?s:Float64Array)]})),o=this.Bc-1,a=void 0!==this.Wc?Math.max(this.Bc-this.Wc,0):0;if(s<=0)return this;let h=!1;const l=Object.values(this.Uc).find(t=>t.cache).cache.length;for(let e=0;e<s;e+=1){const s=t[e];if(s<a||s>o)continue;const c=No(s,this.Bc,l,this.Lc);for(const t of r){const s=null===(i=this.Uc[t])||void 0===i?void 0:i.cache,r=n[t];s&&(s[c]="number"==typeof r?r:r[e],h=!0)}}return h&&this.D.R("clear",{type:"clear"}),this}alterSamplesByMatch(t,e,i){var s;if(!this.Uc)return this;const r=e.length,n=this.Pc,o=this.Bc-1,a=Math.max(o-n+1,0),h=Object.keys(i),l=Object.fromEntries(h.map(t=>{var e,s;return[t,jo(i[t],this.Uc&&null!==(s=null===(e=this.Uc[t])||void 0===e?void 0:e.dataStorage)&&void 0!==s?s:Float64Array)]}));if(r<=0)return this;let c=!1;const u=this.Uc[t].cache,d=this.Zc(t);if(!u)return this;const f=u.length;for(let i=0;i<r;i+=1){const r=e[i];let n;if(d){const t=Uo(r,a,o,!0,t=>u[No(t,this.Bc,f,this.Lc)]);n=No(t,this.Bc,f,this.Lc)}else for(let t=0;t<f;t+=1)if(u[t]===r){n=t;break}if(void 0!==n){if(u[n]===r)for(const t of h){const e=null===(s=this.Uc[t])||void 0===s?void 0:s.cache,r=l[t];e&&(e[n]="number"==typeof r?r:r[i],c=!0)}}else this.Ea&&Ut.console.warn(`LightningChart JS warning - DataSetXY.alterSamplesByMatch no match found for "${t}=${r}"`)}return c&&this.D.R("clear",{type:"clear"}),this}Xc(t=!1){this.Uc&&this.Gc&&Object.entries(this.Uc).forEach(([e,i])=>{if(!i.cache)return;let s;if(i.$c&&"userSpecified"in i.$c)s=i.$c.userSpecified;else if(i.$c&&"autoDetectResult"in i.$c)s=i.$c.autoDetectResult;else if(i.cache&&this.Bc>0&&!t){const t=void 0!==this.Wc&&this.Dc?this.Lc:0,r=this.Pc-1,n=void 0!==this.Wc&&this.Dc?0:void 0,o=void 0!==this.Wc&&this.Dc?this.Lc-1:void 0,[a,h]=void 0!==n&&void 0!==o&&Math.abs(o-n)>Math.abs(r-t)?[n,o]:[t,r];if(1+h-a>=5){let t,r=i.cache[a];for(let e=a+1;e<=h;e+=1)if(!1!==t){const s=i.cache[e],n=Math.sign(s-r);0!==n&&t&&t.direction!==n?t=!1:0===n||t||(t={direction:n}),r=s}s=t&&t.direction>0?"progressive":t&&t.direction<0?"regressive":null,i.$c={autoDetectResult:s,effective:s},this.Ea&&Ut.console.warn(`LightningChart JS DataSetXY warning | Data pattern was detected automatically (${e}=${s}).\nAutomatic detection is only intended for kick-starting application development, not for production use.\nDefine data patterns in schema when creating series or DataSetXY to clear this warning and improve performance.`)}}})}Yc(t){var e,i,s,r,n,o,a,h,l;if(this.Uc||(this.Uc=Object.fromEntries(t.keys.map(e=>[e,{dataStorage:Ho(t.parsedDataArrs[e]),$c:void 0}]))),0===this.Pc&&this.Uc&&!this.Nc){const e=this.Uc;t.keys.forEach(i=>{e[i]||(e[i]={dataStorage:Ho(t.parsedDataArrs[i])})})}if((this.Pc>0||this.Nc)&&this.Uc){const e=this.Uc,i=t.keys.filter(t=>!e[t]);if(i.length>0&&t.appendCount>0){if(this.Nc)throw new Error(`LightningChart JS error - Input data includes data properties that are not defined in schema. This is not allowed when strict mode is enabled. Extra data properties: ${i.map(t=>`'${t}'`).join(", ")}`);this.Ea&&Ut.console.warn(`LightningChart JS warning - Input data includes data properties that are not defined in schema. This is OK for data sets that don't yet have data pushed in, but this was not the case. Extra data properties were dropped: ${i.map(t=>`'${t}'`).join(", ")}`)}i.forEach(e=>{delete t.parsedDataArrs[e]}),t.keys=Object.keys(t.parsedDataArrs)}if(Object.entries(this.Uc).forEach(([e,i])=>{i.dataStorage||(i.dataStorage=Ho(t.parsedDataArrs[e]))}),0===this.Pc&&1===Object.keys(this.Uc).length&&!this.Nc){const a=(null!==(i=null===(e=t.opts)||void 0===e?void 0:e.step)&&void 0!==i?i:1)>0?"progressive":"regressive";this.Uc._auto={dataStorage:Float64Array,auto:{start:null!==(r=null===(s=t.opts)||void 0===s?void 0:s.start)&&void 0!==r?r:0,step:null!==(o=null===(n=t.opts)||void 0===n?void 0:n.step)&&void 0!==o?o:1},$c:{userSpecified:a,effective:a}}}Object.entries(this.Uc).forEach(([e,i])=>{var s,r,n,o,a,h,l,c;if(!i.auto)return;const u=null!==(n=null!==(r=null===(s=t.opts)||void 0===s?void 0:s.step)&&void 0!==r?r:"object"==typeof i.auto?i.auto.step:void 0)&&void 0!==n?n:1;let d;if(0===this.Pc)d=null!==(h=null!==(a=null===(o=t.opts)||void 0===o?void 0:o.start)&&void 0!==a?a:"object"==typeof i.auto?i.auto.start:void 0)&&void 0!==h?h:0;else if(void 0!==(null===(l=t.opts)||void 0===l?void 0:l.start))d=t.opts.start;else{const t=this.Jc();if(!t)return;d=t[e]+u}const f=new(null!==(c=i.dataStorage)&&void 0!==c?c:Float64Array)(t.appendCount);for(let e=0;e<t.appendCount;e+=1)f[e]=d+e*u;t.parsedDataArrs[e]=f}),t.keys=Object.keys(t.parsedDataArrs);const c=Object.keys(this.Uc).filter(e=>!t.keys.includes(e));if(c.length>0&&t.appendCount>0){if(this.Nc)throw new Error(`LightningChart JS error - Input data is missing keys that were defined in schema. This is not allowed when strict mode is enabled. Missing keys: ${c.map(t=>`'${t}'`).join(", ")}`);this.Ea&&Ut.console.warn(`LightningChart JS warning - Input data is missing keys that were defined in schema. They will be filled with \`0\`. Missing keys: ${c.map(t=>`'${t}'`).join(", ")}`)}for(const e of c)t.parsedDataArrs[e]=new(null!==(a=this.Uc[e].dataStorage)&&void 0!==a?a:Float64Array)(t.appendCount).fill(0);if(t.keys=Object.keys(t.parsedDataArrs),0===this.Pc&&0===Object.values(this.Uc).reduce((t,e)=>t+(e.cache?1:0),0)&&(void 0===this.Wc||this.Wc===t.appendCount)&&this.zc&&(0===(null===(h=t.opts)||void 0===h?void 0:h.offset)||void 0===(null===(l=t.opts)||void 0===l?void 0:l.offset)))return Object.entries(this.Uc).forEach(([e,i])=>{var s,r;i.cache="number"==typeof t.parsedDataArrs[e]?new(null!==(s=i.dataStorage)&&void 0!==s?s:Float64Array)(t.appendCount).fill(t.parsedDataArrs[e]):Yo(t.parsedDataArrs[e],null!==(r=i.dataStorage)&&void 0!==r?r:Float64Array)}),this.Xc(),{maxSampleCount:t.appendCount,buckets:this.Uc,incomingDataReplacedCache:!0,keys:t.keys};if(void 0===this.Wc){const e=this.Pc+t.appendCount;if(!Object.values(this.Uc).find(t=>t.cache))return Object.values(this.Uc).forEach(t=>{var i;t.cache=new(null!==(i=t.dataStorage)&&void 0!==i?i:Float64Array)(e)}),this.Xc(),{maxSampleCount:e,buckets:this.Uc,keys:t.keys};const i=Object.values(this.Uc)[0].cache.length;if(i<e){if(!this.Oc.warningDisplayed){const i=Ut.performance.now();if(this.Oc.expandEvents=this.Oc.expandEvents.filter(t=>i-t.timestamp<5e3),e>1e3&&this.Oc.expandEvents.push({timestamp:i}),this.Oc.expandEvents.length>5)return this.Ea&&Ut.console.warn("LightningChart JS warning - DataSetXY append operation was performed more than 5 times in 5 seconds.\nAutomatic max sample count control was enabled.\nFor streaming applications, DataSetXY.setMaxSampleCount() or Series.setMaxSampleCount() should be configured explicitly to get rid of this warning."),this.Oc.warningDisplayed=!0,this.setMaxSampleCount({mode:"auto"}),this.Yc(t)}return Object.values(this.Uc).forEach(t=>{var i;const s=new(null!==(i=t.dataStorage)&&void 0!==i?i:Float64Array)(e);s.set(t.cache),t.cache=s}),this.Lc=this.Pc,this.Xc(),{maxSampleCount:e,buckets:this.Uc,keys:t.keys}}return i>4*e?(Object.values(this.Uc).forEach(t=>{var i;const s=new(null!==(i=t.dataStorage)&&void 0!==i?i:Float64Array)(e);s.set(t.cache.subarray(0,this.Pc)),t.cache=s}),this.Xc(),{maxSampleCount:e,buckets:this.Uc,keys:t.keys}):(this.Xc(),{maxSampleCount:e,buckets:this.Uc,keys:t.keys})}t.appendCount+this.Pc>this.Wc&&this.D.R("maxsamplecountexceed",{type:"maxsamplecountexceed",currentSampleCount:this.Pc,currentMaxSampleCount:this.Wc,newTotalSampleCount:this.Pc+t.appendCount});const u=this.Wc;return Object.values(this.Uc).forEach(t=>{var e;t.cache=t.cache||new(null!==(e=t.dataStorage)&&void 0!==e?e:Float64Array)(u)}),this.Xc(),{maxSampleCount:u,buckets:this.Uc,keys:t.keys}}getSampleCount(){return this.Pc}getNextSampleIndex(){return this.Bc}Zc(t){const e=this.Uc&&this.Uc[t];if(e)return e.$c&&"userSpecified"in e.$c?e.$c.userSpecified:e.$c&&"autoDetectResult"in e.$c?e.$c.autoDetectResult:void 0}Qc(t){if(!this.Uc)return;const e=null==t?void 0:t.x,i=null==t?void 0:t.y,s=void 0!==e?this.Uc[e]:void 0,r=void 0!==i?this.Uc[i]:void 0;if(s&&s.$c&&"userSpecified"in s.$c){if("progressive"===s.$c.userSpecified)return"ProgressiveX";if("regressive"===s.$c.userSpecified)return"RegressiveX"}if(r&&r.$c&&"userSpecified"in r.$c){if("progressive"===r.$c.userSpecified)return"ProgressiveY";if("regressive"===r.$c.userSpecified)return"RegressiveY"}if(s&&s.$c&&"autoDetectResult"in s.$c&&s.$c.autoDetectResult){if("progressive"===s.$c.autoDetectResult)return"ProgressiveX";if("regressive"===s.$c.autoDetectResult)return"RegressiveX"}if(r&&r.$c&&"autoDetectResult"in r.$c&&r.$c.autoDetectResult){if("progressive"===r.$c.autoDetectResult)return"ProgressiveY";if("regressive"===r.$c.autoDetectResult)return"RegressiveY"}}Kc(t){if(!t||!this.Uc)return{dataPattern:void 0,qc:Float64Array,td:Float64Array};const e={dataPattern:this.Qc(t)};for(const i of Object.keys(t)){const s=i,r=t[s];if(void 0===r)continue;const n=this.Uc[r];n&&n.cache&&("x"===s&&(e.sd=n.cache,e.qc=n.dataStorage),"y"===s&&(e.ed=n.cache,e.td=n.dataStorage),"color"===s&&(e.rd=n.cache),"rotation"===s&&(e.hd=n.cache),"size"===s&&(e.nd=n.cache),"lookupValue"===s&&(e.od=n.cache))}return e}setMaxSampleCount(t){if("object"==typeof t){this.ad&&this.removeEventListener("maxsamplecountexceed",this.ad);const e=t.max,i=t.initial;this.ad=t=>{if(void 0!==e&&t.currentMaxSampleCount>=e)return;let i=Math.max(2*t.currentMaxSampleCount,t.newTotalSampleCount);void 0!==e&&(i=Math.min(i,e)),this.setMaxSampleCount(i)},this.addEventListener("maxsamplecountexceed",this.ad),void 0===this.Wc&&(void 0!==i?this.setMaxSampleCount(i):this.setMaxSampleCount(Math.min(2*this.Pc,void 0!==e?e:Number.MAX_SAFE_INTEGER)))}else if("number"==typeof t){const e=t;if(void 0!==this.Wc&&this.Wc>e)throw new Error("LightningChart JS | DataSetXY.setMaxSampleCount attempted to shrink data set. This is currently not supported.");if(!this.Uc||!Object.values(this.Uc).find(t=>t.cache))return this.Wc=e,this;if(e===this.Wc)return this;if(this.Dc&&0!==this.Lc&&this.Lc!==this.getSampleCount())throw new Error("LightningChart JS | DataSetXY.setMaxSampleCount attempted to expand data set that has exceeded its max sample count. This is currently not supported.");this.Wc=e,this.Pc<e?(this.Lc=this.Pc,this.Dc=!1):(this.Lc=0,this.Dc=!0),Object.values(this.Uc).forEach(t=>{var i;const s=new(null!==(i=t.dataStorage)&&void 0!==i?i:Float64Array)(e);s.set(t.cache),t.cache=s})}return this}getMaxSampleCount(){return this.Wc}clear(){return this.Lc=0,this.Pc=0,this.Bc=0,this.Dc=!1,this.D.R("clear",{type:"clear"}),this}readBack(t){var e;if(!this.Uc)return{data:{},iSampleFirst:0};const i=null===(e=Object.values(this.Uc).find(t=>t.cache))||void 0===e?void 0:e.cache;if(!i)return{data:{},iSampleFirst:0};const s=i.length;let r,n=[];if(null==t?void 0:t.onlyInRange){const e=this.Uc[t.onlyInRange.key],i=this.Zc(t.onlyInRange.key),s=e.cache;if(!i)throw new Error("LightningChart JS - attempted to use `DataSetXY.readBack` with `onlyInRange` without a data pattern.\nThis operation is only supported for progressive data");if(!s)return{data:{},iSampleFirst:0};const o=Math.min(t.onlyInRange.start,t.onlyInRange.end),a=Math.max(t.onlyInRange.start,t.onlyInRange.end),h=Oo(o,a,s,this.Bc,this.Pc,this.Lc,i,0);if(!h)return{data:{},iSampleFirst:0};n=h.dataRanges,r=h.iFirstSample}else if(void 0!==this.Wc&&this.Dc&&this.Bc%this.Wc!=0){const t=this.Lc,e=s-t,i=this.Lc-1;n.push({offset:t,count:e}),n.push({offset:0,count:i+1}),r=this.Bc-s}else n.push({offset:0,count:this.Pc}),r=0;const o=n.reduce((t,e)=>t+e.count,0),a=Object.fromEntries(Object.entries(this.Uc).filter(([t,e])=>e.cache).map(([t,e])=>{var i;const s=e.cache;let r;if(1===n.length&&n[0].count===s.length)r=s;else{r=new(null!==(i=e.dataStorage)&&void 0!==i?i:Float64Array)(o);let t=0;for(const i of n)r.set(e.cache.subarray(i.offset,i.offset+i.count),t),t+=i.count}return[t,r]}));return{data:a,iSampleFirst:r}}ld(t,e){var i,s;const r=this.readBack(e);return{xValues:null!==(i=r.data[t.x])&&void 0!==i?i:new Float64Array,yValues:null!==(s=r.data[t.y])&&void 0!==s?s:new Float64Array,lookupValues:t.lookupValue?r.data[t.lookupValue]:void 0,colors:t.color?r.data[t.color]:void 0,sizes:t.size?r.data[t.size]:void 0,rotations:t.rotation?r.data[t.rotation]:void 0,iSampleFirst:r.iSampleFirst}}ud(t){}dd(){return{min:0,max:void 0!==this.Wc&&this.Dc?this.Wc-1:this.Pc-1}}fd(t){t=Math.min(t,this.Pc),this.Bc-=t,this.Pc-=t,this.Lc-=t,this.Lc<0&&void 0!==this.Wc&&(this.Lc+=this.Wc)}Hc(t,e){const i=this.Uc;if(!i)return;const s=this.Zc(t),r="progressive"===s,n=i[t].cache,o=e.parsedDataArrs[t],a=Object.keys(e.parsedDataArrs);if(!s||!n||!o)return;const h=e.count,l=o[0];if(this.jc(Object.fromEntries(a.map(t=>[t,e.parsedDataArrs[t][e.offset+e.count-1]])))){const t=n.length,s=this.Pc,o=this.Bc-1,c=Math.max(o-s+1,0),u=Uo(l,c,o,r,e=>n[No(e,this.Bc,t,this.Lc)]),d=u-1,f=u+1,g=n[No(u,this.Bc,t,this.Lc)],p=f<=this.Bc-1?n[No(f,this.Bc,t,this.Lc)]:void 0,m=void 0!==p&&(r&&p<l||!r&&p>l)?f+1:r&&g<l||!r&&g>l?u+1:d+1,y=o-m+1,x=Object.fromEntries(a.map(t=>{var e;return[t,new(null!==(e=i[t].dataStorage)&&void 0!==e?e:Float64Array)(y)]}));let v=0;for(let e=m;e<=o;e+=1){const s=No(e,this.Bc,t,this.Lc);for(const t of a)x[t][v]=i[t].cache[s];v+=1}this.fd(y);const A=Object.fromEntries(a.map(t=>{var s;const r=new(null!==(s=i[t].dataStorage)&&void 0!==s?s:Float64Array)(h+y);return r.set(e.parsedDataArrs[t]),r.set(x[t],h),[t,r]}));this.Rc=!0,this.appendSamples(A),this.Rc=!1,this.D.R("clear",{type:"clear"})}else{const i=this.Jc(),s=i?i[t]:0;let r=0;for(let t=0;t<h;t+=1)if(o[t]>s){r=t;break}this.Rc=!0,this.appendSamples(e.parsedDataArrs,{offset:r}),this.Rc=!1}}jc(t){const e=this.Jc();if(!e||!this.Uc)return;const i=Object.keys(t),s=[];for(const r of i){const i=this.Zc(r);if(!i)continue;const n=e[r],o=t[r],a="number"==typeof o?o:o[0];("progressive"===i&&a<n||"regressive"===i&&a>n)&&s.push(r)}return s.length>0?s:void 0}Ad(t){const e=this.Kc(t);if(!e.sd||!e.ed||0===this.Pc)return;if(void 0===this.Wc)return this.Bc>0?{x:e.sd[0],y:e.ed[0]}:void 0;if(!this.Dc)return{x:e.sd[0],y:e.ed[0]};let i=this.Lc-this.Pc;return i<0&&(i+=this.Wc),{x:e.sd[i],y:e.ed[i]}}gd(t){const e=this.Kc(t);if(!e.sd||!e.ed||0===this.Pc)return;if(void 0===this.Wc){const t=this.Pc-1;return t>=0?{x:e.sd[t],y:e.ed[t]}:void 0}let i=this.Lc-1;return i<0&&(i+=this.Wc),{x:e.sd[i],y:e.ed[i]}}pd(){if(!this.Uc||0===this.Pc)return;let t;if(void 0===this.Wc){if(this.Bc>0)return;t=0}else this.Dc?(t=this.Lc-this.Pc,t<0&&(t+=this.Wc)):t=0;return Object.fromEntries(Object.entries(this.Uc).map(([e,i])=>[e,i.cache[t]]))}Jc(){if(!this.Uc||0===this.Pc)return;let t;return void 0===this.Wc?t=this.Pc-1:(t=this.Lc-1,t<0&&(t+=this.Wc)),Object.fromEntries(Object.entries(this.Uc).map(([e,i])=>[e,i.cache[t]]))}vd(t,e){const i=this.Kc(t);if(!(this.Uc&&0!==this.Pc&&i&&i.sd&&i.ed))return;const s=i.sd.length,r=this.Pc,n=this.Bc-1,o=Math.max(n-r+1,0)+e,a=No(o,this.Bc,s,this.Lc);return{x:i.sd[a],y:i.ed[a],lookupValue:i.od?i.od[a]:void 0,color:i.rd?i.rd[a]:void 0,size:i.nd?i.nd[a]:void 0,rotation:i.hd?i.hd[a]:void 0,iSample:o,sample:Object.fromEntries(Object.entries(this.Uc).map(([t,e])=>[t,e.cache?e.cache[a]:void 0]))}}yd(t,e,i,s,r){if(!t)return;const n=this.Uc,o=this.Kc(t),a=o.dataPattern,h=o.sd,l=o.ed;if(!h||!l||!n)return;const c=(t,e)=>({x:h[t],y:l[t],lookupValue:o.od?o.od[t]:void 0,color:o.rd?o.rd[t]:void 0,size:o.nd?o.nd[t]:void 0,rotation:o.hd?o.hd[t]:void 0,iSample:e,sample:Object.fromEntries(Object.entries(n).map(([e,i])=>[e,i.cache?i.cache[t]:void 0]))}),u=h.length,d=this.Pc,f=this.Bc-1,g=Math.max(f-d+1,0);if(a){const s=Os(a),r=this.Ad(t),h=this.gd(t);if(!(r&&h&&o.sd&&o.ed))return;const l="ProgressiveX"===a||"RegressiveX"===a?"x":"y",d="x"===l?"y":"x",p="x"===l?o.sd:o.ed,m="x"===d?o.sd:o.ed,y=e[l],x=Math.min(r[l],h[l]),v=Math.max(r[l],h[l]);if(y<x||y>v)return;const A=Uo(y,g,f,s,t=>p[No(t,this.Bc,u,this.Lc)]),S=No(A,this.Bc,u,this.Lc);if(!i)return c(S,A);const b=A-1,M=A+1,E=p[S],k=s?y>=E?M<=f?M:void 0:b>=g?b:void 0:y<=E?M<=f?M:void 0:b>=g?b:void 0;if(void 0===k)return;const T=No(k,this.Bc,u,this.Lc),w=A<k?{pos:p[S],val:m[S],iSample:A}:{pos:p[T],val:m[T],iSample:k},C=A>k?{pos:p[S],val:m[S],iSample:A}:{pos:p[T],val:m[T],iSample:k},B=(y-w.pos)/(C.pos-w.pos),F=Us(w.val,C.val,B),D=Object.fromEntries(Object.entries(n).map(([t,e])=>[t,e.cache?e.cache[S]:void 0]));return"x"===Ns(a)?{x:y,y:F,iSample:Us(w.iSample,C.iSample,B),sample:D}:{y,x:F,iSample:Us(w.iSample,C.iSample,B),sample:D}}let p,m=Number.MAX_VALUE;const y=tt(e,s,r),x=this.Pc-1;for(let t=0;t<=x;t+=1){const e=h[t],i=l[t];if(!this.Vc||!Number.isNaN(e)&&!Number.isNaN(i)){const n=Q(e,s.x,r.x),o=Q(i,s.y,r.y),a=(n-y.x)**2+(o-y.y)**2;a<m&&(m=a,p=t)}}return void 0===p?void 0:c(p,p)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const No=(t,e,i,s)=>t%i,Oo=(t,e,i,s,r,n,o,a)=>{if(0===s||0===r)return;const h="progressive"===o,l=i.length,c=s-1,u=Math.max(c-r+1,0),d=Po(i)?Uo(t,u,c,h,t=>i.elementAt(No(t,s,l))):Uo(t,u,c,h,t=>i[No(t,s,l)]),f=Po(i)?Uo(e,u,c,h,t=>i.elementAt(No(t,s,l))):Uo(e,u,c,h,t=>i[No(t,s,l)]),g=Math.min(d,f),p=Math.max(d,f);if(g===p&&(0===g||g===c))return;const m=Math.max(g-a,u),y=Math.min(p+a,c),x=No(m,s,l),v=No(y,s,l);return x>v?{iFirstSample:m,iLastSample:y,iFirstSampleDataArray:x,iLastSampleDataArray:v,dataRanges:[{offset:x,count:l-x},{offset:0,count:v+1}]}:{iFirstSample:m,iLastSample:y,iFirstSampleDataArray:x,iLastSampleDataArray:v,dataRanges:[{offset:x,count:v-x+1}]}},Uo=(t,e,i,s,r)=>{const n=i;for(;e!==i;){const n=Math.ceil((e+i)/2),o=r(n);s&&t<o||!s&&t>o?i=n-1:e=n}const o=Math.abs(t-r(e));return e<n&&Math.abs(t-r(e+1))<o?e+1:e},Go=(t,e,i,s,r)=>{if("number"==typeof e)t.fill(e,r,r+s);else{const n=e.length;if(Array.isArray(e))for(let n=0;n<s;n+=1)t[r+n]=e[i+n];else t.set(n===s?e:e.subarray(i,i+s),r)}},Yo=(t,e)=>void 0===t?void 0:Array.isArray(t)?new e(t):t instanceof e?t:new e(t),Zo=/^(\d{4}-\d{2}-\d{2})(?:T(\d{2}:\d{2}:\d{2}(?:\.\d+)?)(Z|[+-]\d{2}:\d{2})?)?$/,Wo=t=>"string"==typeof t&&Zo.test(t)&&!Ut.isNaN(Date.parse(t)),jo=(t,e)=>{if("number"==typeof t)return t;if(b(t))return t.toUint32();if(t instanceof Date)return t.getTime();if("string"==typeof t){if(Wo(t))return new Date(t).getTime();throw new Error("LightningChart JS error - XY coordinate supplied as unrecognized String format. Coordinates must be Numbers, Date objects or ISO 8601 Date strings")}const i=t.length,s=t[0]&&t[0]instanceof Date,r=t[0]&&Wo(t[0]),n=t[0]&&b(t[0]);if(!r&&t[0]&&"string"==typeof t[0])throw new Error("LightningChart JS error - XY coordinate supplied as unrecognized String format. Coordinates must be Numbers, Date objects or ISO 8601 Date strings");if(r){const s=new e(i);for(let e=0;e<i;e+=1)s[e]=new Date(t[e]).getTime();return s}if(s){const s=new e(i);for(let e=0;e<i;e+=1)s[e]=t[e].getTime();return s}if(n){const e=t.length,i=new Uint32Array(e);for(let s=0;s<e;s+=1){const e=t[s],r=255*e.a<<24|255*e.b<<16|255*e.g<<8|255*e.r;i[s]=r}return i}return t},Ho=t=>{if(t&&Array.isArray(t))return Float64Array;const e="object"==typeof t?Object.getPrototypeOf(t).constructor:void 0;return null!=e?e:Float64Array},$o=t=>!!t&&!Array.isArray(t)&&(t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array);class Xo extends Io{constructor(t,e,i,s,r){var n;super(t,e,i,s,r),this.ml="label",this.Cc=this.Ws._n(this.renderingScale).tn(this.ml).qe(ls).Mn(Xe).wn(Xe),this.setMargin(null!==(n=r.uiTextPadding)&&void 0!==n?n:5),this.D.zi(this.Cc)}Nn(){return[this.Cc]}setFillStyle(t){return this.Cc.qe(t),this.Ws.Bs(),this}getFillStyle(){return this.Cc.Mh()}ir(){void 0!==this.Yn&&this.Cc.nl(this.Yn);const t=this.getPosition(l(0,0),e.UISpace.Content),i=tt(t,this.scale,this.renderingScale);return this.Cc.sr(i),this.Cc.Zr=this.Zr,this}Nh(){this.Cc.Nh();const t=0===this.ml.length?l(0,0):this.Cc.bc();return this.setContentSize(t),super.Nh()}setText(t){return this.ml=t,this.Cc.tn(this.ml),this.Ws.Bs(),this}getText(){return this.ml}setFont(t){return this.Cc.Ch(t),this.Ws.Bs(),this}getFont(){return this.Cc.kh()}setTextRotation(t){return this.Cc.Th(t),this.Ws.Bs(),this}getTextRotation(){return this.Cc.Fh()}}const qo={...qn,...Jn,uiElement:Xo};class Ko extends Ro{constructor(t,e,i,s,r){super(t,e,i,s,r),this.fitTo=this.jn.bind(this),this.setSize=this.fitTo,this.Cc=this.Ws.md(e).qe(ls).Ke(Bt),this.xd=this.Cc.Ho(),this.D.zi(this.Cc)}Nn(){return[this.Cc]}setCornerRadius(t,e){var i,s,r,n;return this.Sd=t,this.xd.bd(t?{extent:t,c_x1_y1:null===(i=null==e?void 0:e.bottomLeft)||void 0===i||i,c_x1_y2:null===(s=null==e?void 0:e.topLeft)||void 0===s||s,c_x2_y1:null===(r=null==e?void 0:e.bottomRight)||void 0===r||r,c_x2_y2:null===(n=null==e?void 0:e.topRight)||void 0===n||n,skipTooSmallCheck:!!e}:void 0),this.Ws.Bs(),this}getCornerRadius(){return this.Sd}setFillStyle(t){return this.Cc.qe(t),this.Ws.Bs(),this}getFillStyle(){return this.Cc.Mh()}setStrokeStyle(t){return this.Cc.Ke(t),this.Ws.Bs(),this}getStrokeStyle(){return this.Cc.Ja()}ir(){void 0!==this.Yn&&this.Cc.nl(this.Yn);const t=bi([this.getPosition(l(-1,-1),e.UISpace.Content),this.getPosition(l(1,1),e.UISpace.Content)].map(t=>tt(t,this.scale,this.renderingScale)));return this.xd.Md(t.min.x,t.min.y,t.max.x,t.max.y),this}jn(t){return this.setContentSize(t),this.Ws.Bs(),this}Hn(){return 0}Wn(){return 0}Zn(){return 0}Xn(){return 0}}class Jo extends Ro{constructor(t,e,i,s,r){super(t,e,i,s,r),this.wd=l(0,0),this.Cc=t._d(e).Qu(0).Ar(360).qe(ls).Ke(Bt),this.D.zi(this.Cc)}Nn(){return[this.Cc]}setFillStyle(t){return this.Cc.qe(t),this.Ws.Bs(),this}getFillStyle(){return this.Cc.Mh()}setStrokeStyle(t){return this.Cc.Ke(t),this.Ws.Bs(),this}getStrokeStyle(){return this.Cc.Ja()}ir(){void 0!==this.Yn&&this.Cc.nl(this.Yn);const t=this.getSize(e.UISpace.Content).x/2;return this.Cc.qu(t*this.renderingScale.ni().x).tc(t*this.renderingScale.ni().y).sr(tt(this.getPosition(l(0,0),e.UISpace.Content),this.scale,this.renderingScale)).rc(255).Nh(),this}jn(t){const e=Math.sqrt(t.x*t.x/4+t.y*t.y/4);return this.setContentSize(l(2*e,2*e)),this.wd=t,this.Ws.Bs(),this}Hn(){return(this.getSize(e.UISpace.Content).x-this.wd.x)/2}Wn(){return(this.getSize(e.UISpace.Content).x-this.wd.x)/2}Zn(){return(this.getSize(e.UISpace.Content).y-this.wd.y)/2}Xn(){return(this.getSize(e.UISpace.Content).y-this.wd.y)/2}fitTo(t){const e=Math.min(t.x,t.y);return this.setContentSize(l(e,e)),this.wd=t,this}}class Qo extends Lo{constructor(t,e,i,s,r){super(t,e,i,To.Simple,s,r),this.kd=m(l(0,0)),this.Cd=!1,this.Fc()}Ic(){const t=this.kd.T();if(this.Cd){const e=Math.min(t.x,t.y);return[l(0,0),l(e/2,e/2),l(0,e),l(-e/2,e/2)]}const e=2*Math.sqrt(this.kd.T().x*this.kd.T().x/4+this.kd.T().y*this.kd.T().y/4),i=l(Math.cos(Math.PI/4)*e,0),s=l(0,Math.sin(Math.PI/4)*e),r=l(0,0),n=Li(r,Li(i,s)),o=Li(n,Li(s,Ri(i,-1)));return[r,n,o,Pi(o,Li(i,s))]}Nn(){return[this.Cc]}setFillStyle(t){return this.Cc.qe(t),this.Ws.Bs(),this}getFillStyle(){return this.Cc.Mh()}setStrokeStyle(t){return this.Cc.Ke(t),this.Ws.Bs(),this}getStrokeStyle(){return this.Cc.Ja()}jn(t){return this.kd.C(t),this.Cd=!1,this.Ws.Bs(),this}Hn(){return this.Cd?0:(this.getSize(e.UISpace.Content).x-this.kd.T().x)/2}Wn(){return this.Cd?0:(this.getSize(e.UISpace.Content).x-this.kd.T().x)/2}Zn(){return this.Cd?0:(this.getSize(e.UISpace.Content).y-this.kd.T().y)/2}Xn(){return this.Cd?0:(this.getSize(e.UISpace.Content).y-this.kd.T().y)/2}fitTo(t){return this.kd.C(t),this.Cd=!0,this.Ws.Bs(),this}}class ta extends Lo{constructor(t,i,s,r,n){super(t,i,s,To.Simple,r,n),this.Td=m(l(0,0)),this.Fd=m(10),this.Id=m(void 0),this.eo=m(e.UIDirections.Right),this.Fc()}Nn(){return[this.Cc]}setFillStyle(t){return this.Cc.qe(t),this.Ws.Bs(),this}getFillStyle(){return this.Cc.Mh()}setStrokeStyle(t){return this.Cc.Ke(t),this.Ws.Bs(),this}getStrokeStyle(){return this.Cc.Ja()}setDirection(t){return this.eo.C(t),this.Ws.Bs(),this}getDirection(){return this.eo.T()}setPointerLength(t){return this.Fd.C(t),this.Ws.Bs(),this}getPointerLength(){return this.Fd.T()}setPointerAngle(t){return this.Id.C(t),this.Ws.Bs(),this}getPointerAngle(){let t=this.Id.T();if(void 0===t){const e=this.Ld();if(0===e)return 0;t=0!==e?180*Math.atan(2*this.getPointerLength()/e)/Math.PI:0}return Math.min(Math.max(t,1),89)}jn(t){return this.Td.C(t),this.Ws.Bs(),this}Pd(){const t=this.getPointerAngle();return 0===t?0:2*this.getPointerLength()/Math.tan(t*Math.PI/180)}Bd(){return de(this.eo.T())?this.Td.T().x:this.Td.T().y}Ld(){return de(this.eo.T())?this.Td.T().y:this.Td.T().x}Hn(){switch(this.eo.T()){case e.UIDirections.Right:return 0;case e.UIDirections.Left:return this.getPointerLength();case e.UIDirections.Up:case e.UIDirections.Down:return Math.max(0,this.Pd()-this.Ld());default:return 0}}Wn(){switch(this.eo.T()){case e.UIDirections.Right:return this.getPointerLength();case e.UIDirections.Left:return 0;case e.UIDirections.Up:case e.UIDirections.Down:return Math.max(0,this.Pd()-this.Ld());default:return 0}}Zn(){switch(this.eo.T()){case e.UIDirections.Right:case e.UIDirections.Left:return Math.max(0,this.Pd()-this.Ld());case e.UIDirections.Up:return this.getPointerLength();case e.UIDirections.Down:default:return 0}}Xn(){switch(this.eo.T()){case e.UIDirections.Right:case e.UIDirections.Left:return Math.max(0,this.Pd()-this.Ld());case e.UIDirections.Up:return 0;case e.UIDirections.Down:return this.getPointerLength();default:return 0}}Ic(){const t=ue(this.eo.T()),e=Di(l(0,0),t),i=this.getPointerLength(),s=this.Pd(),r=this.Bd(),n=this.Ld();if(!(0!==i&&0!==s||0!==r&&0!==n))return[];const o=l(0,0),a=Li(Li(o,Ri(t,-i)),Ri(e,s/2)),h=Li(a,Ri(e,(n-s)/2)),c=Li(h,Ri(t,-r)),u=Li(Li(o,Ri(t,-i)),Ri(e,-s/2)),d=Li(u,Ri(e,-(n-s)/2)),f=Li(d,Ri(t,-r));let g;return g=0===r||0===n?[o,a,u]:0===i||0===s?[h,c,f,d]:Ht(n,s)?[o,a,c,f,u]:[o,a,h,c,f,d,u],g}}class ea extends Io{constructor(t,e,i,s,r){super(t,e,i,s,r),this.fitTo=this.jn.bind(this),this.setSize=this.fitTo,this.Dd=new Vo,this.Cc=this.Ws.zd(e).cr(Bt).Od(ls).Rd(ls).Ed(this.Dd,{x:"x",y:"y"}),this.D.zi(this.Cc)}Nn(){return[this.Cc]}setShape(t){return this.Cc.Vd(t),this}getShape(){return this.Cc.Nd()}setRotation(t){return this.Cc.Gd(t),this}getRotation(){return this.Cc.$d()}setFillStyle(t){return this.Cc.Rd(t),this.Ws.Bs(),this}getFillStyle(){return this.Cc.Ud()}setStrokeStyle(t){return this.Cc.Yd(t),this.Ws.Bs(),this}getStrokeStyle(){return this.Cc.jd()}ir(){void 0!==this.Yn&&this.Cc.nl(this.Yn);const t=tt(this.getPosition({x:0,y:0},e.UISpace.Content),this.scale,this.renderingScale),i=Math.max(this.size.x,this.size.y);if(this.Dd.clear(),i>0){const e=this.Cc.Nd(),s=this.Cc.Ud(),r=yr(e)&&e,n=wt(s)&&s;if(r){const t=i/r.kt().y;this.Cc.Hd(t)}else if(n){const t=n.source;if(t instanceof Image){const e=i/t.height;this.Cc.Hd(e)}}else this.Cc.Hd(i);this.Dd.appendSample(t)}return this}jn(t){return this.setContentSize(t),this.Ws.Bs(),this}Hn(){return 0}Wn(){return 0}Zn(){return 0}Xn(){return 0}}const ia={...qn,...Jn,uiElement:ea};class sa extends to{setSize(t){return this.setContentSize(t),this.Ws.Bs(),this}}class ra extends Gn{constructor(){super(...arguments),this.Wd=[],this.Xd=0,this.Zd=t=>{const e=this.Wd.indexOf(t);e>=0&&this.Wd.splice(e,1)}}getMembers(){return this.Wd}getMemberCount(){return this.Wd.length}setMinimumSize(t){return this.Jd=t,this.Ws.Bs(),this}getMinimumSize(){return this.Jd}addElement(t,e=-1){const i=t.lo(this.Ws,this.renderingScale,this.scale,this.Zd,this.bi,!1);return i.setPointerEvents(this.getPointerEvents()),e>=0?this.Wd.splice(e,0,i):this.Wd.push(i),i.setVisible(this.getVisible()),this.D.Gi(i),this.ci&&(_e(0,()=>{}),i.dispose()),i}dispose(){return super.dispose(),this.Wd.slice().forEach(Wt),this}ir(){super.ir(),this.Wd.forEach(t=>{t.Zr=this.Zr});const t=this.Yn;return void 0!==t&&this.Wd.forEach((e,i)=>{e.Yn=t+1+.01*i}),this}setVisible(t){return super.setVisible(t),this.Wd.forEach(e=>e.setVisible(t)),this}setPointerEvents(t){super.setPointerEvents(t);for(let e=0;e<this.Wd.length;e+=1)this.Wd[e].setPointerEvents(t);return this}getPointerEvents(){if(super.getPointerEvents())return!0;for(let t=0;t<this.Wd.length;t+=1)if(this.Wd[t].getPointerEvents())return!0;return!1}setHighlight(t){super.setHighlight(t);for(let e=0;e<this.Wd.length;e+=1){const i=this.Wd[e];_t(i)&&i.setHighlight(t)}return this}}class na extends ra{ir(){super.ir();const t=this.getPosition(l(-1,1),e.UISpace.Content),i=this.Wd.reduce((t,e)=>t+ +(e instanceof sa),0),s=i>0?(this.size.x-this.Xd)/i:0;return this.Wd.reduce((e,i)=>i instanceof sa?this.scale.Qt({x:e,y:t.y},{x:s+i.getSize().x,y:0}).x:i.setOrigin(l(-1,1)).setPosition(l(e,t.y)).ir().getPosition(l(1,0)).x,t.x),this}Nh(){for(let t=0;t<this.Wd.length;t+=1){const e=this.Wd[t];e instanceof oa&&e.setMinimumSize(0),e.Nh()}const t=this.Wd.reduce(this.Qd.bind(this),c(0,0));this.Xd=t.x;const e=void 0===this.Jd?t:l(Math.max(t.x,this.Jd),t.y);this.setContentSize(e);for(let t=0;t<this.Wd.length;t+=1){const i=this.Wd[t];i instanceof oa&&i.setMinimumSize(e.y).Nh()}return super.Nh()}Qd(t,e){const i=e.getSize();return t.x+=i.x,t.y=Math.max(t.y,i.y),t}addGap(t=0,e=-1){return this.addElement(aa,e).setSize(l(0,t))}}class oa extends ra{ir(){super.ir();const t=this.getPosition(l(-1,1),e.UISpace.Content),i=this.Wd.reduce((t,e)=>t+ +(e instanceof sa),0),s=i>0?(this.size.y-this.Xd)/i:0;return this.Wd.reduce((e,i)=>i instanceof sa?this.scale.Qt({x:t.x,y:e},{x:0,y:-(s+i.getSize().y)}).y:i.setOrigin(l(-1,1)).setPosition(l(t.x,e)).ir().getPosition(l(0,-1)).y,t.y),this}Nh(){for(let t=0;t<this.Wd.length;t+=1){const e=this.Wd[t];e instanceof na&&e.setMinimumSize(0),e.Nh()}const t=this.Wd.reduce(this.Qd.bind(this),c(0,0));this.Xd=t.y;const e=void 0===this.Jd?t:l(t.x,Math.max(t.y,this.Jd));this.setContentSize(e);for(let t=0;t<this.Wd.length;t+=1){const i=this.Wd[t];i instanceof na&&i.setMinimumSize(e.x).Nh()}return super.Nh()}Qd(t,e){const i=e.getSize();return t.y+=i.y,t.x=Math.max(t.x,i.x),t}addGap(t=0,e=-1){return this.addElement(aa,e).setSize(l(0,t))}}const aa={...qn,...Jn,uiElement:sa};class ha extends oa{constructor(){super(...arguments),this.Wd=[]}addRow(){return this.addElement(ua,void 0)}getRow(t,e=!1){return e&&this.Wd.length<=t?(this.addRow(),this.getRow(t,!0)):this.Wd[t]}}const la={...qn,...Kn,...Qn},ca={...la,uiElement:oa,background:Ko},ua={...la,uiElement:na,background:Ko},da={setTextLabel:null,setText(t){return this.setTextLabel.setText(t),this},getText(){return this.setTextLabel.getText()}},fa=(t=>{const e={},i=`stylable${t}s`;return e[i]=[],e[`set${t}FillStyle`]=function(t){return this[i].forEach(e=>e.setFillStyle(t)),this},e[`get${t}FillStyle`]=function(){return this[i][0].getFillStyle()},e[`set${t}Font`]=function(t){return this[i].forEach(e=>e.setFont(t)),this},e[`get${t}Font`]=function(){return this[i][0].getFont()},e[`set${t}Rotation`]=function(t){return this[i].forEach(e=>e.setTextRotation(t)),this},e[`get${t}Rotation`]=function(){return this[i][0].getTextRotation()},e})("Text"),ga={button:void 0,isLocked:!1,setOn(t){const e=this.button.getOn()!==t;return this.button.setOn(t),e&&this.D.R("switch",{state:t}),this},getOn(){return this.button.getOn()},setLocked(t){return this.isLocked=t,this},getLocked(){return this.isLocked},setButtonOffFillStyle(t){return this.button.setOffFillStyle(t),this},getButtonOffFillStyle(){return this.button.getOffFillStyle()},setButtonOnFillStyle(t){return this.button.setOnFillStyle(t),this},getButtonOnFillStyle(){return this.button.getOnFillStyle()},setButtonStrokeStyle(t){return this.button.setStrokeStyle(t),this},getButtonStrokeStyle(){return this.button.getStrokeStyle()},setButtonSize(t){return this.button.setSize(t),this},getButtonSize(){return this.button.getSize()},setButtonShape(t){return this.button.setButtonShape(t),this},getButtonShape(){return this.button.getButtonShape()}},pa={textFillStyleHidden:void 0,setTextFillStyleHidden(t){return this.textFillStyleHidden="function"==typeof t?t(this.textFillStyleHidden):t,this},getTextFillStyleHidden(){return this.textFillStyleHidden}},ma={pointable:void 0,setDirection(t){return this.pointable.setDirection(t),this},getDirection(){return this.pointable.getDirection()},setPointerLength(t){return this.pointable.setPointerLength(t),this},getPointerLength(){return this.pointable.getPointerLength()}},ya={...qn,...Kn,background:Ko,lo(t,e,i,s,r,n){const o=new na(t,e,i,this.background,s,r),a=o.addElement(qo,void 0),h=Object.assign(o,da,{setTextLabel:a},fa,{stylableTexts:[a]});return Xn(h,r,n),this.applyStylers(h,r)}}.addStyler($n),xa={...qn,...Kn,background:ta,direction:e.UIDirections.Up,setDirection(t){return this.direction=t,this},lo(t,i,s,r,n,o){const a=this.direction,h=new na(t,i,s,this.background,r,n),l=h.addElement(qo,void 0),c=h.getBackground().setDirection(a),u=h.ir.bind(h),d=Object.assign(h,da,{setTextLabel:l},fa,{stylableTexts:[l]},ma,{pointable:c},{setTickLabelPadding(t){return this.getDirection()===e.UIDirections.Up?(this.setPadding({top:t}),l.setMargin({top:0})):this.getDirection()===e.UIDirections.Down?(this.setPadding({bottom:t}),l.setMargin({bottom:0})):this.getDirection()===e.UIDirections.Right?(this.setPadding({right:t}),l.setMargin({right:0})):this.getDirection()===e.UIDirections.Left&&(this.setPadding({left:t}),l.setMargin({left:0})),this},getTickLabelPadding(){return this.getDirection()===e.UIDirections.Up?this.getPadding().top:this.getDirection()===e.UIDirections.Down?this.getPadding().bottom:this.getDirection()===e.UIDirections.Right?this.getPadding().right:this.getPadding().left},setTickLabelAlignment(t,e){return this},getTickLabelAlignment:()=>0,Zr:void 0,ir(){l.Zr=this.Zr,u()}});return d.uo="other",d.setPointerLength(n.xAxisNumericTicks.majorTickStyle.getTickLength()).setTickLabelPadding(n.xAxisNumericTicks.majorTickStyle.getTickPadding()).setTextFont(n.uiTextFont).setTextFillStyle(n.uiTextFillStyle).setBackground(t=>t.setFillStyle(n.uiBackgroundFillStyle).setStrokeStyle(n.uiBackgroundStrokeStyle)),Xn(d,n,o),this.applyStylers(d,n)}};class va extends Un{constructor(t,e,i,s,r,n){super(t,e,i,r,n),this.Kd=!1,this.qd=ls,this.tf=ls,this.getOn=()=>this.Kd,this.tf=n.uiButtonFillStyleHidden||n.uiButtonFillStyle,this.if=new ea(this.Ws,this.renderingScale,this.scale,jt,n).setShape(s).setFillStyle(this.tf),this.D.Gi(this.if)}Nn(){return[...this.if.Nn()]}setOn(t){return this.Kd=t,this.if.setFillStyle(t?this.qd:this.tf),this.Ws.Bs(),this}setOffFillStyle(t){return this.tf="function"==typeof t?t(this.tf):t,this.Kd||this.if.setFillStyle(this.tf),this}getOffFillStyle(){return this.tf}setSize(t){return this.if.fitTo("number"==typeof t?l(t,t):t),this}getSize(){return this.if.getSize()}setOnFillStyle(t){return this.qd="function"==typeof t?t(this.qd):t,this.Kd&&this.if.setFillStyle(this.qd),this}getOnFillStyle(){return this.qd}setStrokeStyle(t){return this.if.setStrokeStyle(t),this}getStrokeStyle(){return this.if.getStrokeStyle()}setButtonShape(t){return this.if.setShape(t),this.Ws.Bs(),this}getButtonShape(){return this.if.getShape()}ir(){return super.ir(),this.if.Yn=this.Yn,this.if.setVisible(this.getVisible()).setPosition(this.getPosition(l(0,0),e.UISpace.Content)).ir(),this}Nh(){const t=this.if.Nh().getSize();return this.setContentSize(t),super.Nh()}dispose(){return super.dispose(),this.if.dispose(),this}setPointerEvents(t){return this.if.setPointerEvents(t),this}getPointerEvents(){return this.if.getPointerEvents()}setHighlight(t){const e=Ge(t);return this.if.setHighlight(e),this.D.R("highlightchange",{highlight:e}),this.Ws.Bs(),this}getHighlight(){return this.if.getHighlight()}}const Aa={...qn,uiElement:va,buttonShape:e.PointShape.Circle,setButtonShape(t){return{...this,buttonShape:t}},lo(t,e,i,s,r,n){const o=this.applyStylers(new this.uiElement(t,e,i,this.buttonShape,s,r),r);return Xn(o,r,n),o}},Sa={...qn,...Kn,background:Ko,buttonBuilder:Aa,setButtonShape(t){return{...this,buttonBuilder:this.buttonBuilder.setButtonShape(t)}},lo(t,i,s,r,n,o){var a;const h=new na(t,i,s,this.background,r,n),l=h.addElement(ca);l.addGap();const c=l.addElement(this.buttonBuilder);l.addGap();const u=h.addElement(ca);u.addGap();const d=u.addElement(qo);u.addGap(),h.addGap();const f=Object.assign(h,da,{setTextLabel:d},fa,{stylableTexts:[d]},ga,{button:c},pa);let g;return f.addEventListener("click",()=>{f.getLocked()||f.setOn(!f.getOn())}),f.addEventListener("pointerenter",()=>{f.setHighlight(!0)}),f.addEventListener("pointerleave",()=>{f.setHighlight(!1)}),f.setMouseStyle(e.MouseStyles.Point),f.setTextFillStyleHidden(n.uiTextFillStyleHidden||n.uiTextFillStyle),f.addEventListener("switch",t=>{t.state?g&&f.setTextFillStyle(g):(g=f.getTextFillStyle(),f.setTextFillStyle(f.getTextFillStyleHidden()))}),f.setPadding({left:null!==(a=n.uiTextPadding)&&void 0!==a?a:5}),Xn(f,n,o),this.applyStylers(f,n)}}.addStyler($n).addStyler((t,e)=>(t.setButtonOnFillStyle(e.uiButtonFillStyle).setButtonOffFillStyle(e.uiButtonFillStyleHidden).setButtonSize(e.uiButtonSize).setButtonStrokeStyle(e.uiButtonStrokeStyle),t));class ba extends Un{constructor(t,i,s,r,n){super(t,i,s,r,n),this.sf=10,this.ef=e.UIDirections.Up,this.rf=0,this.uo="major",this.hf=0,this.nf=1,this.ml=t._n(this.renderingScale).Mn(Xe).wn(Xe),this.D.zi(this.ml),this.ur=t.dr(this.renderingScale),this.D.zi(this.ur)}Nn(){return[this.ml]}ir(){if(super.ir(),this.ci)return this;const t=tt(this.getPosition(),this.scale,this.renderingScale),i=this.renderingScale.Qt(t,{x:this.ef===e.UIDirections.Right?-this.sf:this.ef===e.UIDirections.Left?this.sf:0,y:this.ef===e.UIDirections.Up?-this.sf:this.ef===e.UIDirections.Down?this.sf:0}),s=this.renderingScale.Qt(i,{x:this.ef===e.UIDirections.Right?-this.rf:this.ef===e.UIDirections.Left?this.rf:0,y:this.ef===e.UIDirections.Up?-this.rf:this.ef===e.UIDirections.Down?this.rf:0});return this.ur.gr(t).Ar(i),this.ml.sr(s).Zl(this.ef===e.UIDirections.Up?{x:this.hf,y:this.nf}:this.ef===e.UIDirections.Down?{x:this.hf,y:-this.nf}:this.ef===e.UIDirections.Right?{x:this.nf,y:this.hf}:{x:-this.nf,y:this.hf}),this.ml.Zr=this.Zr,this}Nh(){const t=this.ur.do().getThickness();return this.size=this.ef===e.UIDirections.Left||this.ef===e.UIDirections.Right?{x:this.sf+this.rf+this.ml.Nh().bc().x,y:t}:{y:this.sf+this.rf+this.ml.Nh().bc().y,x:t},super.Nh()}dispose(){return super.dispose(),this.ml.dispose(),this.ur.dispose(),this}setVisible(t){return super.setVisible(t),this.ml.setVisible(t),this.ur.setVisible(t),this}setPointerEvents(t){return this.ml.setPointerEvents(t),this.ur.setPointerEvents(t),this}getPointerEvents(){return this.ml.getPointerEvents()}getText(){return this.ml.rn()}setTextFillStyle(t){return this.ml.qe(t),this.Ws.Bs(),this}getTextFillStyle(){return this.ml.Mh()}setTextFont(t){return this.ml.Ch(t),this}setTextRotation(t){return this.ml.Th(t),this}getTextRotation(){return this.ml.Fh()}getTextFont(){return this.ml.kh()}setText(t){return this.ml.tn(t),this.Ws.Bs(),this}setDirection(t){return this.ef=t,this.Ws.Bs(),this}getDirection(){return this.ef}setPointerLength(t){return this.sf=t,this.Ws.Bs(),this}getPointerLength(){return this.sf}setTickLabelPadding(t){return this.rf=t,this.Ws.Bs(),this}getTickLabelPadding(){return this.rf}setTickStyle(t){return this.ur.cr(t),this.Ws.Bs(),this}getTickStyle(){return this.ur.do()}setTickLabelAlignment(t,e){return this.hf=t,e&&(this.nf=e),this.Ws.Bs(),this}getTickLabelAlignment(){return this.hf}}const Ma={...qn,direction:e.UIDirections.Up,setDirection(t){return this.direction=t,this},lo(t,e,i,s,r,n){const o=this.direction,a=new ba(t,e,i,s,r);return Xn(a,r,n),a.setDirection(o),this.applyStylers(a,r)}}.addStyler($n),Ea=Ma.addStyler((t,e)=>(t.uo="major",t.setPointerLength(e.xAxisNumericTicks.majorTickStyle.tickLength).setTickLabelPadding(e.xAxisNumericTicks.majorTickStyle.tickPadding).setTickStyle(e.xAxisNumericTicks.majorTickStyle.tickStyle).setTextFont(e.xAxisNumericTicks.majorTickStyle.labelFont).setTextFillStyle(e.xAxisNumericTicks.majorTickStyle.labelFillStyle))),ka=Ma.addStyler((t,e)=>(t.uo="minor",t.setPointerLength(e.xAxisNumericTicks.minorTickStyle.tickLength).setTickLabelPadding(e.xAxisNumericTicks.minorTickStyle.tickPadding).setTickStyle(e.xAxisNumericTicks.minorTickStyle.tickStyle).setTextFont(e.xAxisNumericTicks.minorTickStyle.labelFont).setTextFillStyle(e.xAxisNumericTicks.minorTickStyle.labelFillStyle)));class Ta extends Un{constructor(t,e,i,s,r,n){var o,a,h,l,c,u;super(t,e,i,s,r),this.af=[],this.lf="",this.uf=(t,e)=>void 0!==t.label?t.label:e.percentageValues?`${(100*t.value).toFixed(0)}%`:os(e,t.value),this.cf=0,this.df=!1,this.hf=n,this.ff=t.md(e).Ke(Bt),this.xd=this.ff.Ho().bd("number"==typeof r.legendLUTCornerRadius?{extent:r.legendLUTCornerRadius,c_x1_y1:!0,c_x1_y2:!0,c_x2_y1:!0,c_x2_y2:!0}:void 0),this.D.zi(this.ff),this.Af=t._n(e).qe(r.uiTextFillStyle).Ch(r.uiTextFont).setPointerEvents(!1),this.D.zi(this.Af),this.gf=null!==(o=r.legendLUTLabelMargin)&&void 0!==o?o:7,this.pf=null!==(a=r.legendLUTUnitLabelMargin)&&void 0!==a?a:7,"vertical"===n?(this.vf=null!==(h=r.legendLUTLengthVertical)&&void 0!==h?h:140,this.yf=null!==(l=r.legendLUTThicknessVertical)&&void 0!==l?l:25):(this.vf=null!==(c=r.legendLUTLengthHorizontal)&&void 0!==c?c:160,this.yf=null!==(u=r.legendLUTThicknessHorizontal)&&void 0!==u?u:15)}Nn(){return[this.ff,this.Af]}mf(t){return this.Af.Mn(t),this.af.forEach(e=>e.Mn(t)),this.Ws.Bs(),this}xf(t){this.Sf=t;const e=Ba(t,"vertical"===this.hf?0:90,this.df);return this.ff.qe(e),this.Ws.Bs(),this}Ys(){return this.Sf}bf(t){return this.vf=t,this.Ws.Bs(),this}Zl(t){return this.hf=t,this.Ws.Bs(),this}Mf(){return this.vf}wf(t){return this.yf=t,this.Ws.Bs(),this}_f(){return this.yf}kf(t){return this.lf=t,this.Ws.Bs(),this}Cf(){return this.lf}Tf(t){return this.uf=t,this.Ws.Bs(),this}setLUTDisplayProportionalSteps(t){if(this.df=t,this.Sf){const t=Ba(this.Sf,"vertical"===this.hf?0:90,this.df);this.ff.qe(t)}return this.Ws.Bs(),this}getLUTDisplayProportionalSteps(){return this.df}setFillStyle(t){return this.Af.qe(t),this.Ws.Bs(),this}getFillStyle(){return this.Af.Mh()}setFont(t){return this.Af.Ch(t),this.Ws.Bs(),this}getFont(){return this.Af.kh()}setTextRotation(t){return this.cf=t,this.Af.Th(t),this.Ws.Bs(),this}getTextRotation(){return this.Af.Fh()}ir(){var t,i,s,r;if(super.ir(),this.ci||!this.getVisible())return this;const n=this.Sf;if(n){const o=this.renderingScale.ni(),a=n.min,h=n.max;if("vertical"===this.hf){const s=this.getPosition({x:-1,y:-1},e.UISpace.Content),r=Li(s,{x:this.yf*this.renderingScale.x.getPixelSize()+this.gf*o.x,y:0}),l={x:r.x,y:r.y+(this.lf.length>0?this.pf*o.y+this.Af.kt().y:0)+.5*((null===(t=this.af[0])||void 0===t?void 0:t.kt().y)||0)},c={x:l.x,y:this.getPosition({x:-1,y:1},e.UISpace.Content).y-.5*((null===(i=this.af[this.af.length-1])||void 0===i?void 0:i.kt().y)||0)};this.xd.Md(s.x,l.y,s.x+this.yf*this.renderingScale.x.getPixelSize(),l.y+this.vf*this.renderingScale.y.getPixelSize()),this.Af.Zl({x:-1,y:-1}).sr(r),n.getSteps().forEach((t,e)=>{const i=Ai(l,c,this.df?!0===n.getInterpolation()?(t.value-a)/(h-a):.9*(t.value-a)/(h-a):!0===n.getInterpolation()?e/(n.getSteps().length-1):e/n.getSteps().length);this.af[e].Zl({x:-1,y:0}).sr(i)})}else{const t=this.getPosition({x:-1,y:-1},e.UISpace.Content),i=this.getPosition({x:1,y:1},e.UISpace.Content),l=Math.max(this.af.reduce((t,e)=>Math.max(t,e.kt().y),0),this.Af.Nh().kt().y),c=Li(t,{x:.5*((null===(s=this.af[0])||void 0===s?void 0:s.kt().x)||0),y:l}),u={x:i.x,y:c.y},d={x:n.getInterpolation()?u.x-(.5*((null===(r=this.af[this.af.length-1])||void 0===r?void 0:r.kt().x)||0)+(this.lf.length>0?this.pf*o.x+this.Af.kt().x:0)):c.x+this.vf*this.renderingScale.x.getPixelSize(),y:c.y},f={x:c.x,y:c.y+this.gf*o.y};this.xd.Md(f.x,f.y,f.x+this.vf*this.renderingScale.x.getPixelSize(),f.y+this.yf*this.renderingScale.y.getPixelSize()),this.Af.Zl({x:1,y:1}).sr(u),n.getSteps().forEach((t,e)=>{const i=Ai(c,d,this.df?!0===n.getInterpolation()?(t.value-a)/(h-a):.9*(t.value-a)/(h-a):!0===n.getInterpolation()?e/(n.getSteps().length-1):e/n.getSteps().length);this.af[e].Zl({x:0,y:1}).sr(i)})}}return this}Nh(){if(this.Sf&&this.getVisible()){const t=this.Sf.getSteps();for(let e=this.af.length;e<t.length;e+=1){const t=this.Ws._n(this.renderingScale).setPointerEvents(!1);this.af.push(t),this.D.zi(t)}for(let e=0;e<t.length;e+=1)this.af[e].qe(this.Af.Mh()).Ch(this.Af.kh()).tn(this.uf(t[e],this.Sf)).Th(this.cf);for(let e=t.length;e<this.af.length;e+=1)this.af[e].dispose();if(this.af.length=t.length,this.Af.tn(this.lf),"vertical"===this.hf){const t=this.yf,e=this.vf,i=t+Math.max(this.af.reduce((t,e)=>Math.max(t,e.Nh().bc().x),0),this.Af.Nh().bc().x),s=(this.lf.length>0?this.pf+this.Af.Nh().bc().y:0)+e+.5*this.af[0].Nh().bc().y+.5*this.af[this.af.length-1].Nh().bc().y;this.setContentSize({x:i,y:s})}else{const t=this.vf,e=this.yf,i=Math.max(this.lf.length>0?this.pf+this.Af.Nh().bc().x+(this.Sf.getInterpolation()?.5*this.af[this.af.length-1].Nh().bc().x:0):0,this.Sf.getInterpolation()?.5*this.af[this.af.length-1].Nh().bc().x:0),s=t+.5*this.af[0].Nh().bc().x+i,r=e+this.gf+Math.max(this.af.reduce((t,e)=>Math.max(t,e.Nh().bc().y),0),this.Af.Nh().bc().y);this.setContentSize({x:s,y:r})}}else this.af.forEach(t=>t.dispose()),this.af.length=0,this.Af.setVisible(!1),this.ff.setVisible(!1),this.setContentSize({x:0,y:0});return super.Nh()}dispose(){return super.dispose(),this.ff.dispose(),this.af.forEach(Wt),this.Af.dispose(),this}setPointerEvents(t){return this.ff.setPointerEvents(t),this}getPointerEvents(){return this.ff.getPointerEvents()}}const wa={lutElement:{},setLUT(t){return this.lutElement.xf(t),this},getLUT(){return this.lutElement.Ys()},setLUTLength(t){return this.lutElement.bf(t),this},getLUTLength(){return this.lutElement.Mf()},setLUTThickness(t){return this.lutElement.wf(t),this},getLUTThickness(){return this.lutElement._f()},setLookUpUnit(t){return this.lutElement.kf(t),this},getLookUpUnit(){return this.lutElement.Cf()},setLUTStepValueFormatter(t){return this.lutElement.Tf(t),this},setLUTDisplayProportionalSteps(t){return this.lutElement.setLUTDisplayProportionalSteps(t),this},getLUTDisplayProportionalSteps(){return this.lutElement.getLUTDisplayProportionalSteps()}},Ca={...qn,...Kn,background:Ko,alignment:"horizontal",setAlignment(t){return{...this,alignment:t}},lo(t,e,i,s,r,n){const o=new oa(t,e,i,this.background,s,r),a=o.addElement({lo:()=>new Ta(t,e,i,jt,r,this.alignment)}),h=Object.assign(o,fa,{stylableTexts:[a]},wa,{lutElement:a});return Xn(h,r,n),this.applyStylers(h,r)}}.addStyler($n),Ba=(t,e,i)=>{const s=t.getSteps(),r=t.min,n=t.max-r;if(!0===t.getInterpolation())return new U({angle:e,stops:s.map((e,o)=>({offset:i?(e.value-r)/n:o/(s.length-1),color:e.color||t.color}))});const o=[];for(let e=0;e<s.length;e+=1){const a=s[e];o.push({offset:i?.9*(a.value-r)/n:e/s.length,color:a.color||t.color});const h=e<s.length-1?s[e+1]:void 0;o.push({offset:i?h?.9*(h.value-r)/n:1:h?(e+1)/s.length:1,color:a.color||t.color})}return new U({angle:e,stops:o})},Fa=Sa.addStyler(t=>t.addEventListener("switch",e=>!0===e.state?setTimeout(()=>t.setOn(!1),300):void 0)),Da={TextBox:ya,CheckBox:Sa,ButtonBox:Fa,PointableTextBox:xa,AxisTickMajor:Ea,AxisTickMinor:ka,LUTRange:Ca};class Ia extends Ln{constructor(t,e,i,s,r,n){super(t,e,i,s,n),this.Ff=r}}class Ra extends Rn{constructor(t,i,s,r,n,o,a,h,l,c,u,d,f,g,p,m){var y,x,v;super(c,l,a,g,p,{numeric:l.getWidth({x:g.xAxisNumericTicks,y:g.yAxisNumericTicks}),datetime:l.getWidth({x:g.xAxisDateTimeTicks,y:g.yAxisDateTimeTicks}),time:l.getWidth({x:g.xAxisTimeTicks,y:g.yAxisTimeTicks})},m),this.If=new Map,this.Lf=void 0,this.Pf=0,this.Bf=[],this.Df=[],this.Ef=!0,this.Rf=[],this.Of=t=>{const e=this.Df.indexOf(t);e>=0&&this.Df.splice(e,1)},this.zf=t=>(this.Df.indexOf(t)<0&&this.Df.push(t),this.Of),this.Vf=!0,this.Nf=be(this.Rf),this.vf={relative:1},this.Gf=(t,e)=>e.getAllocatesAxisSpace()&&mi(e.getValue(),this.Ah,this.gh)?Math.max(t,e.update().Ao()):t,this.$f=t=>{const e=this.Bf.indexOf(t);-1!==e&&this.Bf.splice(e,1)},this.ds=e.HighlightModes.onHover,this.D=new vt,this.ar={},this.Uf=a instanceof H?a:void 0,this.isX=this.oh.getWidth({x:!0,y:!1}),this.isY=this.oh.getHeight({x:!0,y:!1}),this.Yf=t,this.jf=i,this.Hf=r,this.Wf=n,this.chart=c,this.Xf=d,this.Zf=s,this.ps=o,"logarithmic"===m.type&&this.chart.pi.La(Hn.Eo),this.wh=Pa,f(this,this.zf),a.Jf=this,this.Qf=u,this.Kf=this.Qf>50?1:-1,this.qf=(v=this.oh.toPoint(0,-this.Kf),Math.abs(v.x)>=Math.abs(v.y)?v.x>=0?e.UIDirections.Right:e.UIDirections.Left:v.y>=0?e.UIDirections.Up:e.UIDirections.Down),this.tA=h,this.iA=this.ai instanceof H?(new q).Kt(this.oh.toVec2(this.ai,this.tA)):(new K).Kt(this.oh.toVec2(this.ai,this.tA)),this.sA=this.chart.eA,this.rA=(new q).Kt(this.oh.toVec2(this.oh.getWidth(this.sA),this.tA)),this.hA=this.jf.dr(this.iA).setPointerEvents(!1),this.nA=this.Zf.tr(this.sA).qe(l.getWidth({x:g.xAxisOverlayStyle,y:g.yAxisOverlayStyle})).Ke(Bt).Pi(g.highlightColorOffsetAxisOverlay||g.highlightColorOffset),this.oA=this.Zf.tr(this.sA).qe(l.getWidth({x:g.xAxisZoomingBandFillStyle,y:g.yAxisZoomingBandFillStyle})).Ke(l.getWidth({x:g.xAxisZoomingBandStrokeStyle,y:g.yAxisZoomingBandStrokeStyle})).Pi(g.highlightColorOffsetAxisOverlay||g.highlightColorOffset),this.Jr=this.Zf._n(this.iA).setPointerEvents(!1).Th(this.oh.getTitleTextRotation(this.Kf)).wn(Xe).Mn(Xe),this.chart.pi.Ms.bs(this.nA,t=>this.nA.Ii(t),{animationEnabled:this.Er}),this.D.zi(this.nA),this.hA.cr(l.getWidth({x:g.xAxisStrokeStyle,y:g.yAxisStrokeStyle})),this.Jr.qe(l.getWidth({x:g.xAxisTitleFillStyle,y:g.yAxisTitleFillStyle})).Ch(l.getWidth({x:g.xAxisTitleFont,y:g.yAxisTitleFont})),this.vs=o.ys(this,{}),this.Ih=this.vs.aA([this.Jr]).Ps(g.effectsText),this.lA=null!==(y=l.getWidth({x:g.xAxisMarginAfterTicks,y:g.yAxisMarginAfterTicks}))&&void 0!==y?y:7,this.uA=null!==(x=l.getWidth({x:g.xAxisMarginAfterTitle,y:g.yAxisMarginAfterTitle}))&&void 0!==x?x:7}setHighlight(t){return this.chart.pi.Ms.Vs(this.nA,t),this.D.R("highlightchange",{highlight:Ge(t)}),this}getHighlight(){return this.chart.pi.Ms.Cs(this)}Sn(){return this.zr}bn(){return void 0!==this.Dh}setKeepTickLabelsInAxisBounds(t){return this.Vf=t,this.chart.pi.Bs(),this}getKeepTickLabelsInAxisBounds(){return this.Vf}setTickStrategy(t,e){return super.fh(t,e)}getTickStrategy(){return this.Lr}addBand(t){var e;const i=null===(e=null==t?void 0:t.onTop)||void 0===e||e,s=null==t?void 0:t.legend,r=i?this.Wf:this.Hf,n=new un(r,this.chart,this.Nf,this,this.iA,this.oh,this.bi,this.ps);return s&&this.chart.legend.add(n,s),this.Rf.push(n),n}addConstantLine(t){var e;const i=null===(e=null==t?void 0:t.onTop)||void 0===e||e,s=null==t?void 0:t.legend,r=i?this.Wf:this.Hf,n=new dn(r,this.chart,this.Nf,this,this.iA,this.oh,this.bi,this.ps);return s&&this.chart.legend.add(n,s),this.Rf.push(n),n}cA(t){this.Rf.forEach(t)}dA(t){return this.Rf.map(t)}getHighlighters(){return this.Rf}setThickness(t){return"number"==typeof t?(this.fA=t,this.AA=t):"object"==typeof t?(this.fA=t.min,this.AA=t.max):void 0===t&&(this.fA=void 0,this.AA=void 0),this.$h=void 0,this.chart.pi.Bs(),this}getThickness(){return{min:this.fA,max:this.AA}}gA(){return this.Df}Yh(t){return{}}Xh(t,e,i,s,r){var n;const o=e.Fr;return{keyValue:t,tickLevel:e,labelText:i,labelPosition:this.oh.toPoint(t,0),labelAlignment:this.oh.toPoint(o.getLabelAlignment(),null!==(n=o.labelAlignmentOpposite)&&void 0!==n?n:-this.Kf),labelOffset:{x:0,y:0},labelRotation:e.Fr.labelRotation}}Qh(t,e,i){if(!this.di)return{pA:0,vA:0,yA:0,ticksInfo:e,updatedTicks:i};const s=this.Jr&&this.Jr.rn().length>0&&this.getTitleFillStyle()!==ls,r=this.oh.getHeight(s?this.Jr.Nh().bc():{x:0,y:0})+(s?this.uA:0);let n=0;this.Pr.forEach((t,e)=>{const i=e.Fr.tickLength<0||e.Fr.tickPadding<0,s=e.Fr.tickLength+e.Fr.tickPadding;t.forEach(t=>{if(!t.zh.getVisible()||cs(t.zh.Mh()))return void(i||(n=Math.max(n,s)));const e=s+this.oh.getHeight(t.zh.Nh().bc());i||(n=Math.max(n,e))})});const o=this.Bf.reduce(this.Gf,0);n=Math.max(n,o),n+=this.lA;const a=$t(r+n,void 0!==this.fA?this.fA:0,void 0!==this.AA?this.AA:ni);return this.Pf=a,{pA:n,vA:r,yA:a,ticksInfo:e,updatedTicks:i}}sn(t,e){return new Ia(e,t,this.jf,this.iA,this.iA)}Kr(){return this.iA}Lh(){if(this.If){for(const t of this.If)t[1].grid.dispose(),t[1].tick.dispose();this.If.clear()}super.Lh()}vn(t,e){return"linear"===this.uh.type||"linear-highPrecision"===this.uh.type?Ds(t,e,this.ai):Is(t,e,this.ai)}mA(t,e){return e instanceof H?Ds:Is}xn(t,e,i){if("logarithmic"!==this.uh.type){const s=this.ai.Jt(Math.abs(e-t));return{start:t+Math.sign(t-e)*i.start*s,end:e+Math.sign(e-t)*i.end*s}}const s=this.ai,r={start:s.$,end:s.U};s.W(t,e).rs();const n={start:s.Qt(t,i.start*Math.sign(t-e)),end:s.Qt(e,i.end*Math.sign(e-t))};return s.W(r.start,r.end).rs(),n}Vh(t){var e,i;const s=this.Gh(),r=s.min,n=s.max,o=this.Pr.size>0,a=(null===(e=this.$h)||void 0===e?void 0:e.physicalAxisSize)!==t.physicalAxisSize;let h=(null===(i=this.$h)||void 0===i?void 0:i.min)!==r||this.$h.max!==n;if(this.$h&&this.Uf){const t=this.Uf.getPixelSize(),e=Math.abs(n-this.$h.max),i=Math.abs(e/t),s=Math.abs(r-this.$h.min),o=Math.abs(s/t);h=Math.max(i,o)>=10}return!(!o||a||h||t.anyPreviousAxisUpdated)}ir(t){const i=this.getVisible()&&t.xA>0,s=this.ai.getInnerStart()<this.ai.getInnerEnd()?this.ai.getInnerStart():this.ai.getInnerEnd(),r=this.ai.getInnerEnd()>this.ai.getInnerStart()?this.ai.getInnerEnd():this.ai.getInnerStart();i||this.Lh();const n=this.hA.do().getThickness()*this.Kf/2,o=this.tA.getInnerInterval(),a=this.Qf/100*o,h=a+t.SA,l=o*this.Kf,c=h+n;if("Empty"!==this.Lr&&i){const e=this.ai.bt(),i=this.ai.Mt(),s=Math.min(e,i),r=Math.max(e,i);for(const[e,i]of this.Pr){let n=this.If.get(e);if(!n)if(e.yr)n={grid:this.Yf[0].bA(this.iA).setPointerEvents(!1),tick:this.Yf[0].bA(this.iA).setPointerEvents(!1)};else if("MA"in e){const t=Array.from(this.Pr.keys()).filter(t=>"MA"in t).reverse().indexOf(e),i=this.Yf[t];if(!i)throw new Error("Not enough tick layers. This is an internal LCJS error - if you see this, please contact LightningChart support.");n={grid:i.bA(this.iA).setPointerEvents(!1),tick:i.bA(this.iA).setPointerEvents(!1)}}if(!n)continue;n.grid.Vi(),n.tick.Vi();const o=e.Fr,u=a-l*o.getGridStrokeLength(),d=c+o.getTickLength()*this.Kf,f=d+o.getTickPadding()*this.Kf;for(const[e,o]of i){const e=t.ticksInfo.get(o);if(!e)continue;const i={start:this.oh.toPoint(o.M,h),end:this.oh.toPoint(o.M,u)},a={start:this.oh.toPoint(o.M,c),end:this.oh.toPoint(o.M,d)};let l=0;if(this.Vf){const t=o.zh.bc(),i=this.ai.Dt(e.keyValue)+this.oh.getWidth(e.labelOffset)+(-.5*this.oh.getWidth(e.labelAlignment)-.5)*this.oh.getWidth(t),n=i+this.oh.getWidth(t);l=n>r?r-n:i<s?s-i:0}o.zh.sr(this.oh.toPoint(this.ai.Qt(o.M,l),f)).Zl(e.labelAlignment).Th(e.labelRotation),n.grid.Ho().wA(i.start,i.end),n.tick.Ho().wA(a.start,a.end)}n.grid.cr(e.Fr.getGridStrokeStyle()),n.tick.cr(e.Fr.getTickStyle()),this.If.set(e,n)}}const u=c,d=u+this.Kf*t.yA,f={start:this.oh.toVec2(this.ai.getInnerStart(),u),end:this.oh.toVec2(this.ai.getInnerEnd(),d)},g=tt(f.start,this.iA,this.sA),p=tt(f.end,this.iA,this.sA);this.hA.gr(this.oh.toPoint(s,h)).Ar(this.oh.toPoint(r,h)).setVisible(i);let m=this._A;m||(m="center-chart",("pixels"in this.vf||void 0!==this.kA||void 0!==this.CA||1!==t.TA||this.isY)&&(m="center"));const y=h+t.pA*this.Kf;if(this.Jr.sr(this.oh.toPoint(this.oh.getWidth(tt("center-chart"===m?{x:.5*this.sA.x.getInnerInterval(),y:.5*this.sA.y.getInnerInterval()}:"center"===m?Ri(Li(g,p),.5):"start"===m?g:p,this.sA,this.iA)),y)).Zl(this.oh.toPoint("center-chart"===m||"center"===m?0:"start"===m?-1:1,-1*this.Kf)).setVisible(i),this.Lf){const e=this.Qf/100*o+t.SA,i=-this.Kf*o-t.SA,s={start:this.oh.toVec2(this.Lf.min,c+this.Kf*this.Pf),end:this.oh.toVec2(this.Lf.max,e+i)},r=tt(s.start,this.iA,this.sA),n=tt(s.end,this.iA,this.sA);this.oA.sr(r).Z(Pi(n,r)).setVisible(!0)}else this.oA.setVisible(!1);this.nA.sr(g).Z(Pi(p,g)).setVisible(i);for(const s of this.Bf)if(s.update().plot(i,h,l,t.SA,c),this.Zf.pi.xc&&s.getVisible()&&s.getMarkerVisible()&&s.ao.Zr===e.TextObjectIdentifier.CursorTickMarker){const t=Zn(s.ao);this.Zf.pi.xc.FA({...t,blacklist:[e.TextObjectIdentifier.CursorResultTable,e.TextObjectIdentifier.CursorTickMarker]})}for(const t of this.Rf)t.ir();return{width:Math.abs(p.x-g.x),height:Math.abs(p.y-g.y),left:Math.min(g.x,p.x),right:this.sA.x.getInnerEnd()-Math.max(g.x,p.x),bottom:Math.min(g.y,p.y),top:this.sA.y.getInnerEnd()-Math.max(g.y,p.y)}}setLength(t){return this.vf=t,this.$h=void 0,this.chart.pi.Bs(),this}getLength(){return this.vf}setMargins(t,e){return this.kA=t,this.CA=e,this.$h=void 0,this.chart.pi.Bs(),this}getMargins(){var t,e;return{start:null!==(t=this.kA)&&void 0!==t?t:0,end:null!==(e=this.CA)&&void 0!==e?e:0}}getStackIndex(){var t,e;return null!==(e=null===(t=[...this.chart.IA,...this.chart.LA,...this.chart.PA,...this.chart.BA].find(t=>t.axis===this))||void 0===t?void 0:t.iStack)&&void 0!==e?e:0}getParallelIndex(){var t,e;return null!==(e=null===(t=[...this.chart.IA,...this.chart.LA,...this.chart.PA,...this.chart.BA].find(t=>t.axis===this))||void 0===t?void 0:t.iParallel)&&void 0!==e?e:0}DA(){return this.Pf}EA(t,i){i=i||Da.AxisTickMajor;const s=new jn(this,t?this.Yf[0]:this.Zf,this.Zf,this.ai,this.rA,this.rA,this.oh,this.qf,this.$f,this.bi,i).setTextFormatter(this.formatValue);return this.Bf.push(s),this.$h=void 0,"other"===s.ao.uo&&(s.ao.Zr=e.TextObjectIdentifier.CursorTickMarker),s}RA(t,e){const i=-this.oh.getWidth(e);this.pan(i)}pan(t,e){var i,s;const r=this.Ah,n=this.gh,o=this.ai.Qt(r,t),a=this.ai.Qt(n,t);this.Eh(o,a,{allowIntervalLengthChange:!1,skipIntervalRestriction:!1});const h=this._h();if(!1!==(null==e?void 0:e.releaseScrollingAxisIfLiveReached)&&(null===(i=this.Rh)||void 0===i?void 0:i.id)===pn&&this.Rr&&h){const t=this.vr({forStart:o,forEnd:a,allowIntervalLengthChange:!1});t&&(this.gh>this.Ah&&this.gh>=t.end||this.gh<this.Ah&&this.Ah>=t.start)&&this.setStopped(!1)}if(!1!==(null==e?void 0:e.releaseScrollingAxisIfLiveReached)&&(null===(s=this.Rh)||void 0===s?void 0:s.id)===mn&&this.Rr&&h){const t=this.vr({forStart:o,forEnd:a,allowIntervalLengthChange:!1});t&&(this.gh<this.Ah&&this.gh<=t.end||this.gh>this.Ah&&this.Ah<=t.start)&&this.setStopped(!1)}}zoom(t,e){const i=this.ai.Dt(this.Ah),s=this.ai.Dt(this.gh),r=this.ai.Dt(t),n=$t((r-i)/(s-i),0,1),o=.2*this.ai.wt(),a=n*o*-e,h=(1-n)*o*e,l=this.ai.Qt(this.Ah,a),c=this.ai.Qt(this.gh,h),u=this.mn();let d=l,f=c;if(void 0!==(null==u?void 0:u.intervalMax)&&Math.abs(f-d)>u.intervalMax){const t=u.intervalMax-Math.abs(f-d);d-=t*n,f+=t*(1-n)}if(void 0!==(null==u?void 0:u.intervalMin)&&Math.abs(f-d)<u.intervalMin){const t=u.intervalMin-Math.abs(f-d);d-=t*n,f+=t*(1-n)}this.Eh(d,f,{allowIntervalLengthChange:!0,skipIntervalRestriction:!1})}addCustomTick(t){return this.EA(!0,t)}getCustomTicks(){return[...this.Bf]}setTitlePosition(t){return this._A=t,this.chart.pi.Bs(),this}getTitlePosition(){var t;return null!==(t=this._A)&&void 0!==t?t:"center-chart"}getUiPosition(){return this.Qf}setStrokeStyle(t){return this.hA.cr(t),this.jf.Bs(),this}getStrokeStyle(){return this.hA.do()}getOverlayStyle(){return this.nA.Mh()}setOverlayStyle(t){return this.nA.qe(t),this.jf.Bs(),this}setAnimationHighlight(t){return this.chart.pi.Ms.Ns(this.nA,t),this}getAnimationHighlight(){return this.chart.pi.Ms.Gs(this.nA)}getMarginAfterTicks(){return this.lA}setMarginAfterTicks(t){return this.lA=t,this.$h=void 0,this.jf.Bs(),this}getMarginAfterTitle(){return this.uA}setMarginAfterTitle(t){return this.uA=t,this.$h=void 0,this.jf.Bs(),this}j(){return this.ai.j(),this}H(){return this.ai.H(),this}dispose(){var t;(null===(t=this.Rh)||void 0===t?void 0:t.dispose)&&this.Rh.dispose({axis:this}),this.hA.dispose(),this.nA.dispose(),this.oA.dispose(),this.Jr.dispose(),this.Oh(Wt);for(const t of this.If.values())t.grid.dispose(),t.tick.dispose();return this.Df.slice().forEach(Wt),this.Rf.slice().forEach(Wt),this.Xf(this),this.D.R("dispose",{}),this}setVisible(t){this.hA.setVisible(t),this.Jr.setVisible(t),this.nA.setVisible(t),this.Oh(e=>{e.Fs(t)});for(const e of this.If.values())e.grid.setVisible(t),e.tick.setVisible(t);return super.setVisible(t),this.$h=void 0,this.chart.pi.Bs(),this}setAnimationsEnabled(t){return super.setAnimationsEnabled(t),this.setAnimationHighlight(this.Er),this}setHighlightOnHover(t){return this.ds=t?e.HighlightModes.onHover:e.HighlightModes.noHighlighting,!1===t&&this.getHighlight()>0&&this.setHighlight(!1),this}getHighlightOnHover(){return this.ds!==e.HighlightModes.noHighlighting}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}set draggable(t){this.D.draggable=t}get draggable(){return this.D.draggable}setUserInteractions(t){return this.ar=void 0===t?{pan:!1,zoom:!1,rectangleZoom:!1,restoreDefault:!1,chartInteractions:{pan:!1,paginate:!1,zoom:!1,rectangleZoom:!1,restoreDefault:!1,restorePrevious:!1}}:t,this}getUserInteractions(){return this.ar}}var La;e.AxisXYTitlePositionOptions=void 0,(La=e.AxisXYTitlePositionOptions||(e.AxisXYTitlePositionOptions={})).Start="start",La.Center="center",La.End="end",La.CenterChart="center-chart";const Pa=t=>t.curEnd>t.curStart?{startMin:t.dataMin,endMax:t.dataMax}:{endMin:t.dataMin,startMax:t.dataMax},za={getWidth:t=>t.x,getHeight:t=>t.y,toVec2:(t,e)=>({x:t,y:e}),toPoint:(t,e)=>l(t,e)},_a={getWidth:t=>t.y,getHeight:t=>t.x,toVec2:(t,e)=>({x:e,y:t}),toPoint:(t,e)=>l(e,t)},Va=t=>!!(t&&"object"==typeof t&&"x"in t&&t.x instanceof Ra&&"y"in t&&t.y instanceof Ra),Na=s.Record({type:"tick-style",gridStrokeLength:1,gridStrokeStyle:new lr,tickLength:7,tickStyle:new lr,tickPadding:0,labelFont:new I,labelFillStyle:new fs,labelAlignment:0,labelAlignmentOpposite:void 0,labelRotation:0,labelShadow:void 0});class Oa extends Na{constructor(t){super(t)}setGridStrokeLength(t){return this.set("gridStrokeLength",t)}getGridStrokeLength(){return this.get("gridStrokeLength")}setGridStrokeStyle(t){return this.set("gridStrokeStyle","function"==typeof t?t(this.get("gridStrokeStyle")):t)}getGridStrokeStyle(){return this.get("gridStrokeStyle")}setTickLength(t){return this.set("tickLength",t)}getTickLength(){return this.get("tickLength")}setTickStyle(t){return this.set("tickStyle","function"==typeof t?t(this.get("tickStyle")):t)}getTickStyle(){return this.get("tickStyle")}setTickPadding(t){return this.set("tickPadding",t)}getTickPadding(){return this.get("tickPadding")}setLabelFillStyle(t){return this.set("labelFillStyle","function"==typeof t?t(this.get("labelFillStyle")):t)}getLabelFillStyle(){return this.get("labelFillStyle")}setLabelShadow(t){return this.set("labelShadow",t)}getLabelShadow(){return this.get("labelShadow")}setLabelFont(t){return this.set("labelFont","function"==typeof t?t(this.get("labelFont")):t)}getLabelFont(){return this.get("labelFont")}setLabelAlignment(t,e){return this.withMutations(i=>i.set("labelAlignment",t).set("labelAlignmentOpposite",e))}getLabelAlignment(){return this.get("labelAlignment")}setLabelRotation(t){return this.set("labelRotation",t)}getLabelRotation(){return this.get("labelRotation")}}const Ua=t=>!(!t||"object"!=typeof t||!("type"in t)||"tick-style"!==t.type),Ga=new Oa({labelFillStyle:ls,gridStrokeStyle:Bt,tickStyle:Bt}),Ya=t=>Ua(t)&&cs(t.labelFillStyle)&&Ft(t.gridStrokeStyle)&&Ft(t.tickStyle),Za=1e6,Wa=s.Record({type:"time-ticks",cursorFormatter:void 0,timeOrigin:void 0,majorTickStyle:new Oa,minorTickStyle:new Oa,majorFormattingFunction:void 0,minorFormattingFunction:void 0}),ja=36e5,Ha=6e4,$a=1e3,Xa=1e-6,qa=(t,e)=>{const i=e-t;return i>=864e5?"MajorHours12":i>=ja?"MajorHours":i>=6e5?"MajorMinutes15":i>=9e4?"MajorMinutes":i>=10500?"MajorSeconds15":i>=$a?"MajorSeconds":i>=100?"MajorMilliseconds100":i>=10?"MajorMilliseconds10":i>=1?"MajorMilliseconds":i>=.1?"MajorMicroseconds100":i>=.01?"MajorMicroseconds10":i>=.001?"MajorMicroseconds":i<=.001?"MajorNanoseconds100":"Unknown"},Ka={hhmmss:t=>{let e=Math.abs(t);const i=t>=0?"":"-",s=Math.floor(e/ja);e%=ja;const r=Math.floor(e/Ha);e%=Ha;const n=Math.floor(e/$a);return`${i}${Pe(s,2)}:${Pe(r,2)}:${Pe(n,2)}`},hhmmssmmm:t=>{let e=Math.abs(t);const i=t>=0?"":"-",s=Math.floor(e/ja);e%=ja;const r=Math.floor(e/Ha);e%=Ha;const n=Math.floor(e/$a);e%=$a;const o=Math.floor(e/1);return`${i}${Pe(s,2)}:${Pe(r,2)}:${Pe(n,2)}.${Pe(o,3)}`},hhmmssmmmuuu:t=>{const e=Math.abs(t),i=t>=0?"":"-",s=Math.floor(e/ja),r=Math.floor(e/Ha)%60,n=Math.floor(e/$a)%60,o=Math.floor(e/1)%1e3,a=t.toLocaleString("en-US",{minimumFractionDigits:3,maximumFractionDigits:3}).split(".")[1];return`${i}${Pe(s,2)}:${Pe(r,2)}:${Pe(n,2)}.${Pe(o,3)}${a}`},hhmmssmmmuuunnn:t=>{const e=Math.abs(t),i=t>=0?"":"-",s=Math.floor(e/ja),r=Math.floor(e/Ha)%60,n=Math.floor(e/$a)%60,o=Math.floor(e/1)%1e3,a=t.toLocaleString("en-US",{minimumFractionDigits:6,maximumFractionDigits:6}).split(".")[1];return`${i}${Pe(s,2)}:${Pe(r,2)}:${Pe(n,2)}.${Pe(o,3)}${a}`}},Ja={MajorHours12:{major:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>{const r=432e5;return t=Math.floor(t/(4*r))*r*4,En(t,e,r,void 0,Za)},fitKeyValues:Tn({ignore:"first"},2,4)},minor:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>Mn(t,e,36e5,Za),fitKeyValues:Tn({},2,3,4,6)},defaultValueFormatter:Ka.hhmmss},MajorHours:{major:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>{const r=ja;return t=Math.floor(t/(12*r))*r*12,En(t,e,r,void 0,Za)},fitKeyValues:Tn({ignore:"first"},2,6,12)},minor:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>Mn(t,e,3e5,Za),fitKeyValues:Tn({},2,4,6)},defaultValueFormatter:Ka.hhmmss},MajorMinutes15:{major:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>(t=Math.floor(t/ja)*ja,En(t,e,9e5,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2)},minor:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>Mn(t,e,6e4,Za),fitKeyValues:Tn({},3,5)},defaultValueFormatter:Ka.hhmmss},MajorMinutes:{major:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>{const r=Ha;return t=Math.floor(t/6e5)*r*10,En(t,e,r,void 0,Za)},fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>Mn(t,e,5e3,Za),fitKeyValues:Tn({},2,3,4,6)},defaultValueFormatter:Ka.hhmmss},MajorSeconds15:{major:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>(t=15e3*Math.floor(t/6e4)*4,En(t,e,15e3,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,4)},minor:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>Mn(t,e,1e3,Za),fitKeyValues:Tn({},3,5)},defaultValueFormatter:Ka.hhmmss},MajorSeconds:{major:{format:Ka.hhmmss,getKeyValues:(t,e,i,s)=>{const r=$a;return t=Math.floor(t/1e4)*r*10,En(t,e,r,void 0,Za)},fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmm,getKeyValues:(t,e,i,s)=>Mn(t,e,100,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmm},MajorMilliseconds100:{major:{format:Ka.hhmmssmmm,getKeyValues:(t,e,i,s)=>(t=100*Math.floor(t/1e3)*10,En(t,e,100,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmm,getKeyValues:(t,e,i,s)=>Mn(t,e,10,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmm},MajorMilliseconds10:{major:{format:Ka.hhmmssmmm,getKeyValues:(t,e,i,s)=>(t=10*Math.floor(t/100)*10,En(t,e,10,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmm,getKeyValues:(t,e,i,s)=>Mn(t,e,1,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmm},MajorMilliseconds:{major:{format:Ka.hhmmssmmmuuu,getKeyValues:(t,e,i,s)=>(t=1*Math.floor(t/10)*10,En(t,e,1,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmmuuu,getKeyValues:(t,e,i,s)=>Mn(t,e,.1,Za),fitKeyValues:Tn({},2)},defaultValueFormatter:Ka.hhmmssmmmuuu},MajorMicroseconds100:{major:{format:Ka.hhmmssmmmuuu,getKeyValues:(t,e,i,s)=>(t=.1*Math.floor(t/1)*10,En(t,e,.1,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmmuuu,getKeyValues:(t,e,i,s)=>Mn(t,e,.01,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmmuuu},MajorMicroseconds10:{major:{format:Ka.hhmmssmmmuuu,getKeyValues:(t,e,i,s)=>(t=.01*Math.floor(t/.1)*10,En(t,e,.01,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmmuuu,getKeyValues:(t,e,i,s)=>Mn(t,e,.001,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmmuuu},MajorMicroseconds:{major:{format:Ka.hhmmssmmmuuunnn,getKeyValues:(t,e,i,s)=>(t=.001*Math.floor(t/.01)*10,En(t,e,.001,void 0,Za)),fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmmuuunnn,getKeyValues:(t,e,i,s)=>Mn(t,e,100*Xa,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmmuuunnn},MajorNanoseconds100:{major:{format:Ka.hhmmssmmmuuunnn,getKeyValues:(t,e,i,s)=>{const r=100*Xa;return t=Math.floor(t/.001)*r*10,En(t,e,r,void 0,Za)},fitKeyValues:Tn({ignore:"first"},2,5)},minor:{format:Ka.hhmmssmmmuuunnn,getKeyValues:(t,e,i,s)=>Mn(t,e,10*Xa,Za),fitKeyValues:Tn({},2,3,5)},defaultValueFormatter:Ka.hhmmssmmmuuunnn},Unknown:{major:{format:(t,e,i)=>"",getKeyValues:(t,e,i,s)=>[],fitKeyValues:void 0},minor:{format:(t,e,i)=>"",getKeyValues:(t,e,i,s)=>[],fitKeyValues:void 0},defaultValueFormatter:(t,e,i)=>""}};class Qa extends Wa{br(t){const e=this.timeOrigin||0,i=[{zh:"Major ticks",MA:0,Fr:this.majorTickStyle,mr:this.majorFormattingFunction?this.majorFormattingFunction:(t,i,s)=>{const r=qa(Math.min(i.start,i.end),Math.max(i.start,i.end));return(0,Ja[r].major.format)(t+e,i,s)},Fn:(t,e,i,s,r)=>{const n=qa(i,s);return(0,Ja[n].major.getKeyValues)(t,e,i,s,r)},ih:{hn:(t,e,i,s,r,n)=>{const o=qa(r,n),a=Ja[o].major.fitKeyValues;if(a)return a(t,e,i,s,r,n)},an:"hide-label"},In:void 0}];return Ua(this.minorTickStyle)&&i.push({zh:"Minor ticks",MA:1,Fr:this.minorTickStyle,mr:this.minorFormattingFunction?this.minorFormattingFunction:(t,i,s)=>{const r=qa(Math.min(i.start,i.end),Math.max(i.start,i.end));return(0,Ja[r].minor.format)(t+e,i,s)},Fn:(t,e,i,s,r)=>{const n=qa(i,s);return(0,Ja[n].minor.getKeyValues)(t,e,i,s,r)},ih:{hn:(t,e,i,s,r,n)=>{const o=qa(r,n),a=Ja[o].minor.fitKeyValues;if(a)return a(t,e,i,s,r,n)},an:"hide-tick"},In:void 0}),{Mr:[],wr:i,_r:this.cursorFormatter||((t,i,s)=>{const r=qa(Math.min(i.start,i.end),Math.max(i.start,i.end));return Ja[r].defaultValueFormatter(t+e,i,s)}),kr:1e-4,Cr:864e6}}setTickStyle(t){return this.setMajorTickStyle(t).setMinorTickStyle(t)}setMajorTickStyle(t){return"function"==typeof t?this.set("majorTickStyle",t(this.get("majorTickStyle"))):this.set("majorTickStyle",t)}getMajorTickStyle(){return this.get("majorTickStyle")}setMinorTickStyle(t){if("function"==typeof t){const e=this.get("minorTickStyle");return this.set("minorTickStyle",t(e))}return this.set("minorTickStyle",t)}getMinorTickStyle(){return this.get("minorTickStyle")}setCursorFormatter(t){return this.set("cursorFormatter",t)}getCursorFormatter(){return this.get("cursorFormatter")}setTimeOrigin(t){return this.set("timeOrigin",t)}getTimeOrigin(){return this.get("timeOrigin")}setFormattingFunction(t){return this.withMutations(e=>e.set("majorFormattingFunction",t).set("minorFormattingFunction",t).set("cursorFormatter",t))}getMajorFormattingFunction(){return this.get("majorFormattingFunction")}setMajorFormattingFunction(t){return this.set("majorFormattingFunction",t)}getMinorFormattingFunction(){return this.get("minorFormattingFunction")}setMinorFormattingFunction(t){return this.set("minorFormattingFunction",t)}}const th=(t,e,i,s,r)=>(n,o)=>a=>{const h=new Date(a+n),l={year:o?h.getUTCFullYear():h.getFullYear(),monthIndex:o?h.getUTCMonth():h.getMonth(),day:o?h.getUTCDate():h.getDate(),hours:o?h.getUTCHours():h.getHours(),minutes:o?h.getUTCMinutes():h.getMinutes(),seconds:o?h.getUTCSeconds():h.getSeconds(),millis:o?h.getUTCMilliseconds():h.getMilliseconds()},c=s?s(l):void 0;if(0===t&&!0===c)return a;const u=l[e];r.includes("year")&&(l.year=Math.floor(l.year/i)*i),r.includes("monthIndex")&&(l.monthIndex=0),r.includes("day")&&(l.day=1),r.includes("hours")&&(l.hours=0),r.includes("minutes")&&(l.minutes=0),r.includes("seconds")&&(l.seconds=0),r.includes("millis")&&(l.millis=0);let d=(0===t?1:t)*i;return-1===t&&!1===c&&(d=0),0!==d&&(l[e]=i*(d>0?Math.floor((u+d)/i):Math.ceil((u+d)/i))),o?Date.UTC(l.year,l.monthIndex,l.day,l.hours,l.minutes,l.seconds,l.millis)-n:new Date(l.year,l.monthIndex,l.day,l.hours,l.minutes,l.seconds,l.millis).getTime()-n},eh=(t,e,i,...s)=>th(-1,t,e,i,s),ih=(t,e,i,...s)=>th(-1,t,e,i,s),sh=(t,e,i,...s)=>th(0,t,e,i,s),rh=(t,e,...i)=>th(1,t,e,void 0,i),nh=t=>(e,i)=>s=>{const r=new Date(s+e),n=i?r.getUTCDay():r.getDay(),o=1===n&&0===(i?r.getUTCHours():r.getHours())&&0===(i?r.getUTCMinutes():r.getMinutes())&&0===r.getSeconds()&&0===r.getMilliseconds();if(0===t&&!0===o)return s;let a=i?r.getUTCDate():r.getDate();return-1===t&&1===n&&!1===o||(-1===t?a-=n>=2?n-1:n+6:a+=n>0?8-n:1),i?Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),a,0,0,0,0)-e:new Date(r.getFullYear(),r.getMonth(),a,0,0,0,0).getTime()-e},oh=[{label:"NanoSecond10",unit:1e-5,irregular:!1,greatTicks:void 0,majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"NanoSecond100",unit:1e-4,irregular:!1,greatTicks:{getReferenceKeyValue:(t,e)=>t=>1e-4*Math.floor(t/1e-4)},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"MicroSecond1",unit:.001,irregular:!1,greatTicks:{getReferenceKeyValue:(t,e)=>t=>.001*Math.floor(t/.001)},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"MicroSecond10",unit:.01,irregular:!1,greatTicks:{getReferenceKeyValue:(t,e)=>t=>.01*Math.floor(t/.01)},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"MicroSecond100",unit:.1,irregular:!1,greatTicks:{getReferenceKeyValue:(t,e)=>t=>.1*Math.floor(t/.1)},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"MilliSecond1",unit:1,irregular:!1,greatTicks:{getReferenceKeyValue:eh("millis",1,t=>t.millis%1==0,"millis")},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"MilliSecond10",unit:10,irregular:!1,greatTicks:{getReferenceKeyValue:eh("millis",10,t=>t.millis%10==0,"millis")},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"MilliSecond100",unit:100,irregular:!1,greatTicks:{getReferenceKeyValue:eh("millis",100,t=>t.millis%100==0,"millis")},majorTicks:{fitFunction:Tn({offset:0},2,5)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"Second",unit:1e3,irregular:!1,greatTicks:{getReferenceKeyValue:eh("seconds",1,t=>0===t.millis,"millis")},majorTicks:{fitFunction:wn(3,5,10,15,30)},minorTicks:{amount:4,fitFunction:Tn(void 0,2)}},{label:"Minute",unit:6e4,irregular:!1,greatTicks:{getReferenceKeyValue:eh("minutes",1,t=>0===t.seconds&&0===t.millis,"seconds","millis")},majorTicks:{fitFunction:wn(3,5,10,15,30)},minorTicks:{amount:12,fitFunction:Tn(void 0,3,6)}},{label:"Hour",unit:36e5,irregular:!1,greatTicks:{getReferenceKeyValue:eh("hours",1,t=>0===t.minutes&&0===t.seconds&&0===t.millis,"minutes","seconds","millis")},majorTicks:{fitFunction:wn(3,6,12)},minorTicks:{amount:8,fitFunction:Tn(void 0,2,4)}},{label:"Day",unit:864e5,irregular:!1,greatTicks:{getReferenceKeyValue:eh("day",1,t=>0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"hours","minutes","seconds","millis")},majorTicks:{fitFunction:Tn({ignore:"last"},2,4)},minorTicks:{amount:7,fitFunction:Tn({ignore:"last"},2,3)}},{label:"Week",unit:6048e5,irregular:!0,getPrevKeyValue:nh(-1),getNextKeyValueIncludingRef:nh(0),getNextKeyValue:nh(1),greatTicks:!0,majorTicks:{fitFunction:Tn(void 0,2)},minorTicks:{fitFunction:void 0}},{label:"Month",unit:2592e6,irregular:!0,getPrevKeyValue:ih("monthIndex",1,t=>1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"day","hours","minutes","seconds","millis"),getNextKeyValueIncludingRef:sh("monthIndex",1,t=>1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"day","hours","minutes","seconds","millis"),getNextKeyValue:rh("monthIndex",1,"day","hours","minutes","seconds","millis"),greatTicks:!0,majorTicks:{fitFunction:Tn(void 0,2,3,6)},minorTicks:{fitFunction:Tn(void 0,2,4,6)}},{label:"Year",unit:31536e6,irregular:!0,getPrevKeyValue:ih("year",1,t=>1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValueIncludingRef:sh("year",1,t=>1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValue:rh("year",1,"monthIndex","day","hours","minutes","seconds","millis"),greatTicks:!0,majorTicks:{fitFunction:Tn({ignore:"first"},2,5)},minorTicks:{fitFunction:Tn(void 0,2,5)}},{label:"Decade",unit:31536e7,irregular:!0,getPrevKeyValue:ih("year",10,t=>t.year%10==0&&1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"year","monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValueIncludingRef:sh("year",10,t=>t.year%10==0&&1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"year","monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValue:rh("year",10,"year","monthIndex","day","hours","minutes","seconds","millis"),greatTicks:!0,majorTicks:{fitFunction:Tn(void 0,2,4)},minorTicks:{fitFunction:Tn(void 0,2,5)}},{label:"Century",unit:316224e7,irregular:!0,getPrevKeyValue:ih("year",100,t=>t.year%100==0&&1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"year","monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValueIncludingRef:sh("year",100,t=>t.year%100==0&&1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"year","monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValue:rh("year",100,"year","monthIndex","day","hours","minutes","seconds","millis"),greatTicks:!0,majorTicks:{fitFunction:void 0},minorTicks:void 0},{label:"Millennium",unit:316224e8,irregular:!0,getPrevKeyValue:ih("year",1e3,t=>t.year%1e3==0&&1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"year","monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValueIncludingRef:sh("year",1e3,t=>t.year%1e3==0&&1===t.day&&0===t.hours&&0===t.minutes&&0===t.seconds&&0===t.millis,"year","monthIndex","day","hours","minutes","seconds","millis"),getNextKeyValue:rh("year",1e3,"year","monthIndex","day","hours","minutes","seconds","millis"),greatTicks:!0,majorTicks:{fitFunction:void 0},minorTicks:void 0}],ah=(t,e,i,s,r)=>{const n=e-t;let o;for(let t=r?0:oh.length-1;r?t<oh.length:t>=0;r?t+=1:t-=1){const e=n/oh[t].unit;if((void 0===i||e>=i)&&(void 0===s||e<=s)){o=oh[t];break}}return o},hh=(t,e,i)=>{let s=ah(e,i,void 0,2,!0);if(void 0!==s&&0===oh.indexOf(s)&&(s=oh[1]),void 0===s)return;if("great"===t)return s;const r="major"===t?1:2,n=oh[oh.indexOf(s)-r];return void 0===n?oh[0]:n},lh=(t,e,i)=>(s,r,n,o)=>{const a=hh("great",s,r);if(void 0===a)return[];if("Decade"===a.label||"Century"===a.label||"Millennium"===a.label)return[];const h=o>n?s:r,l=(s+r)/2,c=o>n?r:s;if(oh.indexOf(a)<=oh.findIndex(t=>"Hour"===t.label))return"left"===i?[h]:[];let u;if(!0===a.irregular)u=kn(s,r,a.getPrevKeyValue(t,e),a.getNextKeyValue(t,e));else{const i=a.greatTicks.getReferenceKeyValue(t,e)(s);u=En(s,r,a.unit,i,void 0)}const d=((t,e,i)=>{for(const s of i)if(s>=t&&s<=e)return s})(s,r,u);return"left"===i?void 0===d||mi(d,l,c)?[h]:[d]:void 0!==d&&mi(d,l,c)?[d]:[c]},ch=(t,e,i)=>(s,r,n,o)=>{const a=hh(t,n,o);let h;if(void 0===a)return[];if("great"===t&&void 0!==a.greatTicks)if(!0===a.irregular)h=kn(s,r,a.getPrevKeyValue(e,i),a.getNextKeyValue(e,i));else{const t=a.greatTicks.getReferenceKeyValue(e,i)(s);h=En(s,r,a.unit,t,void 0)}else if("major"===t&&void 0!==a.majorTicks)h=!0===a.irregular?((t,e,i,s)=>{const r=[];let n=i(t),o=0;for(;n<e;)if(r.push(n),n=s(n),o+=1,o>1e3)throw new Error("Infinite loop in Axis tick key values logic.");return r.push(n),r})(s,r,a.getPrevKeyValue(e,i),a.getNextKeyValue(e,i)):((t,e,i)=>{const s=[];let r=t,n=0;for(;(r-t)/(e-t)<.98;)if(s.push(r),n+=1,r=t+n*i,n>1e3)throw new Error("Infinite loop in Axis tick key values logic.");return s.push(r),s})(s,r,a.unit);else{if("minor"!==t||void 0===a.minorTicks)return[];if(!0===a.irregular)h=((t,e,i,s)=>{const r=[];let n=s(t),o=0;for(;n<e;)if(r.push(n),n=s(n),o+=1,o>1e3)throw new Error("Infinite loop in Axis tick key values logic.");return r})(s,r,a.getNextKeyValueIncludingRef(e,i),a.getNextKeyValue(e,i));else{const t=(t=>{if(void 0!==t)return oh[oh.indexOf(t)+1]})(a);if(void 0===t)return[];h=Mn(s,r,t.unit/a.minorTicks.amount,void 0)}}return h},uh=t=>(e,i,s,r,n,o)=>{const a=hh(t,n,o);if(void 0===a)return;let h;return"major"===t?h=a.majorTicks.fitFunction:a.minorTicks&&(h=a.minorTicks.fitFunction),h?h(e,i,s,r,n,o):void 0},dh=s.Record({utc:!1,locale:void 0,dateOrigin:void 0,cursorFormatter:void 0,greatTickStyle:new Oa,majorTickStyle:new Oa,minorTickStyle:new Oa,formatOptionsMajorCentury:{year:"numeric",hour12:!1},formatOptionsMinorDecade:{year:"numeric",hour12:!1},formatOptionsMajorDecade:{year:"numeric",hour12:!1},formatOptionsMinorYear:{year:"numeric",hour12:!1},formatOptionsMajorYear:{year:"numeric",hour12:!1},formatOptionsMinorMonth:{month:"short",hour12:!1},formatOptionsGreatYear:{year:"numeric",hour12:!1},formatOptionsMajorMonth:{month:"long",hour12:!1},formatOptionsMinorWeek:{day:"numeric",hour12:!1},formatOptionsGreatMonth:{year:"numeric",month:"long",hour12:!1},formatOptionsMajorWeek:{day:"numeric",weekday:"short",hour12:!1},formatOptionsMinorDay:{day:"numeric",weekday:"short",hour12:!1},formatOptionsGreatWeek:(t,e,i)=>{const s=new Date(t),r=(t=>{const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));const i=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e.getTime()-i.getTime())/864e5+1)/7)})(s);return`${new Intl.DateTimeFormat(i,{year:"numeric",month:"long",hour12:!1}).format(s)} Week ${r}`},formatOptionsMajorDay:{weekday:"long",day:"numeric",hour12:!1},formatOptionsMinorHour:{hour:"2-digit",minute:"2-digit",hour12:!1},formatOptionsGreatDay:{year:"numeric",month:"long",day:"numeric",hour12:!1},formatOptionsMajorHour:{hour:"2-digit",minute:"2-digit",hour12:!1},formatOptionsMinorMinute:{hour:"2-digit",minute:"2-digit",hour12:!1},formatOptionsGreatHour:{year:"numeric",month:"long",day:"numeric",hour12:!1},formatOptionsMajorMinute:{hour:"2-digit",minute:"2-digit",hour12:!1},formatOptionsMinorSecond:{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},formatOptionsGreatMinute:{year:"numeric",month:"long",day:"numeric",hour12:!1},formatOptionsMajorSecond:{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},formatOptionsMinorMillisecond:t=>{const e=new Date(t);return e.setHours(0,0,0,0),Ka.hhmmssmmm(t-e.getTime())},formatMillisecondRange:t=>{const e=new Date(t);return e.setHours(0,0,0,0),Ka.hhmmssmmm(t-e.getTime())},formatMicrosecondRange:t=>{const e=new Date(t);return e.setHours(0,0,0,0),Ka.hhmmssmmmuuu(t-e.getTime())},formatNanosecondRange:(t,e,i,s)=>{if(s){const t=new Date(s.valueShifted);return t.setHours(0,0,0,0),Ka.hhmmssmmmuuunnn(s.valueShifted-t.getTime())}{const e=new Date(t);return e.setHours(0,0,0,0),Ka.hhmmssmmmuuunnn(t-e.getTime())}},formatOptionsGreatSecond:{},formatOptionsMajorMilliSecond:{}});class fh extends dh{br(t){const e=void 0!==this.dateOrigin?this.dateOrigin.getTime():0,i=t=>oh.map(e=>{const i=((t,e,i)=>{switch(i.label){case"NanoSecond10":case"NanoSecond100":return t.formatNanosecondRange;case"MicroSecond1":case"MicroSecond10":case"MicroSecond100":return t.formatMicrosecondRange;case"MilliSecond1":case"MilliSecond10":case"MilliSecond100":return"Great"===e?t.formatOptionsGreatMinute:t.formatMillisecondRange;case"Second":return"Great"===e?t.formatOptionsGreatMinute:"Major"===e?t.formatOptionsMajorSecond:t.formatOptionsMinorSecond;case"Minute":return"Great"===e?t.formatOptionsGreatMinute:"Major"===e?t.formatOptionsMajorMinute:t.formatOptionsMinorMinute;default:case"Hour":return"Great"===e?t.formatOptionsGreatHour:"Major"===e?t.formatOptionsMajorHour:t.formatOptionsMinorHour;case"Day":return"Great"===e?t.formatOptionsGreatDay:"Major"===e?t.formatOptionsMajorDay:t.formatOptionsMinorDay;case"Week":return"Great"===e?t.formatOptionsGreatWeek:"Major"===e?t.formatOptionsMajorWeek:t.formatOptionsMinorWeek;case"Month":return"Great"===e?t.formatOptionsGreatMonth:"Major"===e?t.formatOptionsMajorMonth:t.formatOptionsMinorMonth;case"Year":return"Great"===e?t.formatOptionsGreatYear:"Major"===e?t.formatOptionsMajorYear:t.formatOptionsMinorYear;case"Decade":return"Great"===e?void 0:"Major"===e?t.formatOptionsMajorDecade:t.formatOptionsMinorDecade;case"Century":return"Great"===e?void 0:"Major"===e?t.formatOptionsMajorCentury:void 0;case"Millennium":return}})(this,t,e);if("object"!=typeof i)return i;try{return new Intl.DateTimeFormat(this.locale,i)}catch(t){let e="";for(const t in i)e+=` ${t}: ${i[t]},`;Ut.console.error(`Invalid Intl.DateTimeFormat ( locale: ${this.locale}, formatOptions {${e}} )`)}}),s=new Map;s.set("great",i("Great")),s.set("major",i("Major")),s.set("minor",i("Minor"));const r=t=>String(t),n=(t,i)=>(n,o)=>{let a=n,h=n+e;const l=o.start,c=o.end,u=l>c,d=hh(t,u?c:l,u?l:c);if(void 0===d)return r(h);if("great"===t){const t=Ht(n,"left"===i?l:c);let s;if(s=!1===t?n:!1===d.irregular?"left"===i&&!1===u||"right"===i&&!0===u?d.greatTicks.getReferenceKeyValue(e,this.utc)(n):d.greatTicks.getReferenceKeyValue(e,this.utc)(n+1*d.unit):"left"===i&&!1===u||"right"===i&&!0===u?d.getPrevKeyValue(e,this.utc)(n):d.getNextKeyValue(e,this.utc)(n),a=s,h=s+e,"right"===i&&!0===t)return"";if("right"===i&&"Week"===d.label)return""}const f=s.get(t);if(void 0===f)return r(h,this.locale);const g=f[oh.indexOf(d)];return void 0===g?"":"function"==typeof g?g(h,o,this.locale,{valueShifted:a,shiftOrigin:this.dateOrigin?this.dateOrigin.getTime():0}):g.format(h)},o=[],a=[{zh:"Great ticks (directive)",MA:0,Sr:!0,Fn:ch("great",e,this.utc),In:void 0},{zh:"Major ticks",MA:1,Fr:this.majorTickStyle,mr:n("major"),Fn:ch("major",e,this.utc),ih:{hn:uh("major"),an:"hide-tick"},In:void 0}];Ya(this.greatTickStyle)||o.push({zh:"Great ticks (left)",Fr:this.greatTickStyle.setLabelAlignment(-1),mr:n("great","left"),Fn:lh(e,this.utc,"left"),yr:!0,un:!1}),Ya(this.minorTickStyle)||a.push({zh:"Minor ticks",MA:2,Fr:this.minorTickStyle,mr:n("minor"),Fn:ch("minor",e,this.utc),ih:{hn:uh("minor"),eh:(t,e,i,s,r,n)=>{const o=hh("minor",r,n);return!o||"Week"!==o.label},an:"hide-tick"},In:void 0,nn:2});const h=this.cursorFormatter;return{Mr:o,wr:a,_r:h?(t,i,s)=>h(e+t,i,s):(t,i,s)=>{const r=ah(Math.min(i.start,i.end),Math.max(i.start,i.end),void 0,1,!0),n=r&&r.unit<=.1,o=r&&r.unit<=100,a=r&&r.unit<=6e4,h=new Date(e+t),l=new Date(e+t);l.setHours(0,0,0,0);const c=n?this.formatNanosecondRange:o?this.formatMicrosecondRange:a?this.formatMillisecondRange:Ka.hhmmss;return`${new Intl.DateTimeFormat(s,{year:"numeric",month:"numeric",day:"numeric"}).format(h)} ${c(h.getTime()-l.getTime(),i,this.locale,{valueShifted:t,shiftOrigin:e})}`},kr:10**-5,Cr:31536e9}}setCursorFormatter(t){return this.set("cursorFormatter",t)}getCursorFormatter(){return this.get("cursorFormatter")}setTickStyle(t){return this.setGreatTickStyle(t).setMajorTickStyle(t).setMinorTickStyle(t)}setGreatTickStyle(t){if("function"==typeof t){const e=this.get("greatTickStyle");return this.set("greatTickStyle",t(e))}return this.set("greatTickStyle",t)}getGreatTickStyle(){return this.get("greatTickStyle")}setMajorTickStyle(t){return"function"==typeof t?this.set("majorTickStyle",t(this.get("majorTickStyle"))):this.set("majorTickStyle",t)}getMajorTickStyle(){return this.get("majorTickStyle")}setMinorTickStyle(t){if("function"==typeof t){const e=this.get("minorTickStyle");return this.set("minorTickStyle",t(e))}return this.set("minorTickStyle",t)}getMinorTickStyle(){return this.get("minorTickStyle")}setUTC(t){return this.set("utc",t)}getUTC(){return this.get("utc")}setLocale(t){return this.set("locale",t)}getLocale(){return this.get("locale")}setDateOrigin(t){return this.set("dateOrigin",t)}getDateOrigin(){return this.get("dateOrigin")}setFormatting(t,e,i){return this.withMutations(s=>s.set("formatOptionsGreatYear",t||this.formatOptionsGreatYear).set("formatOptionsGreatMonth",t||this.formatOptionsGreatMonth).set("formatOptionsGreatWeek",t||this.formatOptionsGreatWeek).set("formatOptionsGreatDay",t||this.formatOptionsGreatDay).set("formatOptionsGreatHour",t||this.formatOptionsGreatHour).set("formatOptionsGreatMinute",t||this.formatOptionsGreatMinute).set("formatOptionsMajorCentury",e||this.formatOptionsMajorCentury).set("formatOptionsMajorDecade",e||this.formatOptionsMajorDecade).set("formatOptionsMajorYear",e||this.formatOptionsMajorYear).set("formatOptionsMajorMonth",e||this.formatOptionsMajorMonth).set("formatOptionsMajorWeek",e||this.formatOptionsMajorWeek).set("formatOptionsMajorDay",e||this.formatOptionsMajorDay).set("formatOptionsMajorHour",e||this.formatOptionsMajorHour).set("formatOptionsMajorMinute",e||this.formatOptionsMajorMinute).set("formatOptionsMajorSecond",e||this.formatOptionsMajorSecond).set("formatOptionsMinorDecade",i||this.formatOptionsMinorDecade).set("formatOptionsMinorYear",i||this.formatOptionsMinorYear).set("formatOptionsMinorMonth",i||this.formatOptionsMinorMonth).set("formatOptionsMinorWeek",i||this.formatOptionsMinorWeek).set("formatOptionsMinorDay",i||this.formatOptionsMinorDay).set("formatOptionsMinorHour",i||this.formatOptionsMinorHour).set("formatOptionsMinorMinute",i||this.formatOptionsMinorMinute).set("formatOptionsMinorSecond",i||this.formatOptionsMinorSecond))}setFormattingDecade(t,e){return this.withMutations(i=>(t&&(i=i.set("formatOptionsMajorDecade",t)),e&&(i=i.set("formatOptionsMinorYear",e)),i))}setFormattingYear(t,e){return this.withMutations(i=>(t&&(i=i.set("formatOptionsMajorYear",t)),e&&(i=i.set("formatOptionsMinorMonth",e)),i))}setFormattingMonth(t,e,i){return this.withMutations(s=>(t&&(s=s.set("formatOptionsGreatYear",t)),e&&(s=s.set("formatOptionsMajorMonth",e)),i&&(s=s.set("formatOptionsMinorWeek",i)),s))}setFormattingWeek(t,e,i){return this.withMutations(s=>(t&&(s=s.set("formatOptionsGreatMonth",t)),e&&(s=s.set("formatOptionsMajorWeek",e)),i&&(s=s.set("formatOptionsMinorDay",i)),s))}setFormattingDay(t,e,i){return this.withMutations(s=>(t&&(s=s.set("formatOptionsGreatWeek",t)),e&&(s=s.set("formatOptionsMajorDay",e)),i&&(s=s.set("formatOptionsMinorHour",i)),s))}setFormattingHour(t,e,i){return this.withMutations(s=>(t&&(s=s.set("formatOptionsGreatDay",t)),e&&(s=s.set("formatOptionsMajorHour",e)),i&&(s=s.set("formatOptionsMinorMinute",i)),s))}setFormattingMinute(t,e,i){return this.withMutations(s=>(t&&(s=s.set("formatOptionsGreatHour",t)),e&&(s=s.set("formatOptionsMajorMinute",e)),i&&(s=s.set("formatOptionsMinorSecond",i)),s))}setFormattingSecond(t,e,i){return this.withMutations(s=>(t&&(s=s.set("formatOptionsGreatMinute",t)),e&&(s=s.set("formatOptionsMajorSecond",e)),i&&(s=s.set("formatOptionsMinorMillisecond",i)),s))}setFormattingMilliSecond(t,e){return this.withMutations(i=>(t&&(i=i.set("formatOptionsGreatSecond",t)),e&&(i=i.set("formatOptionsMajorMilliSecond",e)),i))}}const gh=(t,e)=>(i,s,r,n,o)=>{const a=s-i;if(e){let e=5;o<=125?e=2:o<=250?e=3:o<=500&&(e=4);const r=Math.log10(a/e),n=Math.floor(2*r)/2;let h;h=n%1==0?10**(n-t):10**Math.ceil(n)/2;const l=1/h;h=Math.round(h*l)/l;const c=Math.round(Math.floor(i/(10*h))*h*10*l)/l;return En(c,s,h,void 0,l)}let h=a/5;const l=1/h;return h=Math.round(h*l)/l,Mn(i,s,h,l)},ph=(t,e,i,s,r,n)=>0===e?t.filter((t,e)=>e%2==0):1===e?t.filter((t,e)=>e%5==0):2===e?t.filter((t,e)=>e%10==0):void 0,mh=(t,e,i,s,r,n)=>{},yh=(t,e,i,s,r,n)=>0===e?t.filter((t,e)=>e%2==0):1===e?t.filter((t,e)=>e%3==0):2===e?t.filter((t,e)=>e%4==0):3===e?t.filter((t,e)=>e%5==0):void 0,xh=(t,e,i,s,r,n)=>0===e?[t[1],t[3],t[5]]:1===e?[t[0],t[3]]:2===e?[t[1]]:void 0,vh=(t,e)=>{const i=Hi(t),s=$i(t);if(e)return(t,e)=>{const r=[],n=Math.floor(i(t)),o=Math.ceil(i(e));for(let t=n-1;t<=o+1;t+=1){const e=s**t;r.push(e)}return r};const r=10===t?9:4;return(t,e)=>{const n=Math.round(i(t)),o=Math.round(i(e)),a=[],h=s**n,l=(s**o-h)/r;for(let i=1;i<=r;i+=1){const s=h+l*i;s>t&&s<e&&a.push(s)}return a}},Ah=s.Record({cursorFormatter:void 0,extremeTickStyle:new Oa,majorTickStyle:new Oa,minorTickStyle:new Oa,formattingOffset:void 0,extremeFormattingFunction:void 0,majorFormattingFunction:void 0,minorFormattingFunction:void 0,fallBackToExtremeTicksAutomatically:!0});class Sh extends Ah{br(t){const e=this.formattingOffset,i=this.get("extremeFormattingFunction")||("logarithmic"===t.type?(e,i)=>Qi.LogarithmicNoExponents(e,i,void 0,t.base):Qi.Numeric),s=this.get("majorFormattingFunction")||("logarithmic"===t.type?(e,i)=>Qi.LogarithmicNoExponents(e,i,void 0,t.base):Qi.Numeric),r=this.get("minorFormattingFunction")||("logarithmic"===t.type?(e,i)=>Qi.LogarithmicNoExponents(e,i,void 0,t.base):Qi.Numeric),n=[],o=[];Ya(this.extremeTickStyle)||n.push({zh:"Extreme ticks",Fr:this.extremeTickStyle,mr:void 0===e?i:(t,s,r)=>i(e+t,s,r),Fn:bn,yr:!0,un:!0});const a={zh:"Major ticks",MA:0,Fr:this.majorTickStyle,mr:void 0===e?s:(t,i,r)=>s(e+t,i,r),Fn:"logarithmic"===t.type?vh(t.base,!0):gh(0,!0),ih:{an:"hide-label",hn:"logarithmic"===t.type?yh:ph},In:void 0};if(o.push(a),!Ya(this.minorTickStyle)){const i="logarithmic"===t.type?vh(t.base,!1):gh(1,!1);o.push({zh:"Minor ticks",MA:1,Fr:this.minorTickStyle,mr:void 0===e?r:(t,i,s)=>r(e+t,i,s),Fn:(t,e,s,r,n)=>i(t,e,s,r,n),ih:{an:"hide-tick",hn:"logarithmic"===t.type?xh:mh},In:80})}const h=this.cursorFormatter?this.cursorFormatter:Qi.Numeric;return{Mr:n,wr:o,_r:void 0===e?h:(t,i,s)=>h(e+t,i,s),kr:1e-9,Cr:void 0,Wh:this.fallBackToExtremeTicksAutomatically?a:void 0}}setCursorFormatter(t){return this.set("cursorFormatter",t)}getCursorFormatter(){return this.get("cursorFormatter")}setExtremeTickStyle(t){if("function"==typeof t){const e=this.get("extremeTickStyle");return this.set("extremeTickStyle",t(e))}return this.set("extremeTickStyle",t)}getExtremeTickStyle(){return this.get("extremeTickStyle")}setFormattingOffset(t){return this.set("formattingOffset",t)}getFormattingOffset(){return this.get("formattingOffset")}setTickStyle(t){const e=this.setMajorTickStyle(t).setMinorTickStyle(t);return e.extremeTickStyle!==Ga?e.setExtremeTickStyle(t):e}setMajorTickStyle(t){return"function"==typeof t?this.set("majorTickStyle",t(this.get("majorTickStyle"))):this.set("majorTickStyle",t)}getMajorTickStyle(){return this.get("majorTickStyle")}setMinorTickStyle(t){if("function"==typeof t){const e=this.get("minorTickStyle");return this.set("minorTickStyle",t(e))}return this.set("minorTickStyle",t)}getMinorTickStyle(){return this.get("minorTickStyle")}setFormattingFunction(t){return this.withMutations(e=>e.set("extremeFormattingFunction",t).set("majorFormattingFunction",t).set("minorFormattingFunction",t).set("cursorFormatter",t))}getExtremeFormattingFunction(){return this.get("extremeFormattingFunction")}setExtremeFormattingFunction(t){return this.set("extremeFormattingFunction",t)}getMajorFormattingFunction(){return this.get("majorFormattingFunction")}setMajorFormattingFunction(t){return this.set("majorFormattingFunction",t)}getMinorFormattingFunction(){return this.get("minorFormattingFunction")}setMinorFormattingFunction(t){return this.set("minorFormattingFunction",t)}getFallBackToExtremeTicksAutomatically(){return this.get("fallBackToExtremeTicksAutomatically")}setFallBackToExtremeTicksAutomatically(t){return this.set("fallBackToExtremeTicksAutomatically",t)}}const bh=(t,e,i="image/png",s,r=1)=>{e+=`.${i.slice(i.indexOf("image/")+6)}`;const n=t.captureFrame(i,s,void 0,r);if("image/png"!==i&&n.type.includes("image/png"))throw new Error(`saveToFile | type not supported by browser: ${i}\nCheck support table for HTMLCanvasElement.toDataURL`);if(Ut.navigator.msSaveBlob)Ut.navigator.msSaveBlob(n,e);else{const t=Ut.document.createElement("a");Ut.document.body.appendChild(t);const i=Ut.URL.createObjectURL(n);t.href=i,t.download=e,t.click(),setTimeout(()=>{Ut.URL.revokeObjectURL(i),Ut.document.body.removeChild(t)},0)}},Mh=(t,i,s,r,n,o)=>{const a=t.lo(i,s,r,n,o,!0);return a.setDraggingMode(e.UIDraggingModes.draggable),a},Eh=(t,e)=>{if("relative"===t)return e;if(t instanceof X)return t;const i=t.x instanceof Rn?t.x.ai:t.x.x,s=t.y instanceof Rn?t.y.ai:t.y.y;return As(i,s)},kh=(t,e,i,s,r)=>{if(i){const n=t,o=e,a=Va(o)?o:Ms(o)?s:void 0;if(a&&Ss(i)){const t=tt(n,a,r.ai);return r.sl({engineX:t.x,engineY:t.y})}if(a&&Ms(i))return tt(n,a,s);if(a&&Va(i))return tt(n,a,i)}else{const i=t;if(Ms(e)){const t=r.il(i);return tt({x:t.engineX,y:t.engineY},r.ai,s)}if(Va(e)){const t=e,s=r.il(i);return tt({x:s.engineX,y:s.engineY},r.ai,t)}}throw new Error("translateCoordinate unexpected error. Input or target coordinate system not recognized.")};class Th{constructor(t){this.OA=[],this.zA=t}VA(){return this.NA(),{add:()=>this.GA(),finishPlot:()=>{this.$A()}}}GA(){let t=this.OA.find(t=>t.isFree);return t||(t={isFree:!1,shape:this.zA()},this.OA.push(t)),t.isFree=!1,t.shape}NA(){this.OA.forEach(t=>{t.isFree=!0})}$A(){this.OA.filter(t=>t.isFree).forEach(t=>{t.shape.dispose(),this.OA.splice(this.OA.indexOf(t),1)})}UA(){this.OA.forEach(t=>t.shape.dispose()),this.OA.length=0}Nn(){return this.OA.map(t=>t.shape)}}const wh=t=>{const i=t.layer,s=t.scale,r=t.panel,n=t.legend;let o;const a=r.pi.Ms,h=new Map,l=(t,e,i,s)=>{var r;h.has(t)||h.set(t,[]),null===(r=h.get(t))||void 0===r||r.push({eventType:e,callback:i}),t.addEventListener(e,i,s)},c=()=>{for(const[t,e]of h.entries())for(const{eventType:i,callback:s}of e)t.removeEventListener(i,s);h.clear()},u=[];let d=[],f=[];const g=new Th(()=>i._n(s).Mn(Xe).wn(Xe)),p=new Th(()=>i.zd(s)),m=i.md(s).qe(r.getTheme().uiBackgroundFillStyle).setVisible(!1),y=m.Ho().bd({extent:8,c_x1_y1:!0,c_x1_y2:!0,c_x2_y1:!0,c_x2_y2:!0}),x=r.getTheme().uiButtonFillStyle,v=r.getTheme().uiButtonFillStyleHidden,A=r.getTheme().uiTextFillStyle,S=r.getTheme().uiTextFillStyleHidden,b=r.getTheme().uiTextFont,M=r.getTheme().uiBackgroundFillStyle,E=r.getTheme().uiBackgroundStrokeStyle,k=r.getTheme().uiButtonStrokeStyle,T=()=>{m.setVisible(!1),u.forEach(t=>t.setVisible(!1).Nh()),d.forEach(t=>t.setVisible(!1)),f.forEach(t=>t.setVisible(!1))},w=o=>{var h,d,f,m;c(),o.titleEvents.Vi(),o.backgroundEvents.Vi(),u.forEach(t=>t.dispose()),u.length=0;const y=g.VA(),M=p.VA(),E=null!==(h=o.marginInner)&&void 0!==h?h:0,T=o.marginOuter,w=o.chartPadding,C={left:T.left+w.left,right:T.right+w.right,top:T.top+w.top,bottom:T.bottom+w.bottom},B=r.getSizePixels();let F,D={x:-1,y:1};if("number"==typeof o.position)switch(o.position){case e.LegendPosition.TopLeft:case e.LegendPosition.TopCenter:case e.LegendPosition.TopRight:case e.LegendPosition.BottomLeft:case e.LegendPosition.BottomCenter:case e.LegendPosition.BottomRight:F={x:B.x-o.chartTitleSpace.left-o.chartTitleSpace.right-C.left-C.right,y:B.y-o.chartTitleSpace.top-o.chartTitleSpace.bottom-C.top-C.bottom};break;default:F={x:B.x-C.left-C.right,y:B.y-C.top-C.bottom}}else o.position.origin&&(D=o.position.origin),F={x:B.x-o.position.x*(D.x+1)/2,y:o.position.y*(D.y+1)/2};const R=void 0!==o.orientation?o.orientation===e.LegendOrientation.Vertical:"number"==typeof o.position&&o.position<6,L=null!==(d=o.padding)&&void 0!==d?d:{left:5,right:5,top:5,bottom:5},P=L.top+L.bottom,z=L.left+L.right,_=null!==(f=o.entryMargin)&&void 0!==f?f:10,V={left:_,right:_,top:_,bottom:_},N=t.panel.getTheme().uiButtonSize;let O=0,U=0,G=0,Y=0;const Z=[],W=o.title?y.add().Zl({x:-1,y:0}).tn(o.title).Ch(o.titleFont?new I(o.titleFont):b.setWeight("bold")).qe(null!==(m=o.titleFillStyle)&&void 0!==m?m:A).Mn(V):void 0;if(W){const t=W.setVisible(!0).Nh().bc();G=R?t.y:t.x+_,Y=R?t.x:t.y,O=t.x,U=t.y,o.titleEvents.zi(W)}const j=o.entries.filter(t=>!1!==t.options.show),H=j.map((t,o)=>{var h,c;const d=void 0!==t.options.text?t.options.text:t.component&&"getName"in t.component?t.component.getName():"",f=t.component&&t.component.getVisible?t.component.getVisible()?void 0!==t.options.textFillStyle?t.options.textFillStyle:A:S:void 0!==t.options.textFillStyle?t.options.textFillStyle:A,g=t.options.textFont?new I(t.options.textFont):b,p=y.add().Zl({x:-1,y:0}).tn(d).qe(f).Ch(g).Mn(V),m=void 0!==t.options.buttonShape?t.options.buttonShape:t.component&&t.component.js?t.component.js():e.PointShape.Circle,E=yr(m);E&&m.Js instanceof Image&&l(m.Js,"load",()=>{n.zs()});const T=t.component&&t.component.getVisible?t.component.getVisible()?void 0!==t.options.buttonFillStyle?t.options.buttonFillStyle:t.component&&t.component.er?Ie(r.getTheme(),t.options.matchStyleExactly||!1,t.component.er()):x:v:void 0!==t.options.buttonFillStyle?t.options.buttonFillStyle:t.component&&t.component.er?Ie(r.getTheme(),t.options.matchStyleExactly||!1,t.component.er()):x,w=null!==(h=t.options.buttonStrokeStyle)&&void 0!==h?h:k,C=void 0!==t.options.buttonSize?t.options.buttonSize:E?Math.max(m.kt().x,m.kt().y):d?N:0,B=void 0!==t.options.buttonRotation?t.options.buttonRotation:t.component&&t.component.getPointRotation?t.component.getPointRotation():0,D=M.add().YA({x:-1,y:0}).Hd(C).Gd(B);T&&D.Rd(T),void 0!==m&&D.Vd(m),D.Yd(w);const L=null===t.options.lut?void 0:t.options.lut?t.options.lut:t.component&&t.component.Ys?null===(c=t.component.Ys())||void 0===c?void 0:c.lut:void 0;let W;L&&(W=new Ta(i,s,s,()=>{},r.getTheme(),R?"vertical":"horizontal").xf(L),u.push(W),W.xf(L).setVisible(!0).Zl(R?"vertical":"horizontal").setFillStyle(f).setFont(g).setMargin(_).mf(Xe),t.options.lutLength&&W.bf(t.options.lutLength),t.options.lutThickness&&W.wf(t.options.lutThickness),t.options.lutDisplayProportionalSteps&&W.setLUTDisplayProportionalSteps(t.options.lutDisplayProportionalSteps),t.options.lutStepValueFormatter&&W.Tf(t.options.lutStepValueFormatter),L.units&&W.kf(L.units)),a.bs(p,t=>{p.Ii(t)},{animationEnabled:!0}),a.bs(D,t=>{D.Ii(t)},{animationEnabled:!0});const H=t.component&&_t(t.component)?t.component:void 0;H&&l(H,"highlightchange",t=>{const e=t.highlight;p.Ii(e),D.Ii(e),r.pi.Bs()}),[p,D].forEach(e=>{e&&(l(e,"pointerenter",()=>{!1!==t.options.highlight&&(H&&H.setHighlight(!0),p.Ii(1),D.Ii(1))}),l(e,"pointerleave",()=>{H&&H.setHighlight(!1),p.Ii(0),D.Ii(0)}))}),[p,D,W].forEach(i=>{i&&(l(i,"pointerenter",()=>{r.engine.setMouseStyle(e.MouseStyles.Point)}),l(i,"pointerleave",()=>{r.engine.clearMouseStyle()}),t.options.events&&Object.entries(t.options.events).forEach(([e,s])=>{l(i,e,e=>s(e,{entry:t,allEntries:j}))}),l(i,"click",()=>{n.zs(),r.pi.Bs()}))});const $=p.setVisible(!0).Nh().bc();let X={length:0,thickness:0};if(W){const t=W.Nh().getSize();X=R?{length:t.y,thickness:t.x}:{length:t.x,thickness:t.y}}const q=R?{width:(C?_+C:0)+Math.max($.x,X.thickness),height:Math.max(C,$.y)+X.length}:{width:(C?_+C:0)+$.x+X.length,height:Math.max(C,$.y,X.thickness)};return O=Math.max(q.width,O),U=Math.max(q.height,U),(R?G+q.height<F.y-P:G+q.width<F.x-z)?(Y=R?Math.max(q.width,Y):Math.max(q.height,Y),G+=R?q.height:q.width,o===j.length-1&&Z.push(R?{width:Y,height:0===Z.length?G:F.y-P}:{width:0===Z.length?G:F.x-z,height:Y})):(Z.push(R?{width:Y,height:F.y-P}:{width:F.x-z,height:Y}),G=R?q.height:q.width,o===j.length-1&&Z.push(R?{width:q.width,height:F.y-P}:{width:F.x-z,height:q.height}),Y=R?q.width:q.height),{text:d?p:void 0,button:d&&0!==C?D:void 0,buttonSize:C,lut:W}});return{entries:H,sectionSizes:Z,legendTitle:W,isVertical:R,availableChartSize:F,horizontalLegendPadding:z,verticalLegendPadding:P,marginInner:E,totalMarginOuter:C,maxEntryWidth:O,maxEntryHeight:U,chartSize:B,legendSpace:{left:0,right:0,top:0,bottom:0},origin:D,legendPadding:L,entryMarginValue:_,shapeProviderText:y,shapeProviderMarker:M}};return{update:t=>{if(!t.visible||t.renderOnTop)return Xe;const i=w(t);o=i;const{entries:s,sectionSizes:r,isVertical:n,availableChartSize:a,horizontalLegendPadding:h,verticalLegendPadding:l,marginInner:c,totalMarginOuter:u,maxEntryWidth:d,maxEntryHeight:f,legendSpace:g,shapeProviderText:p,shapeProviderMarker:m}=i;if(p.finishPlot(),m.finishPlot(),0===s.length&&0===r.length)return Xe;const y=Bh(n,r,h,l,a);if(t.autoHideThreshold&&Ch(t.autoHideThreshold,y,a,n,d,f))return Xe;const x={...g},v=t.chartPadding,A=Math.max(0,u.left-v.left),S=Math.max(0,u.right-v.right),b=Math.max(0,u.top-v.top),M=Math.max(0,u.bottom-v.bottom);switch(t.position){case e.LegendPosition.RightTop:case e.LegendPosition.RightCenter:case e.LegendPosition.RightBottom:x.right=y.width+c+S;break;case e.LegendPosition.LeftTop:case e.LegendPosition.LeftCenter:case e.LegendPosition.LeftBottom:x.left=y.width+c+A;break;case e.LegendPosition.TopLeft:case e.LegendPosition.TopCenter:case e.LegendPosition.TopRight:x.top=y.height+c+b;break;case e.LegendPosition.BottomLeft:case e.LegendPosition.BottomCenter:case e.LegendPosition.BottomRight:x.bottom=y.height+c+M}return x},plot:t=>{var i;if(!t.visible)return void T();const s=o||w(t);o=void 0;const{entries:r,sectionSizes:n,legendTitle:a,isVertical:h,availableChartSize:l,horizontalLegendPadding:c,verticalLegendPadding:u,chartSize:x,maxEntryWidth:v,maxEntryHeight:A,origin:S,legendPadding:b,entryMarginValue:k,shapeProviderText:C,shapeProviderMarker:B,totalMarginOuter:F}=s;if(d=g.Nn(),f=p.Nn(),0===r.length&&0===n.length)return T(),C.finishPlot(),void B.finishPlot();const D=Bh(h,n,c,u,l);if(t.autoHideThreshold&&Ch(t.autoHideThreshold,D,l,h,v,A))return T(),C.finishPlot(),void B.finishPlot();const I=(S.x+1)*D.width/2,R=(S.y+1)*D.height/2;d.forEach(t=>t.setVisible(!0)),f.forEach(t=>t.setVisible(!0));const L=t.chartTitleSpace;let P={leftBottom:{x:0,y:0},leftTop:{x:0,y:0},rightTop:{x:0,y:0},rightBottom:{x:0,y:0}};switch(t.position){case e.LegendPosition.RightTop:case e.LegendPosition.RightCenter:case e.LegendPosition.RightBottom:P={leftBottom:{x:x.x-D.width-F.right,y:0+F.bottom},leftTop:{x:x.x-D.width-F.right,y:x.y-F.top},rightTop:{x:x.x-F.right,y:x.y-F.top},rightBottom:{x:x.x-F.right,y:0+F.bottom}};break;case e.LegendPosition.LeftTop:case e.LegendPosition.LeftCenter:case e.LegendPosition.LeftBottom:P={leftBottom:{x:0+F.left,y:0+F.bottom},leftTop:{x:0+F.left,y:x.y-F.top},rightTop:{x:D.width+F.left,y:x.y-F.top},rightBottom:{x:D.width+F.left,y:0+F.bottom}};break;case e.LegendPosition.TopLeft:case e.LegendPosition.TopCenter:case e.LegendPosition.TopRight:P={leftBottom:{x:0+F.left,y:x.y-D.height-F.top-L.top},leftTop:{x:0+F.left,y:x.y-F.top-L.top},rightTop:{x:x.x-F.right,y:x.y-F.top-L.top},rightBottom:{x:x.x-F.right,y:x.y-D.height-F.top-L.top}};break;case e.LegendPosition.BottomLeft:case e.LegendPosition.BottomCenter:case e.LegendPosition.BottomRight:P={leftBottom:{x:0+F.left,y:0+F.bottom+L.bottom},leftTop:{x:0+F.left,y:D.height+F.bottom+L.bottom},rightTop:{x:x.x-F.right,y:D.height+F.bottom+L.bottom},rightBottom:{x:x.x-F.right,y:0+F.bottom+L.bottom}};break;default:P={leftBottom:{x:t.position.x-I,y:t.position.y-R},leftTop:{x:t.position.x-I,y:t.position.y-R+D.height},rightTop:{x:t.position.x-I+D.width,y:t.position.y-R+D.height},rightBottom:{x:t.position.x-I+D.width,y:t.position.y-R}}}if(t.backgroundVisible){let i={x:0,y:0};const s=D.width,r=D.height;switch(t.position){case e.LegendPosition.RightTop:i={x:x.x-D.width-F.right,y:x.y-D.height-F.top};break;case e.LegendPosition.RightCenter:i={x:x.x-D.width-F.right,y:x.y/2-D.height/2-F.top/2+F.bottom/2};break;case e.LegendPosition.RightBottom:i={x:x.x-D.width-F.right,y:0+F.bottom};break;case e.LegendPosition.LeftTop:i={x:0+F.left,y:x.y-D.height-F.top};break;case e.LegendPosition.LeftCenter:i={x:0+F.left,y:x.y/2-D.height/2-F.top/2+F.bottom/2};break;case e.LegendPosition.LeftBottom:i={x:0+F.left,y:0+F.bottom};break;case e.LegendPosition.TopLeft:i={x:0+F.left,y:x.y-D.height-F.top-L.top};break;case e.LegendPosition.TopCenter:i={x:x.x/2-D.width/2+F.left/2-F.right/2,y:x.y-D.height-F.top-L.top};break;case e.LegendPosition.TopRight:i={x:x.x-D.width-F.right,y:x.y-D.height-F.top-L.top};break;case e.LegendPosition.BottomLeft:i={x:0+F.left,y:0+F.bottom+L.bottom};break;case e.LegendPosition.BottomCenter:i={x:x.x/2-D.width/2+F.left/2-F.right/2,y:0+F.bottom+L.bottom};break;case e.LegendPosition.BottomRight:i={x:x.x-D.width-F.right,y:0+F.bottom+L.bottom};break;default:i={x:t.position.x-I,y:t.position.y-R}}y.Md(i.x,i.y,i.x+s,i.y+r)}t.backgroundEvents.zi(m),m.setVisible(null===(i=t.backgroundVisible)||void 0===i||i),m.qe(void 0!==t.backgroundFillStyle?t.backgroundFillStyle:M),m.Ke(void 0!==t.backgroundStrokeStyle?t.backgroundStrokeStyle:E);let z={x:0,y:0};switch(t.position){case e.LegendPosition.LeftTop:case e.LegendPosition.RightTop:z={x:P.leftTop.x,y:P.leftTop.y};break;case e.LegendPosition.LeftCenter:case e.LegendPosition.RightCenter:z={x:P.leftBottom.x,y:P.leftBottom.y+(P.leftTop.y-P.leftBottom.y)/2+D.height/2};break;case e.LegendPosition.LeftBottom:case e.LegendPosition.RightBottom:z={x:P.leftBottom.x,y:P.leftBottom.y+D.height};break;case e.LegendPosition.TopLeft:case e.LegendPosition.BottomLeft:z={x:P.leftTop.x,y:P.leftTop.y};break;case e.LegendPosition.TopCenter:case e.LegendPosition.BottomCenter:z={x:P.leftBottom.x+(P.rightBottom.x-P.leftBottom.x)/2-D.width/2,y:P.leftTop.y};break;case e.LegendPosition.TopRight:case e.LegendPosition.BottomRight:z={x:P.rightTop.x-D.width,y:P.leftTop.y};break;default:z={x:P.leftTop.x,y:P.leftTop.y}}z={x:z.x+b.left,y:z.y-b.top};const _={...z};let V=0,N=0;const O=[];let U=[];if(a){const t=a.bc();a.sr({...z,y:z.y-t.y/2}),N+=h?t.y:t.x+k,z=h?{...z,y:z.y-t.y}:{...z,x:z.x+t.x+k}}r.forEach(t=>{const e=t.text?t.text.bc():{x:0,y:0},i=t.button?t.buttonSize:0,s=t.lut||void 0,r=Fh(e,i,h,k,t.lut);N+r>=(h?n[V].height:n[V].width)&&n.length-1>V&&(O.push(U),U=[],V+=1,N=0),U.push({entry:t,textSize:e,buttonSize:i,lut:s,entryLength:r}),N+=r}),U.length>0&&O.push(U);const G=O.map((t,e)=>{const i=t.reduce((t,e)=>t+e.entryLength,0);if(0===e&&a){const t=a.bc();return i+(h?t.y:t.x+k)}return i});O.forEach((i,s)=>{let r;const o=G[s],l=O.length>1;if(0===s)if(l)if(h){const t=n[s].height-o;r={x:_.x,y:_.y-t/2}}else{const t=n[s].width-o;r={x:_.x+t/2,y:_.y}}else r={..._};else if(h){const i=n.slice(0,s).reduce((t,e)=>t+e.width,0),a=n[s].height;let h;if(l){const i=a-o;let s;switch(t.position){case e.LegendPosition.LeftTop:case e.LegendPosition.RightTop:s=P.leftTop.y-b.top;break;case e.LegendPosition.LeftCenter:case e.LegendPosition.RightCenter:s=P.leftBottom.y+(P.leftTop.y-P.leftBottom.y)/2+a/2;break;case e.LegendPosition.LeftBottom:case e.LegendPosition.RightBottom:s=P.leftBottom.y+a+b.bottom;break;default:s=_.y}h=s-i/2}else h=_.y;r={x:_.x+i,y:h}}else{const i=n.slice(0,s).reduce((t,e)=>t+e.height,0),a=n[s].width;let h;if(l){const i=a-o;let s;switch(t.position){case e.LegendPosition.TopLeft:case e.LegendPosition.BottomLeft:s=P.leftTop.x+b.left;break;case e.LegendPosition.TopCenter:case e.LegendPosition.BottomCenter:s=P.leftBottom.x+(P.rightBottom.x-P.leftBottom.x)/2-a/2;break;case e.LegendPosition.TopRight:case e.LegendPosition.BottomRight:s=P.rightTop.x-a-b.right;break;default:s=_.x}h=s+i/2}else h=_.x;r={x:h,y:_.y-i}}if(0===s&&a){const t=a.bc();h?(a.sr({x:r.x,y:r.y-t.y/2}),r={...r,y:r.y-t.y}):(a.sr({x:r.x,y:r.y-t.y/2}),r={...r,x:r.x+t.x+k})}let c={...r};i.forEach(t=>{Dh(c,t.entry.button,t.entry.text,t.lut,t.textSize,t.buttonSize,h,k),c=h?{...c,y:c.y-t.entryLength}:{...c,x:c.x+t.entryLength}})}),C.finishPlot(),B.finishPlot()},dispose:()=>{c(),g.UA(),p.UA(),m.dispose(),u.forEach(t=>t.dispose())}}},Ch=(t,e,i,s,r,n)=>(s?Math.ceil(e.width)>=Math.ceil(i.x*t):Math.ceil(e.height)>=Math.ceil(i.y*t))||r>i.x||n>i.y,Bh=(t,e,i,s,r)=>t?{width:e.reduce((t,e)=>t+e.width,0)+i,height:e.length>1?r.y:e[0].height+s}:{width:e.length>1?r.x:e[0].width+i,height:e.reduce((t,e)=>t+e.height,0)+s},Fh=(t,e,i,s=0,r)=>{if(r){const n=r.Nh().getSize(),o=i?{length:n.y,thickness:n.x}:{length:n.x,thickness:n.y};return i?Math.max(e,t.y)+o.length:(e?s+e:0)+t.x+o.length}return i?Math.max(e,t.y):(e?s+e:0)+t.x},Dh=(t,e,i,s,r,n,o,a=0)=>{let h,l;if(r.y>n?(h={x:t.x+(n?a:0),y:t.y-r.y/2},l={x:h.x+n,y:t.y-r.y/2}):(h={x:t.x+(n?a:0),y:t.y-n/2},l={x:h.x+n,y:t.y-n/2}),e&&e.Ed(new Vo({schema:{x:{},y:{}}}).appendSample(h),{x:"x",y:"y"}),i&&i.sr(l),s){const e=s.Nh().getSize(),i=o?{length:e.y,thickness:e.x}:{length:e.x,thickness:e.y},a=o?{x:l.x+i.thickness/2,y:t.y-Math.max(n,r.y)-i.length/2}:{x:l.x+r.x+i.length/2,y:t.y-i.thickness/2};s.setPosition(a),s.ir()}},Ih=t=>"Ys"in t;var Rh,Lh;e.LegendPosition=void 0,(Rh=e.LegendPosition||(e.LegendPosition={}))[Rh.RightTop=0]="RightTop",Rh[Rh.RightCenter=1]="RightCenter",Rh[Rh.RightBottom=2]="RightBottom",Rh[Rh.LeftTop=3]="LeftTop",Rh[Rh.LeftCenter=4]="LeftCenter",Rh[Rh.LeftBottom=5]="LeftBottom",Rh[Rh.TopLeft=6]="TopLeft",Rh[Rh.TopCenter=7]="TopCenter",Rh[Rh.TopRight=8]="TopRight",Rh[Rh.BottomLeft=9]="BottomLeft",Rh[Rh.BottomCenter=10]="BottomCenter",Rh[Rh.BottomRight=11]="BottomRight",e.LegendOrientation=void 0,(Lh=e.LegendOrientation||(e.LegendOrientation={}))[Lh.Horizontal=0]="Horizontal",Lh[Lh.Vertical=1]="Vertical";const Ph={toggleIndividualVisibility:(t,e)=>{if(!e.entry.component||!e.entry.component.getVisible||!e.entry.component.setVisible)return;const i=e.entry.component.getVisible();e.entry.component.setVisible(!i)},focusClicked:(t,e)=>{if(!e.entry.component||!e.entry.component.getVisible||!e.entry.component.setVisible)return;let i=!1;e.allEntries.forEach(t=>{t.component&&t.component.getVisible&&t.component.getVisible()&&t!==e.entry&&(i=!0)}),e.allEntries.forEach(t=>{t.component&&t.component.setVisible&&t.component.setVisible(!i)}),e.entry.component.setVisible(!0)},doNothing:()=>{}};class zh{constructor(t,i,s,r,n,o){var a;this.jA=[],this.HA=!0,this.Ln=e.LegendPosition.BottomCenter,this.Yr=void 0,this.WA=!1,this.XA=!1,this.ZA=!0,this.JA=!1,this.QA={left:0,right:0,top:0,bottom:0},this.ci=!1,this.KA=5,this.qA={x:0,y:0},this.tg=!0,this.ig=.5,this.sg=[],this.eg=!1,this.title=new vt,this.background=new vt,this.rg=i,this.hg=null!==(a=i.getTheme().panelPadding)&&void 0!==a?a:7,this.ng={events:{click:Ph.toggleIndividualVisibility}},t!==wh&&(this.WA=!0);const h=this.WA?{panel:i}:{panel:i,layer:s,scale:r,legend:this};this.og=t(h),n&&(this.jA=n),o&&this.setOptions(o),this.rg.pi.Bs();const l=()=>{Ut.setTimeout(()=>{this.zs(),this.rg.pi.Bs()},0)};Ut.setTimeout(()=>{this.ci||this.rg.addEventListener("resize",l)},0),this.ag=()=>{this.rg.removeEventListener("resize",l)}}lg(t,i){const s=t&&"number"==typeof t?{...Xe,top:t}:t&&"number"!=typeof t?t:Xe;let r={visible:this.jA.length>0&&this.HA,chartTitleSpace:s,marginOuter:this.QA,chartPadding:i,titleEvents:this.title,backgroundEvents:this.background,position:this.Ln,orientation:this.ug,padding:this.Gn?this.Gn:this.XA?{left:5,right:5,top:5,bottom:5}:Xe,entryMargin:this.KA,marginInner:this.hg,renderOnTop:this.JA,title:this.Yr,titleFont:this.cg,titleFillStyle:this.dg,backgroundVisible:this.XA,backgroundFillStyle:this.Ag,backgroundStrokeStyle:this.gg,autoHideThreshold:this.ig,entries:this.jA};if(this.WA){const t=this.rg.getTheme().uiTextFillStyle,i=this.rg.getTheme().uiButtonFillStyle,s=this.rg.getTheme().uiTextFont,n=this.jA.map(r=>{var n,o,a,h,l;return{component:r.component,options:{...r.options,show:null===(n=r.options.show)||void 0===n||n,text:null!==(o=r.options.text)&&void 0!==o?o:r.component&&r.component.getName?r.component.getName():"",textFont:r.options.textFont?r.options.textFont:s,textFillStyle:r.options.textFillStyle?r.options.textFillStyle:t,buttonSize:null!==(a=r.options.buttonSize)&&void 0!==a?a:10,buttonShape:null!==(h=r.options.buttonShape)&&void 0!==h?h:e.PointShape.Circle,buttonRotation:null!==(l=r.options.buttonRotation)&&void 0!==l?l:0,buttonFillStyle:r.component&&r.component.er?Ie(this.rg.getTheme(),r.options.matchStyleExactly||!1,r.component.er()):i,events:{click:Ph.toggleIndividualVisibility,...r.options.events}}}});r={...r,entries:n}}return r}pg(){let t=!1;const e=this.rg.getSizePixels(),i=this.rg.getMinimumSize(),s=void 0===i||e.x>i.x&&e.y>i.y;return e.x===this.qA.x&&e.y===this.qA.y&&s||(t=!0),this.qA=e,t}vg(){const t=this.jA.map(t=>({entryText:t.component&&t.component.getName?t.component.getName():void 0,buttonShape:t.component&&t.component.js?t.component.js():void 0,legendStyle:t.component&&t.component.er?t.component.er():void 0}));if(this.sg.length!==t.length)return this.sg=t,!0;const e=t.some((t,e)=>{var i,s,r,n;const o=this.sg[e];if(t.entryText!==o.entryText)return!0;if(t.buttonShape!==o.buttonShape)return!0;if(t.legendStyle&&o.legendStyle){if(t.legendStyle.fill!==o.legendStyle.fill)return!0;if(t.legendStyle.fill2!==o.legendStyle.fill2)return!0;if(t.legendStyle.stroke!==o.legendStyle.stroke)return!0;if(t.legendStyle.point3D!==o.legendStyle.point3D)return!0;if((null===(i=t.legendStyle.behavior)||void 0===i?void 0:i.colorStep)!==(null===(s=o.legendStyle.behavior)||void 0===s?void 0:s.colorStep))return!0;if((null===(r=t.legendStyle.behavior)||void 0===r?void 0:r.priority)!==(null===(n=o.legendStyle.behavior)||void 0===n?void 0:n.priority))return!0;if(t.legendStyle.lutValue!==o.legendStyle.lutValue)return!0}});return this.sg=t,e}yg(){this.eg||this.Ln===e.LegendPosition.RightCenter||this.jA.some(t=>{var e;return!!(t.component&&t.component.Ys&&(null===(e=t.component.Ys())||void 0===e?void 0:e.lut)||ns(t.component)||t.options.lut)})&&(this.Ln=e.LegendPosition.RightCenter,this.tg=!0)}Nh(t,e){var i;if(this.ci)return Xe;if((this.pg()||this.vg())&&(this.tg=!0),this.yg(),!this.tg&&!this.WA)return null!==(i=this.mg)&&void 0!==i?i:Xe;const s=this.lg(t,e),r=this.og.update(s);return this.mg=r||Xe,this.mg}ir(t,e){if(!this.ci&&this.tg){const i=this.lg(t,e);this.og.plot(i),this.tg=!1}}bu(t,e){if(void 0===t||!this.jA.some(e=>e.component===t)){if(this.jA.push({component:t,options:{...this.ng,...e}}),t instanceof Ps){const e=()=>{this.zs(),this.rg.pi.Bs()},i=()=>{t.removeEventListener("dispose",i),t.removeEventListener("visiblechange",e),this.remove(t),this.rg.pi.Bs()};t.addEventListener("visiblechange",e),t.addEventListener("dispose",i)}return this.tg=!0,this}}xg(){return this.ZA}zs(){return this.tg=!0,this}Sg(t){const e=(t=Array.isArray(t)?t:[t]).map(t=>Ih(t)?this.jA.find(e=>e.component===t):this.jA.find(e=>{var i,s,r;return(null===(i=e.component)||void 0===i?void 0:i.Ys)&&(null===(r=null===(s=e.component)||void 0===s?void 0:s.Ys())||void 0===r?void 0:r.lut)===t})).filter(t=>void 0!==t),i=this.jA.filter(t=>!e.includes(t));return this.jA=[...e,...i],this.tg=!0,this.rg.pi.Bs(),this}add(t,e){return void 0===t&&void 0===e||(t instanceof Oh?t.bg().forEach(t=>this.bu(t,e)):t&&!Ih(t)?this.bu({Ys:()=>({lut:t})},e):this.bu(t,e),this.tg=!0,this.rg.pi.Bs()),this}remove(t){const e=this.jA.find(e=>e.component===t);if(e){const t=this.jA.indexOf(e);this.jA.splice(t,1)}return this.tg=!0,this.rg.pi.Bs(),this}clear(){return this.jA=[],this.tg=!0,this.rg.pi.Bs(),this}dispose(){return this.ci||(this.ci=!0,this.ag(),this.og.dispose&&this.og.dispose(),this.tg=!0,this.rg.pi.Bs()),this}setOptions(t){var e,i,s,r,n,o,a,h;return void 0!==t.addEntriesAutomatically&&(this.ZA=t.addEntriesAutomatically),void 0!==t.position&&(this.Ln=t.position,this.eg=!0),void 0!==t.orientation&&(this.ug=t.orientation),void 0!==t.padding&&("number"==typeof t.padding?this.Gn={left:t.padding,right:t.padding,top:t.padding,bottom:t.padding}:this.Gn={left:null!==(e=t.padding.left)&&void 0!==e?e:0,right:null!==(i=t.padding.right)&&void 0!==i?i:0,top:null!==(s=t.padding.top)&&void 0!==s?s:0,bottom:null!==(r=t.padding.bottom)&&void 0!==r?r:0}),void 0!==t.marginOuter&&("number"==typeof t.marginOuter?this.QA={left:t.marginOuter,right:t.marginOuter,top:t.marginOuter,bottom:t.marginOuter}:this.QA={left:null!==(n=t.marginOuter.left)&&void 0!==n?n:0,right:null!==(o=t.marginOuter.right)&&void 0!==o?o:0,top:null!==(a=t.marginOuter.top)&&void 0!==a?a:0,bottom:null!==(h=t.marginOuter.bottom)&&void 0!==h?h:0}),void 0!==t.entryMargin&&(this.KA=t.entryMargin),void 0!==t.marginInner&&(this.hg=t.marginInner),void 0!==t.renderOnTop&&(this.JA=t.renderOnTop),void 0!==t.title&&(this.Yr=t.title),void 0!==t.titleFont&&(this.cg=t.titleFont),void 0!==t.titleFillStyle&&(this.dg=t.titleFillStyle),void 0!==t.visible&&(this.HA=t.visible),void 0!==t.backgroundVisible&&(this.XA=t.backgroundVisible),void 0!==t.backgroundFillStyle&&(this.Ag=t.backgroundFillStyle),void 0!==t.backgroundStrokeStyle&&(this.gg=t.backgroundStrokeStyle),void 0!==t.autoHideThreshold&&(this.ig=t.autoHideThreshold),void 0!==t.entries&&(this.ng={...this.ng,...t.entries},this.jA.forEach(t=>{t.options={...this.ng,...t.options}})),this.tg=!0,this.rg.pi.Bs(),this}getOptions(){return{addEntriesAutomatically:this.ZA,position:this.Ln,orientation:this.ug,padding:this.Gn,marginOuter:this.QA,entryMargin:this.KA,marginInner:this.hg,renderOnTop:this.JA,title:this.Yr,titleFont:new I(this.cg),titleFillStyle:this.dg,visible:this.HA,backgroundVisible:this.XA,backgroundFillStyle:this.Ag,backgroundStrokeStyle:this.gg,autoHideThreshold:this.ig,entries:this.ng}}setEntryOptions(t,e){const i=Ih(t)?this.jA.find(e=>e.component===t):this.jA.find(e=>{var i,s,r;return(null===(i=e.component)||void 0===i?void 0:i.Ys)&&(null===(r=null===(s=e.component)||void 0===s?void 0:s.Ys())||void 0===r?void 0:r.lut)===t});return i&&(i.options={...i.options,...e}),this.tg=!0,this.rg.pi.Bs(),this}getEntryOptions(t){const e=Ih(t)?this.jA.find(e=>e.component===t):this.jA.find(e=>{var i,s,r;return(null===(i=e.component)||void 0===i?void 0:i.Ys)&&(null===(r=null===(s=e.component)||void 0===s?void 0:s.Ys())||void 0===r?void 0:r.lut)===t});if(e)return e.options}getEntries(){return this.jA}}class _h{constructor(t,e,i,s,r,n,o,a,h){this.coordsRelative="relative",this.coordsClient="client",this.Mg=[],this.Os=[],this.wg=void 0,this._g=void 0,this.kg=void 0,this.ot=y(0,0,0,0),this.Cg=!1,this.ci=!1,this.Tg=()=>{this.Fg=!0,this.Ig.Bs()},this.Lg=t=>e=>{const i=this.Mg.indexOf(e);-1!==i&&this.Mg.splice(i,1),this.pi.Bs(),t.G()},this.Fg=!0,this.background=new vt,this.Pg=t,this.Bg=i,this.Ig=s,this.removePanel=r,this.bi=e.pi.bi;const c=e.pi.kt();this.uiScale=i.d2({scaleXYConstructor:q}).ii(0,100).si(0,100).Z(c),this.eA=i.d2({scaleXYConstructor:q}).ii(0,this.uiScale.x.getCellSize()).si(0,this.uiScale.y.getCellSize()).Z(c),this.engine=e.pi.Dg,this.pi=e.pi.Mc,this.vs=this.pi.vs.ys(this,{}),this.Eg=()=>e.Rg("unidentified ui"),this.Og=e.zg(),this.Vg=this.Ig.tr(this.uiScale).sr(l(0,0)).Z(l(100,100)).qe(n).Ke(o),this.background.zi(this.Vg),a?(a.addEventListener("resize",this.Tg),this.Ng=()=>a.removeEventListener("resize",this.Tg)):(e.pi.O("resize",this.Tg),this.Gg=()=>e.pi.N("resize",this.Tg));const u=t=>{this.Cg=t.isInView,this.D.R("inviewchanged",{isInView:this.Cg})};e.pi.O("inviewchanged",u),this.$g=()=>e.pi.N("inviewchanged",u),this.wg=r,this.legend=new zh(null!=h?h:wh,this,this.Og,this.eA),this.Os=[this.legend]}getTheme(){return this.bi}getSizePixels(){return this.eA.getInnerIntervalPixels()}setBackgroundFillStyle(t){return this.Vg.qe(t),this.Ig.Bs(),this}getBackgroundFillStyle(){return this.Vg.Mh()}setBackgroundStrokeStyle(t){return this.Vg.Ke(t),this.Ig.Bs(),this}getBackgroundStrokeStyle(){return this.Vg.Ja()}translateCoordinate(t,e,i){return kh(t,e,i,this.eA,this.pi)}Ug(t){return this.Mg.push(t),this.pi.Bs(),t}addUIElement(t=ya,e=this.uiScale){e=Eh(e,this.eA);const i=this.Eg();return this.Ug(Mh(t,i,this.uiScale,e,this.Lg(i),this.bi))}dispose(){return this.ci||(this.ci=!0,this.Gg&&this.Gg(),this.Ng&&this.Ng(),Vh(this.uiScale),Vh(this.eA),this.$g&&this.$g(),this._g&&this._g(),this.Ig.G(),this.Og.G(),this.Mg.slice().forEach(t=>{t.dispose()}),this.Os.forEach(t=>t.dispose()),this.pi.Bs(),this.wg&&this.wg(this),this.D.R("dispose",{})),this}isDisposed(){return this.ci}saveToFile(t,e,i,s){return bh(this.engine,t,e,i,s),this}Mn(t){this.ot=t,this.Tg()}j(){return this.eA.j(),this.uiScale.j(),this}H(){return this.eA.H(),this.uiScale.H(),this}ir(t){if(this.Fg){const t=this.Ig.pi.kt(),e=t.x,i=t.y;this.uiScale.Z(e,i),this.eA.Z(e,i);const s=[this.ot.left,this.ot.right],r=[this.ot.bottom,this.ot.top];this.uiScale.qt(s),this.uiScale.ti(r);const n=this.uiScale.getInnerIntervalPixels();this.eA.ii(0,n.x).qt(s).si(0,n.y).ti(r),this.D.R("resize",{width:n.x,height:n.y,engineHeight:i,engineWidth:e})}this.Fg=!1}Yg(){for(let t=0;t<this.Mg.length;t+=1)this.Mg[t].Nh().ir();this.kg&&this.kg()}jg(t,e){if(t){const i=t(e);this.addEventListener("resize",i.Nh.bind(i)),this._g=i.G.bind(i),this.kg=i.Nh.bind(i)}}getIsInView(){return this.Cg}}const Vh=t=>{t.xt&&t.xt()};class Nh extends _h{constructor(t,i,s,r,n,o,a){super(t,i,s,i.Hg("uipanel bg",0),r,i.pi.bi.uiPanelBackgroundFillStyle,i.pi.bi.uiPanelBackgroundStrokeStyle,o),this.D=new vt,this.legend.setOptions({position:e.LegendPosition.LeftTop,...a}),this.jg(n,this.eA)}setMinimumSize(t){return this.Jd=t,this.pi.Bs(),this}getMinimumSize(){return this.Jd}ir(t){this.Os.forEach(t=>t.Nh(0,Xe)),super.ir(t),super.Yg(),this.Os.forEach(t=>t.ir(0,Xe))}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Oh extends _h{constructor(t,i,s,r,n,o,a,h,c,u,d,f){super(t,i,s,r,n,o,a,d,f),this.Wg={},this.Er=!0,this.Xg={left:!1,top:!1,right:!1,bottom:!1},this.title=new vt,this.Zg=i.Jg("chart internal ui",0),this.Gn=void 0!==this.bi.panelPadding?{left:this.bi.panelPadding,right:this.bi.panelPadding,top:this.bi.panelPadding,bottom:this.bi.panelPadding}:{left:7,right:7,top:7,bottom:7},this.Yr=this.Zg._n(this.uiScale).tn("Chart").sr(l(50,100)).Zl(l(0,1)).Ch(h).qe(c).setPointerEvents(!1).qh(u),this.Yr.Zr=e.TextObjectIdentifier.ChartTitle,this.title.zi(this.Yr),this.Qg=this.vs.aA([this.Yr]).Ps(this.bi.effectsText)}addLegend(t){var e;let i;(t={addEntriesAutomatically:!1,backgroundVisible:!0,...t}).addEntriesAutomatically&&this.legend&&(i=this.legend.getEntries());const s=null!==(e=t.customLegend)&&void 0!==e?e:wh,r=new zh(s,this,this.Og,this.eA,i,t);return this.Os.push(r),this.pi.Bs(),r}setAnimationsEnabled(t){return this.Er=t,this}getAnimationsEnabled(){return this.Er}setTitle(t){return this.Yr.tn(t),this.pi.Bs(),this}getTitle(){return this.Yr.rn()}getTitleSize(){return this.Yr.Nh().bc()}setTitleFillStyle(t){return this.Yr.qe(t),this.Tg(),this}getTitleFillStyle(){return this.Yr.Mh()}setTitleShadow(t){return this.Yr.qh(t),this.pi.Bs(),this}getTitleShadow(){return this.Yr.Gl()}setTitleFont(t){return this.Yr.Ch(t),this.Tg(),this}getTitleFont(){return this.Yr.kh()}setTitleRotation(t){return this.Yr.Th(t),this.pi.Bs(),this}getTitleRotation(){return this.Yr.Fh()}setTitleEffect(t){return this.Qg.Ps(t),this.pi.Bs(),this}getTitleEffect(){return this.Qg.Ds()}setTitleMargin(t){var e,i;return this.Wg="object"==typeof t?this.Wg?(e=this.Wg,{left:void 0!==(i=t).left?i.left:e.left,top:void 0!==i.top?i.top:e.top,right:void 0!==i.right?i.right:e.right,bottom:void 0!==i.bottom?i.bottom:e.bottom}):t:{left:t,top:t,right:t,bottom:t},this.Tg(),this}getTitleMargin(){return this.Wg}wn(t,e){const i="object"==typeof t?v(this.Gn,t):{left:t,top:t,right:t,bottom:t};return i.bottom===this.Gn.bottom&&i.left===this.Gn.left&&i.right===this.Gn.right&&i.top===this.Gn.top||(Object.entries(t).forEach(t=>{const i=t[0],s=t[1];void 0===s||!e&&this.Xg[i]||(this.Gn[i]=s,this.Xg[i]=e)}),this.Tg()),this}setPadding(t){return this.wn("object"==typeof t?t:{left:t,top:t,right:t,bottom:t},!0),this}getPadding(){return this.Gn}Kg(t){const e=t.qg(),i=null==e?void 0:e.height,s=null==e?void 0:e.width;if(void 0!==i&&void 0!==s)return{x:i/2,y:s/2}}dispose(){return super.dispose(),this.Zg.G(),this}}const Uh={tp(t,e){var i,s;return t.Mh()!==ls&&0!==t.rn().length&&t.getVisible()?t.Nh().bc().y+(null!==(i=e.bottom)&&void 0!==i?i:10)+(null!==(s=e.top)&&void 0!==s?s:10):0},ip(t,e,i,s,r){var n;const o=r&&r.left?r.left:0,a=r&&r.right?r.right:0,h={x:50,y:100-i.y*(s.top+(null!==(n=e.top)&&void 0!==n?n:10))};t.sr(h).Zl({x:0,y:1}).Mn({top:0,bottom:0,right:s.right+(e.right||0)+a,left:s.left+(e.left||0)+o})}};class Gh extends Ps{constructor(t,e,i,s,r){super(t,e,s,r),this.sp=Ks,this.ep=!0,this.rp=!0,this.hp=!0,this.chart=t,this.np=i,this.gs=new Map,this.axisX=t.axisX,this.axisY=t.axisY,this.axisZ=t.axisZ}Qi(t,e,i){const s=null==t?void 0:t.dataPoint;if(s)return{cursorPosition:{resultTable:this.chart.translateCoordinate(e,this.chart.coordsRelative),resultTableScale:this.chart.eA,axisLocation:s},...s,series:this,axisX:this.chart.getDefaultAxisX(),axisY:this.chart.getDefaultAxisY(),axisZ:this.chart.getDefaultAxisZ()}}setCursorEnabled(t){return this.ep=t,this}getCursorEnabled(){return this.ep}setCursorFormattingOverride(t){return this.op=t,this}getCursorFormattingOverride(){return this.op}ap(){return this.getCursorEnabled()}setAutoScrollingEnabled(t){return this.rp=t,this.chart.pi.Bs(),this}getAutoScrollingEnabled(){return this.rp}setColorShadingStyle(t){return this.sp=t,this.gs.forEach((e,i)=>i.lp(t)),this.np.Bs(),this}getColorShadingStyle(){return this.sp}setDepthTestEnabled(t){return this.hp=t,this.gs.forEach((e,i)=>i.up(t)),this.np.Bs(),this}getDepthTestEnabled(){return this.hp}cp(){}ir(){}dp(){}getXMax(){const t=this.Cc;return t?t.Wi():0}getXMin(){const t=this.Cc;return t?t.Hi():0}getYMax(){const t=this.Cc;return t?t.Zi():0}getYMin(){const t=this.Cc;return t?t.Xi():0}getZMax(){const t=this.Cc;return t?t.ye():0}getZMin(){const t=this.Cc;return t?t.ve():0}gn(){const t=this.Cc;return t?d(t.uu(),t.cu(),t.fp()):d(0,0,0)}}class Yh extends Gh{constructor(t,e,i,s,r,n){super(t,e,i,s,n),this.Rs="Box Series 3D",this.Ap=.25,this.gp=!1,this.D=new vt,this.Ze=ze(this.bi.boxSeries3DFillStyle,r),this.Cc=this.np.vp().up(this.hp).qe(this.Ze).pp(this.Ap).Ii(this.getHighlight()),this._s(this.Cc)}yp(){return this.gp}invalidateData(t){const e=t.length;if(0===e)return this;this.gp&&this.chart.pi.La(Hn.Ro);const i=t[0];if(!i)return this;let s;if("xMin"in i||"yMin"in i||"zMin"in i||"xMax"in i||"yMax"in i||"zMax"in i){s=[];for(let i=0;i<e;i+=1){const e=t[i],r="xMin"in e&&"xMax"in e,n="yMin"in e&&"yMax"in e,o="zMin"in e&&"zMax"in e;s[i]={color:e.color,value:e.value,id:e.id,xCenter:r?(e.xMin+e.xMax)/2:void 0,yCenter:n?(e.yMin+e.yMax)/2:void 0,zCenter:o?(e.zMin+e.zMax)/2:void 0,xSize:r?e.xMax-e.xMin:void 0,ySize:n?e.yMax-e.yMin:void 0,zSize:o?e.zMax-e.zMin:void 0}}}else s=t;return this.Cc.mp(s.slice()),this.chart.pi.Bs(),this.gp=!0,this}clear(){return this.Cc.Vi(),this.gp=!1,this.chart.pi.Bs(),this}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.Cc.qe(t),this.chart.pi.Bs(),this}getFillStyle(){return this.Ze}setRoundedEdges(t){return void 0!==t&&isNaN(t)&&(console.error("'BoxSeries3D.setRoundedEdges | NaN was supplied.'"),t=void 0),this.Ap=void 0!==t?$t(t,0,1):void 0,this.Cc.pp(this.Ap),this.np.Bs(),this}getRoundedEdges(){return this.Ap}xp(){return this.rp&&this.getVisible()}rr(t,e){t.Ii(e),this.chart.pi.Bs()}Ys(){return Re(this.Ze,this.Cc._i())}ir(){super.ir(),this.Cc.Nh(!1)}er(){return{fill:this.Ze}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Zh=t=>{if(cr(t)){const e=t.getThickness(),i=t.getFillStyle();if(gs(i))return 1===e?tr:new ir({size:e,fillStyle:i,shape:"sphere"})}return tr},Wh={UserSeries:{type:"ApplicationType",args:{type:"UserSeries"}},InternalUI:{type:"ApplicationType",args:{type:"InternalUI"}}};class jh{constructor(t,e,i,s,r,n,o,a,h,l){this.M=0,this.di=!0,this.ci=!1,this.ui=!0,this.D=new vt,this.Bs=t,this.Sp=e,this.bp=i,this.Mp=s,this.wp=r,this._p=n,this.cf=o,this.kp=a,this.Cp=h,this.co=l}setValue(t){return t===this.M||(this.M=t,this.Bs(),this.D.R("valuechange",{value:this.M})),this}getValue(){return this.M}setTickStyle(t){return this.bp="function"==typeof t?t(this.bp):t,this.Bs(),this}getTickStyle(){return this.bp}setTickLength(t){return this.Mp=t,this.Bs(),this}getTickLength(){return this.Mp}setGridStrokeStyle(t){return this.wp="function"==typeof t?t(this.wp):t,this.Bs(),this}getGridStrokeStyle(){return this.wp}setTextPadding(t){return this._p=t,this.Bs(),this}getTextPadding(){return this._p}setTextRotation(t){return this.cf=t,this.Bs(),this}getTextRotation(){return this.cf}setTextFillStyle(t){return this.kp="function"==typeof t?t(this.kp):t,this.Bs(),this}getTextFillStyle(){return this.kp}setTextFont(t){return this.Cp="function"==typeof t?t(this.Cp):t,this.Bs(),this}getTextFont(){return this.Cp}setTextFormatter(t){return this.co=t,this.Bs(),this}dispose(){return this.ci||(this.ci=!0,this.Sp(),this.Bs(),this.D.R("dispose",{})),this}isDisposed(){return this.ci}setVisible(t){const e=this.di!==t;return this.di=t,e&&(this.D.R("visiblechange",{isVisible:this.di}),this.Bs()),this}getVisible(){return this.di}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.ui=t,this.Bs(),this}getPointerEvents(){return this.ui}}class Hh extends jh{constructor(t,e,i,s,r,n,o,a,h,l,c,u,d){super(t,e,i,s,r,n,o,a,h,l),this.Ag=c,this.gg=u,this.Gn=d}setBackgroundFillStyle(t){return this.Ag="function"==typeof t?t(this.Ag):t,this.Bs(),this}getBackgroundFillStyle(){return this.Ag}setBackgroundStrokeStyle(t){return this.gg="function"==typeof t?t(this.gg):t,this.Bs(),this}getBackgroundStrokeStyle(){return this.gg}setPadding(t){return this.Gn="number"==typeof t?{left:t,top:t,right:t,bottom:t}:{...this.Gn,...t},this.Bs(),this}getPadding(){return this.Gn}}class $h{constructor(t,e,i,s){this.Tp=[],this.Fp=new Map,this.Ip=t,this.Lp=e,this.Pp=i,this.dp=s}VA(){this.Pp&&this.Pp();const t=[];return{add:(e,i)=>{t.push({instanceUniqueProperties:e,instanceSharedProperties:i})},finishPlot:()=>{const e=[];let i=[];t.forEach(t=>{const i=e.find(e=>((t,e)=>{const i=Object.keys(t);for(const s of i)if(t[s]!==e[s])return!1;return!0})(e.sharedProperties,t.instanceSharedProperties));i?i.instances.push(t.instanceUniqueProperties):e.push({sharedProperties:t.instanceSharedProperties,instances:[t.instanceUniqueProperties]})});const s=this.Tp.slice(),r=[];e.forEach(t=>{let e=s.shift();e||(e=this.Ip(),this.Tp.push(e));const n=[],o=e.Bp().slice();t.instances.forEach(t=>{const e=o.shift();n.push({...t,existingMember:e})});const a=this.Lp(e,n,t.sharedProperties);i=Be(i,a,{canReturnB:!0});for(let i=0;i<t.instances.length;i+=1)r.push({xi:t.instances[i].xi,collection:e,member:a[i]});o.forEach(t=>{null==e||e.Zd(t)})}),s.forEach(t=>{t.dispose();const e=this.Tp.indexOf(t);e<0?_e(0,()=>{}):this.Tp.splice(e,1)}),r.forEach(t=>{const e=this.Fp.get(t.xi);e&&t.collection.pi.Ua({entity:e.collection,collectionMember:e.member},{entity:t.collection,collectionMember:t.member})}),this.Fp.clear(),r.forEach(t=>{this.Fp.set(t.xi,t)}),this.dp&&this.dp(this.Tp,i)}}}UA(){this.Tp.forEach(t=>{t.dispose()}),this.Tp.length=0}}class Xh extends Rn{constructor(t,e,i,s,r,n,o,a,h){super(t,e,i,s,a,{numeric:e.Dp({x:t.pi.bi.xAxis3DNumericTicks,y:t.pi.bi.yAxis3DNumericTicks,z:t.pi.bi.zAxis3DNumericTicks}),datetime:e.Dp({x:t.pi.bi.xAxis3DDateTimeTicks,y:t.pi.bi.yAxis3DDateTimeTicks,z:t.pi.bi.zAxis3DDateTimeTicks}),time:e.Dp({x:t.pi.bi.xAxis3DTimeTicks,y:t.pi.bi.yAxis3DTimeTicks,z:t.pi.bi.zAxis3DTimeTicks})},{type:"linear"}),this.Bf=[],this.D=new vt,this.chart=t,this.np=r,this.Ep=n,this.Rp=o,this.Op=this.np.ai;const l=this.oh.Dp({x:this.bi.xAxis3DStrokeStyle,y:this.bi.yAxis3DStrokeStyle,z:this.bi.zAxis3DStrokeStyle});this.zp=this.np.Np([Wh.InternalUI],void 0).cr(l).Vp(Zh(l)).setPointerEvents(!1),this.Jr=this.Ep._n(this.Rp).setPointerEvents(!1).qe(e.Dp({x:t.pi.bi.xAxis3DTitleFillStyle,y:t.pi.bi.yAxis3DTitleFillStyle,z:t.pi.bi.zAxis3DTitleFillStyle})).Ch(e.Dp({x:t.pi.bi.xAxis3DTitleFont,y:t.pi.bi.yAxis3DTitleFont,z:t.pi.bi.zAxis3DTitleFont})).nl(3),this.Gp=new Th(()=>this.Ep._n(this.Rp).nl(2).wn(Xe).Mn(Xe)),this.$p=new $h(()=>this.Ep.Yp(this.Rp).setPointerEvents(!1).nl(1),(t,e,i)=>(t.qe(i.fillStyle).Ke(i.strokeStyle),e.map(({positions:e,existingMember:i})=>{const s=i||t.Ho();return s.au(e),s}))),this.jp=new $h(()=>this.np.bA().setPointerEvents(!1),(t,e,i)=>(t.Vi().cr(i.lineStyle),e.map(({positions:e,existingMember:i})=>i||t.bu(e)))),this.vs=h,this.Ih=this.vs.aA([this.Jr]).Ps(s.effectsText),i.Jf=this}setTickStrategy(t,e){return super.fh(t,e)}getTickStrategy(){return this.Lr}addCustomTick(){const t=new Hh(()=>this.chart.pi.Bs(),()=>{const e=this.Bf.indexOf(t);e>=0&&this.Bf.splice(e,1)},this.bi.xAxis3DNumericTicks.majorTickStyle.tickStyle,this.bi.xAxis3DNumericTicks.majorTickStyle.tickLength,this.bi.xAxis3DNumericTicks.majorTickStyle.gridStrokeStyle,this.bi.xAxis3DNumericTicks.majorTickStyle.tickPadding,this.bi.xAxis3DNumericTicks.majorTickStyle.labelRotation,this.bi.xAxis3DNumericTicks.majorTickStyle.labelFillStyle,this.bi.xAxis3DNumericTicks.majorTickStyle.labelFont,t=>this.formatValue(t),ls,Bt,{left:4,right:4,top:4,bottom:4});return this.Bf.push(t),this.chart.pi.Bs(),t}getCustomTicks(){return[...this.Bf]}setStrokeStyle(t){return this.zp.cr(t).Vp(Zh(this.zp.do())),this.chart.pi.Bs(),this}getStrokeStyle(){return this.zp.do()}setVisible(t){return super.setVisible(t),this.zp.setVisible(t),!1===t&&(this.jp.UA(),this.Gp.UA(),this.$p.UA()),this.np.Bs(),this}gA(){return this.chart.getSeries()}xn(t,e,i){const s=Math.abs(this.ai.J(Math.abs(e-t))*this.np.Hp(1));return{start:t+i.start*s*Math.sign(t-e),end:e+i.end*s*Math.sign(e-t)}}Yh(t){const e=this.Op,i=d(e.x.tt(),e.y.tt(),e.z.tt()),{gridlinePositionA:s,gridlinePositionB:r,gridlinePositionC:n}=this.oh.Wp(t.cameraDirection),o=t=>({x:-1===t.x?this.Op.x.getInnerStart():1===t.x?this.Op.x.getInnerEnd():0,y:-1===t.y?this.Op.y.getInnerStart():1===t.y?this.Op.y.getInnerEnd():0,z:-1===t.z?this.Op.z.getInnerStart():1===t.z?this.Op.z.getInnerEnd():0}),a=o(s),h=o(r),c=o(n),u=this.oh.ef,f=Si(t.start,t.end,.5),g=ri.addVec(f,ri.multiplyVec(ri.multiply(u,-1),i)),p=this.np.Xp(f)||l(0,0),m=this.np.Xp(g)||l(0,0);return{center:f,wuSize:i,tickDirection3D:u,tickDirection2D:Fi(Pi(tt(p,this.chart.pi.ai,this.Rp),tt(m,this.chart.pi.ai,this.Rp))),gridlinePositionA:a,gridlinePositionB:h,gridlinePositionC:c}}Xh(t,e,i,s,r){return{...this.Zp(r,t,e.Fr.tickLength,e.Fr.tickPadding),keyValue:t,tickLevel:e,labelText:i,labelOffset:{x:0,y:0},labelRotation:e.Fr.labelRotation}}sn(t,e){const i=new qh(e,t,this.Ep,this.Rp,this.np);return i.zh.nl(0),i}Qh(t,e,i){return{ticksInfo:e,updatedTicks:i}}Kr(){return this.Rp}Zp(t,e,i,s){const{wuSize:r,start:n,end:o,tickDirection3D:a,tickDirection2D:h}=t,c=(e-this.ai.getInnerStart())/(this.ai.getInnerEnd()-this.ai.getInnerStart()),u=ri.addVec(Si(n,o,c),ri.multiplyVec(ri.multiply(a,this.np.Hp(.5*this.zp.do().getThickness())),r)),d=ri.addVec(u,ri.multiplyVec(ri.multiply(a,this.np.Hp(i)),r)),f=this.np.Xp(d)||l(0,0);return{labelPosition:Li(tt(f,this.chart.pi.ai,this.Rp),Ri(h,s)),labelAlignment:{x:-h.x,y:-h.y},posTickEnd3D:d,posTickStart3D:u,tickPositionRelative:c}}Jp(t,e,i){const{wuSize:s,start:r,end:n,tickDirection3D:o}=e,a=(t-this.ai.getInnerStart())/(this.ai.getInnerEnd()-this.ai.getInnerStart()),h=ri.addVec(Si(r,n,a),ri.multiplyVec(ri.multiply(o,this.np.Hp(.5*this.zp.do().getThickness())),s)),c=ri.addVec(h,ri.multiplyVec(ri.multiply(o,this.np.Hp(10)),s)),u=this.np.Xp(h)||l(0,0),d=this.np.Xp(c)||l(0,0);return this.Ep.dr(this.Rp).gr(u).Ar(d).cr(new lr({fillStyle:new fs({color:k(120*i)}),thickness:1}))}vn(t,e){return Kh(t,e,this.ai)}Qp(t){const e=this.Op;let i,s;this.Kp()?(i=d(e.x.getInnerEnd(),e.y.getInnerStart(),e.z.getInnerStart()),s=d(e.x.getInnerEnd(),e.y.getInnerStart(),e.z.getInnerEnd())):(i=d(e.x.getInnerStart(),e.y.getInnerStart(),e.z.getInnerStart()),s=this.oh.qp(d(e.x.getInnerEnd(),e.y.getInnerEnd(),e.z.getInnerEnd()),i));const r=this.np.Xp(i)||l(0,0),n=this.np.Xp(s)||l(0,0);return{cameraDirection:t,physicalAxisSize:Ii(Pi(r,n)),start:i,end:s,start2D:r,end2D:n}}ir(t){if(!this.di)return;const i=Math.min(this.Ah,this.gh),s=Math.max(this.Ah,this.gh);this.zp.Vi().bu([t.start,t.end]);const r=this.jp.VA();for(const[e,i]of this.Pr)for(const[,s]of i){const i=t.ticksInfo.get(s);if(!i)continue;const n=this.tv(t,i);r.add({xi:0,positions:[n.tickStroke.start,n.tickStroke.end]},{lineStyle:e.Fr.tickStyle}),n.gridStroke&&r.add({xi:0,positions:n.gridStroke},{lineStyle:e.Fr.gridStrokeStyle}),s.zh.sr(i.labelPosition).Zl(i.labelAlignment).Th(i.labelRotation).$l(i.labelOffset.x,i.labelOffset.y)}const n=this.Gp.VA(),o=this.$p.VA(),a={x:0,y:0};this.Bf.forEach(h=>{if(!h.di||h.M<i||h.M>s)return;const l=this.Zp(t,h.M,h.Mp,h._p),c=this.tv(t,l);if(h.kp!==ls){const t=n.add().sr(l.labelPosition).Zl(l.labelAlignment).qe(h.kp).Ch(h.Cp).tn(h.co(h.M)).Th(h.cf).setPointerEvents(h.ui);t.Zr=h.Zr;const i=t.Nh().kt();if(a.x=Math.max(a.x,i.x),a.y=Math.max(a.y,i.y),h.Ag!==ls){const i=t.mc(),s=[{x:i.min.x-h.Gn.left,y:i.max.y+h.Gn.top},{x:i.max.x+h.Gn.right,y:i.max.y+h.Gn.top},{x:i.max.x+h.Gn.right,y:i.min.y-h.Gn.bottom},{x:i.min.x-h.Gn.left,y:i.min.y-h.Gn.bottom}];o.add({xi:0,positions:s},{fillStyle:h.Ag,strokeStyle:h.gg}),this.Ep.pi.xc&&h.Zr===e.TextObjectIdentifier.CursorTickMarker&&this.Ep.pi.xc.FA({...this.Ep.pi.el(i.min,i.max,t.ai,h.Gn),blacklist:[e.TextObjectIdentifier.CursorTickMarker]})}}r.add({xi:0,positions:[c.tickStroke.start,c.tickStroke.end]},{lineStyle:h.bp}),c.gridStroke&&r.add({xi:0,positions:c.gridStroke},{lineStyle:h.wp})}),n.finishPlot(),o.finishPlot(),r.finishPlot();const h=this.ln((t,e)=>{const i=e.zh.Nh().kt();return t.x=Math.max(t.x,i.x),t.y=Math.max(t.y,i.y),t},{x:a.x,y:a.y}),c=Math.atan((t.end2D.y-t.start2D.y)/(t.end2D.x-t.start2D.x));this.Jr.Zl({x:0,y:0}).Th(180*-c/Math.PI);const u=ri.addVec(t.center,ri.multiplyVec(ri.multiply(t.tickDirection3D,this.np.Hp(.5*this.zp.do().getThickness()+this.cn((t,e)=>Math.max(t,e.tickLength),0))),t.wuSize)),d=this.np.Xp(u)||l(0,0),f=Li(tt(d,this.chart.pi.ai,this.Rp),Li(Li(zi(h,t.tickDirection2D),Ri(t.tickDirection2D,this.cn((t,e)=>Math.max(t),0))),zi(Ri(this.Jr.Nh().kt(),.5),t.tickDirection2D)));this.Jr.sr(f)}tv(t,e){const{gridlinePositionA:i,gridlinePositionB:s,gridlinePositionC:r}=t,n=e.posTickStart3D,o=e.posTickEnd3D,a=e.tickPositionRelative;let h;return Ht(a,0)||Ht(a,1)||(h=[this.sv()?{...i,x:n.x}:this.ev()?{...i,y:n.y}:this.Kp()?{...i,z:n.z}:{x:0,y:0,z:0},this.sv()?{...s,x:n.x}:this.ev()?{...s,y:n.y}:this.Kp()?{...s,z:n.z}:{x:0,y:0,z:0},this.sv()?{...r,x:n.x}:this.ev()?{...r,y:n.y}:this.Kp()?{...r,z:n.z}:{x:0,y:0,z:0}]),{gridStroke:h,tickStroke:{start:n,end:o}}}rv(t){const e=this.Ah,i=this.gh,s=.01*t*(i-e),r=e+s,n=i+s;this.Eh(r,n,{allowIntervalLengthChange:!1,skipIntervalRestriction:!1})}hv(t,e,i){if(0===e)return;i<0&&(e*=-1,i*=-1);const s=this.gh-this.Ah,r=s*(e>=1?1+.02*i:1-.02*i)-s;"centered"===t?this.Eh(this.Ah+r/2,this.gh-r/2,{allowIntervalLengthChange:!0,skipIntervalRestriction:!1}):"keep-start"===t?this.Eh(this.Ah,this.gh-r/2,{allowIntervalLengthChange:!0,skipIntervalRestriction:!1}):"keep-end"===t&&this.Eh(this.Ah+r/2,this.gh,{allowIntervalLengthChange:!0,skipIntervalRestriction:!1})}Lh(){super.Lh(),this.jp.UA(),this.Gp.UA(),this.$p.UA()}sv(){return this.oh.sv()}ev(){return this.oh.ev()}Kp(){return this.oh.Kp()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}}class qh extends Ln{constructor(t,e,i,s,r,n){super(t,e,i,s,n),this.nv=r}}const Kh=(t,e,i)=>$t(t+.1*(e-t)+Math.abs(i.tt())/100*Math.sign(e-t),Math.min(t,e),Math.max(t,e)),Jh=(t,e,i,s)=>({dn:i=>{const s=t();let r;for(const t of s){if(!t.xp())continue;const s=e(t,i);r=void 0===s?r:void 0!==r?Math.min(r,s):s}return r},fn:e=>{const s=t();let r;for(const t of s){if(!t.xp())continue;const s=i(t,e);r=void 0===s?r:void 0!==r?Math.max(r,s):s}return r},gn:()=>{const e=t();let i;for(const t of e){if(!t.xp())continue;const e=s(t);i=void 0===e?i:void 0!==i?Math.max(i,e):e}return i}}),Qh=t=>({...Jh(t,t=>t.getYMin(),t=>t.getYMax(),t=>t.gn().y),Dp:t=>t.y,qp:(t,e)=>({x:e.x,y:t.y,z:e.z}),ef:d(-1,0,0),Wp:t=>{const e={x:t.x>=0?1:-1,y:t.y>=0?1:-1,z:t.z>=0?1:-1};return{gridlinePositionA:d(e.x,0,e.z),gridlinePositionB:d(e.x,0,-e.z),gridlinePositionC:d(-e.x,0,-e.z)}},sv:()=>!1,ev:()=>!0,Kp:()=>!1}),tl=t=>({...Jh(t,t=>t.getZMin(),t=>t.getZMax(),t=>t.gn().z),Dp:t=>t.z,qp:(t,e)=>({x:e.x,y:e.y,z:t.z}),ef:d(1,0,0),Wp:t=>{const e={x:t.x>=0?1:-1,y:t.y>=0?1:-1,z:t.z>=0?1:-1};return{gridlinePositionA:d(e.x,-e.y,0),gridlinePositionB:d(e.x,e.y,0),gridlinePositionC:d(-e.x,e.y,0)}},sv:()=>!1,ev:()=>!1,Kp:()=>!0});class el extends Gh{constructor(t,e,i,s,r){super(t,e,i,s,r),this.gp=!1,this.D=new vt}yp(){return this.getPointAmount()>0}setStrokeStyle(t){this.hc="function"==typeof t?t(this.hc):t;const e=this.hc;return this.Cc.cr(e),this.np.Bs(),this}getStrokeStyle(){return this.hc}add(t){return this.gp&&this.chart.pi.La(Hn.Ro),this.gp=!0,(t=Array.isArray(t)?t:[t])?(this.Cc.bu(t.slice()),this.np.Bs(),this):this}clear(){return this.Cc.Vi(),this}getPointAmount(){const t=this.Cc;return t.Cu()+t.Tu()}xp(){return this.rp&&this.getPointAmount()>0&&this.getVisible()}rr(t,e){t.Ii(e),this.np.Bs()}er(){return{stroke:this.hc}}Ys(){return Re(this.hc.getFillStyle(),this.Cc._i())}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class il extends el{constructor(t,e,i,s,r,n,o){super(t,e,i,s,n),this.Rs="Line Series 3D",this.hc=ze(s.lineSeries3DStrokeStyle,r),this.ov=co.pointStyle3D,this.av(this.hc);const a={individualLookupValuesEnabled:!1,...o};this.Cc=this.np.Np([Wh.UserSeries],a).up(this.hp).cr(this.hc).Vp(this.ov).Ii(this.getHighlight()),this._s(this.Cc)}setStrokeStyle(t){super.setStrokeStyle(t),this.av(this.hc);const e=this.ov;return this.Cc.Vp(e),this}av(t){const e=new ar.Triangulated({shape:"sphere",fillStyle:t.getFillStyle(),size:t.getThickness()});this.ov=e}}class sl extends el{constructor(t,e,i,s,r,n,o){super(t,e,i,s,n),this.Rs="Point Line Series 3D",this.ov=ze(s.pointLineSeries3DPointStyle,r),this.hc=ze(s.lineSeries3DStrokeStyle,r),this.lv();const a={individualLookupValuesEnabled:!1,...o};this.Cc=this.np.Np([Wh.UserSeries],a).up(this.hp).cr(this.hc).Vp(this.ov).Ii(this.getHighlight()),this._s(this.Cc)}setPointStyle(t){return this.ov="function"==typeof t?t(this.ov):t,this.lv(),this.Cc.Vp(this.ov),this.np.Bs(),this}getPointStyle(){return this.ov}setStrokeStyle(t){super.setStrokeStyle(t);const e=this.hc,i=Math.abs(e.getThickness()),s=this.ov,r=s.getSize();i>("object"==typeof r?Math.max(r.x,r.y,r.z):r)&&(this.ov=s.setSize(i)),this.lv();const n=this.ov;return this.Cc.Vp(n),this.np.Bs(),this}Ys(){return Re(this.hc.getFillStyle(),this.Cc._i())||Re(this.ov.getFillStyle(),this.Cc._i())}lv(){const t=this.ov,e=t.getSize();this.ov=t.setSize(e)}rr(t,e){t.Ii(e),this.np.Bs()}}class rl extends Gh{constructor(t,e,i,s,r,n){super(t,e,i,s,r),this.gp=!1,this.D=new vt,((null==n?void 0:n.individualPointSizeAxisEnabled)||(null==n?void 0:n.individualPointSizeEnabled))&&this.chart.pi.La(Hn.Oo)}yp(){return this.getPointAmount()>0}add(t){return this.gp&&this.chart.pi.La(Hn.Ro),this.gp=!0,(t=Array.isArray(t)?t:[t])?(this.Cc.bu(t.slice()),this.np.Bs(),this):this}clear(){return this.Cc.Vi(),this}getPointAmount(){const t=this.Cc;return t.Cu()+t.Tu()}xp(){return this.rp&&this.getPointAmount()>0&&this.getVisible()}rr(t,e){t.Ii(e),this.np.Bs()}er(){return{point3D:this.uv}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class nl extends rl{constructor(t,e,i,s,r,n){super(t,e,i,s,r,n),this.Rs="Point Series 3D";const o=void 0!==(null==n?void 0:n.automaticColorIndex)?n.automaticColorIndex:this.chart.getSeries().length;this.uv=ze(s.pointSeries3DPointStyle,o);const a={individualPointColorEnabled:!1,individualPointSizeEnabled:!1,individualLookupValuesEnabled:!1,individualPointSizeAxisEnabled:!1,...n};this.Cc=this.np.dv(a).up(this.hp).cv(this.uv).Ii(this.getHighlight()),this._s(this.Cc)}setPointStyle(t){this.uv="function"==typeof t?t(this.uv):t;const e=this.uv;return this.Cc.cv(e),this.np.Bs(),this}getPointStyle(){return this.uv}Ys(){return Re(this.uv.getFillStyle(),this.Cc._i())}}class ol extends rl{constructor(t,e,i,s,r,n){super(t,e,i,s,r,n),this.Rs="Point Cloud Series 3D";const o=this.chart.getSeries().length;this.uv=ze(s.pointCloudSeries3DPointStyle,o);const a={individualPointColorEnabled:!1,individualPointSizeEnabled:!1,individualLookupValuesEnabled:!1,individualPointSizeAxisEnabled:!1,...n};this.Cc=this.np.dv(a).cv(this.uv).Ii(this.getHighlight()),this._s(this.Cc)}setPointStyle(t){this.uv="function"==typeof t?t(this.uv):t;const e=this.uv;return this.Cc.cv(e),this.np.Bs(),this}getPointStyle(){return this.uv}Ys(){return Re(this.uv.getFillStyle(),this.Cc._i())}}const al={Triangulated:nl,Pixelated:ol};class hl extends Oh{constructor(t,e,i,s,r,n,o,a,h,l,c,u){super(t,e,i,s,r,n,o,a,h,l,c,u),this.fv=[],this.Av=0,this.gv=t=>{const e=this.fv.indexOf(t);e>=0&&(this.fv.splice(e,1),this.D.R("seriesdispose",{series:t}))},this.seriesBackground=new vt,this.pv=this.vs.aA()}setAnimationsEnabled(t){return super.setAnimationsEnabled(t),this.fv.forEach(e=>e.setAnimationHighlight(t)),this}vv(t,e){this.pv.ks([e]),this.seriesBackground.zi(t)}setSeriesBackgroundFillStyle(t){return this.yv.qe(t),this.pi.Bs(),this}getSeriesBackgroundFillStyle(){return this.yv.Mh()}setSeriesBackgroundStrokeStyle(t){return this.mv.Ke(t),this.pi.Bs(),this}getSeriesBackgroundStrokeStyle(){return this.mv.Ja()}setSeriesBackgroundEffect(t){return this.pv.Ps(t),this.pi.Bs(),this}getSeriesBackgroundEffect(){return this.pv.Ds()}xv(t,e){this.fv.push(t),void 0!==this.Sv&&t.setHighlightOnHover(this.Sv),this.D.R("seriesadd",{series:t}),this.Os.forEach(i=>{i.xg()&&null!==(null==e?void 0:e.legend)&&i.bu(t,null==e?void 0:e.legend)})}bg(){return this.fv}setSeriesHighlightOnHover(t){return this.Sv=t,this.fv.forEach(e=>e.setHighlightOnHover(t)),this}dispose(){return this.fv.slice().forEach(Wt),super.dispose()}}const ll=ri.normalize({x:-.5610788649579117,y:-.35242840511865414,z:-1.1349149375849081});class cl{constructor(t,e,i,s){this.bv=!0,this.Mv=!0,this.wv=2*-Math.PI/2160,this._v=2*Math.PI/2160,this.kv=.1,this.Cv=1*Math.PI/180,this.Tv=t,this.Fv=e,this.Iv=i,this.Xp=s}getDefaultCameraConfiguration(t,e){const i={direction:ll,location:ri.multiply(ll,-1)};return this.cameraLocationChanged({boundingBox:t,cameraDirection:i.direction,cameraLocation:i.location,projection:e})||i}applyCameraInteractions(t,e){let i={direction:t.cameraDirection,location:t.cameraLocation};return e.forEach(t=>{"rotate"===t.type?i=this.Lv(i,t):"wheel-zoom"===t.type?i=this.Pv(i,t):"rotate+zoom"===t.type?i=this.Bv(i,t):"fixed-rotate"===t.type?i=this.Dv(i,t):"move"===t.type&&(i=this.Ev(i,t))}),this.bv?i=this.Rv(t.boundingBox,i):this.Mv&&(i=this.Ov(t.boundingBox,t.projection,i)),i}Lv(t,e){const{rotation:i}=e,s=t.location,r=ri.multiply(ri.normalize(t.location),-1),{Right:n,Up:o}=this.zv(r);let a=s;const h=this.Vv(r),l=i.x*this.wv*h;a=ri.rotateAroundAxis(a,o,l);const c=(i.y>0?1:-1)*Math.min(Math.abs(i.y)*this._v,h-this.Cv);return 0!==c&&(a=ri.rotateAroundAxis(a,n,c)),{location:a,direction:ri.multiply(ri.normalize(a),-1)}}Pv(t,e){const{deltaY:i}=e;this.bv&&this.Nv(!1);const s=t.location,r=ri.multiply(ri.normalize(s),-1),n=i*this.kv,o=ri.length(s)*-n;return{direction:r,location:ri.addVec(s,ri.multiply(r,o))}}Bv(t,e){const{rotation:i,cameraDistance:s}=e;this.bv&&this.Nv(!1);let r=this.Lv(t,{type:"rotate",rotation:i});const n=r.location,o=ri.multiply(ri.normalize(n),-1),a=ri.multiply(o,-s);return r={direction:ri.multiply(ri.normalize(a),-1),location:a},r}Dv(t,e){this.bv&&this.Nv(!1);const{rotation:i}=e,s=t.location,r=t.direction,{Right:n,Up:o}=this.zv(r),a=i.x*this.wv;let h=ri.normalize(ri.rotateAroundAxis(r,o,a));const l=i.y*this._v;return h=ri.normalize(ri.rotateAroundAxis(h,n,l)),{location:s,direction:h}}Ev(t,e){this.bv&&this.Nv(!1),this.Mv=!1;const{amountRight:i,amountForward:s}=e,r=t.location,n=t.direction,{Right:o}=this.zv(n);return{location:ri.addVec(r,ri.multiply(n,.01*s),ri.multiply(o,.01*i)),direction:n}}projectionChanged(t,e){return this.viewportChanged(t)}boundingBoxChanged(t){const e={location:t.cameraLocation,direction:ri.multiply(ri.normalize(t.cameraLocation),-1)};return this.bv?this.Rv(t.boundingBox,e):this.Ov(t.boundingBox,t.projection,e)}cameraLocationChanged(t){const e={location:t.cameraLocation,direction:ri.multiply(ri.normalize(t.cameraLocation),-1)};return this.bv?this.Rv(t.boundingBox,e):this.Ov(t.boundingBox,t.projection,e)}viewportChanged(t){const e={location:t.cameraLocation,direction:ri.multiply(ri.normalize(t.cameraLocation),-1)};if(this.bv)return this.Rv(t.boundingBox,e)}Rv(t,e,i){let s=e;i=void 0!==i?i:0,s=this.Gv(t,s,100,20,1,i,5);const r=this.Vv(s.direction);return s=this.$v(s,this.Uv(t,s,100,1),r),s}Gv(t,e,i,s,r,n,o){return ul(n,o,t=>({direction:e.direction,location:ri.multiply(e.direction,-t)}),e=>this.Yv(t,e),i,r,"linear",s)}Uv(t,e,i,s){const{Right:r,Left:n,Up:o,Down:a}=this.zv(e.direction),h=this.jv(t,!1,e);let l=e;const c=s,u=.1;return Math.abs(h.bottom-h.top)>c&&(l=h.bottom<h.top?dl(0,u,t=>({location:l.location,direction:ri.normalize(ri.lerp(l.direction,a,t))}),e=>this.Hv(t,e),0,c,!0,i):dl(0,u,t=>({location:l.location,direction:ri.normalize(ri.lerp(l.direction,o,t))}),e=>this.Hv(t,e),0,c,!0,i)),Math.abs(h.left-h.right)>c&&(l=h.left<h.right?dl(0,u,t=>({location:l.location,direction:ri.normalize(ri.lerp(l.direction,n,t))}),e=>this.Wv(t,e),0,c,!0,i):dl(0,u,t=>({location:l.location,direction:ri.normalize(ri.lerp(l.direction,r,t))}),e=>this.Wv(t,e),0,c,!0,i)),l}Yv(t,e){const i=this.jv(t,!0,e);return Math.min(i.left+i.right,i.top+i.bottom)}Wv(t,e){const i=this.jv(t,!1,e);return Math.abs(i.left-i.right)}Hv(t,e){const i=this.jv(t,!1,e);return Math.abs(i.top-i.bottom)}jv(t,e,i){const s=bi(this.Xv(t,e,i).map(t=>tt(t,this.Tv,this.Fv)));return{left:s.min.x,right:this.Fv.x.getInnerEnd()-s.max.x,top:this.Fv.y.getInnerEnd()-s.max.y,bottom:s.min.y}}Xv(t,e,i){const s=this.Iv,r=d(s.x.getInnerStart(),s.y.getInnerStart(),s.z.getInnerStart()),n=d(s.x.getInnerEnd(),s.y.getInnerEnd(),s.z.getInnerEnd()),o=[],a=e?16:4,h=(r.x+n.x)/2,l=(r.z+n.z)/2,c=Math.sqrt(2)*(n.x-h),u=Math.sqrt(2)*(n.z-l);return[r.y,n.y].forEach(t=>{for(let e=0;e<a;e+=1){const i=Math.PI/4+2*Math.PI*e/a,s=h+Math.cos(i)*c,r=l+Math.sin(i)*u;o.push({x:s,y:t,z:r})}}),o.map(t=>this.Xp(t,i)).filter(t=>void 0!==t)}Ov(t,e,i){const s=ri.length(i.location),r=this.Zv(t,e);return s<r.min?{direction:i.direction,location:ri.multiply(i.direction,-r.min)}:s>r.max?{direction:i.direction,location:ri.multiply(i.direction,-r.max)}:i}Zv(t,e){return{min:("perspective"===e?.8:.5)*Math.sqrt(t.x**2+t.y**2+t.z**2),max:3*Math.sqrt(t.x**2+t.y**2+t.z**2)}}zv(t){const e=d(0,1,0),i=ri.normalize(ri.cross(e,ri.multiply(t,-1)));let s=ri.cross(i,t);return s.y=Math.abs(s.y),s=ri.normalize(s),{Right:i,Up:s,Down:ri.multiply(s,-1),Left:ri.multiply(i,-1)}}Vv(t){const e={x:0,y:1,z:0},i=ri.angle(t,e),s=ri.angle(t,ri.multiply(e,-1));return Math.min(i,s)}$v(t,e,i){return{location:ri.lerp(t.location,e.location,i),direction:ri.normalize(ri.lerp(t.direction,e.direction,i))}}Nv(t){return this.bv=t,this}Jv(){return this.bv}}const ul=(t,e,i,s,r,n,o,a)=>{let h,l=0,c=(e+t)/2;do{const a=i(c);if(h={value:c,result:a,score:s(a)},Math.abs(h.score-r)<=n)break;const u=h.score>r;u&&"linear"===o||!u&&"reversed"===o?(c=(h.value+t)/2,e=h.value):(c=(h.value+e)/2,t=h.value),l+=1}while(l<a);return h.result},dl=(t,e,i,s,r,n,o,a)=>{let h,l=0,c=t;do{const u=i(c),d=s(u);if(void 0===h||Math.abs(d-r)<Math.abs(h.score-r)){if(h={value:c,result:u,score:s(u)},Math.abs(h.score-r)<=n)break}else if(o)break;l+=1,c+=1/(a-1)*(e-t)}while(l<a);return h.result};class fl extends Gh{constructor(t,e,i,s,r,n){super(t,e,i,r,n),this.Rs="Surface Grid Series 3D",this.Qv={},this.gp=!1,this.D=new vt,this.sp=Xs;const o=void 0!==(null==s?void 0:s.automaticColorIndex)?s.automaticColorIndex:this.chart.getSeries().length;this.Ze=ze(this.bi.surfaceGridSeries3DFillStyle,o),this.Kv=ze(this.bi.surfaceGridSeries3DWireframeStyle,o);const a={heatmapDataType:"intensity",dataOrder:s.dataOrder||"columns",columns:s.columns,rows:s.rows};this.Da=a,this.Cc=this.np.ty(a).qe(this.Ze).qv(this.Kv).lp(this.sp).Ii(this.getHighlight()),this._s(this.Cc),this.setHighlightOnHover(!1)}yp(){return this.gp}Qi(t,e,i){const s=null==t?void 0:t.dataPoint;if(s)return{cursorPosition:{resultTable:this.chart.translateCoordinate(e,this.chart.coordsRelative),resultTableScale:this.chart.eA,axisLocation:s},...s,series:this,axisX:this.chart.getDefaultAxisX(),axisY:this.chart.getDefaultAxisY(),axisZ:this.chart.getDefaultAxisZ(),lut:vs(this.Ze)?this.Ze.lut:void 0}}er(){return{fill:this.Ze}}iy(){const t=this.Qv.start||{x:0,z:0};let e;e=this.Qv.end?{x:(this.Qv.end.x-t.x)/this.Da.columns,z:(this.Qv.end.z-t.z)/this.Da.rows}:this.Qv.step?this.Qv.step:{x:1,z:1},this.Cc.sy(t,e),this.chart.pi.Bs()}setStart(t){return this.Qv.start=t,this.iy(),this}getStart(){return this.Cc.ey().start}setStep(t){return this.Qv.step=t,this.iy(),this}getStep(){return this.Cc.ey().step}setEnd(t){return this.Qv.end=t,this.iy(),this}getEnd(){return this.Cc.ey().end}setContours(t){return this.Cc.hy(t?{valueSource:t.valueSource,levels:t.levels.map(t=>{var e,i;return{value:t.value,strokeStyle:null!==(i=null!==(e=t.strokeStyle)&&void 0!==e?e:this.bi.surfaceGridSeriesContourStrokeStyle)&&void 0!==i?i:new lr({thickness:1,fillStyle:new fs({color:M(255,0,0)})})}})}:void 0),this.np.Bs(),this}getContours(){return this.Cc.ny()}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.Cc.qe(this.Ze),this.np.Bs(),this}getFillStyle(){return this.Ze}setWireframeStyle(t){return this.Kv="function"==typeof t?t(this.Kv):t,this.Cc.qv(this.Kv),this.np.Bs(),this}getWireframeStyle(){return this.Cc.oy()}setIntensityInterpolation(t){return t=t||"disabled",this.Cc.ly(t),this.np.Bs(),this}getIntensityInterpolation(){return this.Cc.uy()}invalidateIntensityValues(t){if(this.gp&&this.chart.pi.La(Hn.Ro),Array.isArray(t)){if(0===t.length||0===t[0].length)return this;const e={x:t.length,y:t[0].length,columns:"columns"===this.Da.dataOrder?t.length:t[0].length,rows:"rows"===this.Da.dataOrder?t.length:t[0].length},i="columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows,s="columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns;if(e.x>i||e.y>s){if(!0===this.chart.Pg.Ea){const t=`SurfaceGridSeries3D.invalidateIntensityValues intensity matrix overflow.\n    Grid ${this.Da.columns}x${this.Da.rows}, input ${e.columns}x${e.rows}.\n    Excess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(t)}const r=[];for(let e=0;e<i;e+=1)r[e]=t[e].slice(0,s);t=r}this.Cc.Ay({type:"intensity",lengthPrimary:t.length,lengthSecondary:t[0].length,startPrimary:0,startSecondary:0,values:t})}else if("iColumn"in t&&"iRow"in t&&"values"in t){if(0===t.values.length||0===t.values[0].length)return this;const e={primary:t.values.length,secondary:t.values[0].length,columns:"columns"===this.Da.dataOrder?t.values.length:t.values[0].length,rows:"rows"===this.Da.dataOrder?t.values.length:t.values[0].length};let i="columns"===this.Da.dataOrder?t.iColumn:t.iRow;const s=i+e.primary-1;let r="columns"===this.Da.dataOrder?t.iRow:t.iColumn;const n=r+e.secondary-1,o=("columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows)-1,a=("columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns)-1;if(i<0||r<0||s>o||n>a){if(!0===this.chart.Pg.Ea){const i=`SurfaceGridSeries3D.invalidateIntensityValues intensity matrix overflow.\n    Grid ${this.Da.columns}x${this.Da.rows}, input ${e.columns}x${e.rows} starting at [${t.iColumn},${t.iRow}].\n    Out of bounds data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(i)}const h=Math.max(-i,0),l=Math.max(-r,0),c=Math.max(s-o,0),u=Math.max(n-a,0),d=e.primary-(h+c),f=[];if(0===l&&0===u)for(let e=0;e<d;e+=1)f[e]=t.values[h+e];else for(let e=0;e<d;e+=1)f[e]=t.values[h+e].slice(l,0===u?void 0:-u);if(0===f.length||0===f[0].length)return this;t={iColumn:t.iColumn,iRow:t.iRow,values:f},i=Math.max(i,0),r=Math.max(r,0)}this.Cc.Ay({type:"intensity",lengthPrimary:t.values.length,lengthSecondary:t.values[0].length,startPrimary:i,startSecondary:r,values:t.values})}return this.np.Bs(),this.gp=!0,this}invalidateHeightMap(t){if(this.gp&&this.chart.pi.La(Hn.Ro),Array.isArray(t)){if(0===t.length||0===t[0].length)return this;const e={x:t.length,y:t[0].length,columns:"columns"===this.Da.dataOrder?t.length:t[0].length,rows:"rows"===this.Da.dataOrder?t.length:t[0].length},i="columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows,s="columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns;if(e.x>i||e.y>s){if(!0===this.chart.Pg.Ea){const t=`SurfaceGridSeries3D.invalidateHeightMap height matrix overflow.\n    Grid ${this.Da.columns}x${this.Da.rows}, input ${e.columns}x${e.rows}.\n    Excess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(t)}const r=[];for(let e=0;e<i;e+=1)r[e]=t[e].slice(0,s);t=r}this.Cc.gy({type:"y",lengthPrimary:t.length,lengthSecondary:t[0].length,startPrimary:0,startSecondary:0,values:t})}else if("iColumn"in t&&"iRow"in t&&"values"in t){if(0===t.values.length||0===t.values[0].length)return this;const e={primary:t.values.length,secondary:t.values[0].length,columns:"columns"===this.Da.dataOrder?t.values.length:t.values[0].length,rows:"rows"===this.Da.dataOrder?t.values.length:t.values[0].length};let i="columns"===this.Da.dataOrder?t.iColumn:t.iRow;const s=i+e.primary-1;let r="columns"===this.Da.dataOrder?t.iRow:t.iColumn;const n=r+e.secondary-1,o=("columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows)-1,a=("columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns)-1;if(i<0||r<0||s>o||n>a){if(!0===this.chart.Pg.Ea){const i=`SurfaceGridSeries3D.invalidateHeightMap height matrix overflow.\n    Grid ${this.Da.columns}x${this.Da.rows}, input ${e.columns}x${e.rows} starting at [${t.iColumn},${t.iRow}].\n    Out of bounds data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(i)}const h=Math.max(-i,0),l=Math.max(-r,0),c=Math.max(s-o,0),u=Math.max(n-a,0),d=e.primary-(h+c),f=[];if(0===l&&0===u)for(let e=0;e<d;e+=1)f[e]=t.values[h+e];else for(let e=0;e<d;e+=1)f[e]=t.values[h+e].slice(l,0===u?void 0:-u);if(0===f.length||0===f[0].length)return this;t={iColumn:t.iColumn,iRow:t.iRow,values:f},i=Math.max(i,0),r=Math.max(r,0)}this.Cc.gy({type:"y",lengthPrimary:t.values.length,lengthSecondary:t.values[0].length,startPrimary:i,startSecondary:r,values:t.values})}return this.np.Bs(),this.gp=!0,this}setCullMode(t){return this.Cc.vy("boolean"==typeof t?t?"cull-back":"disabled":t),this}getCullMode(){return this.Cc.yy()}Ys(){return Re(this.Ze,this.Cc._i())}cp(){}ir(){}dp(){}xp(){return this.rp&&this.getVisible()}rr(t,e){t.Ii(e),this.np.Bs()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class gl extends Gh{constructor(t,e,i,s,r,n){super(t,e,i,r,n),this.Rs="Surface Grid Series 3D",this.gp=!1,this.Qv={},this.D=new vt,this.chart.pi.La(Hn.Ro),this.sp=Xs;const o=void 0!==(null==s?void 0:s.automaticColorIndex)?s.automaticColorIndex:this.chart.getSeries().length;this.Ze=ze(this.bi.surfaceScrollingGridSeries3DFillStyle,o),this.Kv=ze(this.bi.surfaceScrollingGridSeries3DWireframeStyle,o);const a={heatmapDataType:"intensity",scrollDimension:s.scrollDimension||"columns",columns:s.columns,rows:s.rows};this.Da=a,this.Cc=this.np.my(a).qe(this.Ze).qv(this.Kv).lp(this.sp).Ii(this.getHighlight()),this._s(this.Cc),this.setHighlightOnHover(!1)}yp(){return this.gp}Qi(t,e,i){const s=null==t?void 0:t.dataPoint;if(s)return{cursorPosition:{resultTable:this.chart.translateCoordinate(e,this.chart.coordsRelative),resultTableScale:this.chart.eA,axisLocation:s},...s,series:this,axisX:this.chart.getDefaultAxisX(),axisY:this.chart.getDefaultAxisY(),axisZ:this.chart.getDefaultAxisZ(),lut:vs(this.Ze)?this.Ze.lut:void 0}}iy(){const t=this.Qv.start||{x:0,z:0};let e;e=this.Qv.step?this.Qv.step:{x:1,z:1},this.Cc.sy(t,e),this.chart.pi.Bs()}setStart(t){return this.Qv.start=t,this.iy(),this}getStart(){return this.Cc.ey().start}setStep(t){return this.Qv.step=t,this.iy(),this}getStep(){return this.Cc.ey().step}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.Cc.qe(this.Ze),this.np.Bs(),this}getFillStyle(){return this.Ze}setWireframeStyle(t){return this.Kv="function"==typeof t?t(this.Kv):t,this.Cc.qv(this.Kv),this.np.Bs(),this}getWireframeStyle(){return this.Cc.oy()}setIntensityInterpolation(t){return t=t||"disabled",this.Cc.ly(t),this.np.Bs(),this}getIntensityInterpolation(){return this.Cc.uy()}clear(){return this.Cc.Vi(),this.np.Bs(),this}addValues(t){if(!t)return this;let e=t.yValues,i=t.intensityValues;if(!e&&!i)return this;if(e&&0===e.length&&(e=void 0),i&&0===i.length&&(i=void 0),this.gp=!0,e){const t=e[0].length,i=0+t-1,s="columns"===this.Da.scrollDimension?this.Da.rows:this.Da.columns;if(i>s-1){if(!0===this.chart.Pg.Ea){const e=`SurfaceScrollingGridSeries3D.addValues input yValues overflow.\nGrid was created with ${s} ${"columns"===this.Da.scrollDimension?"rows":"columns"}, input yValues have ${t}.\nExcess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(e)}const i=[];for(let t=0;t<e.length;t+=1)i[t]=e[t].slice(0,s+1);e=i}}if(i){const t=i[0].length,e=0+t-1,s="columns"===this.Da.scrollDimension?this.Da.rows:this.Da.columns;if(e>s-1){if(!0===this.chart.Pg.Ea){const e=`SurfaceScrollingGridSeries3D.addValues intensityValues overflow.\nGrid was created with ${s} ${"columns"===this.Da.scrollDimension?"rows":"columns"}, input intensityValues have ${t}.\nExcess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(e)}const e=[];for(let t=0;t<i.length;t+=1)e[t]=i[t].slice(0,s+1);i=e}}if(e&&i){const t=e.length,s=i.length;if(t!==s){if(!0===this.chart.Pg.Ea){const e=`SurfaceScrollingGridSeries3D.addValues input yValues and intensityValues size does not match.\nyValues: ${t}\nintensityValues: ${s}\nData will be automatically clipped according to the smaller supplied sample. This can result in sub-optimal performance.`;Ut.console.warn(e)}t>s?e=e.slice(0,s):i=i.slice(0,t)}}const s=e?e.length:null==i?void 0:i.length,r=e?e[0].length:null==i?void 0:i[0].length;return this.Cc.xy({startPrimary:0,startSecondary:0,lengthPrimary:s,lengthSecondary:r,heightMapValues:e,intensityValues:i}),this.np.Bs(),this}invalidateValues(t){return this.Cc.Ay(t),this.chart.pi.Bs(),this}getSampleCount(){return this.Cc.Sy()}setCullMode(t){return this.Cc.vy("boolean"==typeof t?t?"cull-back":"disabled":t),this}getCullMode(){return this.Cc.yy()}Ys(){return Re(this.Ze,this.Cc._i())}cp(){}ir(){}dp(){}xp(){return this.rp&&this.getVisible()}rr(t,e){t.Ii(e),this.np.Bs()}er(){return{fill:this.Ze}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const pl=t=>!!(t&&"object"==typeof t&&"id"in t&&"chart"in t&&t.chart instanceof Rl),ml=t=>!!(t&&"object"==typeof t&&"x"in t&&"number"==typeof t.x&&"y"in t&&"number"==typeof t.y&&"z"in t&&"number"==typeof t.z),yl=(t,e=/\s+/g)=>Array.from(t.split(e).map(parseFloat)),xl=t=>{if(t.length<=3)return t;const e=new Array;for(let i=1;i<t.length-1;i+=1)e.push(t[0]),e.push(t[i]),e.push(t[i+1]);return e},vl=t=>{const e=t.split(/\s+/g);let i=[],s=[],r=[];for(const t of e){const e=yl(t.trim(),"/");i.push(e[0]),e.length>1&&!Number.isNaN(e[1])&&r.push(e[1]),e.length>2&&!Number.isNaN(e[2])&&s.push(e[2])}return i=xl(i),r=xl(r),s=xl(s),{vertexIndex:i,textureIndex:r||void 0,normalIndex:s||void 0}},Al={id:"",ambient:M(0,0,0,0),diffuse:M(254,204,0),emissive:M(0,0,0,0),specular:M(255,255,255),specularCoeff:1,opacity:1};class Sl extends Gh{constructor(t,e,i,s,r,n){super(t,e,i,s,n),this.Rs="Mesh Model 3D",this.by=new Float32Array,this.My=new Float32Array,this.wy=new Uint16Array,this.ai={x:1,y:1,z:1},this._y={x:0,y:0,z:0},this.ky={x:0,y:0,z:0},this.Cy={x:0,y:0,z:0},this.Ty={w:1,x:0,y:0,z:0},this.Fy={x:0,y:0,z:0},this.Iy=new Array,this.Ly=[],this.nu=hi,this.D=new vt;const o=void 0!==(null==r?void 0:r.automaticColorIndex)?r.automaticColorIndex:this.chart.getSeries().length;this.Cc=this.np.Py().up(this.hp).qe(ze(this.bi.meshModel3DFillStyle||this.bi.pointSeriesFillStyle,o)).Ii(this.getHighlight()),this._s(this.Cc)}yp(){return this.by.length>0}Qi(t,e,i){const s=this.getFillStyle();return Je({series:this,axisX:this.chart.getDefaultAxisX(),axisY:this.chart.getDefaultAxisY(),axisZ:this.chart.getDefaultAxisZ(),lut:vs(s)?s.lut:void 0},{cursorPosition:0,index:0,x:0,y:0,z:0,value:0,coordAxis:0,coordModel:0},()=>{const i=this.Cc.By(t,e);if(i)return{cursorPosition:{resultTable:this.chart.translateCoordinate(e,this.chart.coordsRelative),resultTableScale:this.chart.eA,axisLocation:i.coordAxis},...i.coordAxis,index:i.index,value:i.value,coordAxis:i.coordAxis,coordModel:i.coordModel,series:this,axisX:this.chart.getDefaultAxisX(),axisY:this.chart.getDefaultAxisY(),axisZ:this.chart.getDefaultAxisZ(),lut:vs(s)?s.lut:void 0}})}setModelGeometry(t){const{indices:e,vertices:i,normals:s}=t;let r=oi,n=ni,o=oi,a=ni,h=oi,l=ni;for(let t=0;t<i.length;t+=3){const e=i[t],s=i[t+1],c=i[t+2];r=Math.max(r,e),n=Math.min(n,e),o=Math.max(o,s),a=Math.min(a,s),h=Math.max(h,c),l=Math.min(l,c)}this.nu={min:{x:n,y:a,z:l},max:{x:r,y:o,z:h}};for(let t=0;t<i.length;t+=3)i[t]-=this.nu.min.x,i[t+1]-=this.nu.min.y,i[t+2]-=this.nu.min.z;this.Fy={x:this.nu.max.x-this.nu.min.x,y:this.nu.max.y-this.nu.min.y,z:this.nu.max.z-this.nu.min.z},this.by=i instanceof Float32Array?i:new Float32Array(i),this.checkedNormals=s&&!Number.isNaN(s[0])?s instanceof Float32Array?s:new Float32Array(s):void 0,this.checkedNormals||this.setColorShadingStyle(Xs);const c=new Array,u={indexStart:0,count:e.length,useIndexBuffer:!0,offset:0,material:{id:Al.id,diffuse:Al.diffuse,specular:Al.specular,ambient:Al.ambient,emissive:Al.emissive,specularCoeff:Al.specularCoeff,opacity:1}};return c.push(u),this.Ly=c,this.Cc.Dy({vertices:this.by,normals:this.checkedNormals,indices:e instanceof Uint32Array||e instanceof Uint16Array?e:new Uint16Array(e),modelSize:this.Fy,parts:this.Ly}),this.chart.pi.Bs(),this}Ey(t){if(!t)return this;this.Iy=[];let e={id:Al.id,diffuse:Al.diffuse,specular:Al.specular,ambient:Al.ambient,emissive:Al.emissive,specularCoeff:Al.specularCoeff,opacity:1};const i=t.split("\n");for(let t of i){if(t=t.trim(),""===t||t.startsWith("#"))continue;const i=t.split(/\s+/g);switch(i[0].trim().toLowerCase()){case"ka":{const i=yl(t.substring(2).trim()).map(t=>255*t);e.ambient=M(i[0],i[1],i[2])}break;case"ke":{const i=yl(t.substring(2).trim()).map(t=>255*t);e.emissive=M(i[0],i[1],i[2])}break;case"kd":{const i=yl(t.substring(2).trim()).map(t=>255*t);e.diffuse=M(i[0],i[1],i[2])}break;case"ks":{const i=yl(t.substring(2).trim()).map(t=>255*t);e.specular=M(i[0],i[1],i[2])}break;case"d":e.opacity=parseFloat(i[1].trim());break;case"tr":e.opacity=1-parseFloat(i[1].trim());break;case"newmtl":e.diffuse=M(255*e.diffuse.r,255*e.diffuse.g,255*e.diffuse.b,255*e.opacity),e.specular=M(255*e.specular.r,255*e.specular.g,255*e.specular.b,255*e.opacity),e.emissive=M(255*e.emissive.r,255*e.emissive.g,255*e.emissive.b,255*e.opacity),e={id:i[1],diffuse:Al.diffuse,specular:Al.specular,ambient:Al.ambient,emissive:Al.emissive,specularCoeff:Al.specularCoeff,opacity:Al.opacity},this.Iy.push(e)}}return this}setModelMaterial(t){return t?(this.Ey(t),this.setFillStyle(ls),this.Ly?(this.Ly.forEach(t=>{const e=this.Iy.find(e=>e.id.toLowerCase()===t.material.id.toLowerCase());e&&(t.material=e)}),this.Ly.sort((t,e)=>e.material.opacity-t.material.opacity),this.chart.pi.Bs(),this):this):this}setModelFromObj(t){if(!t)return this;const e=new Array,i=new Array,s=new Array,r=new Array,n=new Array,o=new Array,a=new Array;let h={indexStart:0,count:0,offset:0,useIndexBuffer:!1,material:{id:Al.id,diffuse:Al.diffuse,specular:Al.specular,ambient:Al.ambient,emissive:Al.emissive,specularCoeff:Al.specularCoeff,opacity:Al.opacity}},l=0,c=0,u=0,d=0,f=0,g=0,p=0,m=oi,y=ni,x=oi,v=ni,A=oi,S=ni;const b=t.replace(/\r/g,"").split("\n");for(let t of b){if(t=t.trim(),""===t||t.startsWith("#"))continue;const b=t.split(/\s+/g);let M=0;switch(b[0].trim().toLowerCase()){case"v":{const i=yl(t.substring(1).trim()),s=i[0],r=i[1],n=i[2];m=Math.max(m,s),y=Math.min(y,s),x=Math.max(x,r),v=Math.min(v,r),A=Math.max(A,n),S=Math.min(S,n),e.push(...i.slice(0,3)),l+=1,d=l}break;case"vt":{const e=yl(t.substring(2).trim());i.push(...e),c+=1,f=c}break;case"vn":{const e=yl(t.substring(2).trim());s.push(...e),u+=1,g=u}break;case"usemtl":{const t=this.Iy.find(t=>t.id.toLowerCase()===b[1].toLowerCase());p+=a.length>0?h.count:0,h={indexStart:void 0!==h?3*p*2:0,count:0,offset:void 0!==h?1*p:0,useIndexBuffer:!1,material:t||{id:b[1].toLowerCase(),diffuse:Al.diffuse,specular:Al.specular,ambient:Al.ambient,emissive:Al.emissive,specularCoeff:1,opacity:1}},a.push(h)}break;case"fo":M+=1;case"f":M+=1;{const a=vl(t.substring(M).trim());for(let t=0;t<a.vertexIndex.length;t+=1){let i=a.vertexIndex[t];i<0?i+=d:i-=1,i*=3,r.push(e[i]),r.push(e[i+1]),r.push(e[i+2])}if(h.count+=a.vertexIndex.length,a.textureIndex)for(let t=0;t<a.textureIndex.length;t+=1){let e=a.textureIndex[t];e<0?e+=f:e-=1,e*=3,o.push(i[e]),o.push(i[e+1]),o.push(i[e+2])}if(a.normalIndex)for(let t=0;t<a.normalIndex.length;t+=1){let e=a.normalIndex[t];e<0?e+=g:e-=1,e*=3,n.push(s[e]),n.push(s[e+1]),n.push(s[e+2])}}}}this.nu={min:{x:y,y:v,z:S},max:{x:m,y:x,z:A}};for(let t=0;t<r.length;t+=3)r[t]-=this.nu.min.x,r[t+1]-=this.nu.min.y,r[t+2]-=this.nu.min.z;if(this.Fy={x:this.nu.max.x-this.nu.min.x,y:this.nu.max.y-this.nu.min.y,z:this.nu.max.z-this.nu.min.z},a.length<1&&r.length>0&&(h.count=r.length/3,a.push(h)),this.Ly=a,this.by=new Float32Array(r),n.length<1)for(let t=0;t<r.length/9;t+=1){const e={x:r[9*t],y:r[9*t+1],z:r[9*t+2]},i={x:r[9*t+3],y:r[9*t+4],z:r[9*t+5]},s={x:r[9*t+6],y:r[9*t+7],z:r[9*t+8]},o=ri.normalize(ri.cross(ri.subtractVec(e,i),ri.subtractVec(e,s)));for(let t=0;t<3;t+=1)n.push(o.x),n.push(o.y),n.push(o.z)}return this.My=new Float32Array(n.map((t,e)=>n[e])),this.checkedNormals=new Float32Array,this.Iy&&this.Ly.sort((t,e)=>e.material.opacity-t.material.opacity),this.Cc.Dy({vertices:this.by,normals:this.My,indices:this.wy,modelSize:this.Fy,parts:this.Ly}),this.chart.pi.Bs(),this}setVertexValues(t){return this.Cc.Ry(t),this.chart.pi.Bs(),this}setScale(t){const e={x:"number"==typeof t?t:(null==t?void 0:t.x)||1,y:"number"==typeof t?t:(null==t?void 0:t.y)||1,z:"number"==typeof t?t:(null==t?void 0:t.z)||1};return this.ai=e,this.Cc.Oy(e),this.chart.pi.Bs(),this}getScale(){return this.ai}setModelLocation(t){return this.ky=t,this.Cc.zy(t),this.chart.pi.Bs(),this}getModelLocation(){return this.ky}setModelAlignment(t){return this._y=t,this.Cc.Vy(t),this.chart.pi.Bs(),this}getModelAlignment(){return this._y}setModelRotation(t){return this.setModelRotationEuler(t)}getModelRotation(){return this.Cy}setModelRotationEuler(t){const e={x:Ui(t.x),y:Ui(t.y),z:Ui(t.z)};return this.Cy=e,this.Cc.Ny(this.Cy),this.chart.pi.Bs(),this}getModelRotationEuler(){return this.Cy}setModelRotationQuaternion(t){return this.Ty=t,this.Cc.Gy(this.Ty),this.chart.pi.Bs(),this}getModelRotationQuaternion(){return this.Ty}setBackfaceCullingMode(t){return this.Cc.$y(t),this.chart.pi.Bs(),this}getBackfaceCullingMode(){return this.Cc.Uy()}setFillStyle(t){return this.Cc.qe(t),this.chart.pi.Bs(),this}getFillStyle(){return this.Cc.Mh()}setColorShadingStyle(t){return this.checkedNormals||t!==Ks?super.setColorShadingStyle(t):(console.warn("Phong shading style is not supported without normals. Switching to Simple shading style."),super.setColorShadingStyle(new Js.Simple))}xp(){return!1}rr(t,e){t.Ii(e),this.chart.pi.Bs()}Ys(){return Re(this.getFillStyle(),this.Cc._i())}er(){return{fill:this.getFillStyle()}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const bl={None:eo,Rectangle:Ko,Circle:Jo,Diamond:Qo,Pointer:ta};class Ml extends ha{constructor(t,i,s,r,n,o){super(t,i,s,r,n,o),this.qn=this.bi.cursorResultTableTextFont,this.cf=0,this.kp=this.bi.cursorResultTableTextFillStyle,this.Yn=100,this.Zr=e.TextObjectIdentifier.CursorResultTable}setContent(t){var e;let i;void 0===t?i=[]:Array.isArray(t)?(i=[],t.forEach(t=>{i.push(Array.isArray(t)?t:[t])})):i=[[t]];for(let t=0;t<i.length;t+=1){const e=i[t];let s=!1;for(let t=0;t<e.length;t+=1){const i=e[t],r="object"==typeof i&&"text"in i?i.text:"string"==typeof i?i:void 0,n="object"==typeof i&&"icon"in i?i.icon:yr(i)?i:void 0,o=i instanceof Ps&&i;if(!(r&&r.length>0||n||o)){s=!0;break}}s||(e.unshift(""),e.push(""))}const s=i.length;let r=this.getMembers().length;for(let t=0;t<Math.max(s,r);t+=1){const o=this.getRow(t,!0);if(t>=s)this.getMembers()[t].dispose(),t-=1,r-=1;else{const r=i[t].length;let a=o.getMembers().length;for(let h=0;h<Math.max(r,a);h+=1){const l=i[t][h],c="object"==typeof l&&"font"in l?l.font:void 0,u="object"==typeof l&&"fillStyle"in l?l.fillStyle:void 0,d="object"==typeof l&&"text"in l?l.text:"string"==typeof l?l:void 0,f="object"==typeof l&&"icon"in l?l.icon:yr(l)?l:void 0,g=l instanceof Ps&&l||("object"==typeof l&&"component"in l?l.component:void 0),p="object"==typeof l&&"componentColor"in l&&l.componentColor,m="object"==typeof l&&"componentFillStyle"in l&&l.componentFillStyle,y="object"==typeof l&&"rowFillStyle"in l?l.rowFillStyle:void 0,x=o.getMembers();if(h>=r)o.getMembers()[h].dispose(),h-=1,a-=1;else if(void 0!==d&&d.length>0||f||g){const i=c?this.qn.withMutations(t=>{for(const e of Object.keys(c)){const i=c[e];void 0!==i&&t.set(e,i)}return t}):this.qn,r=u||this.kp,a=x[h];if(d){let t;a&&a instanceof Xo?t=a:(a&&a.dispose(),t=o.addElement(qo,h)),t.setText(d).setFont(i).setFillStyle(r).setTextRotation(this.cf)}else if(f){let t;a&&a instanceof ea?t=a:(a&&a.dispose(),t=o.addElement(ia,h)),t.setFillStyle(r).setShape(f).setSize({y:i.size,x:i.size}),t.setMargin(null!==(e=this.bi.uiTextPadding)&&void 0!==e?e:5)}else if(g){let t;a&&"setTextFillStyleHidden"in(n=a)&&"setText"in n?t=a:(a&&a.dispose(),t=o.addElement(Sa.setBackground(bl.None),h).setOn(!0));const e=g.js();void 0!==e&&t.setButtonShape(e),t.setText(g.getName()).setTextFont(i).setTextFillStyle(r).setTextRotation(this.cf),p?t.setButtonOnFillStyle(new fs({color:p})):m?t.setButtonOnFillStyle(m):t.setButtonOnFillStyle(Ie(g.chart.getTheme(),!1,g.er()))}y&&o.setBackground(e=>{e.setFillStyle(y);const i=this.getBackground();_s(i)&&e instanceof Ko&&e.setCornerRadius(i.getCornerRadius(),{topLeft:0===t,topRight:0===t,bottomLeft:t===s-1,bottomRight:t===s-1})})}else{const t=x[h];t&&t instanceof sa||(t&&t.dispose(),o.addGap(void 0,h))}}}}var n;return this.Ws.Bs(),this}ir(){if(super.ir(),this.Ws.pi.xc&&this.getVisible()){const t=Zn(this);this.Ws.pi.xc.FA({...t,blacklist:[e.TextObjectIdentifier.CursorResultTable]})}return this}setTextFillStyle(t){this.kp="function"==typeof t?t(this.kp):t;for(let t=0;t<this.getMemberCount();t+=1){const e=this.getRow(t);for(let t=0;t<e.getMembers().length;t+=1){const i=e.getMembers()[t];i instanceof Xo&&i.setFillStyle(this.kp)}}return this.Ws.Bs(),this}getTextFillStyle(){return this.kp}setTextFont(t){return R(t)?this.qn=t:this.qn=t(this.qn),this.Ws.Bs(),this}getTextFont(){return this.qn}setTextRotation(t){return this.cf=t,this.Ws.Bs(),this}getTextRotation(){return this.cf}Yy(){for(let t=0;t<this.Wd.length;t+=1)for(let e=0;e<this.Wd[t].getMembers().length;e+=1)this.Wd[t].getMembers()[e].dispose()}Nh(){for(let t=0;t<this.Wd.length;t+=1)this.Wd[t].setMinimumSize(void 0);super.Nh();for(let t=0;t<this.Wd.length;t+=1)this.Wd[t].setMinimumSize(this.size.x);return super.Nh(),this}}class El{constructor(t,e,i,s,r,n){this.jy=[],this.Hy=!0,this.Wy=!0,this.Cg=!1,this.di=!0,this.ci=!1,this.Xy=[],this.Zy=!0,this.D=new vt,this.Ws=t,this.renderingScale=e,this.scale=i,this.Jy=s,this.Qy=r,this.bi=n,this.Ky=new Ml(this.Ws,this.renderingScale,this.scale,this.Qy,jt,n).setPointerEvents(!1).setBackground(t=>t.setFillStyle(n.cursorResultTableFillStyle).setStrokeStyle(n.cursorResultTableStrokeStyle)).setTextFillStyle(n.cursorResultTableTextFillStyle).setTextFont(n.cursorResultTableTextFont),this.qy=new Tl(t=>this.Ky.setOrigin(t),()=>this.Ky.getOrigin()),this.tm=new Tl(t=>this.Ky.setPosition(t),()=>this.Ky.getPosition())}isDisposed(){return this.ci}setPointMarkerVisible(t){return this.Hy=t,this.jy.forEach(e=>e.pointMarker.setVisible(e.targetVisible&&t)),this.Ws.Bs(),this}getPointMarkerVisible(){return this.Hy}setPointMarker(t){return this.jy.forEach(e=>t(e.pointMarker)),this.Xy.push(t),this.Ws.Bs(),this}setResultTableVisible(t){return this.Wy=t,this.Ws.Bs(),this}getResultTableVisible(){return this.Wy}setResultTable(t){return t(this.Ky),this.Ws.Bs(),this}setAutoFit(t){return this.Zy=t,this.qy.resetValue(),this.tm.resetValue(),this.Ws.Bs(),this}getAutoFit(){return this.Zy}setVisible(t){return this.di=t,this.Ws.Bs(),this}getVisible(){return this.di}dispose(){return this.jy.forEach(t=>t.pointMarker.dispose()),this.Ky.dispose(),this.Xy.length=0,this.Jy(this),this.D.R("dispose",{}),this}im(){const t=this.Ky,i=this.Ws.pi.ai,s=tt(t.getPosition(l(-1,-1),e.UISpace.PaddedBackground),t.scale,i),r=tt(t.getPosition(l(1,1),e.UISpace.PaddedBackground),t.scale,i),n=s.x<i.x.getInnerStart()||r.x>i.x.getInnerEnd(),o=s.y<i.y.getInnerStart()||r.y>i.y.getInnerEnd();return{x:n,y:o,either:n||o,resultTableViewport:this.Ky.Ws.pi.ai,resultTableViewportBounds:{x:{min:Math.min(i.x.getInnerStart(),i.x.getInnerEnd()),max:Math.max(i.x.getInnerStart(),i.x.getInnerEnd())},y:{min:Math.min(i.y.getInnerStart(),i.y.getInnerEnd()),max:Math.max(i.y.getInnerStart(),i.y.getInnerEnd())}}}}ir(){if(this.di){(this.qy.isAltered()||this.tm.isAltered())&&(this.qy.resetValue(),this.tm.resetValue(),this.Ky.Nh());let t=this.Zy&&this.im();if(t&&t.either){const i=t.resultTableViewport;let s=tt(this.Ky.getPosition(l(-1,-1),e.UISpace.PaddedBackground),this.Ky.scale,i),r=tt(this.Ky.getPosition(l(1,1),e.UISpace.PaddedBackground),this.Ky.scale,i);const n=t.resultTableViewportBounds,o=this.Ky.getOrigin();let a={x:0,y:0},h={...o};if(r.y>n.y.max?a.y=n.y.max-r.y:s.y<n.y.min&&(a.y=n.y.min-s.y),(r.x>n.x.max||s.x<n.x.min)&&(h.x*=-1),0!==a.x||0!==a.y||h.x!==o.x||h.y!==o.y){const o=this.Ky.getPosition(),c=tt(o,this.Ky.scale,i);let u={x:c.x+a.x,y:c.y+a.y},d=tt(u,i,this.Ky.scale);this.tm.alter(d),this.qy.alter(h),this.Ky.Nh(),t=this.im(),t.x&&(s=tt(this.Ky.getPosition(l(-1,-1),e.UISpace.PaddedBackground),this.Ky.scale,i),r=tt(this.Ky.getPosition(l(1,1),e.UISpace.PaddedBackground),this.Ky.scale,i),r.x>n.x.max?a.x=n.x.max-r.x:s.x<n.x.min&&(a.x=n.x.min-s.x),u={x:c.x+a.x,y:c.y+a.y},d=tt(u,i,this.Ky.scale),this.tm.alter(d),this.Ky.Nh())}}}return this.jy.forEach(t=>t.pointMarker.setVisible(t.targetVisible&&this.Cg&&this.di&&this.Hy)),this.jy.forEach(t=>t.pointMarker.ir()),this.Ky.ir(),this}Nh(){return this.Ky.setVisible(this.Cg&&this.di&&this.Wy),this.jy.forEach(t=>t.pointMarker.Nh()),this.Ky.Nh(),this}sm(t,e){const i=e===this.scale?t:tt(t,e,this.scale);this.Ky.setPosition(i)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const kl=(t,e)=>t.setResultTable(t=>t.setEffect(!0).setOrigin(l(-1,-1)).setMargin(.5*e.cursorPointMarkerSize.x+2).setBackground(t=>{e.cursorResultTableBorderRadius&&_s(t)&&t.setCornerRadius(e.cursorResultTableBorderRadius)}));class Tl{constructor(t,e){this.rm=t,this.hm=e}alter(t){this.nm=void 0!==this.nm?this.nm:this.hm(),this.om=t,this.rm(t)}resetValue(){void 0!==this.om&&(void 0!==this.nm&&this.isAltered()&&this.rm(this.nm),this.nm=void 0,this.om=void 0)}getNormalValue(){return void 0!==this.nm?this.nm:this.hm()}isAltered(){return void 0!==this.om&&this.hm()===this.om}}class wl extends El{constructor(t,i,s,r,n,o,a){super(t,i,s,r,n,o),this.chart=a,this.am=this.chart.getDefaultAxisX().addCustomTick().setVisible(!1).setGridStrokeStyle(o.cursor3DGridStrokeStyleX).setTickStyle(o.cursor3DTickStrokeStyleX).setTextFillStyle(o.cursor3DTickLabelFillStyleX).setTextFont(o.cursor3DTickLabelFontX).setBackgroundFillStyle(o.cursor3DTickLabelBackgroundFillStyleX).setBackgroundStrokeStyle(o.cursor3DTickLabelBackgroundStrokeStyleX).setPadding(o.cursor3DTickLabelPaddingX),this.lm=this.chart.getDefaultAxisY().addCustomTick().setVisible(!1).setGridStrokeStyle(o.cursor3DGridStrokeStyleY).setTickStyle(o.cursor3DTickStrokeStyleY).setTextFillStyle(o.cursor3DTickLabelFillStyleY).setTextFont(o.cursor3DTickLabelFontY).setBackgroundFillStyle(o.cursor3DTickLabelBackgroundFillStyleY).setBackgroundStrokeStyle(o.cursor3DTickLabelBackgroundStrokeStyleY).setPadding(o.cursor3DTickLabelPaddingY),this.um=this.chart.getDefaultAxisZ().addCustomTick().setVisible(!1).setGridStrokeStyle(o.cursor3DGridStrokeStyleZ).setTickStyle(o.cursor3DTickStrokeStyleZ).setTextFillStyle(o.cursor3DTickLabelFillStyleZ).setTextFont(o.cursor3DTickLabelFontZ).setBackgroundFillStyle(o.cursor3DTickLabelBackgroundFillStyleZ).setBackgroundStrokeStyle(o.cursor3DTickLabelBackgroundStrokeStyleZ).setPadding(o.cursor3DTickLabelPaddingZ),this.am.Zr=e.TextObjectIdentifier.CursorTickMarker,this.lm.Zr=e.TextObjectIdentifier.CursorTickMarker,this.um.Zr=e.TextObjectIdentifier.CursorTickMarker}setTickX(t){return t(this.am),this.chart.pi.Bs(),this}setTickY(t){return t(this.lm),this.chart.pi.Bs(),this}setTickZ(t){return t(this.um),this.chart.pi.Bs(),this}setTicks(t){return t(this.am),t(this.lm),t(this.um),this.chart.pi.Bs(),this}dispose(){return super.dispose(),this.am.dispose(),this.lm.dispose(),this.um.dispose(),this}ir(){return this.am.setVisible(this.di&&this.Cg),this.lm.setVisible(this.di&&this.Cg),this.um.setVisible(this.di&&this.Cg),super.ir()}setPosition(...t){if(0===t.length)return this;const e=t[0];this.Cg=!0;const i=this.renderingScale,s=Eh(e.resultTableScale,i),r=s===this.scale?e.resultTable:tt(e.resultTable,s,this.scale);this.Ky.setPosition(r),this.am.setValue(e.axisLocation.x),this.lm.setValue(e.axisLocation.y),this.um.setValue(e.axisLocation.z);let n=this.jy[0];if(!n){const t=new ea(this.Ws,this.renderingScale,this.scale,jt,this.bi).setPointerEvents(!1).setFillStyle(this.bi.cursorPointMarkerFillStyle).setStrokeStyle(this.bi.cursorPointMarkerStrokeStyle).setSize(this.bi.cursorPointMarkerSize).setShape(this.bi.cursorPointMarkerShape);n={pointMarker:t,targetVisible:!0},this.jy.push(n),this.Xy.forEach(e=>e(t))}return e.pointMarkerShape&&n.pointMarker.setShape(e.pointMarkerShape),e.pointMarkerSize&&n.pointMarker.setSize(e.pointMarkerSize),e.pointMarkerFillStyle&&n.pointMarker.setFillStyle(e.pointMarkerFillStyle),e.pointMarkerStrokeStyle&&n.pointMarker.setStrokeStyle(e.pointMarkerStrokeStyle),n.pointMarker.setPosition(r),this.chart.pi.Bs(),this}}class Cl{constructor(t,e){this.dm=[],this.fm=(t,e)=>(this.dm.forEach(i=>i(t,e)),t),this.addStyler=t=>new Cl(this.Qy,this.dm.map(t=>t).concat(t)),this.setResultTableBackground=t=>new Cl(t,this.dm.map(t=>t)),this.Am=(t,e,i,s,r,n)=>this.fm(new wl(t,e,i,s,this.Qy,r,n),r),this.Qy=t,this.dm=e}}const Bl=new Cl(Ko,[(t,e)=>{kl(t,e)}]),Fl=(t,e,i,s)=>{t.background.addEventListener(e,i,s),t.seriesBackground.addEventListener(e,i,s),t.getSeries().forEach(t=>t.addEventListener(e,i,s));const r=t=>t.series.addEventListener(e,i,s);return t.addEventListener("seriesadd",r),()=>{t.background.removeEventListener(e,i),t.seriesBackground.removeEventListener(e,i),t.getSeries().forEach(t=>t.removeEventListener(e,i)),t.removeEventListener("seriesadd",r)}},Dl=(t,i,s,r)=>{var n,o,a,h,l,c;si(),i.camera&&s.gm(),i.x&&t.axisX.fit(null!==(n=i.animationsEnabled)&&void 0!==n?n:void 0,null!==(o=i.stopScroll)&&void 0!==o?o:void 0),i.y&&t.axisY.fit(null!==(a=i.animationsEnabled)&&void 0!==a?a:void 0,null!==(h=i.stopScroll)&&void 0!==h?h:void 0),i.z&&t.axisZ.fit(null!==(l=i.animationsEnabled)&&void 0!==l?l:void 0,null!==(c=i.stopScroll)&&void 0!==c?c:void 0);let u=i.cursor;if(null!==u){u=null!=u?u:e.MouseStyles.ZoomOut;const i=t.engine.setMouseStyle(u);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const d=i.on;d&&Ut.requestAnimationFrame(()=>d({event:r}))},Il=(t,e,i,s)=>{si(),t.restorePreviousZoomState();const r=e.on;r&&Ut.requestAnimationFrame(()=>r({event:s}))};class Rl extends hl{constructor(t,i,s,r,n,o,a){var h,c;super(t,i,s,i.Hg("chart3D bg",0),r,i.pi.bi.chart3DBackgroundFillStyle,i.pi.bi.chart3DBackgroundStrokeStyle,i.pi.bi.chart3DTitleFont,i.pi.bi.chart3DTitleFillStyle,i.pi.bi.chart3DTitleShadow,o,null===(h=null==a?void 0:a.legend)||void 0===h?void 0:h.customLegend),this.pm=1,this.vm=[],this.ym=2,this.xm=!0,this.Sm=!0,this.bm=!0,this.Mm=0,this.coordsAxis={id:"axes",chart:this},this.coordsWorld={id:"world",chart:this},this.ua=[],this.wm=[],this._m=!1,this.km=()=>{if(this.ci)return;const t=new Map;this.forEachAxis(e=>{void 0!==e.gA().find(t=>t.yp())&&t.set(e,{...e.getInterval(),stopped:e.getStopped()})}),t.size<=0||(this.wm.push(t),this.wm.length>100&&this.wm.shift())},this.xa=()=>{const t=this.np.Cm();this.Fm.Tm(t),this.Im.Tm(t);const e=this.Lm.viewportChanged(this.Pm());e&&this.Bm(e),this.pi.Bs()},this.D=new vt,this.pi.La(Hn.To),this.Yr.tn("Chart3D"),this.Dm=s.d3(),this.Dm.x.W(-1,1),this.Dm.y.W(-1,1),this.Dm.z.W(-1,1),this.np=i.Em("chart3D layer3D",0,this.Dm),this.Fm=i.Rm("chart3D series bg",0),this.Im=i.Om("chart3D axis ui",1),this.zm={x:new Xh(this,(c=()=>this.fv,{...Jh(c,t=>t.getXMin(),t=>t.getXMax(),t=>t.gn().x),Dp:t=>t.x,qp:(t,e)=>({x:t.x,y:e.y,z:e.z}),ef:d(0,-1,0),Wp:t=>{const e={x:t.x>=0?1:-1,y:t.y>=0?1:-1,z:t.z>=0?1:-1};return{gridlinePositionA:d(0,e.y,e.z),gridlinePositionB:d(0,e.y,-e.z),gridlinePositionC:d(0,-e.y,-e.z)}},sv:()=>!0,ev:()=>!1,Kp:()=>!1}),this.Dm.x,this.bi,this.np,this.Im,this.eA,!1,this.vs),y:new Xh(this,Qh(()=>this.fv),this.Dm.y,this.bi,this.np,this.Im,this.eA,!1,this.vs),z:new Xh(this,tl(()=>this.fv),this.Dm.z,this.bi,this.np,this.Im,this.eA,!1,this.vs)},this.Vm=this.np.Np([Wh.InternalUI],void 0).setPointerEvents(!1),this.setBoundingBoxStrokeStyle(this.bi.chart3DBoundingBoxStrokeStyle),this.yv=this.Fm.Tc(this.pi.ai,To.Simple).qe(this.bi.chart3DSeriesBackgroundFillStyle).Ke(Bt).setPointerEvents(!0),this.mv=this.Fm.Tc(this.pi.ai,To.Simple).qe(ls).Ke(this.bi.chart3DSeriesBackgroundStrokeStyle).setPointerEvents(!1),super.vv(this.yv,this.mv),this.Nm({x:1,y:1,z:1},!0),this.Lm=new cl(this.pi.ai,this.eA,this.Dm,(t,e)=>(e&&this.Bm(e),this.np.Xp(t))),this.Gm=this.Lm.getDefaultCameraConfiguration(this.$m(this.Um),this.getProjection()),this.Bm(this.Gm);const u=qt(a?a.cursorBuilder:void 0,Bl),f=i.Ym();this.jm=ig(this,f,u.Am(f,this.eA,this.eA,jt,this.bi,this),this,"show-pointed",Ll,()=>0),this.setAnimationsEnabled(!1!==(null==a?void 0:a.animationsEnabled)),this.addEventListener("resize",this.xa),this.xa(),this.jg(n,this.eA),this.Hm=(t=>{let e=!1,i=!1,s=!1;const r=(t=>{let e=!0,i=t.getCameraLocation(),s=t.getCameraAutomaticFittingEnabled();return{Wm:()=>{e&&(i=t.getCameraLocation(),s=t.getCameraAutomaticFittingEnabled()),e=!1},gm:()=>{t.setCameraLocation(i).setCameraAutomaticFittingEnabled(s),e=!0}}})(t);let n={};const o=()=>Nt({rotate:{drag:{},ctrl:{drag:!1},shift:{drag:!1},alt:{drag:!1}},zoom:{wheel:{},camera:!0,mode:"centered",pinch:{camera:!1,x:!0,y:!0,z:!0}},restoreDefault:{doubleClick:!0,camera:!0,x:!0,y:!0,z:!0},restorePrevious:!1},n),a=n=>{const a=o();let h=!1,l=!1,c=!1;for(const t of Object.keys(a)){const e=a[t];"object"==typeof e&&(void 0!==e.ctrl&&(h=!0),void 0!==e.shift&&(l=!0),void 0!==e.alt&&(c=!0))}i=n.ctrlKey,e=n.shiftKey,s=n.altKey,("Control"===n.key&&h||"Shift"===n.key&&l||"Alt"===n.key&&c)&&n.preventDefault();const u=Ts(a.restoreDefault,void 0,n,e,i,s);u&&u.code===n.code&&(fe(n),Dl(t,u,r,n));const d=Ts(a.restorePrevious,void 0,n,e,i,s);d&&d.code===n.code&&(fe(n),Il(t,d,0,n))},h=t=>{i=t.ctrlKey,e=t.shiftKey,s=t.altKey},c=()=>{i=!1,e=!1,s=!1};Ut.addEventListener("keydown",a),Ut.addEventListener("keyup",h),Ut.addEventListener("blur",c),t.addEventListener("dispose",()=>{Ut.removeEventListener("keydown",a),Ut.removeEventListener("keyup",h),Ut.removeEventListener("blur",c)});const u=t=>{},d=n=>{const a=ws(!1!==t.pi.Da.Ea),h=o(),c=Ts(h.rotate,"drag",n,e,i,s),u=Ts(h.pan,"drag",n,e,i,s);u&&a.push(()=>((t,e,i,s)=>{const r=t.getCursorMode();t.setCursorMode(void 0);let n=e;"mouse"===e.pointerType&&e.preventDefault();const o=s=>{var r,o,a;if(s.pointerId!==e.pointerId)return;fe(s);const h=s.clientX-n.clientX,l=s.clientY-n.clientY;if(n=s,i&&i.x){const e=h+-l;t.axisX.rv(-Math.sign(e)*(null!==(r=i.sensitivity)&&void 0!==r?r:1)),!1!==i.stopScroll&&t.axisX.setStopped(!0)}if(i&&i.y){const e=-h+l;t.axisY.rv(Math.sign(e)*(null!==(o=i.sensitivity)&&void 0!==o?o:1)),!1!==i.stopScroll&&t.axisY.setStopped(!0)}if(i&&i.z){const e=-h+l;t.axisZ.rv(Math.sign(e)*(null!==(a=i.sensitivity)&&void 0!==a?a:1)),!1!==i.stopScroll&&t.axisZ.setStopped(!0)}const c=null==i?void 0:i.on;c&&Ut.requestAnimationFrame(()=>c({event:s}))},a=i=>{i.pointerId===e.pointerId&&(fe(i),t.setCursorMode(r),Ut.removeEventListener("pointermove",o),Ut.removeEventListener("pointerup",a),t.engine.container.removeEventListener("pointerdown",h),s())},h=i=>{i.pointerId!==e.pointerId&&(t.setCursorMode(r),Ut.removeEventListener("pointermove",o),Ut.removeEventListener("pointerup",a),t.engine.container.removeEventListener("pointerdown",h),s())};Ut.addEventListener("pointermove",o),Ut.addEventListener("pointerup",a),t.engine.container.addEventListener("pointerdown",h),si()})(t,n,u,f())),c&&a.push(()=>((t,e,i,s,r)=>{const n=t.getCursorMode();t.setCursorMode(void 0);let o=e,a=!1,h=0;"mouse"===e.pointerType&&e.preventDefault();const l=s=>{var n,l;if(s.pointerId!==e.pointerId)return;fe(s);const c={x:s.clientX-o.clientX,y:s.clientY-o.clientY};o=s,h+=Ii(c),r.Wm(),t.Xm({x:c.x*(null!==(n=i.sensitivity)&&void 0!==n?n:1),y:-c.y*(null!==(l=i.sensitivity)&&void 0!==l?l:1)}),a||(ii(),a=!0);const u=i.on;u&&Ut.requestAnimationFrame(()=>u({event:s}))},c=i=>{i.pointerId===e.pointerId&&(fe(i),t.setCursorMode(n),Ut.removeEventListener("pointermove",l),Ut.removeEventListener("pointerup",c),t.engine.container.removeEventListener("pointerdown",u),s(),h>=10&&ei("click"))},u=i=>{i.pointerId!==e.pointerId&&(t.setCursorMode(n),Ut.removeEventListener("pointermove",l),Ut.removeEventListener("pointerup",c),t.engine.container.removeEventListener("pointerdown",u),s())};Ut.addEventListener("pointermove",l),Ut.addEventListener("pointerup",c),t.engine.container.addEventListener("pointerdown",u),si()})(t,n,c,f(),r));const d=Ts(h.zoom,"drag",n,e,i,s);d&&a.push(()=>((t,e,i,s,r)=>{const n=t.getCursorMode();t.setCursorMode(void 0);let o=e;"mouse"===e.pointerType&&e.preventDefault();const a=s=>{var n,a,h,l,c,u,d;if(s.pointerId!==e.pointerId)return;fe(s);const f=s.clientX-o.clientX,g=s.clientY-o.clientY;if(o=s,i.x){const e=f+-g;t.axisX.hv(null!==(n=i.mode)&&void 0!==n?n:"centered",Math.sign(e),null!==(a=i.sensitivity)&&void 0!==a?a:1),!1!==i.stopScroll&&t.axisX.setStopped(!0)}if(i.y){const e=-f+g;t.axisY.hv(null!==(h=i.mode)&&void 0!==h?h:"centered",-Math.sign(e),null!==(l=i.sensitivity)&&void 0!==l?l:1),!1!==i.stopScroll&&t.axisY.setStopped(!0)}if(i.z){const e=-f+g;t.axisZ.hv(null!==(c=i.mode)&&void 0!==c?c:"centered",-Math.sign(e),null!==(u=i.sensitivity)&&void 0!==u?u:1),!1!==i.stopScroll&&t.axisZ.setStopped(!0)}if(i.camera){const e=f+-g;r.Wm(),t.Zm(-.15*Math.sign(e)*(null!==(d=i.sensitivity)&&void 0!==d?d:1))}const p=i.on;p&&Ut.requestAnimationFrame(()=>p({event:s}))},h=i=>{i.pointerId===e.pointerId&&(fe(i),t.setCursorMode(n),Ut.removeEventListener("pointermove",a),Ut.removeEventListener("pointerup",h),t.engine.container.removeEventListener("pointerdown",l),s())},l=e=>{t.setCursorMode(n),Ut.removeEventListener("pointermove",a),Ut.removeEventListener("pointerup",h),t.engine.container.removeEventListener("pointerdown",l),s()};Ut.addEventListener("pointermove",a),Ut.addEventListener("pointerup",h),t.engine.container.addEventListener("pointerdown",l),si()})(t,n,d,f(),r)),a.end();const g=Ts(h.rotate,"pinch",n,e,i,s),p=Ts(h.pan,"pinch",n,e,i,s),m=Ts(h.zoom,"pinch",n,e,i,s);(g||m||p)&&((t,e,i,s,r,n,o)=>{if(!i&&!s&&!r)return;const a=c=>{if(c.pointerId===e.pointerId)return;const u=n();let d;t.engine.container.removeEventListener("pointerdown",a),Ut.removeEventListener("pointerup",h);let f,g=c;const p=c,m=t.getCursorMode();t.setCursorMode(void 0);const y=t.getCameraLocation();let x,v,A;const S=[],b=()=>{var n,a,h,u,m,b,E,k;M=void 0;const T=d,w=g;if(S.forEach(t=>{t.pointerId===e.pointerId?d=t:t.pointerId===c.pointerId&&(g=t)}),S.length=0,f=f||d,void 0===d||void 0===T||void 0===f)return;if(!v||!A){const e=t=>{for(;t<0;)t+=360;for(;t>360;)t-=360;return t},i=(i,s)=>{const r=t.np.Xp(i),n=t.np.Xp(s);if(!r||!n)return{deg:-1,dir:{x:0,y:0}};const o=t.pi.sl({engineX:r.x,engineY:r.y}),a=t.pi.sl({engineX:n.x,engineY:n.y});return{deg:e(Gi(Pi(n,r))),dir:Fi(Pi({x:a.clientX,y:a.clientY},{x:o.clientX,y:o.clientY}))}},s=t.axisX.getInterval(),r=t.axisY.getInterval(),n=t.axisZ.getInterval(),o={x:i({x:s.start,y:r.start,z:n.start},{x:s.end,y:r.start,z:n.start}),y:i({x:s.start,y:r.start,z:n.start},{x:s.start,y:r.end,z:n.start}),z:i({x:s.end,y:r.start,z:n.start},{x:s.end,y:r.start,z:n.end})},a=t.pi.il(f),h=t.pi.il(p),l=e(Gi(Pi({x:h.engineX,y:h.engineY},{x:a.engineX,y:a.engineY})));v=["x","y","z"].reduce((t,i)=>{const s=Math.abs(o[i].deg-l),r=Math.abs(e(o[i].deg+180)-l),n=Math.min(s,r);return Math.min(n,r)<t.angleDiff?{angleDiff:n,axis:i}:t},{axis:"x",angleDiff:1e3}).axis,A=o[v].dir}const C=d.clientX-T.clientX,B=d.clientY-T.clientY,F=g.clientX-w.clientX,D=g.clientY-w.clientY,I=Math.sqrt((f.clientX-p.clientX)**2+(f.clientY-p.clientY)**2),R=Math.sqrt((d.clientX-g.clientX)**2+(d.clientY-g.clientY)**2),L=ri.length(y),P=I/R*(null!==(n=null==r?void 0:r.sensitivity)&&void 0!==n?n:1)*L,z=l((null!==(a=null==i?void 0:i.sensitivity)&&void 0!==a?a:1)*(C+F)/2,(null!==(h=null==i?void 0:i.sensitivity)&&void 0!==h?h:1)*-(B+D)/2);o.Wm(),(i||(null==r?void 0:r.camera))&&(t.vm.push({type:"rotate+zoom",rotation:i?z:{x:0,y:0},cameraDistance:(null==r?void 0:r.camera)?P:L}),t.pi.Bs());const _=void 0===x?0:R-Ii(x)?1:-1,V=x?.25*(null!==(u=null==r?void 0:r.sensitivity)&&void 0!==u?u:1)*(R-Ii(x)):0;r&&r.x&&("x"===v||void 0===r.y&&void 0===r.z)&&(t.axisX.hv(null!==(m=r.mode)&&void 0!==m?m:"centered",_,V),!1!==r.stopScroll&&t.axisX.setStopped(!0)),r&&r.y&&("y"===v||void 0===r.x&&void 0===r.z)&&(t.axisY.hv(null!==(b=r.mode)&&void 0!==b?b:"centered",_,V),!1!==r.stopScroll&&t.axisY.setStopped(!0)),r&&r.z&&("z"===v||void 0===r.x&&void 0===r.y)&&(t.axisZ.hv(null!==(E=r.mode)&&void 0!==E?E:"centered",_,V),!1!==r.stopScroll&&t.axisZ.setStopped(!0));const N=(T.clientX+w.clientX)/2,O=(T.clientY+w.clientY)/2,U={x:(d.clientX+g.clientX)/2-N,y:(d.clientY+g.clientY)/2-O},G=Ni(Fi(U),A),Y=Ii(U)*G*.3*(null!==(k=null==s?void 0:s.sensitivity)&&void 0!==k?k:1);s&&s.x&&("x"===v||void 0===s.y&&void 0===s.z)&&(t.axisX.rv(-Y),!1!==s.stopScroll&&t.axisX.setStopped(!0)),s&&s.y&&("y"===v||void 0===s.x&&void 0===s.z)&&(t.axisY.rv(-Y),!1!==s.stopScroll&&t.axisY.setStopped(!0)),s&&s.z&&("z"===v||void 0===s.x&&void 0===s.y)&&(t.axisZ.rv(-Y),!1!==s.stopScroll&&t.axisZ.setStopped(!0)),x={x:Math.abs(d.clientX-g.clientX),y:Math.abs(d.clientY-g.clientY)};const Z=(null==s?void 0:s.on)||(null==i?void 0:i.on)||(null==r?void 0:r.on);Z&&Ut.requestAnimationFrame(()=>Z({event:void 0}))};let M;const E=t=>{t.pointerId!==e.pointerId&&t.pointerId!==c.pointerId||(fe(t),S.push(t),M||(M=Ut.requestAnimationFrame(b)))},k=i=>{i.pointerId!==e.pointerId&&i.pointerId!==c.pointerId||(fe(i),t.setCursorMode(m),Ut.removeEventListener("pointermove",E),Ut.removeEventListener("pointerup",k),u(),M&&Ut.cancelAnimationFrame(M))};Ut.addEventListener("pointermove",E),Ut.addEventListener("pointerup",k),si()},h=i=>{i.pointerId===e.pointerId&&(t.engine.container.removeEventListener("pointerdown",a),Ut.removeEventListener("pointerup",h))};t.engine.container.addEventListener("pointerdown",a),Ut.addEventListener("pointerup",h)})(t,n,g,p,m,f,r)};Fl(t,"wheel",n=>{const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.pan,"wheel",n,e,i,s);l&&a.push(()=>((t,e,i)=>{var s,r,n;fe(e),i.x&&(t.axisX.rv(2*Math.sign(e.deltaY)*(null!==(s=i.sensitivity)&&void 0!==s?s:1)),!1!==i.stopScroll&&t.axisX.setStopped(!0)),i.y&&(t.axisY.rv(2*Math.sign(e.deltaY)*(null!==(r=i.sensitivity)&&void 0!==r?r:1)),!1!==i.stopScroll&&t.axisY.setStopped(!0)),i.z&&(t.axisZ.rv(2*Math.sign(e.deltaY)*(null!==(n=i.sensitivity)&&void 0!==n?n:1)),!1!==i.stopScroll&&t.axisZ.setStopped(!0));const o=i.on;o&&Ut.requestAnimationFrame(()=>o({event:e}))})(t,n,l));const c=Ts(h.zoom,"wheel",n,e,i,s);c&&a.push(()=>((t,e,i,s)=>{var r,n,o,a,h,l,c;fe(e),i.x&&(t.axisX.hv(null!==(r=i.mode)&&void 0!==r?r:"centered",-Math.sign(e.deltaY),3*(null!==(n=i.sensitivity)&&void 0!==n?n:1)),!1!==i.stopScroll&&t.axisX.setStopped(!0)),i.y&&(t.axisY.hv(null!==(o=i.mode)&&void 0!==o?o:"centered",-Math.sign(e.deltaY),3*(null!==(a=i.sensitivity)&&void 0!==a?a:1)),!1!==i.stopScroll&&t.axisY.setStopped(!0)),i.z&&(t.axisZ.hv(null!==(h=i.mode)&&void 0!==h?h:"centered",-Math.sign(e.deltaY),3*(null!==(l=i.sensitivity)&&void 0!==l?l:1)),!1!==i.stopScroll&&t.axisZ.setStopped(!0)),i.camera&&(s.Wm(),t.Zm(.5*Math.sign(e.deltaY)*(null!==(c=i.sensitivity)&&void 0!==c?c:1)));const u=i.on;u&&Ut.requestAnimationFrame(()=>u({event:e}))})(t,n,c,r)),a.end()}),Fl(t,"dblclick",n=>{if(n.defaultPrevented)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.restoreDefault,void 0,n,e,i,s);l&&l.doubleClick&&(fe(n),Dl(t,l,r,n));const c=Ts(h.restorePrevious,void 0,n,e,i,s);c&&c.doubleClick&&(fe(n),Il(t,c,0,n)),a.end()}),Fl(t,"click",n=>{if(n.defaultPrevented)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.restoreDefault,void 0,n,e,i,s);l&&l.singleClick&&(fe(n),Dl(t,l,r,n));const c=Ts(h.restorePrevious,void 0,n,e,i,s);c&&c.singleClick&&(fe(n),Il(t,c,0,n)),a.end()}),Fl(t,"contextmenu",n=>{if(n.defaultPrevented)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.restoreDefault,"rmb",n,e,i,s);l&&l.singleClick&&(fe(n),Dl(t,l,r,n));const c=Ts(h.restorePrevious,"rmb",n,e,i,s);c&&c.singleClick&&(fe(n),Il(t,c,0,n)),a.end()});const f=()=>(g(),p(),()=>{g=Fl(t,"pointermove",u),p=Fl(t,"pointerdown",d)});let g=Fl(t,"pointermove",u),p=Fl(t,"pointerdown",d);return{setUserInteractions:t=>{if(void 0===t)n={rotate:!1,zoom:!1,pan:!1,restoreDefault:!1,restorePrevious:!1};else if(0===Object.keys(t).length)n={};else for(const e of Object.keys(t))!1===t[e]||"object"==typeof t[e]?n[e]=t[e]:n[e]={}},getUserInteractions:o}})(this),this.Jm(this.axisX),this.Jm(this.axisY),this.Jm(this.axisZ);const g={position:e.LegendPosition.RightCenter,backgroundVisible:!0,...null==a?void 0:a.legend};this.legend.setOptions(g)}restorePreviousZoomState(t){if(this.wm.length<=1)return this;this.wm.pop();const e=this.wm[this.wm.length-1];return e?(this._m=!0,this.forEachAxis(i=>{if((null==t?void 0:t.whitelist)&&!t.whitelist.includes(i))return;const s=e.get(i);s?i.li(s.start,s.end,null==t?void 0:t.animate,void 0!==(null==t?void 0:t.stopAxisAfter)?t.stopAxisAfter:s.stopped,"userSetInterval"):i.fit(null==t?void 0:t.animate,null==t?void 0:t.stopAxisAfter)}),this._m=!1,this):this}clearPreviousZoomStateHistory(){if(void 0!==this.Qm)this.wm.length=0;else for(;this.wm.length>1;)this.wm.unshift();return this}Jm(t){const e=()=>{this._m||(this.Qm&&Ut.clearTimeout(this.Qm),this.Qm=Ut.setTimeout(()=>{this.km(),this.Qm=void 0},300))};Ut.requestAnimationFrame(()=>{e()}),t.addEventListener("intervalchange",e),t.addEventListener("dispose",()=>{this.wm.forEach(e=>{e.delete(t)})})}setUserInteractions(t){return this.Hm.setUserInteractions(t),this}getUserInteractions(){return this.Hm.getUserInteractions()}setProjection(t){this.np.Km(t);const e=this.Lm.projectionChanged(this.Pm(),t);return e&&this.Bm(e),this.pi.Bs(),this}getProjection(){return this.np.qm()}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Bl){const e=this.Eg(),i=t.Am(e,this.eA,this.eA,this.Lg(e),this.bi,this);return this.Ug(i),i}addPointSeries(t){const e=new(t&&t.type||nl)(this,this.gv,this.np,this.bi,this.pi.vs,t);return this.xv(e,t),e}addLineSeries(t){const e=new il(this,this.gv,this.np,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs,t);return this.xv(e,t),e}addPointLineSeries(t){const e=new sl(this,this.gv,this.np,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs,t);return this.xv(e,t),e}addSurfaceGridSeries(t){const e=new fl(this,this.gv,this.np,t,this.bi,this.pi.vs);return this.xv(e,t),e}addSurfaceScrollingGridSeries(t){const e=new gl(this,this.gv,this.np,t,this.bi,this.pi.vs);return this.xv(e,t),e}addBoxSeries(t){const e=new Yh(this,this.gv,this.np,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs);return this.xv(e,t),e}addMeshModel(t){const e=new Sl(this,this.gv,this.np,this.bi,t,this.pi.vs);return this.xv(e,t),e}translateCoordinate(t,e,i){if(pl(e)||pl(i)||ml(t)){if(pl(e)&&pl(i)&&ml(t)){if("axes"===e.id&&"world"===i.id)return this.np.ix(t);if("world"===e.id&&"axes"===i.id)return this.np.sx(t);if(e.id===i.id)return t}if(pl(e)&&Ss(i)&&ml(t)){const e=this.np.Xp(t);return e?this.pi.sl({engineX:e.x,engineY:e.y}):{clientX:-1,clientY:-1}}if(pl(e)&&Ms(i)&&ml(t)){const e=this.np.Xp(t);return e?tt(e,this.pi.ai,this.eA):{clientX:-1,clientY:-1}}throw new Error("translateCoordinate unexpected error. Input or target coordinate system not recognized.")}return kh(t,e,i,this.eA,this.pi)}getDefaultAxisX(){return this.zm.x}getDefaultAxisY(){return this.zm.y}getDefaultAxisZ(){return this.zm.z}get axisX(){return this.getDefaultAxisX()}get xAxis(){return this.getDefaultAxisX()}get axisY(){return this.getDefaultAxisY()}get yAxis(){return this.getDefaultAxisY()}get axisZ(){return this.getDefaultAxisZ()}get zAxis(){return this.getDefaultAxisZ()}getDefaultAxes(){return[this.zm.x,this.zm.y,this.zm.z]}setCameraLocation(t){let e={location:t,direction:ri.normalize(ri.multiply(t,-1))};const i=this.Lm.cameraLocationChanged(this.Pm(e));return i&&(e=i),this.Bm(e),this.pi.Bs(),this}getCameraLocation(){return this.np.getCameraLocation()}getCameraDirection(){return this.np.getCameraDirection()}setCameraAutomaticFittingEnabled(t){this.Lm.Nv(t);const e=this.Lm.cameraLocationChanged(this.Pm());return e&&this.Bm(e),this}getCameraAutomaticFittingEnabled(){return this.Lm.Jv()}setBoundingBoxStrokeStyle(t){return this.Vm.cr(t).Vp(Zh(this.Vm.do())),this.np.Bs(),this}getBoundingBoxStrokeStyle(){return this.Vm.do()}setBoundingBox(t){return this.Nm(t,!1),this}Nm(t,e){this.Um=t;const i=this.$m(t);if(this.Dm.x.Z(i.x),this.Dm.y.Z(i.y),this.Dm.z.Z(-i.z),!e){const t=this.Lm.boundingBoxChanged(this.Pm());t&&this.Bm(t)}this.pi.Bs()}getBoundingBox(){return this.Um}ir(t){const e=Uh.tp(this.Yr,this.Wg);this.Os.forEach(t=>t.Nh(e,this.Gn));const i=Xe;if(Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,i),0!==this.Mm){const e=this.Mm*t*.006;this.vm.push({type:"wheel-zoom",deltaY:e}),this.Mm=Math.sign(this.Mm)*Math.max(Math.abs(this.Mm)-.01*t,0),0!==this.Mm&&this.pi.Bs(!0)}const s=this.getCameraDirection();if(this.vm.length>0){const t=this.Lm.applyCameraInteractions(this.Pm(),this.vm);t&&this.Bm(t),this.vm.length=0}this.hx&&ri.equals(this.hx.location,this.Gm.location)&&ri.equals(this.hx.direction,this.Gm.direction)||this.D.R("camerachange",{cameraLocation:this.getCameraLocation()}),this.hx=this.Gm,super.ir(t);for(let t=0;t<this.fv.length;t+=1)this.fv[t].cp();for(let t=0;t<this.fv.length;t+=1)this.fv[t].ir();this.zm.x.pn(),this.zm.y.pn(),this.zm.z.pn();const r=this.zm.x.Nh(this.zm.x.Qp(s)),n=this.zm.y.Nh(this.zm.y.Qp(s)),o=this.zm.z.Nh(this.zm.z.Qp(s));this.zm.x.ir(r),this.zm.y.ir(n),this.zm.z.ir(o),this.jm.ir(!1,this.fv,void 0),super.Yg();const a=this.Dm,h=d(a.x.getInnerStart(),a.y.getInnerStart(),a.z.getInnerStart()),l=d(a.x.getInnerEnd(),a.y.getInnerEnd(),a.z.getInnerEnd());this.Vm.Vi().bu([d(l.x,h.y,h.z),d(l.x,l.y,h.z),d(l.x,l.y,l.z),d(l.x,h.y,l.z),d(h.x,h.y,l.z),d(h.x,l.y,l.z),d(l.x,l.y,l.z),d(l.x,l.y,h.z),d(h.x,l.y,h.z),d(h.x,l.y,l.z),d(h.x,h.y,l.z),d(h.x,h.y,h.z)]);const c=[d(h.x,h.y,h.z),d(l.x,h.y,h.z),d(h.x,l.y,h.z),d(l.x,l.y,h.z),d(h.x,h.y,l.z),d(l.x,h.y,l.z),d(h.x,l.y,l.z),d(l.x,l.y,l.z)].map(t=>this.np.Xp(t)),u=this.np.Xp(d((h.x+l.x)/2,(h.y+l.y)/2,(h.z+l.z)/2)),f=Ce(c,u),g=[];for(let t=0;t<f.length;t+=1){const e=f[t];Ti(e,u,f[t>0?t-1:f.length-1],f[t<f.length-1?t+1:0])||g.push(e)}const p=Ce(g,u);this.yv.au(p),this.mv.au(p);for(let t=0;t<this.fv.length;t+=1)this.fv[t].dp();this.Os.forEach(t=>t.ir(e,this.Gn))}dispose(){return this.ua.forEach(t=>{t()}),this.ua.length=0,this.Dm.G(),this.np.G(),this.Im.G(),this.Fm.G(),this.jm.G(),super.dispose()}j(){return this.Dm.x.j(),this.Dm.y.j(),this.Dm.z.j(),super.j()}H(){return super.H()}Bm(t){this.np.setCameraLocation(t.location).setCameraDirection(t.direction).setLightLocation(ri.addVec(t.location,ri.multiply(t.direction,-this.ym))),this.Gm=t,this.pi.Bs()}$m(t){return ri.divide(t,ri.length(t)/this.pm)}Pm(t=this.Gm){return{boundingBox:this.$m(this.Um),cameraLocation:t.location,cameraDirection:t.direction,projection:this.getProjection()}}forEachAxis(t){return t(this.zm.x),t(this.zm.y),t(this.zm.z),this}getSeries(){return this.fv}getMinimumSize(){}setAnimationsEnabled(t){return super.setAnimationsEnabled(t),this.setAnimationZoom(t),this.forEachAxis(e=>e.setAnimationsEnabled(t)),this}setAnimationZoom(t){return this.xm=!!t,this}getAnimationZoom(){return this.xm}Xm(t){this.vm.push({type:"rotate",rotation:t}),this.pi.Bs()}Zm(t){this.xm?Math.sign(this.Mm)!==Math.sign(t)?this.Mm=t:this.Mm+=t:this.vm.push({type:"wheel-zoom",deltaY:t}),this.pi.Bs()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Ll=(t,e,i)=>{var s,r;const n=t.axisX.getTitle()||void 0,o=t.axisY.getTitle()||void 0,a=t.axisZ.getTitle()||void 0;return st(e)?Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[...n?[n,""]:[],{text:Bs(e.axisX.formatValue(e.x),e.axisX),font:{weight:"bold"}}],[...o?[o,""]:[],{text:Bs(e.axisY.formatValue(e.y),e.axisY),font:{weight:"bold"}}],[...a?[a,""]:[],{text:Bs(e.axisZ.formatValue(e.z),e.axisZ),font:{weight:"bold"}}],void 0!==e.intensity?["Value","",{text:Bs(e.lut?os(e.lut,e.intensity):e.intensity.toFixed(2),null===(s=e.lut)||void 0===s?void 0:s.units),font:{weight:"bold"}}]:[]]):nt(e)?Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],void 0!==e.value?["Value","",{text:Bs(e.lut?os(e.lut,e.value):e.value.toFixed(2),null===(r=e.lut)||void 0===r?void 0:r.units),font:{weight:"bold"}}]:[]]):Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[...n?[n,""]:[],{text:Bs(e.axisX.formatValue(e.x),e.axisX),font:{weight:"bold"}}],[...o?[o,""]:[],{text:Bs(e.axisY.formatValue(e.y),e.axisY),font:{weight:"bold"}}],[...a?[a,""]:[],{text:Bs(e.axisZ.formatValue(e.z),e.axisZ),font:{weight:"bold"}}]])};class Pl extends El{setPosition(...t){const e=this.renderingScale;if(t.length>0){const i=Eh(t[0].resultTableScale,e),s=i===this.scale?t[0].resultTable:tt(t[0].resultTable,i,this.scale);this.Ky.setPosition(s)}return this.Cg=!1,this.jy.forEach(t=>{t.targetVisible=!1}),t.forEach((t,i)=>{const s=Eh(t.pointMarkerScale,e),r=s===this.scale?t.pointMarker:tt(t.pointMarker,s,this.scale);let n=this.jy[i];if(!n){const t=new ea(this.Ws,this.renderingScale,this.scale,jt,this.bi).setPointerEvents(!1).setFillStyle(this.bi.cursorPointMarkerFillStyle).setStrokeStyle(this.bi.cursorPointMarkerStrokeStyle).setSize(this.bi.cursorPointMarkerSize).setShape(this.bi.cursorPointMarkerShape);n={pointMarker:t,targetVisible:!0},this.jy.push(n),this.Xy.forEach(e=>e(t))}t.pointMarkerShape&&n.pointMarker.setShape(t.pointMarkerShape),t.pointMarkerSize&&n.pointMarker.setSize(t.pointMarkerSize),t.pointMarkerFillStyle&&n.pointMarker.setFillStyle(t.pointMarkerFillStyle),t.pointMarkerStrokeStyle&&n.pointMarker.setStrokeStyle(t.pointMarkerStrokeStyle),n.pointMarker.setPosition(r),n.targetVisible=((t,e,i=e)=>{const s=e!==i?tt(t,e,i):t;return s.x>=i.x.getInnerStart()&&s.x<=i.x.getInnerEnd()&&s.y>=i.y.getInnerStart()&&s.y<=i.y.getInnerEnd()})(t.pointMarker,s),n.targetVisible&&(this.Cg=!0)}),this.Ws.Bs(),this}}class zl{constructor(t,e=[]){this.dm=[],this.fm=(t,e)=>(this.dm.forEach(i=>i(t,e)),t),this.addStyler=t=>new zl(this.Qy,this.dm.map(t=>t).concat(t)),this.setResultTableBackground=t=>new zl(t,this.dm.map(t=>t)),this.Am=(t,e,i,s,r)=>this.fm(new Pl(t,e,i,s,this.Qy,r),r),this.Qy=t,this.dm=e}}const _l=new zl(Ko,[kl]),Vl=_l,Nl=_l,Ol=_l,Ul=_l,Gl=Vl,Yl=new zl(Ko,[kl,t=>t.setPointMarkerVisible(!1).setResultTable(t=>t.setOrigin(tn.LeftBottom))]),Zl=_l,Wl={Angola:{name:"Angola",ISO_A3:"AGO"},Burundi:{name:"Burundi",ISO_A3:"BDI"},Benin:{name:"Benin",ISO_A3:"BEN"},"Burkina Faso":{name:"Burkina Faso",ISO_A3:"BFA"},Botswana:{name:"Botswana",ISO_A3:"BWA"},"Central African Republic":{name:"Central African Republic",ISO_A3:"CAF"},"Ivory Coast":{name:"Ivory Coast",ISO_A3:"CIV"},Cameroon:{name:"Cameroon",ISO_A3:"CMR"},"Democratic Republic of the Congo":{name:"Democratic Republic of the Congo",ISO_A3:"COD"},"Republic of Congo":{name:"Republic of Congo",ISO_A3:"COG"},Comoros:{name:"Comoros",ISO_A3:"COM"},"Cape Verde":{name:"Cape Verde",ISO_A3:"CPV"},Djibouti:{name:"Djibouti",ISO_A3:"DJI"},Algeria:{name:"Algeria",ISO_A3:"DZA"},Egypt:{name:"Egypt",ISO_A3:"EGY"},Eritrea:{name:"Eritrea",ISO_A3:"ERI"},Ethiopia:{name:"Ethiopia",ISO_A3:"ETH"},Gabon:{name:"Gabon",ISO_A3:"GAB"},Ghana:{name:"Ghana",ISO_A3:"GHA"},Guinea:{name:"Guinea",ISO_A3:"GIN"},Gambia:{name:"Gambia",ISO_A3:"GMB"},"Guinea Bissau":{name:"Guinea Bissau",ISO_A3:"GNB"},"Equatorial Guinea":{name:"Equatorial Guinea",ISO_A3:"GNQ"},Israel:{name:"Israel",ISO_A3:"ISR"},Jordan:{name:"Jordan",ISO_A3:"JOR"},Kenya:{name:"Kenya",ISO_A3:"KEN"},Lebanon:{name:"Lebanon",ISO_A3:"LBN"},Liberia:{name:"Liberia",ISO_A3:"LBR"},Libya:{name:"Libya",ISO_A3:"LBY"},Lesotho:{name:"Lesotho",ISO_A3:"LSO"},Morocco:{name:"Morocco",ISO_A3:"MAR"},Madagascar:{name:"Madagascar",ISO_A3:"MDG"},Mali:{name:"Mali",ISO_A3:"MLI"},Malta:{name:"Malta",ISO_A3:"MLT"},Mozambique:{name:"Mozambique",ISO_A3:"MOZ"},Mauritania:{name:"Mauritania",ISO_A3:"MRT"},Mauritius:{name:"Mauritius",ISO_A3:"MUS"},Malawi:{name:"Malawi",ISO_A3:"MWI"},Namibia:{name:"Namibia",ISO_A3:"NAM"},Niger:{name:"Niger",ISO_A3:"NER"},Nigeria:{name:"Nigeria",ISO_A3:"NGA"},Oman:{name:"Oman",ISO_A3:"OMN"},Rwanda:{name:"Rwanda",ISO_A3:"RWA"},"Western Sahara":{name:"Western Sahara",ISO_A3:"ESH"},"Saudi Arabia":{name:"Saudi Arabia",ISO_A3:"SAU"},Sudan:{name:"Sudan",ISO_A3:"SDN"},"South Sudan":{name:"South Sudan",ISO_A3:"SSD"},Senegal:{name:"Senegal",ISO_A3:"SEN"},"Saint Helena":{name:"Saint Helena",ISO_A3:"SHN"},"Sierra Leone":{name:"Sierra Leone",ISO_A3:"SLE"},Somalia:{name:"Somalia",ISO_A3:"SOM"},Swaziland:{name:"Swaziland",ISO_A3:"SWZ"},Seychelles:{name:"Seychelles",ISO_A3:"SYC"},Syria:{name:"Syria",ISO_A3:"SYR"},Chad:{name:"Chad",ISO_A3:"TCD"},Togo:{name:"Togo",ISO_A3:"TGO"},Tunisia:{name:"Tunisia",ISO_A3:"TUN"},"United Republic of Tanzania":{name:"United Republic of Tanzania",ISO_A3:"TZA"},Uganda:{name:"Uganda",ISO_A3:"UGA"},Yemen:{name:"Yemen",ISO_A3:"YEM"},"South Africa":{name:"South Africa",ISO_A3:"ZAF"},Zambia:{name:"Zambia",ISO_A3:"ZMB"},Zimbabwe:{name:"Zimbabwe",ISO_A3:"ZWE"}},jl={Afghanistan:{name:"Afghanistan",ISO_A3:"AFG"},"United Arab Emirates":{name:"United Arab Emirates",ISO_A3:"ARE"},Armenia:{name:"Armenia",ISO_A3:"ARM"},Australia:{name:"Australia",ISO_A3:"AUS"},Azerbaijan:{name:"Azerbaijan",ISO_A3:"AZE"},Bangladesh:{name:"Bangladesh",ISO_A3:"BGD"},Bahrain:{name:"Bahrain",ISO_A3:"BHR"},Brunei:{name:"Brunei",ISO_A3:"BRN"},Bhutan:{name:"Bhutan",ISO_A3:"BTN"},China:{name:"China",ISO_A3:"CHN"},Georgia:{name:"Georgia",ISO_A3:"GEO"},Indonesia:{name:"Indonesia",ISO_A3:"IDN"},India:{name:"India",ISO_A3:"IND"},Iran:{name:"Iran",ISO_A3:"IRN"},Iraq:{name:"Iraq",ISO_A3:"IRQ"},Israel:{name:"Israel",ISO_A3:"ISR"},Jordan:{name:"Jordan",ISO_A3:"JOR"},Japan:{name:"Japan",ISO_A3:"JPN"},Kazakhstan:{name:"Kazakhstan",ISO_A3:"KAZ"},Kyrgyzstan:{name:"Kyrgyzstan",ISO_A3:"KGZ"},Cambodia:{name:"Cambodia",ISO_A3:"KHM"},"South Korea":{name:"South Korea",ISO_A3:"KOR"},Kuwait:{name:"Kuwait",ISO_A3:"KWT"},Laos:{name:"Laos",ISO_A3:"LAO"},Lebanon:{name:"Lebanon",ISO_A3:"LBN"},"Sri Lanka":{name:"Sri Lanka",ISO_A3:"LKA"},Maldives:{name:"Maldives",ISO_A3:"MDV"},Myanmar:{name:"Myanmar",ISO_A3:"MMR"},Mongolia:{name:"Mongolia",ISO_A3:"MNG"},Malaysia:{name:"Malaysia",ISO_A3:"MYS"},Nepal:{name:"Nepal",ISO_A3:"NPL"},Oman:{name:"Oman",ISO_A3:"OMN"},Pakistan:{name:"Pakistan",ISO_A3:"PAK"},Philippines:{name:"Philippines",ISO_A3:"PHL"},"Papua New Guinea":{name:"Papua New Guinea",ISO_A3:"PNG"},"North Korea":{name:"North Korea",ISO_A3:"PRK"},Palestine:{name:"Palestine",ISO_A3:"PSE"},Qatar:{name:"Qatar",ISO_A3:"QAT"},Russia:{name:"Russia",ISO_A3:"RUS"},"Saudi Arabia":{name:"Saudi Arabia",ISO_A3:"SAU"},Singapore:{name:"Singapore",ISO_A3:"SGP"},Syria:{name:"Syria",ISO_A3:"SYR"},Thailand:{name:"Thailand",ISO_A3:"THA"},Tajikistan:{name:"Tajikistan",ISO_A3:"TJK"},Turkmenistan:{name:"Turkmenistan",ISO_A3:"TKM"},Turkey:{name:"Turkey",ISO_A3:"TUR"},Taiwan:{name:"Taiwan",ISO_A3:"TWN"},Uzbekistan:{name:"Uzbekistan",ISO_A3:"UZB"},Vietnam:{name:"Vietnam",ISO_A3:"VNM"},Yemen:{name:"Yemen",ISO_A3:"YEM"}},Hl={"New South Wales":{name:"New South Wales"},Victoria:{name:"Victoria"},Queensland:{name:"Queensland"},"South Australia":{name:"South Australia"},"Western Australia":{name:"Western Australia"},Tasmania:{name:"Tasmania"},"Northern Territory":{name:"Northern Territory"},"Australian Capital Territory":{name:"Australian Capital Territory"},"Other Territories":{name:"Other Territories"}},$l={"British Columbia":{name:"British Columbia"},Quebec:{name:"Quebec"},Nunavut:{name:"Nunavut"},"Prince Edward Island":{name:"Prince Edward Island"},Saskatchewan:{name:"Saskatchewan"},Yukon:{name:"Yukon"},Manitoba:{name:"Manitoba"},Ontario:{name:"Ontario"},"New Brunswick":{name:"New Brunswick"},"Northwest Territories":{name:"Northwest Territories"},Alberta:{name:"Alberta"},"Newfoundland and Labrador":{name:"Newfoundland and Labrador"},"Nova Scotia":{name:"Nova Scotia"}},Xl={Albania:{name:"Albania",ISO_A3:"ALB"},Austria:{name:"Austria",ISO_A3:"AUT"},Belarus:{name:"Belarus",ISO_A3:"BLR"},Belgium:{name:"Belgium",ISO_A3:"BEL"},Bulgaria:{name:"Bulgaria",ISO_A3:"BGR"},"Bosnia and Herzegovina":{name:"Bosnia and Herzegovina",ISO_A3:"BIH"},Switzerland:{name:"Switzerland",ISO_A3:"CHE"},Cyprus:{name:"Cyprus",ISO_A3:"CYP"},"Czech Republic":{name:"Czech Republic",ISO_A3:"CZE"},Germany:{name:"Germany",ISO_A3:"DEU"},Denmark:{name:"Denmark",ISO_A3:"DNK"},Spain:{name:"Spain",ISO_A3:"ESP"},Estonia:{name:"Estonia",ISO_A3:"EST"},Finland:{name:"Finland",ISO_A3:"FIN"},France:{name:"France",ISO_A3:"FRA"},"United Kingdom":{name:"United Kingdom",ISO_A3:"GBR"},Greece:{name:"Greece",ISO_A3:"GRC"},Croatia:{name:"Croatia",ISO_A3:"HRV"},Hungary:{name:"Hungary",ISO_A3:"HUN"},Ireland:{name:"Ireland",ISO_A3:"IRL"},Iceland:{name:"Iceland",ISO_A3:"ISL"},Italy:{name:"Italy",ISO_A3:"ITA"},Kosovo:{name:"Kosovo",ISO_A3:"-99"},Lithuania:{name:"Lithuania",ISO_A3:"LTU"},Luxembourg:{name:"Luxembourg",ISO_A3:"LUX"},Latvia:{name:"Latvia",ISO_A3:"LVA"},Macedonia:{name:"Macedonia",ISO_A3:"MKD"},Malta:{name:"Malta",ISO_A3:"MLT"},Montenegro:{name:"Montenegro",ISO_A3:"MNE"},Netherlands:{name:"Netherlands",ISO_A3:"NLD"},Norway:{name:"Norway",ISO_A3:"NOR"},Poland:{name:"Poland",ISO_A3:"POL"},Portugal:{name:"Portugal",ISO_A3:"PRT"},Romania:{name:"Romania",ISO_A3:"ROU"},"Republic of Serbia":{name:"Republic of Serbia",ISO_A3:"SRB"},Slovakia:{name:"Slovakia",ISO_A3:"SVK"},Slovenia:{name:"Slovenia",ISO_A3:"SVN"},Sweden:{name:"Sweden",ISO_A3:"SWE"},Ukraine:{name:"Ukraine",ISO_A3:"UKR"},Moldova:{name:"Moldova",ISO_A3:"MDA"},Russia:{name:"Russia",ISO_A3:"RUS"},Turkey:{name:"Turkey",ISO_A3:"TUR"}},ql={Aruba:{name:"Aruba",ISO_A3:"ABW"},Afghanistan:{name:"Afghanistan",ISO_A3:"AFG"},Angola:{name:"Angola",ISO_A3:"AGO"},Anguilla:{name:"Anguilla",ISO_A3:"AIA"},Albania:{name:"Albania",ISO_A3:"ALB"},Aland:{name:"Aland",ISO_A3:"ALA"},Andorra:{name:"Andorra",ISO_A3:"AND"},"United Arab Emirates":{name:"United Arab Emirates",ISO_A3:"ARE"},Argentina:{name:"Argentina",ISO_A3:"ARG"},Armenia:{name:"Armenia",ISO_A3:"ARM"},"American Samoa":{name:"American Samoa",ISO_A3:"ASM"},Antarctica:{name:"Antarctica",ISO_A3:"ATA"},"French Southern and Antarctic Lands":{name:"French Southern and Antarctic Lands",ISO_A3:"ATF"},"Antigua and Barbuda":{name:"Antigua and Barbuda",ISO_A3:"ATG"},Australia:{name:"Australia",ISO_A3:"AUS"},Austria:{name:"Austria",ISO_A3:"AUT"},Azerbaijan:{name:"Azerbaijan",ISO_A3:"AZE"},Burundi:{name:"Burundi",ISO_A3:"BDI"},Belgium:{name:"Belgium",ISO_A3:"BEL"},Benin:{name:"Benin",ISO_A3:"BEN"},"Burkina Faso":{name:"Burkina Faso",ISO_A3:"BFA"},Bangladesh:{name:"Bangladesh",ISO_A3:"BGD"},Bulgaria:{name:"Bulgaria",ISO_A3:"BGR"},Bahrain:{name:"Bahrain",ISO_A3:"BHR"},"The Bahamas":{name:"The Bahamas",ISO_A3:"BHS"},"Bosnia and Herzegovina":{name:"Bosnia and Herzegovina",ISO_A3:"BIH"},Belarus:{name:"Belarus",ISO_A3:"BLR"},Belize:{name:"Belize",ISO_A3:"BLZ"},Bermuda:{name:"Bermuda",ISO_A3:"BMU"},Bolivia:{name:"Bolivia",ISO_A3:"BOL"},Brazil:{name:"Brazil",ISO_A3:"BRA"},Barbados:{name:"Barbados",ISO_A3:"BRB"},Brunei:{name:"Brunei",ISO_A3:"BRN"},Bhutan:{name:"Bhutan",ISO_A3:"BTN"},Botswana:{name:"Botswana",ISO_A3:"BWA"},"Central African Republic":{name:"Central African Republic",ISO_A3:"CAF"},Canada:{name:"Canada",ISO_A3:"CAN"},Switzerland:{name:"Switzerland",ISO_A3:"CHE"},Chile:{name:"Chile",ISO_A3:"CHL"},China:{name:"China",ISO_A3:"CHN"},"Ivory Coast":{name:"Ivory Coast",ISO_A3:"CIV"},Cameroon:{name:"Cameroon",ISO_A3:"CMR"},"Cyprus No Mans Area":{name:"Cyprus No Mans Area",ISO_A3:"-99"},"Democratic Republic of the Congo":{name:"Democratic Republic of the Congo",ISO_A3:"COD"},"Republic of Congo":{name:"Republic of Congo",ISO_A3:"COG"},"Cook Islands":{name:"Cook Islands",ISO_A3:"COK"},Colombia:{name:"Colombia",ISO_A3:"COL"},Comoros:{name:"Comoros",ISO_A3:"COM"},"Cape Verde":{name:"Cape Verde",ISO_A3:"CPV"},"Costa Rica":{name:"Costa Rica",ISO_A3:"CRI"},Cuba:{name:"Cuba",ISO_A3:"CUB"},Curaçao:{name:"Curaçao",ISO_A3:"CUW"},"Cayman Islands":{name:"Cayman Islands",ISO_A3:"CYM"},"Northern Cyprus":{name:"Northern Cyprus",ISO_A3:"-99"},Cyprus:{name:"Cyprus",ISO_A3:"CYP"},"Czech Republic":{name:"Czech Republic",ISO_A3:"CZE"},Germany:{name:"Germany",ISO_A3:"DEU"},Djibouti:{name:"Djibouti",ISO_A3:"DJI"},Dominica:{name:"Dominica",ISO_A3:"DMA"},Denmark:{name:"Denmark",ISO_A3:"DNK"},"Dominican Republic":{name:"Dominican Republic",ISO_A3:"DOM"},Algeria:{name:"Algeria",ISO_A3:"DZA"},Ecuador:{name:"Ecuador",ISO_A3:"ECU"},Egypt:{name:"Egypt",ISO_A3:"EGY"},Eritrea:{name:"Eritrea",ISO_A3:"ERI"},"Dhekelia Sovereign Base Area":{name:"Dhekelia Sovereign Base Area",ISO_A3:"-99"},Spain:{name:"Spain",ISO_A3:"ESP"},Estonia:{name:"Estonia",ISO_A3:"EST"},Ethiopia:{name:"Ethiopia",ISO_A3:"ETH"},Finland:{name:"Finland",ISO_A3:"FIN"},Fiji:{name:"Fiji",ISO_A3:"FJI"},"Falkland Islands":{name:"Falkland Islands",ISO_A3:"FLK"},France:{name:"France",ISO_A3:"FRA"},"Faroe Islands":{name:"Faroe Islands",ISO_A3:"FRO"},"Federated States of Micronesia":{name:"Federated States of Micronesia",ISO_A3:"FSM"},Gabon:{name:"Gabon",ISO_A3:"GAB"},"United Kingdom":{name:"United Kingdom",ISO_A3:"GBR"},Georgia:{name:"Georgia",ISO_A3:"GEO"},Guernsey:{name:"Guernsey",ISO_A3:"GGY"},Ghana:{name:"Ghana",ISO_A3:"GHA"},Guinea:{name:"Guinea",ISO_A3:"GIN"},Gambia:{name:"Gambia",ISO_A3:"GMB"},"Guinea Bissau":{name:"Guinea Bissau",ISO_A3:"GNB"},"Equatorial Guinea":{name:"Equatorial Guinea",ISO_A3:"GNQ"},Greece:{name:"Greece",ISO_A3:"GRC"},Grenada:{name:"Grenada",ISO_A3:"GRD"},Greenland:{name:"Greenland",ISO_A3:"GRL"},Guatemala:{name:"Guatemala",ISO_A3:"GTM"},Guam:{name:"Guam",ISO_A3:"GUM"},Guyana:{name:"Guyana",ISO_A3:"GUY"},"Hong Kong S.A.R.":{name:"Hong Kong S.A.R.",ISO_A3:"HKG"},"Heard Island and McDonald Islands":{name:"Heard Island and McDonald Islands",ISO_A3:"HMD"},Honduras:{name:"Honduras",ISO_A3:"HND"},Croatia:{name:"Croatia",ISO_A3:"HRV"},Haiti:{name:"Haiti",ISO_A3:"HTI"},Hungary:{name:"Hungary",ISO_A3:"HUN"},Indonesia:{name:"Indonesia",ISO_A3:"IDN"},"Isle of Man":{name:"Isle of Man",ISO_A3:"IMN"},India:{name:"India",ISO_A3:"IND"},"Indian Ocean Territories":{name:"Indian Ocean Territories",ISO_A3:"-99"},"British Indian Ocean Territory":{name:"British Indian Ocean Territory",ISO_A3:"IOT"},Ireland:{name:"Ireland",ISO_A3:"IRL"},Iran:{name:"Iran",ISO_A3:"IRN"},Iraq:{name:"Iraq",ISO_A3:"IRQ"},Iceland:{name:"Iceland",ISO_A3:"ISL"},Israel:{name:"Israel",ISO_A3:"ISR"},Italy:{name:"Italy",ISO_A3:"ITA"},Jamaica:{name:"Jamaica",ISO_A3:"JAM"},Jersey:{name:"Jersey",ISO_A3:"JEY"},Jordan:{name:"Jordan",ISO_A3:"JOR"},Japan:{name:"Japan",ISO_A3:"JPN"},"Baykonur Cosmodrome":{name:"Baykonur Cosmodrome",ISO_A3:"-99"},"Siachen Glacier":{name:"Siachen Glacier",ISO_A3:"-99"},Kazakhstan:{name:"Kazakhstan",ISO_A3:"KAZ"},Kenya:{name:"Kenya",ISO_A3:"KEN"},Kyrgyzstan:{name:"Kyrgyzstan",ISO_A3:"KGZ"},Cambodia:{name:"Cambodia",ISO_A3:"KHM"},Kiribati:{name:"Kiribati",ISO_A3:"KIR"},"Saint Kitts and Nevis":{name:"Saint Kitts and Nevis",ISO_A3:"KNA"},"South Korea":{name:"South Korea",ISO_A3:"KOR"},Kosovo:{name:"Kosovo",ISO_A3:"-99"},Kuwait:{name:"Kuwait",ISO_A3:"KWT"},Laos:{name:"Laos",ISO_A3:"LAO"},Lebanon:{name:"Lebanon",ISO_A3:"LBN"},Liberia:{name:"Liberia",ISO_A3:"LBR"},Libya:{name:"Libya",ISO_A3:"LBY"},"Saint Lucia":{name:"Saint Lucia",ISO_A3:"LCA"},Liechtenstein:{name:"Liechtenstein",ISO_A3:"LIE"},"Sri Lanka":{name:"Sri Lanka",ISO_A3:"LKA"},Lesotho:{name:"Lesotho",ISO_A3:"LSO"},Lithuania:{name:"Lithuania",ISO_A3:"LTU"},Luxembourg:{name:"Luxembourg",ISO_A3:"LUX"},Latvia:{name:"Latvia",ISO_A3:"LVA"},"Macao S.A.R":{name:"Macao S.A.R",ISO_A3:"MAC"},"Saint Martin":{name:"Saint Martin",ISO_A3:"MAF"},Morocco:{name:"Morocco",ISO_A3:"MAR"},Moldova:{name:"Moldova",ISO_A3:"MDA"},Madagascar:{name:"Madagascar",ISO_A3:"MDG"},Maldives:{name:"Maldives",ISO_A3:"MDV"},Mexico:{name:"Mexico",ISO_A3:"MEX"},"Marshall Islands":{name:"Marshall Islands",ISO_A3:"MHL"},Macedonia:{name:"Macedonia",ISO_A3:"MKD"},Mali:{name:"Mali",ISO_A3:"MLI"},Malta:{name:"Malta",ISO_A3:"MLT"},Myanmar:{name:"Myanmar",ISO_A3:"MMR"},Montenegro:{name:"Montenegro",ISO_A3:"MNE"},Mongolia:{name:"Mongolia",ISO_A3:"MNG"},"Northern Mariana Islands":{name:"Northern Mariana Islands",ISO_A3:"MNP"},Mozambique:{name:"Mozambique",ISO_A3:"MOZ"},Mauritania:{name:"Mauritania",ISO_A3:"MRT"},Montserrat:{name:"Montserrat",ISO_A3:"MSR"},Mauritius:{name:"Mauritius",ISO_A3:"MUS"},Malawi:{name:"Malawi",ISO_A3:"MWI"},Malaysia:{name:"Malaysia",ISO_A3:"MYS"},Namibia:{name:"Namibia",ISO_A3:"NAM"},"New Caledonia":{name:"New Caledonia",ISO_A3:"NCL"},Niger:{name:"Niger",ISO_A3:"NER"},Nigeria:{name:"Nigeria",ISO_A3:"NGA"},Nicaragua:{name:"Nicaragua",ISO_A3:"NIC"},Niue:{name:"Niue",ISO_A3:"NIU"},Netherlands:{name:"Netherlands",ISO_A3:"NLD"},Norway:{name:"Norway",ISO_A3:"NOR"},Nepal:{name:"Nepal",ISO_A3:"NPL"},"New Zealand":{name:"New Zealand",ISO_A3:"NZL"},Oman:{name:"Oman",ISO_A3:"OMN"},Pakistan:{name:"Pakistan",ISO_A3:"PAK"},Panama:{name:"Panama",ISO_A3:"PAN"},"Pitcairn Islands":{name:"Pitcairn Islands",ISO_A3:"PCN"},Peru:{name:"Peru",ISO_A3:"PER"},"Spratly Islands":{name:"Spratly Islands",ISO_A3:"-99"},Philippines:{name:"Philippines",ISO_A3:"PHL"},Palau:{name:"Palau",ISO_A3:"PLW"},"Papua New Guinea":{name:"Papua New Guinea",ISO_A3:"PNG"},Poland:{name:"Poland",ISO_A3:"POL"},"Puerto Rico":{name:"Puerto Rico",ISO_A3:"PRI"},"North Korea":{name:"North Korea",ISO_A3:"PRK"},Portugal:{name:"Portugal",ISO_A3:"PRT"},Paraguay:{name:"Paraguay",ISO_A3:"PRY"},Palestine:{name:"Palestine",ISO_A3:"PSE"},"French Polynesia":{name:"French Polynesia",ISO_A3:"PYF"},Qatar:{name:"Qatar",ISO_A3:"QAT"},Romania:{name:"Romania",ISO_A3:"ROU"},Russia:{name:"Russia",ISO_A3:"RUS"},Rwanda:{name:"Rwanda",ISO_A3:"RWA"},"Western Sahara":{name:"Western Sahara",ISO_A3:"ESH"},"Saudi Arabia":{name:"Saudi Arabia",ISO_A3:"SAU"},Sudan:{name:"Sudan",ISO_A3:"SDN"},"South Sudan":{name:"South Sudan",ISO_A3:"SSD"},Senegal:{name:"Senegal",ISO_A3:"SEN"},Singapore:{name:"Singapore",ISO_A3:"SGP"},"South Georgia and South Sandwich Islands":{name:"South Georgia and South Sandwich Islands",ISO_A3:"SGS"},"Saint Helena":{name:"Saint Helena",ISO_A3:"SHN"},"Solomon Islands":{name:"Solomon Islands",ISO_A3:"SLB"},"Sierra Leone":{name:"Sierra Leone",ISO_A3:"SLE"},"El Salvador":{name:"El Salvador",ISO_A3:"SLV"},Somalia:{name:"Somalia",ISO_A3:"SOM"},"Saint Pierre and Miquelon":{name:"Saint Pierre and Miquelon",ISO_A3:"SPM"},"Republic of Serbia":{name:"Republic of Serbia",ISO_A3:"SRB"},"Sao Tome and Principe":{name:"Sao Tome and Principe",ISO_A3:"STP"},Suriname:{name:"Suriname",ISO_A3:"SUR"},Slovakia:{name:"Slovakia",ISO_A3:"SVK"},Slovenia:{name:"Slovenia",ISO_A3:"SVN"},Sweden:{name:"Sweden",ISO_A3:"SWE"},Swaziland:{name:"Swaziland",ISO_A3:"SWZ"},Seychelles:{name:"Seychelles",ISO_A3:"SYC"},Syria:{name:"Syria",ISO_A3:"SYR"},"Turks and Caicos Islands":{name:"Turks and Caicos Islands",ISO_A3:"TCA"},Chad:{name:"Chad",ISO_A3:"TCD"},Togo:{name:"Togo",ISO_A3:"TGO"},Thailand:{name:"Thailand",ISO_A3:"THA"},Tajikistan:{name:"Tajikistan",ISO_A3:"TJK"},Turkmenistan:{name:"Turkmenistan",ISO_A3:"TKM"},"East Timor":{name:"East Timor",ISO_A3:"TLS"},Tonga:{name:"Tonga",ISO_A3:"TON"},"Trinidad and Tobago":{name:"Trinidad and Tobago",ISO_A3:"TTO"},Tunisia:{name:"Tunisia",ISO_A3:"TUN"},Turkey:{name:"Turkey",ISO_A3:"TUR"},Tuvalu:{name:"Tuvalu",ISO_A3:"TUV"},Taiwan:{name:"Taiwan",ISO_A3:"TWN"},"United Republic of Tanzania":{name:"United Republic of Tanzania",ISO_A3:"TZA"},Uganda:{name:"Uganda",ISO_A3:"UGA"},Ukraine:{name:"Ukraine",ISO_A3:"UKR"},"United States Minor Outlying Islands":{name:"United States Minor Outlying Islands",ISO_A3:"UMI"},Uruguay:{name:"Uruguay",ISO_A3:"URY"},"United States of America":{name:"United States of America",ISO_A3:"USA"},"US Naval Base Guantanamo Bay":{name:"US Naval Base Guantanamo Bay",ISO_A3:"-99"},Uzbekistan:{name:"Uzbekistan",ISO_A3:"UZB"},"Saint Vincent and the Grenadines":{name:"Saint Vincent and the Grenadines",ISO_A3:"VCT"},Venezuela:{name:"Venezuela",ISO_A3:"VEN"},"British Virgin Islands":{name:"British Virgin Islands",ISO_A3:"VGB"},"United States Virgin Islands":{name:"United States Virgin Islands",ISO_A3:"VIR"},Vietnam:{name:"Vietnam",ISO_A3:"VNM"},Vanuatu:{name:"Vanuatu",ISO_A3:"VUT"},"Wallis and Futuna":{name:"Wallis and Futuna",ISO_A3:"WLF"},"Akrotiri Sovereign Base Area":{name:"Akrotiri Sovereign Base Area",ISO_A3:"-99"},Samoa:{name:"Samoa",ISO_A3:"WSM"},Yemen:{name:"Yemen",ISO_A3:"YEM"},"South Africa":{name:"South Africa",ISO_A3:"ZAF"},Zambia:{name:"Zambia",ISO_A3:"ZMB"},Zimbabwe:{name:"Zimbabwe",ISO_A3:"ZWE"},"French Guyana":{name:"French Guyana",ISO_A3:"GUF"}},Kl={Alabama:{name:"Alabama"},Alaska:{name:"Alaska"},Arizona:{name:"Arizona"},Arkansas:{name:"Arkansas"},California:{name:"California"},Colorado:{name:"Colorado"},Connecticut:{name:"Connecticut"},Delaware:{name:"Delaware"},"District of Columbia":{name:"District of Columbia"},Florida:{name:"Florida"},Georgia:{name:"Georgia"},Hawaii:{name:"Hawaii"},Idaho:{name:"Idaho"},Illinois:{name:"Illinois"},Indiana:{name:"Indiana"},Iowa:{name:"Iowa"},Kansas:{name:"Kansas"},Kentucky:{name:"Kentucky"},Louisiana:{name:"Louisiana"},Maine:{name:"Maine"},Maryland:{name:"Maryland"},Massachusetts:{name:"Massachusetts"},Michigan:{name:"Michigan"},Minnesota:{name:"Minnesota"},Mississippi:{name:"Mississippi"},Missouri:{name:"Missouri"},Montana:{name:"Montana"},Nebraska:{name:"Nebraska"},Nevada:{name:"Nevada"},"New Hampshire":{name:"New Hampshire"},"New Jersey":{name:"New Jersey"},"New Mexico":{name:"New Mexico"},"New York":{name:"New York"},"North Carolina":{name:"North Carolina"},"North Dakota":{name:"North Dakota"},Ohio:{name:"Ohio"},Oklahoma:{name:"Oklahoma"},Oregon:{name:"Oregon"},Pennsylvania:{name:"Pennsylvania"},"Rhode Island":{name:"Rhode Island"},"South Carolina":{name:"South Carolina"},"South Dakota":{name:"South Dakota"},Tennessee:{name:"Tennessee"},Texas:{name:"Texas"},Utah:{name:"Utah"},Vermont:{name:"Vermont"},Virginia:{name:"Virginia"},Washington:{name:"Washington"},"West Virginia":{name:"West Virginia"},Wisconsin:{name:"Wisconsin"},Wyoming:{name:"Wyoming"}},Jl={Anguilla:{name:"Anguilla",ISO_A3:"AIA"},"Antigua and Barbuda":{name:"Antigua and Barbuda",ISO_A3:"ATG"},"The Bahamas":{name:"The Bahamas",ISO_A3:"BHS"},Bermuda:{name:"Bermuda",ISO_A3:"BMU"},Barbados:{name:"Barbados",ISO_A3:"BRB"},Canada:{name:"Canada",ISO_A3:"CAN"},Cuba:{name:"Cuba",ISO_A3:"CUB"},"Cayman Islands":{name:"Cayman Islands",ISO_A3:"CYM"},Dominica:{name:"Dominica",ISO_A3:"DMA"},"Dominican Republic":{name:"Dominican Republic",ISO_A3:"DOM"},Grenada:{name:"Grenada",ISO_A3:"GRD"},Greenland:{name:"Greenland",ISO_A3:"GRL"},Haiti:{name:"Haiti",ISO_A3:"HTI"},Jamaica:{name:"Jamaica",ISO_A3:"JAM"},"Saint Kitts and Nevis":{name:"Saint Kitts and Nevis",ISO_A3:"KNA"},"Saint Lucia":{name:"Saint Lucia",ISO_A3:"LCA"},"Saint Martin":{name:"Saint Martin",ISO_A3:"MAF"},Mexico:{name:"Mexico",ISO_A3:"MEX"},Montserrat:{name:"Montserrat",ISO_A3:"MSR"},"Puerto Rico":{name:"Puerto Rico",ISO_A3:"PRI"},"Saint Pierre and Miquelon":{name:"Saint Pierre and Miquelon",ISO_A3:"SPM"},"Turks and Caicos Islands":{name:"Turks and Caicos Islands",ISO_A3:"TCA"},"Trinidad and Tobago":{name:"Trinidad and Tobago",ISO_A3:"TTO"},"United States of America":{name:"United States of America",ISO_A3:"USA"},"Saint Vincent and the Grenadines":{name:"Saint Vincent and the Grenadines",ISO_A3:"VCT"},"British Virgin Islands":{name:"British Virgin Islands",ISO_A3:"VGB"},"United States Virgin Islands":{name:"United States Virgin Islands",ISO_A3:"VIR"}},Ql={Argentina:{name:"Argentina",ISO_A3:"ARG"},Bolivia:{name:"Bolivia",ISO_A3:"BOL"},Brazil:{name:"Brazil",ISO_A3:"BRA"},Chile:{name:"Chile",ISO_A3:"CHL"},Colombia:{name:"Colombia",ISO_A3:"COL"},"Costa Rica":{name:"Costa Rica",ISO_A3:"CRI"},Ecuador:{name:"Ecuador",ISO_A3:"ECU"},"Falkland Islands":{name:"Falkland Islands",ISO_A3:"FLK"},Guyana:{name:"Guyana",ISO_A3:"GUY"},Nicaragua:{name:"Nicaragua",ISO_A3:"NIC"},Panama:{name:"Panama",ISO_A3:"PAN"},Peru:{name:"Peru",ISO_A3:"PER"},Paraguay:{name:"Paraguay",ISO_A3:"PRY"},Suriname:{name:"Suriname",ISO_A3:"SUR"},Uruguay:{name:"Uruguay",ISO_A3:"URY"},Venezuela:{name:"Venezuela",ISO_A3:"VEN"},"French Guyana":{name:"French Guyana",ISO_A3:"GUF"},Guatemala:{name:"Guatemala",ISO_A3:"GTM"},"El Salvador":{name:"El Salvador",ISO_A3:"SLV"},Honduras:{name:"Honduras",ISO_A3:"HND"}},tc={World:ql,USA:Kl,NorthAmerica:Jl,SouthAmerica:Ql,Canada:$l,Europe:Xl,Asia:jl,Africa:Wl,Australia:Hl},ec={World:"World",USA:"USA",NorthAmerica:"NorthAmerica",SouthAmerica:"SouthAmerica",Canada:"Canada",Europe:"Europe",Asia:"Asia",Africa:"Africa",Australia:"Australia"},ic=(t,e)=>!(!e.name||t.name.toLowerCase()!==e.name.toLowerCase())||"ISO_A3"in t&&"ISO_A3"in e&&t.ISO_A3.toLowerCase()===e.ISO_A3.toLowerCase(),sc=(t,e)=>{let i=e.geometry;return i=rc(t,e,i),i=nc(t,e,i),i},rc=(t,e,i)=>{if(t===ec.Asia){const t=[];for(let e=0;e<i.length;e+=1){t[e]=[];const s=i[e],r=t[e];for(let t=0;t<s.length;t+=1){const e=s[t];e.x<-100?r[t]={x:e.x+360,y:e.y}:r[t]=e}}return t}return i},nc=(t,e,i)=>{const s=e.name.toLowerCase();let r;if(t===ec.USA&&("alaska"===s?r={translate:{x:55,y:-25},scale:{x:.16,y:.16}}:"hawaii"===s&&(r={translate:{x:48,y:7},scale:{x:1,y:1}})),r){const{translate:t,scale:n}=r,o=bi(Xt(i)),a=[];for(let e=0;e<i.length;e+=1){a[e]=[];const r=i[e],h=a[e];for(let e=0;e<r.length;e+=1){const i=r[e];let a=i.x;"alaska"===s&&1===Math.sign(a)&&(a=-180-(180-a)),h[e]={x:t.x+(a-o.min.x)*n.x+o.min.x,y:t.y+(i.y-o.min.y)*n.y+o.min.y}}}return e.outlier=!0,e.transform={...r,vertexBoundaries:o},a}return i},oc={World:{min:{x:-180,y:-90},max:{x:180.0000000000002,y:83.63410065300012}},Europe:{min:{x:-25,y:34},max:{x:40,y:70}},Africa:{min:{x:-17,y:-40},max:{x:52,y:37.37549753800012}},Asia:{min:{x:27,y:-10.922621351999808},max:{x:180.0000000000002,y:81.85871002800009}},NorthAmerica:{min:{x:-179.1435033839999,y:5.515082098000121},max:{x:-50,y:83.11652252800009}},SouthAmerica:{min:{x:-85,y:-55.9185042229998},max:{x:-35,y:15}},USA:{min:{x:-125,y:24},max:{x:-68,y:50}},Canada:{min:{x:-141.0181,y:41.7297},max:{x:-52.6194,y:75}},Australia:{min:{x:111,y:-43.6586},max:{x:155,y:-9.2199}}},ac={World:.6,Europe:1/1.4,Africa:1.3,Asia:.8,NorthAmerica:.9,SouthAmerica:1.5,USA:3/4,Canada:6/8,Australia:11/12};class hc extends Oh{constructor(t,e,i,s,r,n,o){var a;super(t,e,i,e.Hg("mapChart bg",0),s,e.pi.bi.mapChartBackgroundFillStyle,e.pi.bi.mapChartBackgroundStrokeStyle,e.pi.bi.mapChartTitleFont,e.pi.bi.mapChartTitleFillStyle,e.pi.bi.mapChartTitleShadow,o,null===(a=null==n?void 0:n.legend)||void 0===a?void 0:a.customLegend),this.nx=[],this.ai=this.Bg.d2({scaleXYConstructor:q}),this.ox=!0,this.lx=this.bi.mapChartSeparateRegionFillStyle,this.ux=this.bi.mapChartSeparateRegionStrokeStyle,this.Er=!0,this.Ax=0,this.gx=!0,this.vx=new Map,this.regions=new vt,this.yx=t=>{this.ai.x.Z(t.engineWidth).St([this.ot.left+this.Gn.left,this.ot.right+this.Gn.right]),this.ai.y.Z(t.engineHeight).St([this.ot.bottom+this.Gn.bottom,this.ot.top+this.Gn.top+Uh.tp(this.Yr,this.Wg)]),this.mx&&this.xx(this.Sx,this.ai,this.mx)},this.D=new vt,this.pi.La(Hn.Io),this.Er=!1!==(null==n?void 0:n.animationsEnabled),this.bx=e.Om("mapChart plotting",0),this.addEventListener("resize",this.yx),this.Yr.tn("Map Chart");const h=e.Ym(),l=qt(n?n.cursorBuilder:void 0,Yl);this.jm=ig(this,h,l.Am(h,this.uiScale,this.uiScale,jt,this.bi),void 0,"show-pointed",cc,()=>0),this.Mx=this.vs.aA(),this.jg(r,this.uiScale),this.wx=this.bx.Yp(this.ai).setPointerEvents(this.ox).qe(this.bi.mapChartFillStyle).Ke(this.bi.mapChartStrokeStyle),this.regions.Ni(this.wx,t=>{if(!this._x)return;const e=this.kx(this._x,t);return e?e.region:void 0}),this.wx.addEventListener("pointermove",(t,e)=>{const i=e.collectionMember;if(!this._x||!i)return;const s=this.kx(this._x,i);this.Cx(s),this.gx&&s&&this.pi.Ms.Vs(s.region,!0)}),this.wx.addEventListener("pointerleave",(t,e)=>{const i=e.collectionMember;if(!this._x||!i)return;const s=this.kx(this._x,i);this.Tx(),this.gx&&s&&this.pi.Ms.Vs(s.region,!1)}),this.Fx=this.bx.Yp(this.ai).setPointerEvents(this.ox).qe(this.bi.mapChartOutlierRegionFillStyle).Ke(this.bi.mapChartOutlierRegionStrokeStyle);const c=qt(n&&n.type,ec.World);this.Sx=c,this.Ix(c).then(()=>{this.D.R("ready",{})});const u={renderOnTop:!0,backgroundVisible:!0,...null==n?void 0:n.legend};this.legend.setOptions(u)}setFillStyle(t){return this.wx.qe(t),this.Os.forEach(t=>{t.xg()&&t.add(this)}),this.Os.forEach(t=>t.zs()),this.pi.Bs(),this}getFillStyle(){return this.wx.Mh()}setStrokeStyle(t){return this.wx.Ke(t),this.pi.Bs(),this}getStrokeStyle(){return this.wx.Ja()}setEffect(t){return this.Mx.Ps(t),this.pi.Bs(),this}getEffect(){return this.Mx.Ds()}setOutlierRegionFillStyle(t){return this.Fx.qe(t),this.pi.Bs(),this}getOutlierRegionFillStyle(){return this.Fx.Mh()}setOutlierRegionStrokeStyle(t){return this.Fx.Ke(t),this.pi.Bs(),this}getOutlierRegionStrokeStyle(){return this.Fx.Ja()}setSeparateRegionFillStyle(t){return this.lx="function"==typeof t?t(this.lx):t,this.nx.forEach(t=>t.qe(this.lx)),this.pi.Bs(),this}getSeparateRegionFillStyle(){return this.lx}setSeparateRegionStrokeStyle(t){return this.ux="function"==typeof t?t(this.ux):t,this.nx.forEach(t=>t.Ke(this.ux)),this.pi.Bs(),this}getSeparateRegionStrokeStyle(){return this.ux}invalidateRegionValues(t){if(!this._x||!this.Lx)return this.Px=this.Px||[],this.Px.push(t),this;if("function"==typeof t)for(let e=0;e<this._x.regions.length;e+=1){const i=this._x.regions[e],s=this.Lx[e],r=t({...i,geometry:void 0},s);if(void 0!==r&&r!==s){this.Lx[e]=r;const t=this.vx.get(i);null==t||t.forEach(t=>{t.Bx(r)})}}else for(const e of t)if(e)for(let t=0;t<this._x.regions.length;t+=1){const i=this._x.regions[t],s=this.Lx[t];if(void 0!==e.value&&e.value!==s&&ic(i,e)){this.Lx[t]=e.value;const s=this.vx.get(i);null==s||s.forEach(t=>{t.Bx(e.value)})}}return this.Os.forEach(t=>{t.xg()&&t.add(this)}),this.pi.Bs(),this}setPointerEvents(t){return this.ox=t,this.wx.setPointerEvents(t),this}getPointerEvents(){return this.ox}setHighlight(t){var e;return t=Ge(t),this.Ax=t,null===(e=this._x)||void 0===e||e.regions.forEach(e=>{this.pi.Ms.Vs(e,t)}),this.D.R("highlightchange",{highlight:t}),this}getHighlight(){return this.Ax}setAnimationHighlight(t){var e;return null===(e=this._x)||void 0===e||e.regions.forEach(e=>{this.pi.Ms.Ns(e,t)}),this}getAnimationHighlight(){var t;return this.pi.Ms.Gs(null===(t=this._x)||void 0===t?void 0:t.regions[0])}setHighlightOnHover(t){return this.gx=t,!1===t&&this.getHighlight()>0&&this.setHighlight(!1),this}getHighlightOnHover(){return this.gx}async Ix(t){const e=await((t,e)=>{let i;if(t===ec.World)i="countries_world.json";else if(t===ec.NorthAmerica)i="countries_northAmerica.json";else if(t===ec.SouthAmerica)i="countries_southAmerica.json";else if(t===ec.Africa)i="countries_africa.json";else if(t===ec.Europe)i="countries_europe.json";else if(t===ec.Asia)i="countries_asia.json";else if(t===ec.USA)i="states_usa.json";else if(t===ec.Canada)i="territoriesProvinces_canada.json";else{if(t!==ec.Australia){const e=`LCJS MapChart unidentified \`type\`: ${t}`;throw Ut.alert(e),new Error(e)}i="territories_australia.json"}return new Promise((t,s)=>{(t=>{if(t.resourcesBaseUrl){const e=`${t.resourcesBaseUrl}${t.fileName}`;return void Ut.fetch(e).then(e=>{t.success(e)}).catch(()=>{t.error({url:e})})}const e=`${Ut.location.origin}/resources${t.fileName}`;Ut.fetch(e).then(e=>{if(!e.ok)throw new Error;t.success(e)}).catch(()=>{const i=`https://lcjs-resources.lightningchart.com/v1${t.fileName}`;Ut.fetch(i).then(e=>{Ut.console.warn("LightningChart JS warning | fallbacking publicly hosted asset resources.\nFor more information, please see https://lightningchart.com/js-charts/docs/troubleshooting/warning-using-publicly-hosted-resources/"),t.success(e)}).catch(()=>{t.error({url:e})})})})({fileName:`/maps/${i}`,resourcesBaseUrl:e,success:e=>e.json().then(t),error:({url:t})=>je(e,t,"Map Chart",{shouldCrash:!0})})})})(t,this.Pg.me);this.Lx=new Array(e.regions.length).map(t=>{}).fill(void 0);const i=oc[t];if(!i)throw new Error("Unidentified map type.");for(const t of e.outliers)for(const e of t.geometry)this.Fx.Ho().au(e);if(t===ec.USA){const t=25.8,e=29.7;this.nx.push(this.Ig.tr(this.ai).setPointerEvents(!1).qe(this.lx).Ke(this.ux).sr({x:-126,y:t}).Z({x:10,y:e-t}),this.Ig.tr(this.ai).setPointerEvents(!1).qe(this.lx).Ke(this.ux).sr({x:-113,y:t}).Z({x:7,y:e-t}))}const s=this.pi.Ms.jo(this.wx,{animationEnabled:this.Er});for(let i=0;i<e.regions.length;i+=1){const r=e.regions[i],n=sc(t,r),o=[];for(const t of n)t.length<3||o.push(this.wx.Ho().au(t));this.vx.set(r,o),s.Ho(r,t=>{o.forEach(e=>e.Ii(t))})}if(this.Mx.ks([this.wx]),this.mx=i,this.xx(t,this.ai,i),this._x=e,this.Px){for(const t of this.Px)this.invalidateRegionValues(t);this.Px=void 0}this.pi.Bs()}xx(t,e,i){const s=ac[t],r=e.x.getCellSize(),n=e.y.getCellSize()/r,o={min:{x:i.min.x,y:i.min.y},max:{x:i.max.x,y:i.max.y}};if(n<s){const t=(o.max.x-o.min.x)*(s/n-1);o.min.x-=t/2,o.max.x+=t/2}else if(n>s){const t=(o.max.y-o.min.y)*(n/s-1);o.min.y-=t/2,o.max.y+=t/2}e.x.W(o.min.x,o.max.x),e.y.W(o.min.y,o.max.y);const a=this.ai.x.Tt(),h=this.ai.y.Tt();this.D.R("viewchange",{latitudeRange:{start:o.min.y,end:o.max.y},longitudeRange:{start:o.min.x,end:o.max.x},margin:{top:h[1],bottom:h[0],left:a[0],right:a[1]}})}Cx(t){this.Dx=t,this.pi.Bs()}Tx(){this.Dx=void 0,this.pi.Bs()}kx(t,e){const i=Array.from(this.vx.entries()).findIndex(([t,i])=>i.includes(e)),s=null==t?void 0:t.regions[i],r=this.pi.Ia();if(!r)return;const n=this.pi.il(r),o=this.Lx&&this.Lx[i];let a=tt({x:n.engineX,y:n.engineY},this.pi.ai,this.ai);a={x:$t(a.x,this.ai.x.getInnerStart(),this.ai.x.getInnerEnd()),y:$t(a.y,this.ai.y.getInnerStart(),this.ai.y.getInnerEnd())};let h=a.x,l=a.y;const c=s.transform;s.outlier&&c&&(h=(h-c.translate.x-c.vertexBoundaries.min.x)/c.scale.x+c.vertexBoundaries.min.x,l=(l-c.translate.y-c.vertexBoundaries.min.y)/c.scale.y+c.vertexBoundaries.min.y);const u=this.getFillStyle();return{cursorPosition:{pointMarker:{x:n.engineX,y:n.engineY},pointMarkerScale:this.pi.ai,resultTable:{x:n.engineX,y:n.engineY},resultTableScale:this.pi.ai},region:s,value:o,longitude:l,latitude:h,lut:vs(u)?u.lut:void 0}}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Yl){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}setAnimationsEnabled(t){return this.Er=!t,this}getAnimationsEnabled(){return this.Er}getMinimumSize(){}bg(){return[this]}ir(t){super.ir(t),super.Yg();const e=Uh.tp(this.Yr,this.Wg),i=this.Os.reduce((t,i)=>{const s=i.Nh(e,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,i);const s=p(this.ai.x.bt()+i.left,this.ai.y.bt()+i.bottom,this.ai.x.wt()-i.right,this.ai.y.wt()-i.top);return this.bx.Tm(s),this.jm.ir(!1,[],void 0,{explicitTarget:this.Dx}),this.Os.forEach(t=>t.ir(e,this.Gn)),this}dispose(){return this.bx.G(),this.jm.G(),Vh(this.ai),super.dispose()}j(){return super.j(),this.ai.j(),this}H(){return super.H(),this.ai.H(),this}Ys(){return Re(this.getFillStyle(),this.wx._i())}er(){return{fill:this.getFillStyle()}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const lc=(t,e)=>{const i=t>0,s=e>0;return`${[Pe(Math.abs(0|t),2),"° ",Pe(Math.abs(0|(t<0?t=-t:t)%1*60),2),"' "].join("")+(i?"E":"W")}, ${[Pe(Math.abs(0|e),2),"° ",Pe(Math.abs(0|(e<0?e=-e:e)%1*60),2),"' "].join("")+(s?"N":"S")}`},cc=(t,e,i)=>{var s;const r=[[{text:e.region.name,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[lc(e.longitude,e.latitude)]];return void 0!==e.value&&r.push({text:Bs(e.lut?os(e.lut,e.value):e.value.toFixed(2),null===(s=e.lut)||void 0===s?void 0:s.units),font:{weight:"bold"}}),r};class uc extends Rn{constructor(t,e,i,s,r,n,o,a,h){super(t,e,e.Ex(i),s,r,{numeric:e.Rx({amplitude:s.polarAmplitudeAxisNumericTicks,radial:s.polarAmplitudeAxisNumericTicks}),datetime:e.Rx({amplitude:s.polarAmplitudeAxisDateTimeTicks,radial:s.polarAmplitudeAxisDateTimeTicks}),time:e.Rx({amplitude:s.polarAmplitudeAxisTimeTicks,radial:s.polarAmplitudeAxisTimeTicks})},{type:"linear"}),this.D=new vt,this.Ox=n,this.zx=o,this.Vx=a,this.vs=h,this.Nx=i,this.Gx=e.Rx({amplitude:s.polarAmplitudeAxisStrokeStyle,radial:s.polarRadialAxisStrokeStyle}),this.Jr=a._n(i).setPointerEvents(!1).Ch(e.Rx({amplitude:s.polarAmplitudeAxisTitleFont,radial:s.polarRadialAxisTitleFont})).qe(e.Rx({amplitude:s.polarAmplitudeAxisTitleFillStyle,radial:s.polarRadialAxisTitleFillStyle})),this.Ih=this.vs.aA([this.Jr]).Ps(s.effectsText)}setTickStrategy(t,e){return super.fh(t,e)}setStrokeStyle(t){return this.Gx="function"==typeof t?t(this.Gx):t,this.zx.Bs(),this}getStrokeStyle(){return this.Gx}Yh(t){return{}}Xh(t,e,i,s){const r=this.$x(this.Nx,t,e.Fr);return{keyValue:t,tickLevel:e,labelText:i,labelPosition:Li(this.Ux(this.Nx,t),r.padding),labelAlignment:r.alignment,labelRotation:r.rotation,labelOffset:r.offset}}sn(t,e,i,s){return new dc(e,t,this.Nx,this.Vx,this.Yx(this.Ox,this.Nx),this.Vx.dr(this.Nx).setPointerEvents(!1))}Kr(){return this.Nx}ir(t){this.jx(this.Nx,this.Gx,t.yA),this.Hx(this.Nx,this.Jr,t.yA),t.ticksInfo.forEach((t,e)=>{e.zh.sr(t.labelPosition).Zl(t.labelAlignment).Th(t.labelRotation).$l(t.labelOffset.x,t.labelOffset.y),this.Wx&&!1===this.Wx(e)&&e.zh.setVisible(!1),this.Xx(this.Nx,e.Zx,e.Jx,e)})}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}}class dc extends Ln{constructor(t,e,i,s,r,n,o){super(t,e,s,i,o),this.Zx=r,this.Jx=n,r.setPointerEvents(!1),this.gs.push(r,n)}}class fc extends uc{constructor(t,e,i,s,r,n,o,a,h){super(t,gc(()=>this.gA()),e,i,s,r,n,o,a),this.zp=this.zx.dr(this.Nx).setPointerEvents(!1),this.Qx=h,this.setScrollStrategy(yn.expansion),this.setTickStrategy(xn.Numeric),this.setTitle("Amplitude"),this.Jr.qh(i.polarAmplitudeAxisTitleShadow)}gA(){return this.Qx()}Qh(t,e,i){return{ticksInfo:e,yA:this.ln((t,e)=>{const i=e.kn.Fr,s=.5*this.Gx.getThickness()+i.tickLength+i.tickPadding+Math.abs(e.zh.Nh().bc().y);return Math.max(t,s)},0),updatedTicks:i}}vn(t,e){return Ds(t,e,this.Nx.y)}xn(t,e,i){const s=2*Math.abs(e-t),r=this.Nx.x.Jt(s);return{start:t+i.start*r*Math.sign(t-e),end:e+i.end*r*Math.sign(e-t)}}Ux(t,e){return{x:t.ue()?e-t.le().start:t.le().start-e,y:0}}Yx(t,e){return t._d(e)}Xx(t,e,i,s){const r=s.kn.Fr,n=t.ue()?s.M-t.le().start:t.le().start-s.M;Ht(s.M,t.le().start)||Ht(s.M,t.le().end)?e.setVisible(!1):e.setVisible(!0).Qu(0).Ar(360).rc(void 0).sc(0).Ku(n).rc(60).qe(ls).Ke(r.gridStrokeStyle);const o=.5*this.Gx.getThickness();i.gr({x:n,y:-o*t.ni().y}).Ar({x:n,y:-(o+r.tickLength)*t.ni().y}).cr(r.tickStyle)}$x(t,e,i){return{alignment:{x:0,y:1},padding:{x:0,y:t.ni().y*-(.5*this.Gx.getThickness()+i.tickLength+i.tickPadding)},rotation:0,offset:{x:0,y:0}}}jx(t,e,i){const s=t.ue()?t.le().end-t.le().start:t.le().start-t.le().end;this.zp.gr({x:0,y:0}).Ar({x:s,y:0}).cr(e)}Hx(t,e,i){const s=t.ue()?(t.le().start+t.le().end)/2-t.le().start:t.le().start-(t.le().start+t.le().end)/2;e.Zl({x:0,y:1}).sr({x:s,y:-i*t.ni().y})}}const gc=t=>({...Jh(t,t=>t.getAmplitudeMin(),t=>t.getAmplitudeMax(),t=>{}),Ex:t=>({getInnerStart:()=>t.le().start,getInnerEnd:()=>t.le().end,W:(e,i)=>t.oe(e,i),et:(e,i,s,r,n)=>t.y.et(e,i,s,r,n)}),Rx:t=>t.amplitude});class pc{constructor(t,e,i,s){this.Kx=!1,this.D=new vt,this.Ce=t,this.qx=e,this.fv=i,this.Cc=s}setGeometry(t){return this.tS=t,this.Kx=!0,this.Ce.pi.Bs(),this}getGeometry(){return this.tS}setPointerEvents(t){return this.Cc.setPointerEvents(t),this}dispose(){return this.Cc.dispose(),this.qx(this),this.D.R("dispose",{}),this}setVisible(t){const e=this.Cc.getVisible()!==t;return this.Cc.setVisible(t),e&&this.D.R("visiblechange",{isVisible:t}),this.Ce.pi.Bs(),this}getVisible(){return this.Cc.getVisible()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class mc extends Ps{constructor(){super(...arguments),this.rp=!0,this.ep=!0}setAutoScrollingEnabled(t){return this.rp=t,this.chart.pi.Bs(),this}getAutoScrollingEnabled(){return this.rp}cp(){}ir(){}dp(){}setCursorEnabled(t){return this.ep=t,this}getCursorEnabled(){return this.ep}ap(){return this.getVisible()&&this.getCursorEnabled()}setCursorFormattingOverride(t){return this.op=t,this}getCursorFormattingOverride(){return this.op}}class yc extends mc{constructor(t,e,i,s,r,n){super(e,i,r,n),this.Ws=t,this.chart=e,this.scale=s}getAmplitudeMin(){return this.iS?this.iS.min:void 0}getAmplitudeMax(){return this.iS?this.iS.max:void 0}}const xc=(t,e)=>{const i=[],s=e.le().start,r=e.le().end,n=e.ue(),o=e.de()?1:-1,a=e.Ae(),h=Math.abs(r-s),l=Math.min(s,r)+.001*h,c=Math.max(s,r)-.001*h;for(const e of t){const t=$t(e.amplitude,l,c),r=e.angle*Math.PI/180-a,h=Math.cos(r*o)*(n?t-s:s-t),u=Math.sin(r*o)*(n?t-s:s-t),d=e.color;i.push({x:h,y:u,color:d})}return i},vc=t=>{const e={min:ni,max:oi};for(const i of t)e.min=Math.min(e.min,i.amplitude),e.max=Math.max(e.max,i.amplitude);return e},Ac=t=>t.slice().map(t=>t.angle>=0&&t.angle<=360?t:{...t,angle:t.angle%360}),Sc=(t,e)=>{let i=Gi(t);for(e.de()||(i*=-1),i+=180*e.Ae()/Math.PI;i<0;)i+=360;i%=360;const s=Ii(t),r=e.le(),n=Math.abs(r.end-r.start);return{angle:i,amplitude:Us(r.start,r.end,s/n),color:t.color?T(t.color):void 0}};class bc extends yc{constructor(t,e,i,s,r,n,o){super(t,e,i,s,r,o),this.Rs="Polygon Series",this.sS=[],this.eS=[],this.rS=t=>{const e=this.eS.indexOf(t);e>=0&&this.eS.splice(e,1);const i=this.sS.findIndex(e=>e===t.Cc);i>=0&&this.sS.splice(i,1),this.Ws.Bs()},this.D=new vt,this.Ze=ze(this.bi.polarPolygonSeriesFillStyle,n),this.Je=ze(this.bi.polarPolygonSeriesStrokeStyle,n)}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=ks(s,this.sS,(t,e)=>{const i=t.yd(e);if(i)return tt(i,this.scale,t.pi.ai)},yi);if(!r)return;const n=tt(r[0],r[1].pi.ai,this.scale);if(!this.hS(r[1]))return;const o=Sc(n,this.scale);return{cursorPosition:{pointMarker:n,pointMarkerScale:this.scale,resultTable:n,resultTableScale:this.scale},series:this,...o}}Qi(t,e,i){return Je({series:this},{cursorPosition:0,amplitude:0,angle:0,color:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}addPolygon(){const t=new pc(this.chart,this.rS,this,this.nS());return this.eS.push(t),t}setFillStyle(t){this.Ze="function"==typeof t?t(this.Ze):t;const e=this.Ze;for(const t of this.sS)t.qe(e);return this.Ws.Bs(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){this.Je="function"==typeof t?t(this.Je):t;const e=this.Je;for(const t of this.sS)t.Ke(e);return this.Ws.Bs(),this}getStrokeStyle(){return this.Je}xp(){return this.rp&&void 0!==this.eS.find(t=>void 0!==t.oS)&&this.getVisible()}ir(){this.eS.forEach(t=>{(t.Kx||this.scale.ge())&&t.aS&&(t.Cc.au(xc(t.aS,this.scale)),t.Kx=!1,t.Cc.Nh())})}cp(){super.cp();const t=g(ni,oi);this.eS.forEach(e=>{if(!e.tS)return;const i=!e.Kx&&e.aS?e.aS:Ac(e.tS);e.aS=i;const s=!e.Kx&&e.oS?e.oS:vc(i);e.oS=s,t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max)}),this.iS=t}rr(t,e){t.Ii(e),this.Ws.Bs()}er(){return{fill:this.Ze,stroke:this.Je}}nS(){const t=this.Ws.Tc(this.scale,To.Simple).qe(this.Ze).Ke(this.Je).Ii(this.getHighlight());return this.sS.push(t),this._s(t),t}hS(t){return this.eS.find(e=>e.Cc===t)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Mc extends yc{constructor(t,e,i,s,r,n,o){super(t,e,i,s,r,o),this.Rs="Area Series",this.lS=[],this.uS=!1,this.cS=!1,this.dS=!1,this.D=new vt,this.Ze=ze(this.bi.polarAreaSeriesFillStyle,n),this.Je=ze(this.bi.polarAreaSeriesStrokeStyle,n)}setData(t){0!==this.lS.length&&this.chart.pi.La(Hn.Ro);const e=(t=>{const e=[];let i,s,r=!1;for(let n=0;n<t.length;n+=1){const o=t[n];let a=!0;if(i){a=!1;const t=o.angle-i.angle;if(Ht(t,0))a=!0;else{const e=Math.sign(t);void 0===s?(s=e,a=!0):s===e&&(a=!0)}}a?e.push(o):r=!0,i=o}return{progressivePoints:e,userDataModified:r}})(t);return e.userDataModified&&!1===this.dS&&(console.warn(`${this.Rs} setData data format is faulty. Consecutive 'angle' values should progress in the same direction! Invalid data points have been removed.`),this.dS=!0),this.lS=e.progressivePoints,this.uS=!0,this.iS=vc(this.lS),this.Ws.Bs(),this}getData(){return this.lS}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.Ws.Bs(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.Ws.Bs(),this}getStrokeStyle(){return this.Je}setConnectDataAutomaticallyEnabled(t){return this.cS=t,this.Ws.Bs(),this}getConnectDataAutomaticallyEnabled(){return this.cS}xp(){return this.rp&&this.lS.length>0&&this.getVisible()}er(){return{fill:this.Ze,stroke:this.Je}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Ec extends Mc{constructor(t,e,i,s,r,n,o){super(t,e,i,s,r,n,o),this.fS=this.Ws.Tc(this.scale,To.Simple).Ii(this.getHighlight()),this._s(this.fS)}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=this.fS.yd(s);if(!r)return;const n=Sc(r,this.scale);return{cursorPosition:{pointMarker:r,pointMarkerScale:this.scale,resultTable:r,resultTableScale:this.scale},series:this,...n}}Qi(t,e,i){return Je({series:this},{cursorPosition:0,amplitude:0,angle:0,color:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}ir(){if(this.uS||this.scale.ge()){const t=this.lS,e=!0===this.cS?xc(t,this.scale):[...xc(t,this.scale),{x:0,y:0}];this.fS.au(e).qe(this.Ze).Ke(this.Je),this.uS=!1,this.fS.Nh()}}rr(t,e){t.Ii(e),this.Ws.Bs()}}class kc extends yc{constructor(t,e,i,s,r,n,o){super(t,e,i,s,r,o),this.Rs="Line Series",this.lS=[],this.uS=!1,this.cS=!1,this.D=new vt,this.hc=ze(this.bi.polarLineSeriesStrokeStyle,n),this.AS=t.Np(s,void 0,[Wh.UserSeries]).cr(this.hc).Ii(this.getHighlight()),this._s(this.AS)}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=this.AS.gS(s);if(!r)return;const n=Sc(r,this.scale);return{cursorPosition:{pointMarker:r,pointMarkerScale:this.scale,resultTable:r,resultTableScale:this.scale},series:this,...n}}Qi(t,e,i){return Je({series:this},{cursorPosition:0,amplitude:0,angle:0,color:0},()=>this.solveNearest(e,"show-nearest"))}setData(t){return 0!==this.lS.length&&this.chart.pi.La(Hn.Ro),this.lS=Ac(t),this.uS=!0,this.iS=vc(this.lS),this.Ws.Bs(),this}getData(){return this.lS}setStrokeStyle(t){this.hc="function"==typeof t?t(this.hc):t;const e=this.hc;return this.AS.cr(e),this.Ws.Bs(),this}getStrokeStyle(){return this.hc}setConnectDataAutomaticallyEnabled(t){return this.cS=t,this.Ws.Bs(),this}getConnectDataAutomaticallyEnabled(){return this.cS}xp(){return this.rp&&this.lS.length>0&&this.getVisible()}rr(t,e){t.Ii(e),this.Ws.Bs()}ir(){if(this.uS||this.scale.ge()){const t=xc(this.lS,this.scale),e=bi(t);this.cS?(t.push({...t[0]}),this.AS.Lu(!0)):this.AS.Lu(!1),this.AS.Vi().bu(t).Ti(e),this.uS=!1,this.AS.Nh()}}er(){return{stroke:this.hc}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Tc extends On{constructor(t,e,i,s,r,n,o,a,h){super(),this.xi=qe(),this.ci=!1,this.D=new vt,this.pS=s,this.vS=r,this.yS=n,this.mS=o,this.xS=a,this.Ws=t,this.scale=e,this.SS=i,this.bi=h}bS(t){this.MS=t}setHighlight(t){const e=Ge(t);return this.wS=e<=0?void 0:e,this.MS&&this.MS.Ii(e),this.D.R("highlightchange",{highlight:e}),this}dispose(){return this.SS&&this.SS(this),this.Ws.pi.Bs(),this.D.R("dispose",{}),this.ci=!0,this}setVisible(t){return super.setVisible(t),this.yS(),this.Ws.pi.Bs(),this}isDisposed(){return this.ci}setPointerEvents(t){return this.mS(this,t),this}getPointerEvents(){return this.xS(this)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class wc extends Tc{constructor(t,e,i,s,r,n,o,a,h,l,c,u,d,f,p,m,y,x){super(e,i,s,r,n,o,a,h,x),this._S=1,this.kS=1,this.fv=t,this.Ws=e,this.scale=i,this.dimensionStrategy=l,this.start=c,this.end=u,this.lowerExtreme=d,this.lowerQuartile=f,this.median=p,this.upperQuartile=m,this.upperExtreme=y,this.boundaries=g(this.dimensionStrategy.toPoint(c,d),this.dimensionStrategy.toPoint(u,y)),this.CS=this.bi.boxSeriesBodyFillStyle,this.TS=this.bi.boxSeriesBodyStrokeStyle,this.hc=this.bi.boxSeriesStrokeStyle,this.FS=this.bi.boxSeriesMedianStrokeStyle,this.Nh()}Qi(t,e){const i=this.fv.Xs.toPoint((this.start+this.end)/2,this.median);return{cursorPosition:{resultTable:i,resultTableScale:this.scale,pointMarker:i,pointMarkerScale:{x:this.fv.axisX,y:this.fv.axisY}},...i,figure:this,start:this.start,end:this.end,lowerExtreme:this.lowerExtreme,lowerQuartile:this.lowerQuartile,median:this.median,upperQuartile:this.upperQuartile,upperExtreme:this.upperExtreme,series:this.fv,axisX:this.fv.axisX,axisY:this.fv.axisY}}IS(){return this.boundaries}setBodyWidth(t){return this._S=t,this.Nh(),this}getBodyWidth(){return this._S}setBodyFillStyle(t){return this.CS="function"==typeof t?t(this.CS):t,this.vS(),this}getBodyFillStyle(){return this.CS}setBodyStrokeStyle(t){return this.TS="function"==typeof t?t(this.TS):t,this.vS(),this}getBodyStrokeStyle(){return this.TS}setTailWidth(t){return this.kS=t,this.Nh(),this}getTailWidth(){return this.kS}setStrokeStyle(t){return this.hc="function"==typeof t?t(this.hc):t,this.vS(),this}getStrokeStyle(){return this.hc}setMedianStrokeStyle(t){return this.FS="function"==typeof t?t(this.FS):t,this.vS(),this}getMedianStrokeStyle(){return this.FS}Nh(){this.pS()}getDominantStyle(){return this.getBodyFillStyle()}}class Cc extends mc{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,h,l),this.Hs=!0,this.gs=new Map,this.chart=t,this.Ws=i,this.axisX=s,this.axisY=r,this.axisXAttachHandler=n,this.axisYAttachHandler=o,this.scale=As(s.ai,r.ai),this.LS=t.PS,t.PS+=1,this.BS(this.scale),this.attacheAxis()}get xAxis(){return this.axisX}get yAxis(){return this.axisY}hl(){const t=Array.from(this.gs.keys());for(const e of t){const t=e.hl();if(t)return t}}setClipping(t){return this.Hs=t,this.Ws.Bs(),this}getClipping(){return this.Hs}attacheAxis(){this.DS=this.axisXAttachHandler(this),this.ES=this.axisYAttachHandler(this)}_s(t,e){super._s(t,e),t.nl(this.LS)}getName(){const t=this.ws(),e="ProgressiveY"===t||"RegressiveY"===t?this.axisX.getTitle():this.axisY.getTitle();return this.Rs||e.length>0&&e||"Series"}setDrawOrder(t){return this.LS=t.seriesDrawOrderIndex,this.gs.forEach((t,e)=>{e.nl(this.LS)}),this.chart.pi.Bs(),this}dispose(){return super.dispose(),this.DS(this),this.ES(this),this.chart.legend.remove(this),this}dp(){super.dp(),Cs(this.Hs,Array.from(this.gs.keys()),this.scale)}getXMax(){var t;return null!==(t=this.RS(!1))&&void 0!==t?t:0}getXMin(){var t;return null!==(t=this.OS(!1))&&void 0!==t?t:0}getYMax(){var t;return null!==(t=this.zS(!1))&&void 0!==t?t:0}getYMin(){var t;return null!==(t=this.VS(!1))&&void 0!==t?t:0}getBoundaries(){return g(l(this.getXMin()||0,this.getYMin()||0),l(this.getXMax()||0,this.getYMax()||0))}setCursorEnabled(t){return super.setCursorEnabled(t)}}const Bc=(t,e,i,s)=>{const r=t.length;let n=0;if(void 0!==e){const r=i-e;if(r>0){const e=t.slice(n,r);n+=r,s(e,!0)}}for(;n<r;){const e=t.slice(n,n+i);n+=i,s(e,!1)}};class Fc extends Cc{constructor(t,i,s,r,n,o,a,h,l,c){super(t,i,s,r,n,o,a,h,l,c),this.NS=[],this.GS=void 0,this.$S=!1,this.SS=t=>{const e=this.NS.findIndex(e=>e===t);e>=0&&this.NS.splice(e,1),this.$S=!0,this.GS=void 0,this.Ws.Bs()},this.pS=()=>{this.GS=void 0,this.$S=!0,this.chart.pi.Bs()},this.vS=()=>{this.$S=!0,this.chart.pi.Bs()},this.yS=()=>{this.GS=void 0,this.$S=!0,this.chart.pi.Bs()},this.mS=(t,e)=>{this.setPointerEvents(e)},this.US=t=>this.getPointerEvents(),this.ds=e.HighlightModes.onHoverIndividual}getFigures(){return this.NS.slice()}setPointerEvents(t){return super.setPointerEvents(t),this.gs.forEach((e,i)=>i.setPointerEvents(t)),this}yp(){return this.NS.length>0}ir(){super.ir(),this.$S&&(this.YS(this.NS),this.$S=!1)}clear(){return this.NS.slice().forEach(Wt),this.NS.length=0,this.$S=!0,this.GS=void 0,this.Ws.Bs(),this}jS(t,i){void 0!==i?this.NS.splice(i,0,t):this.NS.push(t),this.$S=!0,this.HS&&this.HS(t),this.D.Gi(t),this.Ws.Bs(),t.addEventListener("pointerenter",()=>{this.ds===e.HighlightModes.onHoverIndividual&&t.setHighlight(!0)}),t.addEventListener("pointerleave",()=>{this.ds===e.HighlightModes.onHoverIndividual&&t.setHighlight(!1)})}xp(){return this.rp&&this.NS.length>0&&this.getVisible()}setDefaultStyle(t){return this.HS=t,this.NS.forEach(t),t(this.WS),this.$S=!0,this.chart.pi.Bs(),this}setVisible(t){return super.setVisible(t),t!==this.getVisible()&&this.NS.forEach(e=>e.setVisible(t)),this}RS(){return this.GS||(this.GS=this.XS()),this.GS.max.x}OS(){return this.GS||(this.GS=this.XS()),this.GS.min.x}zS(){return this.GS||(this.GS=this.XS()),this.GS.max.y}VS(){return this.GS||(this.GS=this.XS()),this.GS.min.y}gn(){return l(0,0)}XS(){const t=g(c(ni,ni),c(oi,oi));for(let e=0;e<this.NS.length;e+=1)if(this.NS[e].getVisible()){const i=this.NS[e].IS();t.min.x=Math.min(t.min.x,i.min.x),t.min.y=Math.min(t.min.y,i.min.y),t.max.x=Math.max(t.max.x,i.max.x),t.max.y=Math.max(t.max.y,i.max.y)}return t}er(){return{fill:this.NS.length>0?this.NS[0].getDominantStyle():this.WS.getDominantStyle()}}}class Dc extends Fc{constructor(t,e,i,s,r,n,o,a,h,l,c,u){super(t,e,i,s,r,n,o,a,l,c),this.Rs="Box Series",this.ZS=$e(),this.JS=t=>tt(this.Xs.toPoint((t.start+t.end)/2,t.median),this.scale,this.Ws.pi.ai),this.D=new vt,this.chart.pi.La(Hn.Do),this.Xs=h,this.WS=new wc(this,this.Ws,this.scale,this.SS,jt,jt,jt,jt,t=>!1,this.Xs,0,0,0,0,0,0,0,this.bi).dispose(),this.QS=new $h(()=>{const t=this.Ws.bA(this.scale);return this._s(t,{setEventHandlers:!1,pointerEventsDisabled:!0}),t},(t,e,i)=>(t.cr(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.wA(e.start,e.end),i}))),this.KS=new $h(()=>{const t=this.ZS.Ji(this.Ws.Yp(this.scale));return this._s(t,{setEventHandlers:!1}),t},(t,e,i)=>(t.qe(i.fillStyle).Ke(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.au(e.vertices),this.ZS.Ki(i,e.figure),e.figure.bS(i),i})),()=>{this.ZS.Vi()},(t,e)=>{this.Ts(e)})}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY};if(0===this.NS.length)return;const r=ks(s,this.NS.filter(t=>t.getVisible()),this.JS,yi);if(!r)return;const n=tt(r[0],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,figure:r[1],start:r[1].start,end:r[1].end,lowerExtreme:r[1].lowerExtreme,lowerQuartile:r[1].lowerQuartile,median:r[1].median,upperQuartile:r[1].upperQuartile,upperExtreme:r[1].upperExtreme,series:this,axisX:this.axisX,axisY:this.axisY}}Qi(t,e,i){if(!i)return;const s=this.NS.find(t=>t.MS===i);if(!s)return;const r=this.Xs.toPoint((s.start+s.end)/2,s.median);return{cursorPosition:{resultTable:r,resultTableScale:this.scale,pointMarker:r,pointMarkerScale:{x:this.axisX,y:this.axisY}},...r,start:s.start,end:s.end,lowerExtreme:s.lowerExtreme,lowerQuartile:s.lowerQuartile,median:s.median,upperQuartile:s.upperQuartile,upperExtreme:s.upperExtreme,figure:s,series:this,axisX:this.axisX,axisY:this.axisY}}BS(t){if(!(t instanceof q||t instanceof K))throw new Error("BoxSeries only supports Linear Axes")}YS(t){const e=this.KS.VA(),i=this.QS.VA();t.forEach(t=>{if(!t.getVisible())return;const s=this.Xs.toPoint((t.start+t.end-t._S*(t.end-t.start))/2,t.lowerQuartile),r=this.Xs.toPoint((t.end-t.start)*t._S,t.upperQuartile-t.lowerQuartile),n=this.Xs.toPoint((t.start+t.end)/2,t.lowerQuartile),o=this.Xs.toPoint((t.start+t.end)/2,t.lowerExtreme),a=this.Xs.toPoint((t.start+t.end)/2,t.upperQuartile),h=this.Xs.toPoint((t.start+t.end)/2,t.upperExtreme),l=this.Xs.toPoint((t.start+t.end-t.kS*(t.end-t.start))/2,t.lowerExtreme),c=this.Xs.toPoint((t.start+t.end+t.kS*(t.end-t.start))/2,t.lowerExtreme),u=this.Xs.toPoint((t.start+t.end-t.kS*(t.end-t.start))/2,t.upperExtreme),d=this.Xs.toPoint((t.start+t.end+t.kS*(t.end-t.start))/2,t.upperExtreme),f=this.Xs.toPoint((t.start+t.end-t._S*(t.end-t.start))/2,t.median),g=this.Xs.toPoint((t.start+t.end+t._S*(t.end-t.start))/2,t.median);e.add({xi:t.xi,vertices:[{x:s.x,y:s.y},{x:s.x,y:s.y+r.y},{x:s.x+r.x,y:s.y+r.y},{x:s.x+r.x,y:s.y}],figure:t},{fillStyle:t.CS,strokeStyle:t.TS}),i.add({xi:0,start:n,end:o,figure:t},{strokeStyle:t.hc}),i.add({xi:0,start:a,end:h,figure:t},{strokeStyle:t.hc}),i.add({xi:0,start:l,end:c,figure:t},{strokeStyle:t.hc}),i.add({xi:0,start:u,end:d,figure:t},{strokeStyle:t.hc}),i.add({xi:0,start:f,end:g,figure:t},{strokeStyle:t.FS})}),e.finishPlot(),i.finishPlot()}add(t){const e=new wc(this,this.Ws,this.scale,this.SS,this.pS,this.vS,this.yS,this.mS,this.US,this.Xs,t.start,t.end,t.lowerExtreme,t.lowerQuartile,t.median,t.upperQuartile,t.upperExtreme,this.bi);return this.jS(e),this.$S=!0,this.chart.pi.Bs(),e}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Ic extends Tc{constructor(t,e,i,s,r,n,o,a,h,c,u){super(e,i,s,r,n,o,a,h,c),this.dimensions={x:0,y:0,radiusX:0,radiusY:0},this.nu=g(l(0,0),l(0,0)),this.fv=t,this.Ws=e,this.scale=i,this.Ze=ze(c.ellipseSeriesFillStyle,u),this.Je=ze(c.ellipseSeriesStrokeStyle,u)}Qi(t,e){const i=this.getDimensions(),s=l(i.x,i.y);return{cursorPosition:{resultTable:s,resultTableScale:this.scale,pointMarker:s,pointMarkerScale:{x:this.fv.axisX,y:this.fv.axisY}},...s,figure:this,...this.getDimensions(),series:this.fv,axisX:this.fv.axisX,axisY:this.fv.axisY}}IS(){return this.nu}setDimensions(t){return this.dimensions=t,this.nu=g(l(t.x-t.radiusX,t.y-t.radiusY),l(t.x+t.radiusX,t.y+t.radiusY)),this.pS(),this.Ws.Bs(),this}getDimensions(){return this.dimensions}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.vS(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.vS(),this}getStrokeStyle(){return this.Je}getDominantStyle(){return this.Ze}}class Rc extends Fc{constructor(t,e,i,s,r,n,o,a,h,c,u){super(t,e,i,s,r,n,o,a,h,c),this.Rs="Ellipse Series",this.ZS=$e(),this.JS=t=>{const e=t.getDimensions(),i=l(e.x,e.y);return tt(i,this.scale,this.Ws.pi.ai)},this.D=new vt,this.chart.pi.La(Hn.Do),this.qS=u,this.WS=new Ic(this,this.Ws,this.scale,jt,jt,jt,jt,jt,t=>!1,this.bi,this.qS).dispose(),this.KS=new $h(()=>{const t=this.ZS.Ji(this.Ws.Yp(this.scale));return this._s(t,{setEventHandlers:!1}),t},(t,e,i)=>(t.qe(i.fillStyle).Ke(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.au(e.vertices),this.ZS.Ki(i,e.figure),e.figure.bS(i),i})),()=>{this.ZS.Vi()},(t,e)=>{this.Ts(e)})}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY};if(0===this.NS.length)return;const r=ks(s,this.NS.filter(t=>t.getVisible()),this.JS,yi);if(!r)return;const n=tt(r[0],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,figure:r[1],...r[1].getDimensions(),series:this,axisX:this.axisX,axisY:this.axisY}}Qi(t,e,i){if(!i)return;const s=this.NS.find(t=>t.MS===i);if(!s)return;const r=s.getDimensions();return{cursorPosition:{resultTable:r,resultTableScale:this.scale,pointMarker:r,pointMarkerScale:{x:this.axisX,y:this.axisY}},...r,figure:s,series:this,axisX:this.axisX,axisY:this.axisY}}BS(t){if(!(t instanceof q||t instanceof K))throw new Error("EllipseSeries only supports Linear Axes")}YS(t){const e=this.KS.VA();t.forEach(t=>{if(!t.getVisible())return;const i=t.getDimensions(),s=[],r=void 0!==i.drawSteps?i.drawSteps:72;for(let t=0;t<=r;t+=1){const e=t/r*2*Math.PI,n=i.x+i.radiusX*Math.cos(e),o=i.y+i.radiusY*Math.sin(e);s.push({x:n,y:o})}const n=t.getFillStyle(),o=t.getStrokeStyle();e.add({xi:t.xi,vertices:s,figure:t},{fillStyle:n,strokeStyle:o})}),e.finishPlot()}add(t){const e=new Ic(this,this.Ws,this.scale,this.SS,this.pS,this.vS,this.yS,this.mS,this.US,this.bi,this.qS).setDimensions(t);return this.jS(e),this.$S=!0,this.chart.pi.Bs(),e}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Lc extends Tc{constructor(t,e,i,s,r,n,o,a,h,l,c){super(e,i,s,r,n,o,a,h,l),this.tb=[],this.nu=ai,this.fv=t,this.Ws=e,this.scale=i,this.Ze=ze(l.polygonSeriesFillStyle,c),this.Je=ze(l.polygonSeriesStrokeStyle,c)}Qi(t,e){const i=this.IS(),s=l((i.min.x+i.max.x)/2,(i.min.y+i.max.y)/2);return{cursorPosition:{resultTable:s,resultTableScale:this.scale,pointMarker:s,pointMarkerScale:{x:this.fv.axisX,y:this.fv.axisY}},...s,figure:this,coordinates:this.getDimensions(),series:this.fv,axisX:this.fv.axisX,axisY:this.fv.axisY}}IS(){return this.nu}setDimensions(t){return this.tb=t,this.nu=bi(this.tb),this.pS(),this.Ws.Bs(),this}getDimensions(){return this.tb}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.vS(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.vS(),this}getStrokeStyle(){return this.Je}getDominantStyle(){return this.Ze}}class Pc extends Fc{constructor(t,e,i,s,r,n,o,a,h,c,u){super(t,e,i,s,r,n,o,a,h,c),this.Rs="Polygon Series",this.ZS=$e(),this.JS=t=>{const e=t.IS(),i=l((e.min.x+e.max.x)/2,(e.min.y+e.max.y)/2);return tt(i,this.scale,this.Ws.pi.ai)},this.D=new vt,this.chart.pi.La(Hn.Do),this.qS=u,this.WS=new Lc(this,this.Ws,this.scale,jt,jt,jt,jt,jt,t=>!1,this.bi,this.qS).dispose(),this.KS=new $h(()=>{const t=this.ZS.Ji(this.Ws.Yp(this.scale));return this._s(t,{setEventHandlers:!1}),t},(t,e,i)=>(t.qe(i.fillStyle).Ke(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.au(e.vertices),this.ZS.Ki(i,e.figure),e.figure.bS(i),i})),()=>{this.ZS.Vi()},(t,e)=>{this.Ts(e)})}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY};if(0===this.NS.length)return;const r=ks(s,this.NS.filter(t=>t.getVisible()),this.JS,yi);if(!r)return;const n=tt(r[0],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,figure:r[1],coordinates:r[1].getDimensions(),series:this,axisX:this.axisX,axisY:this.axisY}}Qi(t,e,i){if(!i)return;const s=this.NS.find(t=>t.MS===i);if(!s)return;const r=s.IS(),n=l((r.min.x+r.max.x)/2,(r.min.y+r.max.y)/2);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,coordinates:s.getDimensions(),figure:s,series:this,axisX:this.axisX,axisY:this.axisY}}BS(t){}YS(t){const e=this.KS.VA();t.forEach(t=>{if(!t.getVisible())return;const i=t.getDimensions(),s=t.getFillStyle(),r=t.getStrokeStyle();e.add({xi:t.xi,vertices:i,figure:t},{fillStyle:s,strokeStyle:r})}),e.finishPlot()}add(t){const e=new Lc(this,this.Ws,this.scale,this.SS,this.pS,this.vS,this.yS,this.mS,this.US,this.bi,this.qS).setDimensions(t);return this.jS(e),this.$S=!0,this.chart.pi.Bs(),e}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class zc extends Tc{constructor(t,e,i,s,r,n,o,a,h,c,u){super(e,i,s,r,n,o,a,h,c),this.ib={x:0,y:0,width:0,height:0},this.sb={x1:0,y1:0,x2:0,y2:0},this.nu=g(l(0,0),l(0,0)),this.fv=t,this.Ze=ze(c.rectangleSeriesFillStyle,u),this.Ws=e,this.scale=i,this.Je=ze(c.rectangleSeriesStrokeStyle,u)}setCornerRadius(t){return this.eb=t,this.pS(),this}getCornerRadius(){return this.eb}Qi(t,e){const i=this.getDimensionsPositionAndSize(),s=l(i.x+i.width/2,i.y+i.height/2);return{cursorPosition:{resultTable:s,resultTableScale:this.scale,pointMarker:s,pointMarkerScale:{x:this.fv.axisX,y:this.fv.axisY}},...s,figure:this,positionAndSize:this.getDimensionsPositionAndSize(),...this.getDimensionsTwoPoints(),series:this.fv,axisX:this.fv.axisX,axisY:this.fv.axisY}}IS(){return this.nu}setDimensions(t){return"x"in t?(this.ib=t,this.sb={x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height}):(this.sb=t,this.ib={x:t.x1,y:t.y1,width:t.x2-t.x1,height:t.y2-t.y1}),this.nu=bi([this.ib,l(this.ib.x+this.ib.width,this.ib.y+this.ib.height)]),this.pS(),this.Ws.Bs(),this}getDimensionsPositionAndSize(){return this.ib}getDimensionsTwoPoints(){return this.sb}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.vS(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.vS(),this}getStrokeStyle(){return this.Je}getDominantStyle(){return this.Ze}}class _c extends Fc{constructor(t,e,i,s,r,n,o,a,h,c,u,d){super(t,e,i,s,r,n,o,a,h,c),this.Rs="Rectangle Series",this.rb=$e(),this.hb="xy",this.JS=t=>{const e=t.getDimensionsPositionAndSize(),i=l(e.x+e.width/2,e.y+e.height/2);return tt(i,this.scale,this.Ws.pi.ai)},this.D=new vt,this.chart.pi.La(Hn.Do),this.qS=u,this.Da=d,this.WS=new zc(this,this.Ws,this.scale,jt,jt,jt,jt,jt,t=>!1,this.bi,this.qS).dispose(),this.nb=new $h(()=>{const t=this.rb.Ji(this.Ws.md(this.scale));return this._s(t,{setEventHandlers:!1}),t},(t,e,i)=>(t.qe(i.fillStyle).Ke(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.Md(e.x1,e.y1,e.x2,e.y2).bd(e.roundedCorners?{extent:e.roundedCorners,c_x1_y1:!0,c_x1_y2:!0,c_x2_y1:!0,c_x2_y2:!0}:void 0),this.rb.Ki(i,e.figure),e.figure.bS(i),i})),()=>{this.rb.Vi()},(t,e)=>{this.Ts(e)})}ob(){var t,e,i;let s,r;if(!(null===(t=this.Da)||void 0===t?void 0:t.solvePlane)&&this.NS.length>=3){let t;for(const e of this.NS){const i=e.getDimensionsPositionAndSize(),n={x:i.x+i.width/2,y:i.y+i.height/2};if(t){const e=n.x-t.x,i=0===e?s:e>0?"progressive":"regressive";s=null===s?null:void 0===s?i:i!==s?null:s;const o=n.y-t.y,a=0===o?r:o>0?"progressive":"regressive";r=null===r?null:void 0===r?a:a!==r?null:r}t=n}}const n=null!==(i=null===(e=this.Da)||void 0===e?void 0:e.solvePlane)&&void 0!==i?i:s?"x":r?"y":"xy";this.hb=n}ws(){return"x"===this.hb?"ProgressiveX":"y"===this.hb?"ProgressiveY":void 0}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY};if(0===this.NS.length)return;const r="x"===this.hb?(t,e)=>Math.abs(t.x-e.x):"y"===this.hb?(t,e)=>Math.abs(t.y-e.y):yi,n=ks(s,this.NS.filter(t=>t.getVisible()),this.JS,r);if(!n)return;const o=tt(s,this.Ws.pi.ai,this.scale);if("x"===this.hb&&!mi(o.x,this.getXMin(),this.getXMax()))return;if("y"===this.hb&&!mi(o.y,this.getYMin(),this.getYMax()))return;const a=tt(n[0],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:a,resultTableScale:this.scale,pointMarker:a,pointMarkerScale:{x:this.axisX,y:this.axisY}},...a,figure:n[1],positionAndSize:n[1].getDimensionsPositionAndSize(),...n[1].getDimensionsTwoPoints(),series:this,axisX:this.axisX,axisY:this.axisY}}Qi(t,e,i){if(!i)return;const s=this.NS.find(t=>t.MS===i);if(!s)return;const r=s.getDimensionsPositionAndSize(),n=l(r.x+r.width/2,r.y+r.height/2);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,positionAndSize:s.getDimensionsPositionAndSize(),...s.getDimensionsTwoPoints(),figure:s,series:this,axisX:this.axisX,axisY:this.axisY}}BS(t){}YS(t){const e=this.nb.VA();t.forEach(t=>{if(!t.getVisible())return;const i=t.getDimensionsTwoPoints(),s=t.getFillStyle(),r=t.getStrokeStyle();e.add({xi:t.xi,figure:t,roundedCorners:t.eb,...i},{fillStyle:s,strokeStyle:r})}),e.finishPlot(),this.ob()}add(t){const e=new zc(this,this.Ws,this.scale,this.SS,this.pS,this.vS,this.yS,this.mS,this.US,this.bi,this.qS).setDimensions(t);return this.jS(e),this.$S=!0,this.chart.pi.Bs(),e}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Vc extends Tc{constructor(t,e,i,s,r,n,o,a,h,c,u){super(e,i,s,r,n,o,a,h,c),this.dimensions={startX:0,startY:0,endX:0,endY:0},this.nu=g(l(0,0),l(0,0)),this.fv=t,this.bi=c,this.Ws=e,this.scale=i,this.Je=ze(c.segmentSeriesStrokeStyle,u)}Qi(t,e){const i=this.getDimensions(),s=l((i.startX+i.endX)/2,(i.startY+i.endY)/2);return{cursorPosition:{resultTable:s,resultTableScale:this.scale,pointMarker:s,pointMarkerScale:{x:this.fv.axisX,y:this.fv.axisY}},...s,figure:this,...this.getDimensions(),series:this.fv,axisX:this.fv.axisX,axisY:this.fv.axisY}}IS(){return this.nu}setDimensions(t){return this.dimensions=t,this.nu=g(l(Math.min(t.startX,t.endX),Math.min(t.startY,t.endY)),l(Math.max(t.startX,t.endX),Math.max(t.startY,t.endY))),this.pS(),this.Ws.Bs(),this}getDimensions(){return this.dimensions}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.vS(),this}getStrokeStyle(){return this.Je}getDominantStyle(){const t=this.Je;return t!==Bt?t.getFillStyle():ls}}class Nc extends Fc{constructor(t,e,i,s,r,n,o,a,h,c,u){super(t,e,i,s,r,n,o,a,h,c),this.Rs="Segment Series",this.ab=$e(),this.JS=t=>{const e=t.getDimensions(),i=l((e.startX+e.endX)/2,(e.startY+e.endY)/2);return tt(i,this.scale,this.Ws.pi.ai)},this.D=new vt,this.chart.pi.La(Hn.Do),this.qS=u,this.WS=new Vc(this,this.Ws,this.scale,jt,jt,jt,jt,jt,t=>!1,this.bi,this.qS).dispose(),this.QS=new $h(()=>{const t=this.ab.Ji(this.Ws.bA(this.scale));return this._s(t,{setEventHandlers:!1}),t},(t,e,i)=>(t.cr(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.wA(e.start,e.end),this.ab.Ki(i,e.figure),e.figure.bS(i),i})),()=>{this.ab.Vi()},(t,e)=>{this.Ts(e)})}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY};if(0===this.NS.length)return;const r=ks(s,this.NS.filter(t=>t.getVisible()),this.JS,yi);if(!r)return;const n=tt(r[0],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,figure:r[1],...r[1].getDimensions(),series:this,axisX:this.axisX,axisY:this.axisY}}Qi(t,e,i){if(!i)return;const s=this.NS.find(t=>t.MS===i);if(!s)return;const r=s.getDimensions(),n=l((r.startX+r.endX)/2,(r.startY+r.endY)/2);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,...r,figure:s,series:this,axisX:this.axisX,axisY:this.axisY}}BS(t){}YS(t){const e=this.QS.VA();t.forEach(t=>{if(!t.getVisible())return;const i=t.getDimensions(),s={x:i.startX,y:i.startY},r={x:i.endX,y:i.endY},n=t.getStrokeStyle();e.add({xi:t.xi,start:s,end:r,figure:t},{strokeStyle:n})}),e.finishPlot()}add(t){const e=new Vc(this,this.Ws,this.scale,this.SS,this.pS,this.vS,this.yS,this.mS,this.US,this.bi,this.qS).setDimensions(t);return this.jS(e),this.$S=!0,this.chart.pi.Bs(),e}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Oc={x:0,y:0};class Uc extends Tc{constructor(t,e,i,s,r,n,o,a,h,l,c){var u;super(e,i,s,r,n,o,a,h,l),this.ml="Text",this.na=Oc,this.hf=Oc,this._l=0,this.ot=Xe,this.fv=t,this.Ze=l.textSeriesFillStyle?ze(l.textSeriesFillStyle,c):l.uiTextFillStyle,this.qn=null!==(u=l.textSeriesFont)&&void 0!==u?u:l.uiTextFont,this.Cc=this.Ws._n(i,!1).qh(l.textSeriesShadow),this.Cc.xl=!0,this.D.zi(this.Cc,{getExtraData:(t,e,i)=>this.Qi(i,t)}),this.addEventListener("dispose",()=>this.Cc.dispose())}Qi(t,e){const i=this.na;return{cursorPosition:{resultTable:i,resultTableScale:this.scale,pointMarker:i,pointMarkerScale:{x:this.fv.axisX,y:this.fv.axisY}},...i,figure:this,series:this.fv,axisX:this.fv.axisX,axisY:this.fv.axisY}}IS(){return{min:{x:this.na.x,y:this.na.y},max:{x:this.na.x,y:this.na.y}}}lb(){this.Cc.tn(this.ml).sr(this.na).Zl(this.hf).Th(this._l).Mn(this.ot).qe(this.Ze).Ch(this.qn)}getSizePixels(){return this.lb(),this.Cc.Nh().bc()}getBoundingBox(){return this.lb(),this.Cc.Nh().mc()}setText(t){return this.ml=t,this.pS(),this}getText(){return this.ml}setLocation(t){return this.na=t,this.pS(),this}getLocation(){return this.na}setAlignment(t){return this.hf=t,this.pS(),this}getAlignment(){return this.hf}setRotation(t){return this._l=t,this.pS(),this}getRotation(){return this._l}setMargin(t){return this.ot=v(this.ot,t),this.pS(),this}getMargin(){return this.ot}setLabelShadow(t){return this.Cc.qh(t),this.Ws.Bs(),this}getLabelShadow(){return this.Cc.Gl()}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.vS(),this}getFillStyle(){return this.Ze}setFont(t){return this.qn="function"==typeof t?t(this.qn):t,this.vS(),this}getFont(){return this.qn}getDominantStyle(){return this.Ze}}class Gc extends Fc{constructor(t,e,i,s,r,n,o,a,h,l,c){super(t,e,i,s,r,n,o,a,h,l),this.Rs="Text Series",this.JS=t=>tt(t.getLocation(),this.scale,this.Ws.pi.ai),this.D=new vt,this.qS=c,this.WS=new Uc(this,this.Ws,this.scale,jt,jt,jt,jt,jt,t=>!1,this.bi,this.qS).dispose()}BS(t){}YS(t){t.forEach(t=>{t.lb(),t.Cc.setVisible(t.getVisible())})}add(t){const e=new Uc(this,this.Ws,this.scale,this.SS,this.pS,this.vS,this.yS,this.mS,this.US,this.bi,this.qS);return(null==t?void 0:t.alignment)&&e.setAlignment(t.alignment),(null==t?void 0:t.fillStyle)&&e.setFillStyle(t.fillStyle),(null==t?void 0:t.font)&&e.setFont(t.font),(null==t?void 0:t.location)&&e.setLocation(t.location),(null==t?void 0:t.margin)&&e.setMargin(t.margin),void 0!==(null==t?void 0:t.rotation)&&e.setRotation(t.rotation),(null==t?void 0:t.text)&&e.setText(t.text),this.jS(e),this.$S=!0,this._s(e.Cc,{setEventHandlers:!1,isText:!0}),this.chart.pi.Bs(),this.D.zi(e.Cc,{getExtraData:(t,i,s)=>e.Qi(s,t)}),e}Qi(t,e,i){return Je({series:this,axisX:this.axisX,axisY:this.axisY},{cursorPosition:0,x:0,y:0,multiHit:0,figure:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY};if(0===this.NS.length)return;const r=ks(s,this.NS.filter(t=>t.getVisible()),this.JS,yi);if(!r)return;const n=tt(r[0],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,figure:r[1],series:this,axisX:this.axisX,axisY:this.axisY}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Yc=(t,e)=>{let i=0;const s=[];for(;i<t;){const r=i;let n=e;const o=i>0;n-=o?1:0,n-=i+n<t?1:0;const a=Math.min(n,t-r),h=i-(o?1:0),l={start:h,startUnique:r,sizeData:Math.min(e,t-h),sizeUniqueData:a};s.push(l),i+=a}return s},Zc=(t,e)=>{let i=0;const s=[];for(;i<t;){const r=i;let n=e;const o=i>0;n-=o?1:0,n-=0;const a=Math.min(n,t-r),h=i-(o?1:0),l={start:h,startUnique:r,sizeData:Math.min(e,t-h),sizeUniqueData:a};s.push(l),i+=a}return s},Wc=(t,e,i,s)=>{if(i){const t=new Map;return e.gridTiles.forEach(e=>{t.set(e,{type:i,dataInvalidationRanges:[{tileInvalidationOffset:{primary:0,secondary:0},tileInvalidationLength:e.sizeHeatmapDataVectors}]})}),t}const r=new Map;for(let i=0;i<t.length;i+=1){const n=t[i],o={x:n.startPrimary,y:n.startSecondary},a={x:o.x+n.lengthPrimary-1,y:o.y+n.lengthSecondary-1},h=[o,{x:a.x,y:o.y},a,{x:o.x,y:a.y}];e.gridTiles.forEach(t=>{const e=t.iFirstVector,i=s(t),o={x:e.primary+i.primary-1,y:e.secondary+i.secondary-1},a=[{x:e.primary,y:e.secondary},{x:o.x,y:e.secondary},o,{x:e.primary,y:o.y}];if(!ui(h,a))return;let c=r.get(t);c||(c={type:n.type,dataInvalidationRanges:[]},r.set(t,c));const u=(d=h,f=a,g(l(Math.max(Math.min(d[0].x,d[2].x),Math.min(f[0].x,f[2].x)),Math.max(Math.min(d[0].y,d[2].y),Math.min(f[0].y,f[2].y))),l(Math.min(Math.max(d[0].x,d[2].x),Math.max(f[0].x,f[2].x)),Math.min(Math.max(d[0].y,d[2].y),Math.max(f[0].y,f[2].y)))));var d,f;const p={primary:u.min.x-e.primary,secondary:u.min.y-e.secondary},m={primary:1+u.max.x-u.min.x,secondary:1+u.max.y-u.min.y};let y=!1;const x=[{x:p.primary,y:p.secondary},{x:p.primary+m.primary,y:p.secondary},{x:p.primary+m.primary,y:p.secondary+m.secondary},{x:p.primary,y:p.secondary+m.secondary}];for(let t=0;t<c.dataInvalidationRanges.length;t+=1)if(!y){const e=c.dataInvalidationRanges[t],i=[{x:e.tileInvalidationOffset.primary,y:e.tileInvalidationOffset.secondary},{x:e.tileInvalidationOffset.primary+e.tileInvalidationLength.primary,y:e.tileInvalidationOffset.secondary},{x:e.tileInvalidationOffset.primary+e.tileInvalidationLength.primary,y:e.tileInvalidationOffset.secondary+e.tileInvalidationLength.secondary},{x:e.tileInvalidationOffset.primary,y:e.tileInvalidationOffset.secondary+e.tileInvalidationLength.secondary}];if(ui(x,i)){const t=di(x,i);e.tileInvalidationOffset.primary=t.min.x,e.tileInvalidationOffset.secondary=t.min.y,e.tileInvalidationLength.primary=t.max.x-t.min.x,e.tileInvalidationLength.secondary=t.max.y-t.min.y,y=!0}}y||c.dataInvalidationRanges.push({tileInvalidationLength:m,tileInvalidationOffset:p})})}return r},jc=t=>$o(t)||Array.isArray(t)&&"number"==typeof t[0],Hc=t=>!jc(t)&&Array.isArray(t),$c=(t,e,i,s)=>{if(1!==t.length||0!==e.startPrimary||0!==e.startSecondary||e.lengthPrimary!==t[0].sizeHeatmapDataVectors.primary||e.lengthSecondary!==t[0].sizeHeatmapDataVectors.secondary)t.forEach(t=>{const s=i(t),r=Math.max(e.startPrimary,t.iFirstVector.primary),n=Math.min(e.startPrimary+e.lengthPrimary-1,t.iFirstVector.primary+t.sizeHeatmapDataVectors.primary-1),o=Math.max(e.startSecondary,t.iFirstVector.secondary),a=Math.min(e.startSecondary+e.lengthSecondary-1,t.iFirstVector.secondary+t.sizeHeatmapDataVectors.secondary-1);if(Hc(e.values))for(let i=r;i<=n;i+=1){const r=i-e.startPrimary,n=e.values[r],h=(i-t.iFirstVector.primary)*t.sizeHeatmapDataVectors.secondary;for(let i=o;i<=a;i+=1){const r=i-e.startSecondary,o=i-t.iFirstVector.secondary,a=n[r];s[h+o]=a}}else for(let i=r;i<=n;i+=1){const r=i-e.startPrimary,n=(i-t.iFirstVector.primary)*t.sizeHeatmapDataVectors.secondary;for(let i=o;i<=a;i+=1){const o=i-e.startSecondary,a=i-t.iFirstVector.secondary,h=r*e.lengthSecondary+o,l=e.values[h];s[n+a]=l}}});else{const r=t[0],n=i(r);if(Hc(e.values))for(let t=0;t<e.lengthPrimary;t+=1){const i=t*r.sizeHeatmapDataVectors.secondary;n.set(e.values[t],i)}else s(r,Ho(e.values)===Float32Array?e.values:new Float32Array(e.values))}},Xc=(t,e,i)=>{var s,r;const n=null===(s=t.gl2)||void 0===s?void 0:s.ctx;if(n)return t.ub(null,n.RED,!1,!0,{x:e,y:i},!1,n.FLOAT,n.R32F);const o=t.gl;return(null===(r=t.gl1)||void 0===r?void 0:r.optional.OES_texture_float)?t.ub(null,o.LUMINANCE,!1,!0,{x:e,y:i},!1,o.FLOAT):t.ub(null,o.RGBA,!1,!0,{x:e,y:i},!1,o.UNSIGNED_BYTE)},qc=(t,e,i,s)=>{e.forEach((e,r)=>{var n,o;const a=i(r),h=s(r),l=t.gl;l.bindTexture(l.TEXTURE_2D,h),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);const c=null===(n=t.gl2)||void 0===n?void 0:n.ctx,u=e.dataInvalidationRanges.length,d=e.dataInvalidationRanges.reduce((t,e)=>t+e.tileInvalidationLength.primary,0)/r.sizeHeatmapDataVectors.primary;1===u&&d<1||d<.5&&u<10?e.dataInvalidationRanges.forEach(e=>{var i;const s=e.tileInvalidationOffset.primary*r.sizeHeatmapDataVectors.secondary,n=s+e.tileInvalidationLength.primary*r.sizeHeatmapDataVectors.secondary;if(c)c.texSubImage2D(l.TEXTURE_2D,0,0,e.tileInvalidationOffset.primary,r.sizeHeatmapDataVectors.secondary,e.tileInvalidationLength.primary,c.RED,c.FLOAT,a.subarray(s,n));else if(null===(i=t.gl1)||void 0===i?void 0:i.optional.OES_texture_float)l.texSubImage2D(l.TEXTURE_2D,0,0,e.tileInvalidationOffset.primary,r.sizeHeatmapDataVectors.secondary,e.tileInvalidationLength.primary,l.LUMINANCE,l.FLOAT,a.subarray(s,n));else{const t=new Uint8Array(a.buffer).subarray(4*s,4*n);l.texSubImage2D(l.TEXTURE_2D,0,0,e.tileInvalidationOffset.primary,r.sizeHeatmapDataVectors.secondary,e.tileInvalidationLength.primary,l.RGBA,l.UNSIGNED_BYTE,t)}}):c?c.texImage2D(l.TEXTURE_2D,0,c.R32F,r.sizeHeatmapDataVectors.secondary,r.sizeHeatmapDataVectors.primary,0,c.RED,c.FLOAT,a):(null===(o=t.gl1)||void 0===o?void 0:o.optional.OES_texture_float)?l.texImage2D(l.TEXTURE_2D,0,l.LUMINANCE,r.sizeHeatmapDataVectors.secondary,r.sizeHeatmapDataVectors.primary,0,l.LUMINANCE,l.FLOAT,a):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,r.sizeHeatmapDataVectors.secondary,r.sizeHeatmapDataVectors.primary,0,l.RGBA,l.UNSIGNED_BYTE,new Uint8Array(a.buffer)),l.bindTexture(l.TEXTURE_2D,null)})};class Kc extends Cc{constructor(t,e,i,s,r,n,o,a,h,l,c,u){super(t,e,i,s,r,n,o,a,l,c),this.Rs="Heatmap Grid Series",this.cb=!0,this.Qv={},this.chart.pi.La(Hn.Bo),this.fb=h,this.bi=l;const d=u;this.Ze=ze(l.heatmapGridSeriesFillStyle,d),this.Kv=ze(this.bi.heatmapGridSeriesWireframeStyle,d);const f={heatmapDataType:"intensity",dataOrder:h.dataOrder||"columns",columns:h.columns,rows:h.rows,Ab:h.maxTileSize};this.Da=f,this.gb=this.Ws.pb(this.scale,[],f).qe(this.Ze).qv(this.Kv).Ii(this.getHighlight()),this._s(this.gb),this.cb=!0,this.setHighlightOnHover(!1)}solveNearest(t,e="show-nearest"){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=tt(s,this.Ws.pi.ai,this.scale),n=Kf(e)?this.gb.yb(r):this.gb.yd(r);if(n)return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},x:n.x,y:n.y,column:n.column,row:n.row,intensity:n.cellValue,series:this,axisX:this.axisX,axisY:this.axisY,lut:vs(this.Ze)?this.Ze.lut:void 0}}Qi(t,e,i){return Je({series:this,axisX:this.axisX,axisY:this.axisY},{cursorPosition:0,x:0,y:0,multiHit:0,intensity:0,column:0,row:0,lut:vs(this.Ze)?this.Ze.lut:void 0},()=>this.solveNearest(e,this.chart.getCursorMode()))}iy(){const t=this.Qv.start||{x:0,y:0};let e;e=this.Qv.end?{x:(this.Qv.end.x-t.x)/this.Da.columns,y:(this.Qv.end.y-t.y)/this.Da.rows}:this.Qv.step?this.Qv.step:{x:1,y:1},this.gb.sy(t,e),this.chart.pi.Bs()}setStart(t){return this.Qv.start=t,this.iy(),this}getStart(){return this.gb.ey().start}setStep(t){return this.Qv.step=t,this.iy(),this}getStep(){return this.gb.ey().step}setEnd(t){return this.Qv.end=t,this.iy(),this}getEnd(){return this.gb.ey().end}setContours(t){var e,i,s;return this.gb.hy(t?{showLabels:null===(e=t.showLabels)||void 0===e||e,levels:t.levels.map(t=>{var e,i,s,r,n,o;return{value:t.value,strokeStyle:null!==(i=null!==(e=t.strokeStyle)&&void 0!==e?e:this.bi.heatmapGridSeriesContourStrokeStyle)&&void 0!==i?i:new lr({thickness:1,fillStyle:new fs({color:M(0,0,0)})}),labelFillStyle:new fs({color:null!==(s=t.labelColor)&&void 0!==s?s:this.bi.heatmapGridSeriesContourLabelColor}),labelFont:(n=t.labelFont,o=null!==(r=this.bi.heatmapGridSeriesContourLabelFont)&&void 0!==r?r:this.bi.uiTextFont,void 0===n?o:R(n)?n:new I({size:o.size,family:o.family,variant:o.variant,type:o.type,style:o.style,weight:o.weight,...n})),label:t.label}}),shadows:null!==(s=null!==(i=t.shadows)&&void 0!==i?i:this.bi.heatmapGridSeriesContourLabelShadow)&&void 0!==s?s:null}:void 0),this.Ws.Bs(),this}getContours(){return this.gb.ny()}xp(){return this.rp&&this.getVisible()}Ys(){return Re(this.Ze,this.gb._i())}er(){return{fill:this.Ze}}mb(t){this.gb.mb().forEach(e=>{t.gb.Ay(e)})}RS(){const t=this.gb;return t?t.Wi():void 0}OS(){const t=this.gb;return t?t.Hi():void 0}zS(){const t=this.gb;return t?t.Zi():void 0}VS(){const t=this.gb;return t?t.Xi():void 0}gn(){const t=l(0,0);return t.x=Math.max(t.x,this.gb.uu()),t.y=Math.max(t.y,this.gb.cu()),t}BS(t){if(!(t instanceof q))throw new Error("HeatmapGridSeries can only be attached to a pair of Linear Axes.")}rr(t,e){t.Ii(e),this.Ws.Bs()}ir(){return super.ir(),this.gb.Ti(this.getBoundaries()),this}}class Jc extends Kc{constructor(t,e,i,s,r,n,o,a,h,l,c,u){super(t,e,i,s,r,n,o,a,h,l,c,u),this.gp=!1,this.D=new vt}yp(){return this.gp}invalidateIntensityValues(t){if(this.gp&&this.chart.pi.La(Hn.Ro),$o(t)||Array.isArray(t)&&"number"==typeof t[0]){const e=this.Da.columns*this.Da.rows,i=t.length;if(e!==i)throw new Error(`LightningChart JS input error | Heatmap invalidateIntensityValues received typed array whose length does not match heatmap columns x rows (received ${i}, expected ${e})`);this.gb.Ay({type:"intensity",lengthPrimary:"columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows,lengthSecondary:"columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns,startPrimary:0,startSecondary:0,values:t})}else if(Array.isArray(t)){let e=t;if(0===t.length)return this;const i={x:e.length,y:e[0].length,columns:"columns"===this.Da.dataOrder?e.length:e[0].length,rows:"rows"===this.Da.dataOrder?e.length:e[0].length},s="columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows,r="columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns;if(i.x>s||i.y>r){if(!0===this.chart.Pg.Ea){const t=`HeatmapGridSeries.invalidateIntensityValues intensity matrix overflow.\nGrid ${this.Da.columns}x${this.Da.rows}, input ${i.columns}x${i.rows}.\nExcess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(t)}const t=[];for(let i=0;i<s;i+=1)t[i]=e[i].slice(0,r);e=t}this.gb.Ay({type:"intensity",lengthPrimary:i.x,lengthSecondary:i.y,startPrimary:0,startSecondary:0,values:e})}else if("iColumn"in t&&"iRow"in t&&"values"in t&&Hc(t.values)){const e=t.values;if(0===t.values.length)return this;const i={primary:e.length,secondary:e[0].length,columns:"columns"===this.Da.dataOrder?e.length:e[0].length,rows:"rows"===this.Da.dataOrder?e.length:e[0].length},s="columns"===this.Da.dataOrder?t.iColumn:t.iRow,r=s+i.primary-1,n="columns"===this.Da.dataOrder?t.iRow:t.iColumn,o=n+i.secondary-1,a=("columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows)-1,h=("columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns)-1;if(s<0||n<0){if(!0===this.chart.Pg.Ea){const e=`HeatmapGridSeries.invalidateIntensityValues invalidation start below 0 not permitted.\niColumn: ${t.iColumn}, iRow: ${t.iRow}.\nNo intensity values will be invalidated.`;Ut.console.warn(e)}return this}if(r>a||o>h){if(!0===this.chart.Pg.Ea){const e=`HeatmapGridSeries.invalidateIntensityValues intensity matrix overflow.\nGrid ${this.Da.columns}x${this.Da.rows}, input ${i.columns}x${i.rows} starting at [${t.iColumn},${t.iRow}].\nOut of bounds data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(e)}const s=Math.max(r-a,0),n=i.primary-s,l=Math.max(o-h,0),c=[];for(let t=0;t<n;t+=1)c[t]=e[t].slice(0,l>0?-l:void 0);t={iColumn:t.iColumn,iRow:t.iRow,values:c}}this.gb.Ay({type:"intensity",lengthPrimary:e.length,lengthSecondary:e[0].length,startPrimary:s,startSecondary:n,values:e})}else if("iColumn"in t&&"iRow"in t&&"columns"in t&&"rows"in t&&"values"in t&&jc(t.values)){const e=t.values;if(0===t.values.length)return this;const i={primary:"columns"===this.Da.dataOrder?t.columns:t.rows,secondary:"columns"===this.Da.dataOrder?t.rows:t.columns,columns:t.columns,rows:t.rows},s="columns"===this.Da.dataOrder?t.iColumn:t.iRow,r=s+i.primary-1,n="columns"===this.Da.dataOrder?t.iRow:t.iColumn,o=n+i.secondary-1,a=("columns"===this.Da.dataOrder?this.Da.columns:this.Da.rows)-1,h=("columns"===this.Da.dataOrder?this.Da.rows:this.Da.columns)-1;if(s<0||n<0){if(!0===this.chart.Pg.Ea){const e=`HeatmapGridSeries.invalidateIntensityValues invalidation start below 0 not permitted.\niColumn: ${t.iColumn}, iRow: ${t.iRow}.\nNo intensity values will be invalidated.`;Ut.console.warn(e)}return this}if(r>a||o>h){if(!0===this.chart.Pg.Ea){const e=`HeatmapGridSeries.invalidateIntensityValues intensity matrix overflow.\nGrid ${this.Da.columns}x${this.Da.rows}, input ${i.columns}x${i.rows} starting at [${t.iColumn},${t.iRow}].\nWith flat array input, this operation is not permitted. No intensity values will be invalidated.`;Ut.console.warn(e)}return this}const l=i.columns*i.rows;if(e.length!==l){if(!0===this.chart.Pg.Ea){const i=`HeatmapGridSeries.invalidateIntensityValues invalid flat data input.\ncolumns=${t.columns} rows=${t.rows}, array length must be ${l}, received ${e.length}\nNo intensity values will be invalidated.`;Ut.console.warn(i)}return this}this.gb.Ay({type:"intensity",lengthPrimary:i.primary,lengthSecondary:i.secondary,startPrimary:s,startSecondary:n,values:e})}return this.D.R("invalidateintensity",{value:t}),this.Ws.Bs(),this.gp=!0,this}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.gb.qe(this.Ze),this.D.R("stylechange",{}),this.Ws.Bs(),this}getFillStyle(){return this.Ze}setIntensityInterpolation(t){return t=t||"disabled",this.gb.ly(t),this.Ws.Bs(),this.D.R("stylechange",{}),this}getIntensityInterpolation(){return this.gb.uy()}setAggregation(t){return this.gb.xb(t),this.Ws.Bs(),this}getAggregation(){return this.gb.Sb()}clear(){return this.gb.Vi(),this.Ws.Bs(),this.D.R("dataclear",{}),this}setWireframeStyle(t){return this.Kv="function"==typeof t?t(this.Kv):t,this.gb.qv(this.Kv),this.Ws.Bs(),this.D.R("stylechange",{}),this}getWireframeStyle(){return this.Kv}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Qc extends Cc{constructor(t,e,i,s,r,n,o,a,h,l,c,u){super(t,e,i,s,r,n,o,a,l,c),this.Rs="Scrolling Heatmap Grid Series",this.Qv={},this.chart.pi.La(Hn.Bo),this.chart.pi.La(Hn.Ro);const d=u;this.Ze=ze(l.heatmapScrollingGridSeriesFillStyle,d),this.Kv=ze(this.bi.heatmapScrollingGridSeriesWireframeStyle,d);const f={scrollDimension:"columns",heatmapDataType:"intensity",...h};this.Da=f,this.bb=this.Ws.Mb(this.scale,[],f).qe(this.Ze).qv(this.Kv).Ii(this.getHighlight()),this._s(this.bb),this.setHighlightOnHover(!1)}yp(){return this.bb.Sy()>0}solveNearest(t,e="show-nearest"){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=tt(s,this.Ws.pi.ai,this.scale),n=Kf(e)?this.bb.yb(r):this.bb.yd(r);if(n)return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},x:n.x,y:n.y,column:n.column,row:n.row,intensity:n.cellValue,series:this,axisX:this.axisX,axisY:this.axisY,lut:vs(this.Ze)?this.Ze.lut:void 0}}Qi(t,e,i){return Je({series:this,axisX:this.axisX,axisY:this.axisY},{cursorPosition:0,x:0,y:0,intensity:0,multiHit:0,column:0,row:0,lut:vs(this.Ze)?this.Ze.lut:void 0},()=>this.solveNearest(e,this.chart.getCursorMode()))}iy(){const t=this.Qv.start||{x:0,y:0};let e;e=this.Qv.step?this.Qv.step:{x:1,y:1},this.bb.sy(t,e),this.chart.pi.Bs()}setStart(t){return this.Qv.start=t,this.iy(),this}getStart(){return this.bb.ey().start}setStep(t){return this.Qv.step=t,this.iy(),this}getStep(){return this.bb.ey().step}clear(){return this.bb.Vi(),this.Ws.Bs(),this}setAggregation(t){return this.bb.xb(t),this.Ws.Bs(),this}getAggregation(){return this.bb.Sb()}setWireframeStyle(t){return this.Kv="function"==typeof t?t(this.Kv):t,this.bb.qv(this.Kv),this.Ws.Bs(),this}getWireframeStyle(){return this.Kv}setIntensityInterpolation(t){return t=t||"disabled",this.bb.ly(t),this.Ws.Bs(),this}getIntensityInterpolation(){return this.bb.uy()}setPixelInterpolationMode(t){return this.setIntensityInterpolation(t),this}getPixelInterpolationMode(){return this.getIntensityInterpolation()}setDataCleaning(t){return this.bb.wb(t),this.Ws.Bs(),this}xp(){return this.rp&&this.getVisible()}Ys(){return Re(this.Ze,this.bb._i())}er(){return{fill:this.Ze}}qe(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.bb.qe(this.Ze),this.Ws.Bs(),this}BS(t){if(!(t instanceof q))throw new Error("HeatmapScrollingGridSeries can only be attached to a pair of Linear Axes.")}RS(){return this.bb.Wi()||0}OS(){return this.bb.Hi()||0}zS(){return this.bb.Zi()||0}VS(){return this.bb.Xi()||0}gn(){const t=l(0,0);return t.x=Math.max(t.x,this.bb.uu()),t.y=Math.max(t.y,this.bb.cu()),t}rr(t,e){t.Ii(e),this.Ws.Bs()}}class tu extends Qc{constructor(t,e,i,s,r,n,o,a,h,l,c,u){super(t,e,i,s,r,n,o,a,h,l,c,u),this.D=new vt}addIntensityValues(t){if(0===t.length||0===t[0].length)return this;const e=t.length,i=t[0].length,s=("columns"===this.Da.scrollDimension?t.length:t[0].length,"rows"===this.Da.scrollDimension?t.length:t[0].length,0+i-1),r=this.Da.resolution-1;if(s>r){if(!0===this.chart.Pg.Ea){const t=`HeatmapScrollingGridSeries.addIntensityValues intensity matrix overflow.\nGrid resolution: ${this.Da.resolution}, input ${e}x${i}.\nExcess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(t)}const s=[];for(let i=0;i<e;i+=1)s[i]=t[i].slice(0,r+1);t=s}return this.bb.xy(t),this.Ws.Bs(),this}invalidateIntensityValues(t){return this.bb.Ay(t.iSample,t.values),this.Ws.Bs(),this}getSampleCount(){return this.bb.Sy()}setFillStyle(t){return this.qe(t),this}getFillStyle(){return this.Ze}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class eu extends Cc{constructor(){super(...arguments),this._b=[],this.fc=[],this.kb=[],this.Cb=[],this.Tb=1e3,this.Fb=0,this.ds=e.HighlightModes.onHover,this.Ib=[],this.Lb=[],this.Pb=!1,this.Bb=(t,e)=>{const i=t.gS(e);if(i)return[tt(i[0],this.scale,this.Ws.pi.ai),tt(i[1],this.scale,this.Ws.pi.ai)]},this.Db=(t,e)=>{const i=t.Eb(e);if(i)return[tt(i[0],this.scale,this.Ws.pi.ai),tt(i[1],this.scale,this.Ws.pi.ai)]},this.Rb=t=>{const e=t.length;if(this._b.length>0){const i=this._b.length-1,s=this._b[i];if(e>0){const[e,i]=s.Mu(),[r,n]=s.wu();if((r?e.length+r.length:e.length)>=this.Tb){const o=r&&r.length>0?r[r.length-1]:e[e.length-1],a=n&&n.length>0?n[n.length-1]:i[e.length-1],h=(o.x+t[0].position)/2,c=Oi(h,o,l(t[0].position,t[0].high)).y,d=Oi(h,a,l(t[0].position,t[0].low)).y,f=u(h,c,d);s.bu(f,g(l(h,d),l(h,c))).Lu(!0),this.Ob([f].concat(t)).Fu(!0)}else s.bu(t)}}else e>0&&this.Ob(t)},this.zb=t=>{const e=this.Ib,i=t.length;if(this.Ib.length>0){if(i>0){const i=e[e.length-1],s=i.Mu(),r=i.wu();if(s.length+r.length>=this.Tb){const n=r.length>0?r[r.length-1]:s[s.length-1],o=(n.x+t[0].x)/2,a=Oi(o,n,l(t[0].x,t[0].y)).y,h=l(o,a);i.bu(h,g(l(o,a),l(o,a))).Lu(!0),e.push(this.Vb([h].concat(t),this.Nb).Fu(!0))}else i.bu(t)}}else i>0&&e.push(this.Vb(t))},this.Gb=t=>{const e=this.Lb,i=t.length;if(this.Lb.length>0){if(i>0){const i=e[e.length-1],s=i.Mu(),r=i.wu();if(s.length+r.length>=this.Tb){const n=r.length>0?r[r.length-1]:s[s.length-1],o=(n.x+t[0].x)/2,a=Oi(o,n,l(t[0].x,t[0].y)).y,h=l(o,a);i.bu(h,g(l(o,a),l(o,a))).Lu(!0),e.push(this.$b([h].concat(t)).Fu(!0))}else i.bu(t)}}else i>0&&e.push(this.$b(t))}}ws(){return"ProgressiveX"}yp(){return this.getPointAmount()>0}setDataCleaning(t){const e=t&&t.minDataPointCount;return this.Fb=void 0!==e&&e>0?e:0,this.Ws.Bs(),this}clear(){for(let t=0;t<this._b.length;t+=1)this._b[t].dispose();for(let t=0;t<this.Ib.length;t+=1)this.Ib[t].dispose();for(let t=0;t<this.Lb.length;t+=1)this.Lb[t].dispose();return this.fc.length=0,this.kb.length=0,this.Cb.length=0,this.Nb=void 0,this._b.length=0,this.Ib.length=0,this.Lb.length=0,this.Ws.Bs(),this.D.R("dataclear",{}),this}getPointAmount(){return this._b.reduce((t,e)=>t+e.Cu()+e.Tu(),this.fc.length)}RS(){return ne(this._b,Jt,Math.max,ie,this.Nb)||0}OS(){return ne(this._b,Kt,Math.min,ee,this.Nb)||0}zS(){return ne(this._b,te,Math.max,re,this.Nb)||0}VS(){return ne(this._b,Qt,Math.min,se,this.Nb)||0}gn(){const t=l(0,0);for(const e of this._b)t.x=Math.max(t.x,e.uu()),t.y=Math.max(t.y,e.cu());return t}Ys(){return Re(this.Ub,void 0)||Re(this.Yb,void 0)}xp(){return this.rp&&this.getPointAmount()>0&&this.getVisible()}BS(t){}jb(t,e,i){this.fc=Be(this.fc,t,{canReturnB:!1}),this.kb=Be(this.kb,e,{canReturnB:!1}),this.Cb=Be(this.Cb,i,{canReturnB:!1}),this.Ws.Bs()}Hb(t,e,i,s){this.Wb(e,i,s),this.jb(Array.isArray(t)?t:[t],e,i)}Wb(t,e,i){const s=Ei(bi(t),bi(e));this.Nb?this.Nb=Ei(this.Nb,s):this.Nb=s,i&&(this.Nb=Ei(this.Nb,i))}Xb(){const t=this._b.length,e=Math.min(this.scale.x.getInnerStart(),this.scale.x.getInnerEnd());let i=0;if(t>1)for(let s=0;s<t-1;s+=1)this.scale.x.Qt(this._b[s].Wi(),this._b[s].uu())<e&&(i+=1);return i}Zb(t,e,i,s){if(i>0){const r=Math.ceil(i/e),n=t.length-r;if(n>0&&s>0){const e=n-s>0?s:n;if(e>0){for(let i=0;i<e;i+=1)t[i].dispose();t.splice(0,e)}}}}Jb(t){const e=this._b.length>0?this._b[this._b.length-1]:void 0,i=e?e.Mu()[0].length+(e.wu()[0]?e.wu()[0].length:0):void 0;Bc(t,i,this.Tb,this.Rb)}Qb(t){const e=this.Ib.length>0?this.Ib[this.Ib.length-1].Mu().length+this.Ib[this.Ib.length-1].wu().length:void 0;Bc(t,e,this.Tb,this.zb)}Kb(t,e){const i=this.Ib.length>0?this.Ib[this.Ib.length-1].Mu().length+this.Ib[this.Ib.length-1].wu().length:void 0;Bc(t,i,this.Tb,this.zb),Bc(e,i,this.Tb,this.Gb)}Ob(t,e){const i=this.Ws.qb(this.scale).bu(t,e).qe(this.Ub)._u(this.Yb).Ii(this.getHighlight());return this._b.push(i),this._s(i),i}tM(t,e,i){const s=this.Ws.Np(this.scale,void 0,[Wh.UserSeries]).bu(t,i).setPointerEvents(!1).cr(e).Ii(this.getHighlight());return this._s(s),s}Vb(t,e){return this.tM(t,this.iM,e)}$b(t,e){return this.tM(t,this.sM,e)}eM(t){this.Ub="function"==typeof t?t(this.Ub):t;const e=this.Ub;for(let t=0;t<this._b.length;t+=1)this._b[t].qe(e);this.Ws.Bs()}rM(t){this.Yb="function"==typeof t?t(this.Yb):t;const e=this.Yb;for(let t=0;t<this._b.length;t+=1)this._b[t]._u(e);this.Ws.Bs()}hM(){return this.Ub}ku(){return this.Yb}nM(t){this.iM="function"==typeof t?t(this.iM):t;const e=this.iM;for(let t=0;t<this.Ib.length;t+=1)this.Ib[t].cr(e);this.Ws.Bs()}oM(t){this.sM="function"==typeof t?t(this.sM):t;const e=this.sM;for(let t=0;t<this.Lb.length;t+=1)this.Lb[t].cr(e);this.Ws.Bs()}aM(){return this.iM}lM(){return this.sM}rr(t,e){t.Ii(e),this.uM(e),this.Ws.Bs()}uM(t){for(let e=0;e<this.Ib.length;e+=1)this.Ib[e].Ii(t);for(let e=0;e<this.Lb.length;e+=1)this.Lb[e].Ii(t)}cp(){if(super.cp(),this.Pb=!1,this.Fb>0){const t=this.Xb();this.Zb(this._b,this.Tb,this.Fb,t),this.Ib.length>0&&this.Zb(this.Ib,this.Tb,this.Fb,t),this.Lb.length>0&&this.Zb(this.Lb,this.Tb,this.Fb,t),this.Pb=!0}}ir(){if(super.ir(),this.fc.length>0&&(this.Jb(this.fc),this.cM(this.kb,this.Cb),this.Pb=!0),this.Pb){const t=this.getBoundaries();for(const e of this._b)e.Ti(t);for(const e of this.Ib)e.Ti(t);for(const e of this.Lb)e.Ti(t)}}dp(){super.dp(),this.Nb=void 0,this.fc.length=0,this.kb.length=0,this.Cb.length=0}}class iu extends eu{constructor(t,e,i,s,r,n,o,a,h,l,c){super(t,e,i,s,r,n,o,a,h,l),this.D=new vt,this.chart.pi.La(Hn.Po);const u=c;this.Ub=ze(this.bi.areaRangeSeriesFillStyle,u),this.iM=ze(this.bi.areaRangeSeriesStrokeStyle,u),this.Yb=ze(this.bi.areaRangeSeriesFillStyleInverted,u),this.sM=ze(this.bi.areaRangeSeriesStrokeStyleInverted,u)}solveNearest(t,e=this.chart.getCursorMode()||"show-nearest"){const i=this.chart.pi.il(t),s=((t,e,i)=>{let s,r,n=Number.MAX_VALUE;for(let o=0;o<e.length;o+=1){const a=e[o],h=i(a,t);if(h){const e=yi(t,h[0]),i=yi(t,h[1]);(void 0===s||e<n||i<n)&&(s=h,r=a,e<n?n=e:i<n&&(n=i))}}return s&&r?[s,r]:void 0})({x:i.engineX,y:i.engineY},this._b,Kf(e)?this.Db:this.Bb);if(void 0!==s&&void 0!==s[0]){const t=tt(s[0][0],this.Ws.pi.ai,this.scale),e=tt(s[0][1],this.Ws.pi.ai,this.scale);return{cursorPosition:{resultTable:t,resultTableScale:this.scale,pointMarker:t,pointMarkerScale:{x:this.axisX,y:this.axisY}},...t,series:this,axisX:this.axisX,axisY:this.axisY,multiHit:[t,e]}}}add(t){const e=Array.isArray(t)?t:[t],[i,s]=f(e);this.Hb(t,i,s);const r=this.fc[this.fc.length-1];return this.dM=r?{position:r.position,high:r.high,low:r.low}:void 0,this.D.R("dataadd",{data:e,boundaries:this.Nb}),this}addArraysHighLow(t,e,i=1,s=0){if(t.length!==e.length)throw new Error("arrayHigh and arrayLow lengths are not equal");{let r=s;r||(r=this.dM?this.dM.position+i:0),this.add(((t,e,i=1,s)=>{const r=void 0!==s?s:0,n=new Array(t.length);for(let s=0;s<t.length;s+=1)n[s]={position:r+i*s,high:t[s],low:e[s]};return n})(t,e,i,r))}return this}cM(t,e){this.Kb(t,e)}setHighFillStyle(t){return this.eM(t),this}setLowFillStyle(t){return this.rM(t),this}setHighStrokeStyle(t){return this.nM(t),this}setLowStrokeStyle(t){return this.oM(t),this}getHighFillStyle(){return this.hM()}getLowFillStyle(){return this.ku()}getHighStrokeStyle(){return this.aM()}getLowStrokeStyle(){return this.lM()}fM(){return((t,e=t=>t)=>{const i=[];let s;for(let r=0;r<t.length;r+=1){s=t[r];const n=e(s.Mu()),o=s.wu(),a=o?e(o):[];let h=!1,l=!1;"Iu"in s&&(h=s.Iu(),l=s.Pu()),i.push.apply(i,n.slice(h?1:0,n.length-(l&&0===a.length?1:0))),i.push.apply(i,a.slice(h&&0===n.length?1:0,a.length-(l?1:0)))}return i})(this._b,t=>{const e=t[0],i=t[1];if(!e||!i)return[];const s=[],r=e.length;for(let t=0;t<r;t+=1)s[t]={position:e[t].x,high:e[t].y,low:i[t].y};return s})}er(){return{fill:this.Ub,fill2:this.Yb,behavior:{colorStep:!0}}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class su extends Cc{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this.AM=t=>t[4]>=t[1],this.GS=g(c(ni,ni),c(oi,oi)),this.gM=[],this.pM=!1,this.vM=-1,this.yM=[],this.mM=!0,this.xM=!1,this.SM=4,this.bM=[1e-7,1e-6,1e-5,1e-4,.001,.01,.1,1,5,10,30,60,300,600,1800,3600,7200,14400,28800,36e3,43200,50400,57600,64800,72e3,86400,172800,259200,345600,432e3,604800,1209600,2592e3,7776e3,10368e3,15552e3,31536e3,15768e4,31536e4,63072e4,7884e5,15768e5,31536e5,3942e6,47304e5,63072e5,7884e6,15768e6,31536e6,3942e7,47304e6,63072e6,7884e7,15768e7,31536e7,63072e7,7884e8,15768e8,31536e8,47304e8,63072e8],this.D=new vt,this.chart.pi.La(Hn.bo)}yp(){return this.yM.length>0}ws(){return"ProgressiveX"}fM(){return this.yM}xp(){return this.rp&&this.yM.length>0&&this.getVisible()}MM(t){if(!(this.yM.length<1))return[this.yM[t][0],this.yM[t][1],this.yM[t][2],this.yM[t][3],this.yM[t][4]]}solveNearest(t,e){if(0===this.yM.length)return;const i=this.chart.translateCoordinate(t,{x:this.axisX,y:this.axisY}).x,s=void 0!==this.getPackDataState();let r,n,o,a,h;if(s){const t=this.wM;if(!t)return;const e=He(i,t.length-1,e=>t[e][0]),s=void 0!==e&&t[e];if(!s)return;a=s[3],o=s[2],n=s[1],h=s[4],r=s[0]}else{const t=He(i,this.yM.length-1,t=>this.yM[t][0]),e=void 0!==t&&this.yM[t];if(!e)return;r=e[0],n=e[1],o=e[2],a=e[3],h=e[4]}return{cursorPosition:{resultTable:l(r,h),resultTableScale:this.scale,pointMarker:l(r,h),pointMarkerScale:{x:this.axisX,y:this.axisY}},x:r,y:h,open:n,high:o,low:a,close:h,position:r,isPacked:s,series:this,axisX:this.axisX,axisY:this.axisY}}Qi(t,e,i){return Je({series:this,axisX:this.axisX,axisY:this.axisY},{cursorPosition:0,x:0,y:0,multiHit:0,open:0,high:0,low:0,close:0,position:0,isPacked:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}BS(t){if(!(t.x instanceof H))throw new Error("OHLCSeries must be attached to a Linear X Axis.");this._M=t.x}gn(){return l(5,5)}Pb(t){const e=t.length-1;if(e<0)return this;for(let i=0;i<=e;i+=1)t[i][3]<this.GS.min.y&&(this.GS.min.y=t[i][3]),this.GS.max.y<t[i][2]&&(this.GS.max.y=t[i][2]);return this.GS.min.x=Math.min(this.GS.min.x,t[0][0]),this.GS.max.x=Math.max(this.GS.max.x,t[e][0]),this}RS(){return this.GS.max.x}OS(){return this.GS.min.x}zS(){return this.GS.max.y}VS(){return this.GS.min.y}add(t){this.yM.length>0&&this.chart.pi.La(Hn.Ro);const e=Array.isArray(t[0])?t:[t[0]];if(e.length>0){this.pM=!0;const t=this.yM.length,i=this.gM.length,s=e.length;this.yM.length=t+s,this.gM.length=i+s;for(let r=0;r<s;r+=1)this.yM[t+r]=e[r],this.gM[i+r]=this.yM[t+r];this.Pb(e),this.D.R("dataadd",{data:e}),this.Ws.Bs()}return this}setPackData(t){return t!==this.mM&&(this.xM=!0,this.mM=t,this.chart.pi.Bs()),this}getPackData(){return this.mM}getPackDataState(){const t=this.vM;if(!(t<0||void 0===this.wM||this.wM.length===this.yM.length))return{figureAxisInterval:t}}setFigureWidth(t){return this.kM=t,this.chart.pi.Bs(),this}getFigureWidth(){return this.kM}setFigureMinimumGap(t){return this.SM=t,this.chart.pi.Bs(),this}getFigureMinimumGap(){return this.SM}clear(){return this.yM=[],this.gM=[],this.wM=void 0,this.CM(),this.GS.min.x=ni,this.GS.min.y=ni,this.GS.max.x=oi,this.GS.max.y=oi,this.D.R("dataclear",{}),this}TM(t){return this._M.getPixelSize()*t/1e3}FM(){const t=this.bM.length-1,e=this.TM(this.kM+this.SM);let i=He(e,t,t=>this.bM[t]);return void 0===i?i=e<this.bM[0]?0:this.bM[t]<e?t:this.bM.length/2:this.bM[i]<e&&(i+=1),this.bM.length<=i&&(i=t),1e3*this.bM[i]}ir(){if(super.ir(),!this.mM){this.wM=void 0;let t=null;if(this.xM?(this.xM=!1,t=this.yM,this.CM()):t=this.gM,t.length>=1){for(let e=0;e<t.length;e+=1){const i=t[e],s=i[0];this.AM(i)?this.IM(s,i):this.LM(s,i)}this.gM.length=0,this.pM=!1,this.vM=-1}}}dp(){super.dp();const t=this.FM();if(this.mM&&this.yM.length>=1&&(t!==this.vM||this.pM||this.xM)){this.xM=!1,this.vM=t,this.pM=!1,this.CM(),this.wM=[];const e=this.yM.length;let i=this.yM[0][0]-this.yM[0][0]%(t/2)+t,s=0;for(;s<e;){let r=this.MM(s);if(void 0===r)break;let n=r[3],o=r[2];const a=s;for(s+=1;s<e&&this.yM[s][0]<i;)r=this.yM[s],this.yM[s][3]<n&&(n=this.yM[s][3]),o<this.yM[s][2]&&(o=this.yM[s][2]),s+=1;const h=s-1;let l=r[0];a<h&&(l=this.yM[h][0],r=[l,this.yM[a][1],o,n,this.yM[h][4]]),r[1]<r[4]?this.IM(l,r):this.LM(l,r),this.wM.push(r),i+=t}}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class ru extends su{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this.PM=1175494351e-14,this.kM=this.bi.ohlcCandleThicknessPixels||5,this.BM=this.bi.ohlcCandleTailStrokeStylePositive,this.DM=this.bi.ohlcCandleTailStrokeStyleNegative,this.EM=this.bi.ohlcCandleBodyFillStylePositive,this.RM=this.bi.ohlcCandleBodyFillStyleNegative,this.OM=i.bA(this.scale).cr(new lr({thickness:this.kM,fillStyle:this.EM})),this.OM.cc={x:0,y:1},this.zM=i.bA(this.scale).cr(new lr({thickness:this.kM,fillStyle:this.RM})),this.zM.cc={x:0,y:-1},this.VM=i.bA(this.scale).cr(this.BM),this.NM=i.bA(this.scale).cr(this.DM),this._s(this.OM),this._s(this.zM),this._s(this.VM),this._s(this.NM)}setBodyThickness(t){return this.kM=t,this.OM.cr(new lr({thickness:this.kM,fillStyle:this.EM})),this.zM.cr(new lr({thickness:this.kM,fillStyle:this.RM})),this.chart.pi.Bs(),this}getBodyThickness(){return this.kM}setBodyFillStylePositive(t){return this.EM="function"==typeof t?t(this.EM):t,this.OM.cr(new lr({thickness:this.kM,fillStyle:this.EM})),this.chart.pi.Bs(),this}getBodyFillStylePositive(){return this.EM}setBodyFillStyleNegative(t){return this.RM="function"==typeof t?t(this.RM):t,this.zM.cr(new lr({thickness:this.kM,fillStyle:this.RM})),this.chart.pi.Bs(),this}getBodyFillStyleNegative(){return this.RM}setTailStrokeStylePositive(t){return this.BM="function"==typeof t?t(this.BM):t,this.VM.cr(this.BM),this.chart.pi.Bs(),this}getTailStrokeStylePositive(){return this.BM}setTailStrokeStyleNegative(t){return this.DM="function"==typeof t?t(this.DM):t,this.NM.cr(this.DM),this.chart.pi.Bs(),this}getTailStrokeStyleNegative(){return this.DM}er(){return{fill:this.EM,fill2:this.RM,behavior:{colorStep:!0}}}CM(){return this.VM.Vi(),this.NM.Vi(),this.OM.Vi(),this.zM.Vi(),this}IM(t,e){return Math.abs(e[1]-e[4])<this.PM?this.OM.Ho().wA({x:t,y:e[1]-this.PM},{x:t,y:e[1]+this.PM}):this.OM.Ho().wA({x:t,y:e[1]},{x:t,y:e[4]}),e[4]<e[2]&&this.VM.Ho().wA({x:t,y:e[4]},{x:t,y:e[2]}),e[3]<e[1]&&this.VM.Ho().wA({x:t,y:e[3]},{x:t,y:e[1]}),this}LM(t,e){return Math.abs(e[1]-e[4])<this.PM?this.zM.Ho().wA({x:t,y:e[1]-this.PM},{x:t,y:e[1]+this.PM}):this.zM.Ho().wA({x:t,y:e[1]},{x:t,y:e[4]}),e[3]<e[4]&&this.NM.Ho().wA({x:t,y:e[3]},{x:t,y:e[4]}),e[1]<e[2]&&this.NM.Ho().wA({x:t,y:e[1]},{x:t,y:e[2]}),this}}class nu extends su{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this.kM=this.bi.ohlcBarThicknessPixels||10,this.GM=this.bi.ohlcBarStrokeStylePositive,this.$M=this.bi.ohlcBarStrokeStyleNegative,this.UM=i.bA(this.scale).cr(this.GM),this._s(this.UM),this.YM=i.bA(this.scale).cr(this.GM),this.YM.cc={x:-this.kM/2,y:0},this._s(this.YM),this.jM=i.bA(this.scale).cr(this.GM),this.jM.cc={x:this.kM/2,y:0},this._s(this.jM),this.HM=i.bA(this.scale).cr(this.$M),this._s(this.HM),this.WM=i.bA(this.scale).cr(this.$M),this.WM.cc={x:-this.kM/2,y:0},this._s(this.WM),this.XM=i.bA(this.scale).cr(this.$M),this.XM.cc={x:this.kM/2,y:0},this._s(this.XM)}setStrokeStylePositive(t){return this.GM="function"==typeof t?t(this.GM):t,this.UM.cr(this.GM),this.YM.cr(this.GM),this.jM.cr(this.GM),this.chart.pi.Bs(),this}getStrokeStylePositive(){return this.GM}setStrokeStyleNegative(t){return this.$M="function"==typeof t?t(this.$M):t,this.HM.cr(this.$M),this.WM.cr(this.$M),this.XM.cr(this.$M),this.chart.pi.Bs(),this}getStrokeStyleNegative(){return this.$M}er(){return{fill:this.GM.getFillStyle(),fill2:this.$M.getFillStyle(),behavior:{colorStep:!0}}}setFigureWidth(t){return super.setFigureWidth(t),this.YM.cc={x:-t/2,y:0},this.WM.cc={x:-t/2,y:0},this.jM.cc={x:t/2,y:0},this.XM.cc={x:t/2,y:0},this}CM(){return this.HM.Vi(),this.UM.Vi(),this.WM.Vi(),this.YM.Vi(),this.XM.Vi(),this.jM.Vi(),this}IM(t,e){return this.UM.Ho().wA({x:t,y:e[3]},{x:t,y:e[2]}),this.YM.Ho().wA({x:t,y:e[1]},{x:t,y:e[1]}),this.jM.Ho().wA({x:t,y:e[4]},{x:t,y:e[4]}),this}LM(t,e){return this.HM.Ho().wA({x:t,y:e[3]},{x:t,y:e[2]}),this.WM.Ho().wA({x:t,y:e[1]},{x:t,y:e[1]}),this.XM.Ho().wA({x:t,y:e[4]},{x:t,y:e[4]}),this}}const ou={Candlesticks:ru,Bars:nu},au=t=>({defaultDragMouseStyle:e.MouseStyles.Horizontal,getTitleTextRotation:()=>0,...Jh(t,(t,e)=>t.OS(e),(t,e)=>t.RS(e),t=>t.gn().x)}),hu=t=>({defaultDragMouseStyle:e.MouseStyles.Vertical,getTitleTextRotation:t=>90*t,...Jh(t,(t,e)=>t.VS(e),(t,e)=>t.zS(e),t=>t.gn().y)});class lu extends El{constructor(t,e,i,s,r,n,o,a){super(t,e,i,s,r,a),this.ZM=!1,this.JM=!1,this.QM=!1,this.KM=!1,this.qM=!1,this.tw=new Map,this.iw=new Map,this.sw=[],this.ew=[],this.rw=!0,this.hw=!0,this.nw=!1,this.ow=[],this.aw=new Set,this.lw=!1,this.Qy=r,this.uw=n,this.cw=o,this.dw=a.cursorGridStrokeStyleX,this.fw=a.cursorGridStrokeStyleY}setKeepWithinAxisBoundaries(t){return this.ZM=t,this.Ws.Bs(),this}getKeepWithinAxisBoundaries(){return this.ZM}dispose(){return super.dispose(),this.tw.forEach(t=>t.forEach(t=>t.dispose())),this.iw.forEach(t=>t.forEach(t=>t.dispose())),this.sw.length=0,this.ew.length=0,this.Xy.length=0,this}ir(){return this.nw&&this.di&&this.setPosition(...this.ow),this.tw.forEach(t=>{t.forEach(t=>t.setVisible(!1).setMarkerVisible(!1))}),this.iw.forEach(t=>{t.forEach(t=>t.setVisible(!1).setMarkerVisible(!1))}),this.sw.forEach(t=>t.setVisible(this.di&&this.Cg).setMarkerVisible(this.di&&this.Cg&&this.rw)),this.ew.forEach(t=>t.setVisible(this.di&&this.Cg).setMarkerVisible(this.di&&this.Cg&&this.hw)),super.ir()}im(){if(!this.ZM)return super.im();const t=this.Ky,i=t.getPosition(l(-1,-1),e.UISpace.PaddedBackground),s=t.getPosition(l(1,1),e.UISpace.PaddedBackground),r=this.ow.map(e=>{const r=e.pointMarkerScale.x,n=e.pointMarkerScale.y,o=tt({x:r.ai.$,y:n.ai.$},{x:r,y:n},t.scale),a=tt({x:r.ai.U,y:n.ai.U},{x:r,y:n},t.scale),h={x:$t(i.x,o.x,a.x),y:$t(i.y,o.y,a.y)},l={x:$t(s.x,o.x,a.x),y:$t(s.y,o.y,a.y)};return{axisX:r,axisY:n,a:o,b:a,visibleArea:Math.abs(l.x-h.x)*Math.abs(l.y-h.y),clampMin:h,clampMax:l,tableMin:i,tableMax:s}});r.sort((t,e)=>e.visibleArea-t.visibleArea);const n=r[0];if(!n)return super.im();const o=mi(n.tableMin.x,n.a.x,n.b.x)&&mi(n.tableMax.x,n.a.x,n.b.x),a=mi(n.tableMin.y,n.a.y,n.b.y)&&mi(n.tableMax.y,n.a.y,n.b.y);return{x:!o,y:!a,either:!o||!a,resultTableViewport:{x:n.axisX,y:n.axisY},resultTableViewportBounds:{x:{min:Math.min(n.axisX.ai.$,n.axisX.ai.U),max:Math.max(n.axisX.ai.$,n.axisX.ai.U)},y:{min:Math.min(n.axisY.ai.$,n.axisY.ai.U),max:Math.max(n.axisY.ai.$,n.axisY.ai.U)}}}}setPosition(...t){t=t.filter(t=>!Number.isNaN(t.pointMarker.x)&&!Number.isNaN(t.pointMarker.y)),this.ow=t,this.sw.length=0,this.ew.length=0;const e=this.renderingScale;if(t.length>0){const i=t[0].resultTable,s=Eh(t[0].resultTableScale,e),r=s===this.scale?i:tt(i,s,this.scale);this.Ky.setPosition(r)}this.Cg=!1,this.jy.forEach(t=>{t.targetVisible=!1});const i=new Map;t.forEach((t,s)=>{const r=t.pointMarkerScale.x,n=t.pointMarkerScale.y,o=i.get(r)||[],a=i.get(n)||[],h=!o.includes(t.pointMarker.x),c=!a.includes(t.pointMarker.y);o.push(t.pointMarker.x),a.push(t.pointMarker.y),i.set(r,o),i.set(n,a);const u=t.pointMarker,d=du(l(u.x,u.y),r,n);if(h){const t=this.Aw(r,!0);t.setValue(u.x),t.setGridStrokeLength(this.JM?d.x:1).setAllocatesAxisSpace(this.lw),this.sw.push(t)}if(c){const t=this.Aw(n,!1);t.setValue(u.y),t.setGridStrokeLength(this.QM?d.y:1).setAllocatesAxisSpace(this.lw),this.ew.push(t)}let f=this.jy[s];if(!f){const t=new ea(this.Ws,this.renderingScale,this.scale,jt,this.bi).setPointerEvents(!1).setFillStyle(this.bi.cursorPointMarkerFillStyle).setStrokeStyle(this.bi.cursorPointMarkerStrokeStyle).setSize(this.bi.cursorPointMarkerSize).setShape(this.bi.cursorPointMarkerShape);f={pointMarker:t,targetVisible:!0},this.jy.push(f),this.Xy.forEach(e=>e(t))}void 0!==t.pointMarkerShape&&f.pointMarker.setShape(t.pointMarkerShape),void 0!==t.pointMarkerSize&&f.pointMarker.setSize(t.pointMarkerSize),t.pointMarkerFillStyle&&f.pointMarker.setFillStyle(t.pointMarkerFillStyle),t.pointMarkerStrokeStyle&&f.pointMarker.setStrokeStyle(t.pointMarkerStrokeStyle);const g=Eh(t.pointMarkerScale,e),p=g===this.scale?t.pointMarker:tt(t.pointMarker,g,this.scale);f.pointMarker.setPosition(p),f.targetVisible=!0;const m=r.getInterval(),y=n.getInterval(),x=Math.min(m.start,m.end),v=Math.max(m.start,m.end),A=Math.min(y.start,y.end),S=Math.max(y.start,y.end);u.x>=x&&u.x<=v&&u.y>=A&&u.y<=S&&(this.Cg=!0)});for(const t of this.jy)t.targetVisible||(t.pointMarker.dispose(),this.jy.splice(this.jy.indexOf(t),1));return this}setTickMarkersAllocateAxisSpace(t){return this.lw=t,this.Ws.Bs(),this}getTickMarkersAllocateAxisSpace(){return this.lw}Aw(t,e){this.aw.has(t)||(t.addEventListener("dispose",()=>{var e;null===(e=i.get(t))||void 0===e||e.forEach(t=>t.dispose()),i.delete(t)}),this.aw.add(t));const i=e?this.tw:this.iw,s=e?this.sw:this.ew,r=i.get(t)||[];i.set(t,r);let n=r.find(t=>!s.includes(t));return n||(n=e?t.EA(!1,this.uw):t.EA(!1,this.cw),r.push(n),this.Kh(n,e),n.setPointerEvents(!1)),n}Kh(t,e){const i=e?this.dw:this.fw;return t.setGridStrokeStyle(i),t.setPointerEvents(!1),(e?this.rw:this.hw)?t.setMarkerVisible(!0):t.setMarkerVisible(!1),t}setGridStrokeXCut(t){return this.JM=t,this.Ws.Bs(),this}getGridStrokeXCut(){return this.JM}setGridStrokeYCut(t){return this.QM=t,this.Ws.Bs(),this}getGridStrokeYCut(){return this.QM}setGridStrokeXStyle(t){return this.dw=t instanceof Function?t(this.getGridStrokeXStyle()):t,this.tw.forEach(t=>t.forEach(t=>t.setGridStrokeStyle(this.dw))),this}getGridStrokeXStyle(){return this.dw}setGridStrokeYStyle(t){return this.fw=t instanceof Function?t(this.getGridStrokeYStyle()):t,this.iw.forEach(t=>t.forEach(t=>t.setGridStrokeStyle(this.fw))),this}getGridStrokeYStyle(){return this.fw}setTickMarkerXVisible(t){return this.rw=t,this.Ws.Bs(),this}getTickMarkerXVisible(){return this.rw}setTickMarkerYVisible(t){return this.hw=t,this.Ws.Bs(),this}getTickMarkerYVisible(){return this.hw}setTickMarkerX(t){return this.tw.forEach(e=>e.forEach(e=>e.setMarker(t))),this.uw=this.uw.addStyler(t),this.Ws.Bs(),this}setTickMarkerY(t){return this.iw.forEach(e=>e.forEach(e=>e.setMarker(t))),this.cw=this.cw.addStyler(t),this.Ws.Bs(),this}}class cu{constructor(t,e,i,s){this.dm=[],this.fm=(t,e)=>(this.dm.forEach(i=>i(t,e)),t),this.addStyler=t=>new cu(this.Qy,this.uw,this.cw,this.dm.map(t=>t).concat(t)),this.setResultTableBackground=t=>new cu(t,this.uw,this.cw,this.dm.map(t=>t)),this.Am=(t,e,i,s,r)=>this.fm(new lu(t,e,i,s,this.Qy,this.uw,this.cw,r),r),this.Qy=t,this.dm=s,this.uw=e,this.cw=i}}const uu=new cu(Ko,Da.PointableTextBox,Da.PointableTextBox,[(t,e)=>{kl(t,e),t.setTickMarkerX(t=>{t.setEffect(!0).setTextFont(e.cursorTickMarkerXTextFont).setTextFillStyle(e.cursorTickMarkerXTextFillStyle),Yn(t)&&t.setBackground(t=>t.setFillStyle(e.cursorTickMarkerXBackgroundFillStyle).setStrokeStyle(e.cursorTickMarkerXBackgroundStrokeStyle))}),t.setTickMarkerY(t=>{t.setEffect(!0).setTextFont(e.cursorTickMarkerYTextFont).setTextFillStyle(e.cursorTickMarkerYTextFillStyle),Yn(t)&&t.setBackground(t=>t.setFillStyle(e.cursorTickMarkerYBackgroundFillStyle).setStrokeStyle(e.cursorTickMarkerYBackgroundStrokeStyle))})}]),du=(t,e,i)=>{const s=e.ai,r=i.ai;let n=(t.x-s.getInnerStart())/(s.getInnerEnd()-s.getInnerStart()),o=(t.y-r.getInnerStart())/(r.getInnerEnd()-r.getInnerStart());return 1===i.Kf&&(n=1-n),1===e.Kf&&(o=1-o),l(o,n)};class fu{constructor(t,e,i,s){this.gw=!1,this.D=new vt,this.chart=i,this.pw=s,this.me=t.me,this.ke=s||hn,this.yw=Ut.document.createElement("div"),this.yw.style.position="absolute",this.yw.style.pointerEvents="none",Ut.document.body.append(this.yw);const r=()=>{const t=i.engine.container.getBoundingClientRect();this.yw.style.left=`${t.left}px`,this.yw.style.top=`${t.top}px`,this.yw.style.width=`${t.width}px`,this.yw.style.height=`${t.height}px`};r(),i.addEventListener("resize",r),this.mw(this.yw),this.xw(),this.Sw(),this.bw(),this.Mw(e),this.chart.ww().push(this)}mw(t){this._w=Ut.document.createElement("div"),this._w.style.pointerEvents="all",t.append(this._w),this.kw=Ut.document.createElement("div"),this.Cw=new Jr(this.me,this.ke,this.chart,this.kw),this.Tw=Ut.document.createElement("table"),this.Tw.style.borderSpacing="0",this._w.appendChild(this.Cw.Ee()),this._w.appendChild(this.kw),this.kw.appendChild(this.Tw)}Sw(){let t=0,e=0,i=0,s=0,r=!1;this.gw=!1,this._w.onmousedown=n=>{n=n||Ut.event,i=n.clientX,s=n.clientY,r=!0,Ut.document.onmouseup=t=>{this.gw?this._w.addEventListener("click",fe,!0):this._w.removeEventListener("click",fe,!0),r=!1,this.gw=!1,Ut.document.onmouseup=null,Ut.document.onmousemove=null},Ut.document.onmousemove=n=>{n=n||Ut.event,r&&(t=i-n.clientX,e=s-n.clientY,i=n.clientX,s=n.clientY,this.gw=!0,this._w.style.top=this._w.offsetTop-e+"px",this._w.style.left=this._w.offsetLeft-t+"px",this._w.style.removeProperty("right"),this._w.style.removeProperty("bottom"))}}}bw(){let t=0,e=0,i=0,s=0,r=!1;this._w.ontouchstart=n=>{n=n||Ut.event,i=n.touches[0].clientX,s=n.touches[0].clientY,r=!0,this._w.ontouchend=()=>{r=!1,Ut.document.ontouchend=null,Ut.document.ontouchmove=null},this._w.ontouchmove=n=>{r&&(fe(n),n=n||Ut.event,t=i-n.touches[0].clientX,e=s-n.touches[0].clientY,i=n.touches[0].clientX,s=n.touches[0].clientY,this._w.style.top=this._w.offsetTop-e+"px",this._w.style.left=this._w.offsetLeft-t+"px",this._w.style.removeProperty("right"),this._w.style.removeProperty("bottom"))}}}xw(){this._w.style.setProperty("top","10px"),this._w.style.setProperty("left","10px"),this._w.style.position="absolute",this._w.style.display="flex",this._w.style.alignItems="flex-start",this.kw.style.setProperty("display","none")}removePositionProperty(){this._w.style.removeProperty("top"),this._w.style.removeProperty("left"),this._w.style.removeProperty("bottom"),this._w.style.removeProperty("right")}setPositionProperty(t){switch(this.removePositionProperty(),t){case e.OSMPosition.BottomLeft:this._w.style.setProperty("bottom","10px"),this._w.style.setProperty("left","10px");break;case e.OSMPosition.TopLeft:this._w.style.setProperty("top","10px"),this._w.style.setProperty("left","10px");break;case e.OSMPosition.BottomRight:this._w.style.setProperty("bottom","10px"),this._w.style.setProperty("right","10px");break;case e.OSMPosition.TopRight:default:this._w.style.setProperty("top","10px"),this._w.style.setProperty("right","10px")}}Mw(t){for(let e=0;e<t.length;e+=1){const i=this.Tw.insertRow();for(let s=0;s<t[e].length;s+=1){const r=i.insertCell(),n=t[e][s];"object"!=typeof n?this.Fw(n,r):this.addCustomButton(n,r)}}}Fw(t,i){switch(t){case e.OnScreenMenuButtonType.ZoomIn:this.Iw(new Yr(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ZoomInX:this.Iw(new Zr(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ZoomInY:this.Iw(new Wr(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ZoomOut:this.Iw(new jr(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ZoomOutX:this.Iw(new Hr(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ZoomOutY:this.Iw(new $r(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ZoomToFit:this.Iw(new qr(this.me,this.chart,this.ke),i);break;case e.OnScreenMenuButtonType.ToggleAnimations:this.Iw(new Xr(this.me,this.chart,this.ke),i);break;default:console.error(`No predefined button like "${e.OnScreenMenuButtonType[t]}" exists.`)}}Iw(t,e){e.rowSpan=t.xe.rows,e.colSpan=t.xe.columns,t.De(e)}addCustomButton(t,e){const i=new Kr(this.me,t,this.chart);return this.Iw(i,e),this}dispose(){this.yw.remove(),this.D.R("dispose",{})}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class gu extends Cc{constructor(t,e,i,s,r,n,o,a,h,l,c,u){var d;super(t,e,i,s,r,n,o,a,h,l),this.Lw=t=>{this.D.R(t.type,t)},this.Pw=0,this.D=new vt,this.Da=u,this.Cc=this.Ws.zd(this.scale).cr(ze(this.bi.lineSeriesStrokeStyle,c)).Rd(ze(this.bi.pointSeriesFillStyle,c)).Yd(ze(this.bi.pointSeriesStrokeStyle,c)).Od(ze(this.bi.areaSeriesPositiveFillStyle,c)).Bw(void 0).Hd(7),this.Cc.Dw=!1!==(null===(d=this.Da)||void 0===d?void 0:d.allowDataGrouping),this._s(this.Cc)}yp(){return this.Ew().getSampleCount()>0}ws(){return this.getDataSet().Qc(this.Rw)}setDataSet(t,e){var i;const s=null===(i=this.Dd)||void 0===i?void 0:i.ts;if(t===s&&e&&this.Rw&&_o(e,this.Rw))return this;const r=["change","clear","loop","maxsamplecountexceed"];return s&&r.forEach(t=>s.removeEventListener(t,this.Lw)),t?(r.forEach(e=>t.addEventListener(e,this.Lw)),!e&&t.Uc&&(e=this.Ow(t.Uc)),e&&t.ud(e),this.Rw=e,this.zw=!1,(null==e?void 0:e.color)&&this.chart.pi.La(Hn.zo),(null==e?void 0:e.size)&&this.chart.pi.La(Hn.Oo),this.Dd=Ke(t,this.Dd,()=>({change:()=>{this.Pw+=1,this.Pw>1&&this.chart.pi.La(Hn.Ro),this.chart.pi.Bs()},clear:()=>{this.chart.pi.Bs()}})),e&&this.Cc.Ed(t,e),this.chart.pi.Bs(),this):(this.Cc.Ed(),this)}getDataSet(){return this.Ew()}setDataMapping(t){var e;return(null===(e=this.Dd)||void 0===e?void 0:e.ts)?this.setDataSet(this.getDataSet(),t):this.Rw=t,this.zw=!1,this}getDataMapping(){return this.Rw}setStrokeStyle(t){return this.Cc.cr(t),this.Ws.Bs(),this}getStrokeStyle(){return this.Cc.do()}setAreaFillStyle(t){return this.Cc.Od(t),this.Ws.Bs(),this}getAreaFillStyle(){return this.Cc.Vw()}setPointFillStyle(t){return this.Cc.Rd(t),this.Ws.Bs(),this}getPointFillStyle(){return this.Cc.Ud()}setPointStrokeStyle(t){return this.Cc.Yd(t),this.Ws.Bs(),this}getPointStrokeStyle(){return this.Cc.jd()}setPointSize(t){return this.Cc.Hd(t),this.Ws.Bs(),this}getPointSize(){return this.Cc.Nw()}setPointShape(t){return this.Cc.Vd(t),this.Ws.Bs(),this}getPointShape(){return this.Cc.Nd()}setPointRotation(t){return this.Cc.Gd(t),this.Ws.Bs(),this}getPointRotation(){return this.Cc.$d()}setPointAlignment(t){return this.Cc.YA(t),this.chart.pi.Bs(),this}getPointAlignment(){return this.Cc.Gw()}setCurvePreprocessing(t){return this.Cc.Bw(t),this.Ws.Bs(),this}getCurvePreprocessing(){return this.Cc.$w()}appendJSON(t,e,i){return this.Ew().appendJSON(t,e,i),this.Ws.pi.Bs(),this}appendSample(t,e){return this.Ew().appendSample(t,e),this.Ws.pi.Bs(),this}appendSamples(t,e){return this.Ew().appendSamples(t,e),this.Ws.pi.Bs(),this}fill(t){return this.Ew().fill(t),this.Ws.Bs(),this}setSamples(t,e){return this.Ew().setSamples(t,e),this.Ws.Bs(),this}alterSamplesStartingFrom(t,e,i){return this.Ew().alterSamplesStartingFrom(t,e,i),this.Ws.Bs(),this}alterSamplesByIndex(t,e){return this.Ew().alterSamplesByIndex(t,e),this.Ws.Bs(),this}alterSamplesByMatch(t,e,i){return this.Ew().alterSamplesByMatch(t,e,i),this.Ws.Bs(),this}getSampleCount(){return this.Ew().getSampleCount()}getNextSampleIndex(){return this.Ew().getNextSampleIndex()}setMaxSampleCount(t){return this.Ew().setMaxSampleCount(t),this.Ws.Bs(),this}getMaxSampleCount(){return this.Ew().getMaxSampleCount()}clear(){return this.Ew().clear(),this.Ws.Bs(),this}readBack(t){if(this.Rw||this.Uw(),!this.Rw)return{xValues:new Float64Array,yValues:new Float64Array,iSampleFirst:0};const e=this.Ew();if(null==t?void 0:t.onlyInRange){const i=e.Qc(this.Rw),s=i&&Ns(i);if(!s)throw new Error("LightningChart JS - attempted to use `PointLineAreaSeries.readBack` with `onlyInRange` without a data pattern.\nThis operation is only supported for progressive data");const r=this.Rw[s];return e.ld(this.Rw,{onlyInRange:{key:r,start:t.onlyInRange.start,end:t.onlyInRange.end}})}return e.ld(this.Rw)}solveNearest(t,e=this.chart.getCursorMode()||"show-nearest"){this.Rw||this.Uw();let i=Kf(e);void 0!==this.getCurvePreprocessing()&&(i=!1);const s=this.Yw(),r=bs(t)?this.chart.translateCoordinate(t,{x:this.axisX,y:this.axisY}):t,n=s.yd(this.Rw,r,i,this.scale,this.chart.eA);if(void 0!==n)return{cursorPosition:{resultTable:n,resultTableScale:this.scale,pointMarker:n,pointMarkerScale:{x:this.axisX,y:this.axisY}},...n,series:this,axisX:this.axisX,axisY:this.axisY,pointShape:this.getPointShape()}}Qi(t,e,i){const s=this.getDataSet(),r=null==t?void 0:t.dataPoint;return void 0===s.Qc(this.Rw)||r?r?{cursorPosition:{resultTable:r,resultTableScale:this.scale,pointMarker:r,pointMarkerScale:{x:this.axisX,y:this.axisY}},...r,series:this,axisX:this.axisX,axisY:this.axisY,pointShape:this.getPointShape()}:void 0:Je({series:this,axisX:this.axisX,axisY:this.axisY},{x:0,y:0,cursorPosition:0,rotation:0,size:0,color:0,lookupValue:0,multiHit:0,iSample:0,sample:0,pointShape:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}Yw(){return this.Ew()}Ys(){return Re(this.getPointFillStyle(),this.Cc._i())||Re(this.getStrokeStyle().getFillStyle(),this.Cc._i())||Re(this.getAreaFillStyle(),this.Cc._i())}xp(){var t;const e=null===(t=this.Dd)||void 0===t?void 0:t.ts;return this.getVisible()&&this.getAutoScrollingEnabled()&&void 0!==e&&e.Bc>0}BS(t){}RS(t){this.Rw||this.Uw();const e=this.Cc.hl();return e&&"y"===e.jw&&t&&e.Hw(),this.Cc.Wi(t)}OS(t){this.Rw||this.Uw();const e=this.Cc.hl();return e&&"y"===e.jw&&t&&e.Hw(),this.Cc.Hi(t)}zS(t){this.Rw||this.Uw();const e=this.Cc.hl();return e&&"x"===e.jw&&!t&&e.Hw(),this.Cc.Zi(t)}VS(t){this.Rw||this.Uw();const e=this.Cc.hl();return e&&"x"===e.jw&&t&&e.Hw(),this.Cc.Xi(t)}gn(){return{x:this.Cc.uu(),y:this.Cc.cu()}}Uw(){var t;const e=null===(t=this.Dd)||void 0===t?void 0:t.ts;if((!this.Rw||this.zw)&&e&&e.Uc){const t=e.Uc,i=this.Ww;let s=!1;if(this.Rw&&this.zw&&i){const e=Object.keys(t).length!==Object.keys(i).length,r=Object.entries(t).find(([t,e])=>{var s;return t in i&&i[t]!==(null===(s=e.$c)||void 0===s?void 0:s.effective)});s=!e&&void 0===r}if(!s){const t=this.Ow(e.Uc);!t||this.Rw&&_o(this.Rw,t)||(this.Rw=t,this.zw=!0,t.color&&this.chart.pi.La(Hn.zo),t.size&&this.chart.pi.La(Hn.Oo),this.Cc.Ed(e,t)),this.Ww=Object.fromEntries(Object.entries(e.Uc).map(([t,e])=>{var i;return[t,null===(i=e.$c)||void 0===i?void 0:i.effective]}))}}}cp(){var t,e,i,s;if(super.cp(),this.Uw(),((null===(t=this.Da)||void 0===t?void 0:t.strictMode)||(null===(e=this.Dd)||void 0===e?void 0:e.ts.Nc))&&this.Rw&&(null===(i=this.Dd)||void 0===i?void 0:i.ts)){const t=this.Dd.ts.Uc;t&&Object.values(this.Rw).forEach(e=>{if(!(e in t))throw new Error(`LightningChart JS error - PointLineAreaSeries data mapping is referencing a data property ('${e}') that doesn't exist in the connected data set. This is not allowed when strict mode is enabled.`)})}const r=Ns(null!==(s=this.ws())&&void 0!==s?s:"ProgressiveX");this.Cc.Xw("x"===r?0===this.xAxis.Qf?"bottom":"top":0===this.yAxis.Qf?"left":"right")}Ew(){var t;if(!this.Dd){const t=new Vo(this.Da);return this.setDataSet(t,!0!==this.zw?this.Rw:void 0),t}return null===(t=this.Dd)||void 0===t?void 0:t.ts}Ow(t){var e,i;if((null===(e=this.Da)||void 0===e?void 0:e.strictMode)||(null===(i=this.Dd)||void 0===i?void 0:i.ts.Nc))throw new Error("LightningChart JS error - PointLineAreaSeries data mapping is not explicitly defined. This is not allowed when strict mode is enabled.");const s=Object.entries(t),r=s.find(t=>t[0].toLowerCase().includes("x")),n=s.find(t=>t[0].toLowerCase().includes("y")),o=s.find(t=>t[0].toLowerCase().includes("size")),a=s.find(t=>t[0].toLowerCase().includes("rot")),h=s.find(t=>t[0].toLowerCase().includes("lookup")||t[0].toLowerCase().includes("value")&&!t[0].toLowerCase().includes("y")&&!t[0].toLowerCase().includes("x")),l=s.find(t=>t[0].toLowerCase().includes("color")),c={};o&&(c.size=o[0]),a&&(c.rotation=a[0]),h&&(c.lookupValue=h[0]),l&&(c.color=l[0]);const u=s.find(t=>{var e;return Boolean(null===(e=t[1].$c)||void 0===e?void 0:e.effective)}),d=(t,...e)=>{for(const i of e)if(i!==t)return i[0];for(const e of s)if(e!==t&&!Object.keys(c).includes(e[0]))return e[0]};if("xValues"in t&&"yValues"in t)return{...c,x:"xValues",y:"yValues"};if("yValues"in t){const t=d(s.find(t=>"yValues"===t[0]));if(t)return{...c,x:t,y:"yValues"}}if("xValues"in t){const t=d(s.find(t=>"xValues"===t[0]));if(t)return{...c,y:t,x:"xValues"}}if(r&&n)return{...c,x:r[0],y:n[0]};if(u){const t="x",e="y",i=d(u);if(i)return{...c,[t]:u[0],[e]:i}}return s.length>=2?{...c,x:s[0][0],y:s[1][0]}:void 0}er(){const t=this.getPointFillStyle(),e=this.getAreaFillStyle();return{stroke:this.getStrokeStyle(),fill:t!==ls?t:e,behavior:{priority:"stroke"}}}js(){return this.Es||this.getPointShape()}rr(t,e){t.Ii(e),this.Ws.Bs()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const pu={pan:!1,zoom:!1,rectangleZoom:!1,restoreDefault:!1,chartInteractions:void 0},mu=(t,e,i,s)=>{t.seriesBackground.addEventListener(e,i,s),t.getSeries().forEach(t=>t.addEventListener(e,i,s));const r=t=>t.series.addEventListener(e,i,s);return t.addEventListener("seriesadd",r),()=>{t.seriesBackground.removeEventListener(e,i),t.getSeries().forEach(t=>t.removeEventListener(e,i)),t.removeEventListener("seriesadd",r)}},yu=(t,e,i,s)=>{const r=[];t.forEachAxis(t=>{const n=e=>i(t,e);t.addEventListener(e,n,s),r.push(()=>t.removeEventListener(e,n))});const n=t=>{const n=e=>i(t.axis,e);t.axis.addEventListener(e,n,s),r.push(()=>t.axis.removeEventListener(e,n))};return t.addEventListener("axisadd",n),r.push(()=>t.removeEventListener("axisadd",n)),()=>{r.forEach(t=>t())}},xu=(t,i,s)=>{si();const r=new Map;t.forEachAxis(t=>{var e,s;const n=t.ar.chartInteractions;!1===n||"object"==typeof n&&!1===n.restoreDefault||r.set(t,{animate:null!==(e=i.animationsEnabled)&&void 0!==e?e:void 0,stopAxisAfter:null!==(s=i.stopScroll)&&void 0!==s?s:void 0})}),t.Zw(r);let n=i.cursor;if(null!==n){n=null!=n?n:e.MouseStyles.ZoomOut;const i=t.engine.setMouseStyle(n);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const o=i.on;o&&Ut.requestAnimationFrame(()=>o({event:s}))},vu=(...t)=>(e,i)=>t.forEach(t=>t.forEach(t=>{t.axis.ai.Z(e),t.axis.tA.Z(i)})),Au=l(10,10);var Su;e.AxisPosition=void 0,(Su=e.AxisPosition||(e.AxisPosition={}))[Su.Top=0]="Top",Su[Su.Bottom=1]="Bottom",Su[Su.Left=2]="Left",Su[Su.Right=3]="Right";const bu=new Set([e.AxisPosition.Top,e.AxisPosition.Bottom,e.AxisPosition.Left,e.AxisPosition.Right]),Mu=t=>t.setStopped(!0),Eu=(t,e)=>{if(!t||!e)throw new Error("LightningChart JS error | either X or Y axis didn't exist when creating a series.");const i="linear-highPrecision"===t.uh.type||"linear-highPrecision"===e.uh.type,s="logarithmic"===t.uh.type||"logarithmic"===e.uh.type;if(i&&s){const i=`Invalid Axis combination | 'logarithmic' can't be combined with 'linear-highPrecision' (x: ${t.uh.type}, y: ${e.uh.type})`;throw new Error(i)}};var ku,Tu,wu;!function(t){t[t.seriesBackground=0]="seriesBackground",t[t.gridLine0=1]="gridLine0",t[t.gridLine1=2]="gridLine1",t[t.gridLine2=3]="gridLine2",t[t.highlightersBelow=4]="highlightersBelow"}(ku||(ku={})),function(t){t[t.plotting=0]="plotting",t[t.highlightersAbove=1]="highlightersAbove",t[t.fg=2]="fg"}(Tu||(Tu={}));class Cu extends hl{constructor(t,i,s,r,n,o,a){var h,l,c,u,d;super(t,i,s,i.Hg("chartXY bg",0),r,i.pi.bi.chartXYBackgroundFillStyle,i.pi.bi.chartXYBackgroundStrokeStyle,i.pi.bi.chartXYTitleFont,i.pi.bi.chartXYTitleFillStyle,i.pi.bi.chartXYTitleShadow,a,null===(h=null==o?void 0:o.legend)||void 0===h?void 0:h.customLegend),this.Jw=this.Bg.d2({scaleXYConstructor:q}),this.IA=[],this.LA=[],this.BA=[],this.PA=[],this.Qw=new Map,this.Kw=!0,this.qw=[],this.t_=this.bi.chartXYZoomingRectangleFillStyle,this.i_=this.bi.chartXYZoomingRectangleStrokeStyle,this._A=Bu,this.PS=0,this.wm=[],this.km=()=>{if(this.ci)return;const t=new Map;this.forEachAxis(e=>{void 0!==e.gA().find(t=>t.yp())&&t.set(e,{...e.getInterval(),stopped:e.getStopped()})}),t.size<=0||(this.wm.push(t),this.wm.length>100&&this.wm.shift())},this.s_=(t,e,i)=>{const s=t.solveNearest(e,i);return s&&mi(s.cursorPosition.pointMarker.x,s.axisX.getInterval().start,s.axisX.getInterval().end)&&mi(s.cursorPosition.pointMarker.y,s.axisY.getInterval().start,s.axisY.getInterval().end)?s:void 0},this.e_=vu(this.LA,this.IA),this.r_=vu(this.BA,this.PA),this.h_=t=>{this.e_(t.engineWidth,t.engineHeight),this.r_(t.engineHeight,t.engineWidth),this.Jw.Z(t.engineWidth,t.engineHeight),this.pi.Bs()},this.n_=(t,e)=>{this.Qw.set(t,e)},this.Xf=t=>{const e=this.LA.findIndex(e=>e.axis===t),i=this.IA.findIndex(e=>e.axis===t),s=this.BA.findIndex(e=>e.axis===t),r=this.PA.findIndex(e=>e.axis===t);e>=0&&this.LA.splice(e,1),i>=0&&this.IA.splice(i,1),s>=0&&this.BA.splice(s,1),r>=0&&this.PA.splice(r,1),this.Qw.delete(t),this.pi.Bs()},this.addAreaRangeSeries=t=>{const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new iu(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length);return this.xv(s,t),s},this.D=new vt,this.pi.La(Hn.Lo),this.wn({left:null!==(l=this.bi.panelPadding)&&void 0!==l?l:7,right:null!==(c=this.bi.panelPadding)&&void 0!==c?c:7,top:null!==(u=this.bi.panelPadding)&&void 0!==u?u:7,bottom:null!==(d=this.bi.panelPadding)&&void 0!==d?d:7},!1),this.a_=i.Rm("chartXY series bg",ku.seriesBackground),this.l_=[ku.gridLine0,ku.gridLine1,ku.gridLine2].map(t=>i.u_(`chartXY gridline #${t}`,t)),this.Hf=i.u_("chartXY highlighters below",ku.highlightersBelow),this.bx=i.Om("chartXY plotting",Tu.plotting),this.Wf=i.Om("chartXY highlighters above",Tu.highlightersAbove),this.jf=i.Om("chartXY fg",Tu.fg),this.Jw.x.W(0,this.uiScale.x.getCellSize()-(this.ot.left+this.ot.right+this.Gn.left+this.Gn.right)),this.Jw.y.W(0,this.uiScale.y.getCellSize()-(this.ot.bottom+this.ot.top+this.Gn.bottom+this.Gn.top)),this.Jw.Z(this.uiScale.kt().x,this.uiScale.kt().y),this.yv=this.a_.tr(this.Jw).qe(this.bi.chartXYSeriesBackgroundFillStyle).Ke(Bt),this.mv=this.a_.tr(this.Jw).qe(ls).Ke(this.bi.chartXYSeriesBackgroundStrokeStyle).setPointerEvents(!1),super.vv(this.yv,this.mv),this.setSeriesBackgroundEffect(!1);const f=qt(o?o.cursorBuilder:void 0,uu),g=i.Ym();this.jm=ig(this,g,f.Am(g,this.Jw,this.Jw,jt,this.bi),this,"show-all",Lu,(t,e)=>{const i=this.translateCoordinate(t,{x:t.axisX,y:t.axisY},this.coordsClient);return Math.sqrt((i.clientX-e.clientX)**2+(i.clientY-e.clientY)**2)}),this.addAxisX(o&&o.defaultAxisX),this.addAxisY(o&&o.defaultAxisY),this.addEventListener("resize",this.h_),this.Yr.tn("ChartXY"),this.setAnimationsEnabled(!1!==(null==o?void 0:o.animationsEnabled)),this.jg(n,this.Jw),this.Hm=(t=>{let i={},s=!1,r=!1,n=!1;const o=()=>{var e;const s=t.getAxes().find(t=>{var e,i;return(null===(e=t.getScrollStrategy())||void 0===e?void 0:e.id)===pn||(null===(i=t.getScrollStrategy())||void 0===i?void 0:i.id)===mn}),r=t.getSeries().map(t=>t.ws()).find(t=>t),n=t.getSeries().find(t=>t instanceof gu&&!cs(t.getAreaFillStyle())&&t.ws()),o=s?{type:"scrolling",scrollingAxis:s,x:s.isX,y:s.isY}:r?{type:"progressive",x:"ProgressiveX"===r||"RegressiveX"===r,y:"ProgressiveY"===r||"RegressiveY"===r}:{type:"freeform"};if("progressive"===o.type){const t={zoom:{wheel:{},stopScroll:!0},pan:{lmb:!1,rmb:{drag:{}}},restoreDefault:{doubleClick:!0},rectangleZoom:{lmb:{drag:{}},rmb:!1}},e={pan:{lmb:!1,rmb:{drag:{}}},zoom:{wheel:{},mode:n?"keep-start":"centered"},restoreDefault:{doubleClick:!0},rectangleZoom:{lmb:{drag:{}},rmb:!1}};return Nt({rectangleZoom:{x:o.x,y:o.y,rmb:!1},pan:{x:o.x,y:o.y,pinch:{},lmb:!1,rmb:{drag:{}}},paginate:!1,zoom:{x:o.x,y:o.y,wheel:{},pinch:{},stopScroll:!0},restoreDefault:{doubleClick:!0},restorePrevious:{ctrl:{code:"KeyZ"}},xAxis:o.x?t:e,yAxis:o.y?t:e},i)}if("scrolling"===o.type){const t=((null===(e=o.scrollingAxis.Rh)||void 0===e?void 0:e.id)===mn?-1:1)*(o.scrollingAxis.getInterval().end>o.scrollingAxis.getInterval().start?1:-1)>0?"keep-end":"keep-start",s={zoom:{wheel:{},stopScroll:!1,mode:t},pan:{drag:{}},restoreDefault:{doubleClick:!0}},r={rectangleZoom:{lmb:{},rmb:!1,mmb:!1},pan:{lmb:!1,rmb:{drag:{}},mmb:!1},zoom:{drag:!1,wheel:{},mode:n?"keep-start":"centered"},restoreDefault:{doubleClick:!0}};return Nt({rectangleZoom:!1,pan:{x:o.x,y:o.y,pinch:{},drag:{}},paginate:!1,zoom:{x:o.x,y:o.y,wheel:{},pinch:{stopScroll:!0},stopScroll:!1,mode:t},restoreDefault:{doubleClick:!0},restorePrevious:!1,xAxis:o.x?s:r,yAxis:o.y?s:r},i)}return Nt({pan:{x:!0,y:!0,pinch:{},lmb:!1,rmb:{drag:{}}},zoom:{x:!0,y:!0,pinch:{},wheel:{},mode:"toward-pointer"},rectangleZoom:{x:!0,y:!0,lmb:!0,rmb:!1},restoreDefault:{doubleClick:!0},restorePrevious:{ctrl:{code:"KeyZ"}},axes:{pan:{rmb:{drag:{}},lmb:!1},rectangleZoom:{lmb:{drag:{}},rmb:!1},zoom:{wheel:{}},restoreDefault:{doubleClick:!0}}},i)},a=t=>{const e=o(),i=t.getUserInteractions();let s=t.isX?e.xAxis:e.yAxis,r=e.axes;return s=!1!==s?s:pu,r=!1!==r?r:pu,Nt(null!=r?r:{},null!=s?s:{},i)},h=t=>{},l=i=>{if(!t.axisX||!t.axisY)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.pan,"drag",i,s,r,n);l&&a.push(()=>((t,i,s,r)=>{let n;const o=t.getCursorMode();let a=!1,h=i;"mouse"===i.pointerType&&i.preventDefault();const l=r=>{if(r.pointerId!==i.pointerId)return;const o=r.clientX-h.clientX,l=r.clientY-h.clientY;if(h=r,!a){if(!("mouse"===r.pointerType||Math.max(Math.abs(r.clientX-i.clientX),Math.abs(r.clientY-i.clientY))>=10))return;{a=!0;let i=s.cursor;null!==i&&(i=null!=i?i:!1===s.x?e.MouseStyles.Vertical:!1===s.y?e.MouseStyles.Horizontal:e.MouseStyles.Move,n=t.engine.setMouseStyle(i)),t.setCursorMode(void 0),ii()}}fe(r),s.x&&t.forEachAxisX(t=>{var e;const i=t.ar.chartInteractions;!1===i||"object"==typeof i&&!1===i.pan||(!1!==s.stopScroll&&t.setStopped(!0),t.pan(-o*(null!==(e=s.sensitivity)&&void 0!==e?e:1)))}),s.y&&t.forEachAxisY(t=>{var e;const i=t.ar.chartInteractions;!1===i||"object"==typeof i&&!1===i.pan||(!1!==s.stopScroll&&t.setStopped(!0),t.pan(l*(null!==(e=s.sensitivity)&&void 0!==e?e:1)))});const c=s.on;c&&Ut.requestAnimationFrame(()=>c({event:r}))},c=e=>{e.pointerId===i.pointerId&&(Ut.removeEventListener("pointermove",l),Ut.removeEventListener("pointerup",c),t.engine.container.removeEventListener("pointerdown",u),n=t.engine.restoreMouseStyle(n),r(),t.setCursorMode(o),a&&(ei("click"),ei("contextmenu")))},u=e=>{e.pointerId!==i.pointerId&&(Ut.removeEventListener("pointermove",l),Ut.removeEventListener("pointerup",c),t.engine.container.removeEventListener("pointerdown",u),n=t.engine.restoreMouseStyle(n),r(),t.setCursorMode(o))};Ut.addEventListener("pointermove",l),Ut.addEventListener("pointerup",c),t.engine.container.addEventListener("pointerdown",u),si()})(t,i,l,g()));const c=Ts(h.zoom,"drag",i,s,r,n);c&&a.push(()=>((t,i,s,r)=>{let n;const o=s.cursor;if(null!==o){let i="function"==typeof o?o("in"):o;null!==i&&(i=null!=i?i:e.MouseStyles.ZoomIn,n=t.engine.setMouseStyle(i))}const a=t.getCursorMode();t.setCursorMode(void 0);let h=!1,l=i;"mouse"===i.pointerType&&i.preventDefault();const c=r=>{if(r.pointerId!==i.pointerId)return;fe(r);const a={x:r.clientX-l.clientX,y:r.clientY-l.clientY};l=r,s.x&&t.forEachAxisX(r=>{var h;const l=r.ar.chartInteractions;if(!1===l||"object"==typeof l&&!1===l.zoom)return;let c;c="keep-start"===s.mode?r.getInterval().start:"keep-end"===s.mode?r.getInterval().end:"centered"===s.mode?r.ai.Et((r.ai.bt()+r.ai.Mt())/2):t.translateCoordinate(i,{x:r,y:r}).x;const u=.05*r.oh.getWidth({x:-a.x,y:a.y})*(null!==(h=s.sensitivity)&&void 0!==h?h:1);if(r.zoom(c,u),!1!==s.stopScroll&&r.setStopped(!0),null!==o){let i="function"==typeof o?o(u<0?"in":"out"):o;null!==i&&(i=null!=i?i:u<0?e.MouseStyles.ZoomIn:e.MouseStyles.ZoomOut,n=t.engine.setMouseStyle(i,n))}}),s.y&&t.forEachAxisY(r=>{var h;const l=r.ar.chartInteractions;if(!1===l||"object"==typeof l&&!1===l.zoom)return;let c;c="keep-start"===s.mode?r.getInterval().start:"keep-end"===s.mode?r.getInterval().end:"centered"===s.mode?r.ai.Et((r.ai.bt()+r.ai.Mt())/2):t.translateCoordinate(i,{x:r,y:r}).y;const u=.05*r.oh.getWidth({x:-a.x,y:a.y})*(null!==(h=s.sensitivity)&&void 0!==h?h:1);if(r.zoom(c,u),!1!==s.stopScroll&&r.setStopped(!0),null!==o){let i="function"==typeof o?o(u<0?"in":"out"):o;null!==i&&(i=null!=i?i:u<0?e.MouseStyles.ZoomIn:e.MouseStyles.ZoomOut,n=t.engine.setMouseStyle(i,n))}}),h||(ii(),h=!0);const c=s.on;c&&Ut.requestAnimationFrame(()=>c({event:r}))},u=e=>{e.pointerId===i.pointerId&&(Ut.removeEventListener("pointermove",c),Ut.removeEventListener("pointerup",u),t.engine.container.removeEventListener("pointerdown",d),n=t.engine.restoreMouseStyle(n),r(),t.setCursorMode(a))},d=e=>{e.pointerId!==i.pointerId&&(Ut.removeEventListener("pointermove",c),Ut.removeEventListener("pointerup",u),t.engine.container.removeEventListener("pointerdown",d),n=t.engine.restoreMouseStyle(n),r(),t.setCursorMode(a))};Ut.addEventListener("pointermove",c),Ut.addEventListener("pointerup",u),t.engine.container.addEventListener("pointerdown",d),si()})(t,i,c,g()));const u=Ts(h.rectangleZoom,void 0,i,s,r,n);u&&a.push(()=>((t,i,s,r)=>{let n;const o=t.getCursorMode(),a=t.addRectangleSeries({legend:null}).setDrawOrder({seriesDrawOrderIndex:1e3}).setPointerEvents(!1).setCursorEnabled(!1).setAutoScrollingEnabled(!1).setClipping(!1),h=a.add({x1:0,x2:0,y1:0,y2:0});let l=!1,c=!1;"mouse"===i.pointerType&&i.preventDefault();const u=r=>{if(r.pointerId!==i.pointerId)return;fe(r),s.x&&t.forEachAxisX(t=>{const e=t.ar.chartInteractions;!1===e||"object"==typeof e&&!1===e.rectangleZoom||t.setStopped(!0)}),s.y&&t.forEachAxisY(t=>{const e=t.ar.chartInteractions;!1===e||"object"==typeof e&&!1===e.rectangleZoom||t.setStopped(!0)});const a=t.translateCoordinate(i,t.coordsAxis),u=t.translateCoordinate(r,t.coordsAxis),d=tt({x:0,y:0},t.Jw,t.coordsAxis),f=tt({x:t.Jw.x.getInnerEnd(),y:t.Jw.y.getInnerEnd()},t.Jw,t.coordsAxis);!1===s.x?h.setDimensions({y1:a.y,x1:d.x,y2:u.y,x2:f.x}):!1===s.y?h.setDimensions({x1:a.x,y1:d.y,x2:u.x,y2:f.y}):h.setDimensions({x1:a.x,y1:a.y,x2:u.x,y2:u.y});const g=yi({x:r.clientX,y:r.clientY},{x:s.x?i.clientX:r.clientX,y:s.y?i.clientY:r.clientY})>=20,p=mi(u.x,d.x,f.x)&&mi(u.y,d.y,f.y);if(h.setFillStyle(g&&p?t.getZoomingRectangleFillStyle():ls).setStrokeStyle(g&&p?t.getZoomingRectangleStrokeStyle():Bt),l||(ii(),l=!0),t.setCursorMode(g?void 0:o),g){let i=s.cursor;if(null!==i&&(i=null!=i?i:e.MouseStyles.ZoomIn,n=t.engine.setMouseStyle(i,n)),!c){const t=s.start;t&&t({event:r})}}else n=t.engine.restoreMouseStyle(n);c=g},d=e=>{if(e.pointerId!==i.pointerId)return;const h=yi({x:e.clientX,y:e.clientY},{x:s.x?i.clientX:e.clientX,y:s.y?i.clientY:e.clientY})>=20,l=t.translateCoordinate(e,t.coordsAxis),c=tt({x:0,y:0},t.Jw,t.coordsAxis),g=tt({x:t.Jw.x.getInnerEnd(),y:t.Jw.y.getInnerEnd()},t.Jw,t.coordsAxis),p=mi(l.x,c.x,g.x)&&mi(l.y,c.y,g.y);h&&p&&t.forEachAxis(r=>{var n,o;if(r.isX&&!s.x)return;if(r.isY&&!s.y)return;const a=r.ar.chartInteractions;if(!1===a||"object"==typeof a&&!1===a.rectangleZoom)return;const h=t.translateCoordinate(i,{x:r,y:r}),l=t.translateCoordinate(e,{x:r,y:r}),c=r.oh.getWidth(h),u=r.oh.getWidth(l),d=Math.sign(u-c),f=Math.sign(r.getInterval().end-r.getInterval().start),g=d===f?c:u,p=d===f?u:c;r.li(g,p,null!==(n=s.animationsEnabled)&&void 0!==n?n:void 0,null!==(o=s.stopScroll)&&void 0!==o?o:void 0,"interactionSetInterval")}),h&&(ei("click"),ei("contextmenu")),t.setCursorMode(o),a.dispose(),Ut.removeEventListener("pointermove",u),Ut.removeEventListener("pointerup",d),t.engine.container.removeEventListener("pointerdown",f),n=t.engine.restoreMouseStyle(n),r();const m=h&&p&&s.on;m&&Ut.requestAnimationFrame(()=>m({event:e}))},f=e=>{e.pointerId!==i.pointerId&&(t.setCursorMode(o),a.dispose(),Ut.removeEventListener("pointermove",u),Ut.removeEventListener("pointerup",d),t.engine.container.removeEventListener("pointerdown",f),n=t.engine.restoreMouseStyle(n),r())};Ut.addEventListener("pointermove",u),Ut.addEventListener("pointerup",d),t.engine.container.addEventListener("pointerdown",f),si()})(t,i,u,g())),a.end();const d=Ts(h.pan,"pinch",i,s,r,n),f=Ts(h.zoom,"pinch",i,s,r,n);(f||d)&&((t,e,i,s,r)=>{if(!i&&!s)return;const n=a=>{if(a.pointerId===e.pointerId)return;const h=r();let l;t.engine.container.removeEventListener("pointerdown",n),Ut.removeEventListener("pointerup",o);let c=a;const u=t.getCursorMode();t.setCursorMode(void 0);const d=r=>{var n,o,h,u;const d=l,f=c;if(r.pointerId===e.pointerId)l=r;else{if(r.pointerId!==a.pointerId)return;c=r}if(fe(r),void 0===l||void 0===d)return;const g={x:(l.clientX-d.clientX+(c.clientX-f.clientX))/2*(null!==(n=null==i?void 0:i.sensitivity)&&void 0!==n?n:1),y:(l.clientY-d.clientY+(c.clientY-f.clientY))/-2*(null!==(o=null==i?void 0:i.sensitivity)&&void 0!==o?o:1)};let p=!1;if(i&&i.x&&(p=!0,t.forEachAxisX(t=>{const e=t.ar.chartInteractions;!1===e||"object"==typeof e&&!1===e.pan||t.RA({},g)})),i&&i.y&&(p=!0,t.forEachAxisY(t=>{const e=t.ar.chartInteractions;!1===e||"object"==typeof e&&!1===e.pan||t.RA({},g)})),p){const t=null==i?void 0:i.on;t&&Ut.requestAnimationFrame(()=>t({event:r}))}const m=zi(Pi({x:Math.abs(d.clientX-f.clientX),y:Math.abs(d.clientY-f.clientY)},{x:Math.abs(l.clientX-c.clientX),y:Math.abs(l.clientY-c.clientY)}),{x:null!==(h=null==s?void 0:s.sensitivity)&&void 0!==h?h:1,y:null!==(u=null==s?void 0:s.sensitivity)&&void 0!==u?u:1});let y=!1;if(s&&s.x&&(y=!0,t.forEachAxisX(t=>{var e;const i=t.ar.chartInteractions;!1===i||"object"==typeof i&&!1===i.zoom||t.li(t.ai.Qt(t.getInterval().start,-t.oh.getWidth(m)),t.ai.Qt(t.getInterval().end,t.oh.getWidth(m)),!1,null!==(e=s.stopScroll)&&void 0!==e?e:void 0,"interactionZoom")})),s&&s.y&&(y=!0,t.forEachAxisY(t=>{var e;const i=t.ar.chartInteractions;!1===i||"object"==typeof i&&!1===i.zoom||t.li(t.ai.Qt(t.getInterval().start,-t.oh.getWidth(m)),t.ai.Qt(t.getInterval().end,t.oh.getWidth(m)),!1,null!==(e=s.stopScroll)&&void 0!==e?e:void 0,"interactionZoom")})),y){const t=null==s?void 0:s.on;t&&Ut.requestAnimationFrame(()=>t({event:r}))}},f=i=>{i.pointerId!==e.pointerId&&i.pointerId!==a.pointerId||(fe(i),t.setCursorMode(u),Ut.removeEventListener("pointermove",d),Ut.removeEventListener("pointerup",f),h())};Ut.addEventListener("pointermove",d),Ut.addEventListener("pointerup",f),si()},o=i=>{i.pointerId===e.pointerId&&(t.engine.container.removeEventListener("pointerdown",n),Ut.removeEventListener("pointerup",o))};t.engine.container.addEventListener("pointerdown",n),Ut.addEventListener("pointerup",o)})(t,i,d,f,g)};mu(t,"wheel",i=>{const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.pan,"wheel",i,s,r,n);l&&a.push(()=>((t,i,s)=>{if(fe(i),t.forEachAxisX(t=>{var e;const r=t.ar.chartInteractions;!1===r||"object"==typeof r&&!1===r.pan||s.x&&(!1!==s.stopScroll&&t.setStopped(!0),t.pan(-30*Math.sign(i.deltaY)*(null!==(e=s.sensitivity)&&void 0!==e?e:1)))}),t.forEachAxisY(t=>{var e;const r=t.ar.chartInteractions;!1===r||"object"==typeof r&&!1===r.pan||s.y&&(!1!==s.stopScroll&&t.setStopped(!0),t.pan(-30*Math.sign(i.deltaY)*(null!==(e=s.sensitivity)&&void 0!==e?e:1)))}),s.x||s.y){let r=s.cursor;if(null!==r){r=null!=r?r:!s.x&&s.y?e.MouseStyles.Vertical:s.x&&!s.y?e.MouseStyles.Horizontal:e.MouseStyles.Move;const i=t.engine.setMouseStyle(r);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const n=s.on;n&&Ut.requestAnimationFrame(()=>n({event:i}))}})(t,i,l));const c=Ts(h.zoom,"wheel",i,s,r,n);c&&a.push(()=>((t,i,s)=>{fe(i),t.forEachAxisX(e=>{var r;const n=e.ar.chartInteractions;if(!1===n||"object"==typeof n&&!1===n.zoom)return;if(!s.x)return;let o;o="keep-start"===s.mode?e.getInterval().start:"keep-end"===s.mode?e.getInterval().end:"centered"===s.mode?e.ai.Et((e.ai.bt()+e.ai.Mt())/2):t.translateCoordinate(i,{x:e,y:e}).x,e.zoom(o,Math.sign(i.deltaY)*(null!==(r=s.sensitivity)&&void 0!==r?r:1)),!1!==s.stopScroll&&e.setStopped(!0)}),t.forEachAxisY(e=>{var r;const n=e.ar.chartInteractions;if(!1===n||"object"==typeof n&&!1===n.zoom)return;if(!s.y)return;let o;o="keep-start"===s.mode?e.getInterval().start:"keep-end"===s.mode?e.getInterval().end:"centered"===s.mode?e.ai.Et((e.ai.bt()+e.ai.Mt())/2):t.translateCoordinate(i,{x:e,y:e}).y,e.zoom(o,Math.sign(i.deltaY)*(null!==(r=s.sensitivity)&&void 0!==r?r:1)),!1!==s.stopScroll&&e.setStopped(!0)});const r=s.cursor;if(null!==r){let s="function"==typeof r?r(i.deltaY<0?"in":"out"):r;if(null!==s){s=null!=s?s:i.deltaY<0?e.MouseStyles.ZoomIn:e.MouseStyles.ZoomOut;const r=t.engine.setMouseStyle(s);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(r)},500)}}const n=s.on;n&&Ut.requestAnimationFrame(()=>n({event:i}))})(t,i,c)),a.end()}),mu(t,"click",i=>{if(i.defaultPrevented)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.restoreDefault,void 0,i,s,r,n);l&&l.singleClick&&a.push(()=>{fe(i),xu(t,l,i)});const c=Ts(h.restorePrevious,void 0,i,s,r,n);c&&c.singleClick&&a.push(()=>{fe(i);const s=t.getAxes().filter(t=>{const e=t.ar.chartInteractions;return!(!1===e||"object"==typeof e&&!1===e.restorePrevious)});t.restorePreviousZoomState({whitelist:s});let r=c.cursor;if(null!==r){r=null!=r?r:e.MouseStyles.ZoomOut;const i=t.engine.setMouseStyle(r);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const n=c.on;n&&Ut.requestAnimationFrame(()=>n({event:i}))}),a.end()}),mu(t,"contextmenu",i=>{if(i.defaultPrevented)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.restoreDefault,"rmb",i,s,r,n);l&&l.singleClick&&a.push(()=>{fe(i),xu(t,l,i)});const c=Ts(h.restorePrevious,"rmb",i,s,r,n);c&&c.singleClick&&a.push(()=>{fe(i);const s=t.getAxes().filter(t=>{const e=t.ar.chartInteractions;return!(!1===e||"object"==typeof e&&!1===e.restorePrevious)});t.restorePreviousZoomState({whitelist:s});let r=c.cursor;if(null!==r){r=null!=r?r:e.MouseStyles.ZoomOut;const i=t.engine.setMouseStyle(r);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const n=c.on;n&&Ut.requestAnimationFrame(()=>n({event:i}))}),a.end()}),mu(t,"dblclick",i=>{if(i.defaultPrevented)return;const a=ws(!1!==t.pi.Da.Ea),h=o(),l=Ts(h.restoreDefault,void 0,i,s,r,n);l&&l.doubleClick&&a.push(()=>{fe(i),xu(t,l,i)});const c=Ts(h.restorePrevious,void 0,i,s,r,n);c&&c.doubleClick&&a.push(()=>{fe(i);const s=t.getAxes().filter(t=>{const e=t.ar.chartInteractions;return!(!1===e||"object"==typeof e&&!1===e.restorePrevious)});t.restorePreviousZoomState({whitelist:s});let r=c.cursor;if(null!==r){r=null!=r?r:e.MouseStyles.ZoomOut;const i=t.engine.setMouseStyle(r);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const n=c.on;n&&Ut.requestAnimationFrame(()=>n({event:i}))}),a.end()});const c=(i,o)=>{const h=ws(!1!==t.pi.Da.Ea),l=a(i),c=Ts(l.pan,"drag",o,s,r,n);c&&h.push(()=>((t,i,s,r)=>{const n=t.chart,o=n.getCursorMode();let a;n.setCursorMode(void 0);let h=s.cursor;null!==h&&(h=null!=h?h:t.isY?e.MouseStyles.Vertical:e.MouseStyles.Horizontal,a=n.engine.setMouseStyle(h));let l=!1,c=i;"mouse"===i.pointerType&&i.preventDefault();const u=e=>{var r;if(e.pointerId!==i.pointerId)return;fe(e);const n=e.clientX-c.clientX,o=e.clientY-c.clientY;c=e,!1!==s.stopScroll&&t.setStopped(!0),t.pan((t.isX?-n:o)*(null!==(r=s.sensitivity)&&void 0!==r?r:1)),l||(ii(),l=!0);const a=s.on;a&&Ut.requestAnimationFrame(()=>a({event:e}))},d=e=>{e.pointerId===i.pointerId&&(fe(e),Ut.removeEventListener("pointermove",u),Ut.removeEventListener("pointerup",d),a=t.chart.engine.restoreMouseStyle(a),r(),t.chart.setCursorMode(o))};Ut.addEventListener("pointermove",u),Ut.addEventListener("pointerup",d)})(i,o,c,g()));const u=Ts(l.zoom,"drag",o,s,r,n);u&&h.push(()=>((t,i,s,r)=>{const n=t.chart;let o;const a=s.cursor;if(null!==a){let t="function"==typeof a?a("in"):a;null!==t&&(t=null!=t?t:e.MouseStyles.ZoomIn,o=n.engine.setMouseStyle(t))}const h=n.getCursorMode();n.setCursorMode(void 0);let l=!1,c=i;"mouse"===i.pointerType&&i.preventDefault();const u=r=>{var h;if(r.pointerId!==i.pointerId)return;fe(r);const u={x:r.clientX-c.clientX,y:r.clientY-c.clientY};let d;c=r,d="keep-start"===s.mode?t.getInterval().start:"keep-end"===s.mode?t.getInterval().end:t.ai.Et((t.ai.bt()+t.ai.Mt())/2);const f=.05*t.oh.getWidth({x:-u.x,y:u.y})*(null!==(h=s.sensitivity)&&void 0!==h?h:1);if(t.zoom(d,f),!1!==s.stopScroll&&t.setStopped(!0),null!==a){let t="function"==typeof a?a("in"):a;null!==t&&(t=null!=t?t:f<0?e.MouseStyles.ZoomIn:e.MouseStyles.ZoomOut,o=n.engine.setMouseStyle(t,o))}l||(ii(),l=!0);const g=s.on;g&&Ut.requestAnimationFrame(()=>g({event:r}))},d=t=>{t.pointerId===i.pointerId&&(fe(t),Ut.removeEventListener("pointermove",u),Ut.removeEventListener("pointerup",d),o=n.engine.restoreMouseStyle(o),n.setCursorMode(h),r())};Ut.addEventListener("pointermove",u),Ut.addEventListener("pointerup",d)})(i,o,u,g()));const d=Ts(l.rectangleZoom,void 0,o,s,r,n);d&&h.push(()=>((t,i,s,r)=>{const n=t.chart,o=n.getCursorMode();let a;n.setCursorMode(void 0);let h=s.cursor;null!==h&&(h=null!=h?h:e.MouseStyles.ZoomIn,a=n.engine.setMouseStyle(h));const l=t.addBand({onTop:!0}).setPointerEvents(!1).setValueStart(t.oh.getWidth(n.translateCoordinate(i,{x:t,y:t}))).setValueEnd(t.oh.getWidth(n.translateCoordinate(i,{x:t,y:t}))).setVisible(!1).setFillStyle(n.getZoomingRectangleFillStyle()).setStrokeStyle(n.getZoomingRectangleStrokeStyle());let c=!1,u=!1;"mouse"===i.pointerType&&i.preventDefault();const d=e=>{if(e.pointerId!==i.pointerId)return;fe(e),t.setStopped(!0);const r=n.translateCoordinate(e,{x:t,y:t});l.setValueEnd(t.oh.getWidth(r));const o=yi({x:e.clientX,y:e.clientY},{x:t.isX?i.clientX:e.clientX,y:t.isY?i.clientY:e.clientY})>=20;if(l.setVisible(o),c||(ii(),c=!0),o&&!u){const t=o&&s.start;t&&t({event:e})}u=o},f=e=>{var h,c;if(e.pointerId!==i.pointerId)return;fe(e);const u=yi({x:e.clientX,y:e.clientY},{x:t.isX?i.clientX:e.clientX,y:t.isY?i.clientY:e.clientY})>=20;if(u){const r=t.oh.getWidth(n.translateCoordinate(i,{x:t,y:t})),o=t.oh.getWidth(n.translateCoordinate(e,{x:t,y:t})),a=Math.sign(o-r),l=Math.sign(t.getInterval().end-t.getInterval().start),u=a===l?r:o,d=a===l?o:r;t.li(u,d,null!==(h=s.animationsEnabled)&&void 0!==h?h:void 0,null!==(c=s.stopScroll)&&void 0!==c?c:void 0,"interactionSetInterval")}l.dispose(),Ut.removeEventListener("pointermove",d),Ut.removeEventListener("pointerup",f),a=n.engine.restoreMouseStyle(a),r(),n.setCursorMode(o);const g=u&&s.on;g&&Ut.requestAnimationFrame(()=>g({event:e}))};Ut.addEventListener("pointermove",d),Ut.addEventListener("pointerup",f)})(i,o,d,g())),h.end()};yu(t,"pointerenter",(t,e)=>{const i=a(t);t.getHighlightOnHover()&&(i.pan||i.rectangleZoom||i.restoreDefault||i.zoom)&&t.setHighlight(!0)}),yu(t,"pointerleave",(t,e)=>{t.getHighlightOnHover()&&t.setHighlight(!1)}),yu(t,"wheel",(i,o)=>{const h=ws(!1!==t.pi.Da.Ea),l=a(i),c=Ts(l.zoom,"wheel",o,s,r,n);c&&h.push(()=>((t,i,s)=>{var r;let n;fe(i),n="keep-start"===s.mode?t.getInterval().start:"keep-end"===s.mode?t.getInterval().end:"centered"===s.mode?t.ai.Et((t.ai.bt()+t.ai.Mt())/2):t.oh.getWidth(t.chart.translateCoordinate(i,{x:t,y:t})),t.zoom(n,Math.sign(i.deltaY)*(null!==(r=s.sensitivity)&&void 0!==r?r:1)),!1!==s.stopScroll&&t.setStopped(!0);const o=s.cursor;if(null!==o){let s="function"==typeof o?o(i.deltaY<0?"in":"out"):o;if(null!==s){s=null!=s?s:i.deltaY<0?e.MouseStyles.ZoomIn:e.MouseStyles.ZoomOut;const r=t.chart.engine.setMouseStyle(s);Ut.setTimeout(()=>{t.chart.engine.restoreMouseStyle(r)},500)}}const a=s.on;a&&Ut.requestAnimationFrame(()=>a({event:i}))})(i,o,c));const u=Ts(l.pan,"wheel",o,s,r,n);u&&h.push(()=>((t,i,s)=>{var r;fe(i);const n=t.chart;!1!==s.stopScroll&&t.setStopped(!0),t.pan(30*Math.sign(i.deltaY)*t.oh.getWidth({x:-1,y:1})*(null!==(r=s.sensitivity)&&void 0!==r?r:1));let o=s.cursor;if(null!==o){o=null!=o?o:t.isY?e.MouseStyles.Vertical:e.MouseStyles.Horizontal;const i=n.engine.setMouseStyle(o);Ut.setTimeout(()=>{t.chart.engine.restoreMouseStyle(i)},500)}const a=s.on;a&&Ut.requestAnimationFrame(()=>a({event:i}))})(i,o,u)),h.end()}),yu(t,"dblclick",(i,o)=>{var h,l;if(o.defaultPrevented)return;const c=a(i),u=Ts(c.restoreDefault,void 0,o,s,r,n);if(u&&u.doubleClick){fe(o),i.fit(null!==(h=u.animationsEnabled)&&void 0!==h?h:void 0,null!==(l=u.stopScroll)&&void 0!==l?l:void 0);let s=u.cursor;if(null!==s){s=null!=s?s:e.MouseStyles.ZoomOut;const i=t.engine.setMouseStyle(s);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const r=u.on;r&&Ut.requestAnimationFrame(()=>r({event:o}))}});const u=i=>{const a=o();let h=!1,l=!1,c=!1;for(const t of Object.keys(a)){const e=a[t];if("object"==typeof e)if("axes"===t||"xAxis"===t||"yAxis"===t){const t=e;if("object"!=typeof t)continue;for(const e of Object.keys(t)){const i=t[e];"object"==typeof i&&("ctrl"in i&&void 0!==i.ctrl&&(h=!0),"shift"in i&&void 0!==i.shift&&(l=!0),"alt"in i&&void 0!==i.alt&&(c=!0))}}else"ctrl"in e&&void 0!==e.ctrl&&(h=!0),"shift"in e&&void 0!==e.shift&&(l=!0),"alt"in e&&void 0!==e.alt&&(c=!0)}r=i.ctrlKey,s=i.shiftKey,n=i.altKey,("Control"===i.key&&h||"Shift"===i.key&&l||"Alt"===i.key&&c)&&i.preventDefault();const u=Ts(a.restorePrevious,void 0,i,s,r,n);if(u&&u.code===i.code){fe(i);const e=t.getAxes().filter(t=>{const e=t.ar.chartInteractions;return!(!1===e||"object"==typeof e&&!1===e.restorePrevious)});t.restorePreviousZoomState({whitelist:e});const s=u.on;s&&Ut.requestAnimationFrame(()=>s({event:i}))}const d=Ts(a.paginate,void 0,i,s,r,n);d&&((t,i,s)=>{var r,n,o,a;const h=null!==(n=null===(r=s.forward)||void 0===r?void 0:r.code)&&void 0!==n?n:"ArrowLeft",l=null!==(a=null===(o=s.backward)||void 0===o?void 0:o.code)&&void 0!==a?a:"ArrowRight",c=i.code===h?1:i.code===l?-1:0;if(0===c)return;let u=!1;if(t.forEachAxis(t=>{var e;const i=t.ar.chartInteractions;!1===i||"object"==typeof i&&!1===i.paginate||t.isX&&!s.x||t.isY&&!s.y||(u=!0,!1!==s.stopScroll&&t.setStopped(!0),t.pan(-c*(t.gh>t.Ah?1:-1)*.5*t.ai.wt()*(null!==(e=s.sensitivity)&&void 0!==e?e:1)))}),u){fe(i);let r=s.cursor;if(null!==r){r=null!=r?r:!s.x&&s.y?e.MouseStyles.Vertical:s.x&&!s.y?e.MouseStyles.Horizontal:e.MouseStyles.Move;const i=t.engine.setMouseStyle(r);Ut.setTimeout(()=>{t.engine.restoreMouseStyle(i)},500)}const n=s.on;n&&Ut.requestAnimationFrame(()=>n({event:i}))}})(t,i,d);const f=Ts(a.restoreDefault,void 0,i,s,r,n);if(f&&f.code===i.code){fe(i),t.getAxes().forEach(t=>{var e,i;const s=t.ar.chartInteractions;!1===s||"object"==typeof s&&!1===s.restoreDefault||t.fit(null!==(e=f.animationsEnabled)&&void 0!==e?e:void 0,null!==(i=f.stopScroll)&&void 0!==i?i:void 0)});const e=f.on;e&&Ut.requestAnimationFrame(()=>e({event:i}))}},d=t=>{r=t.ctrlKey,s=t.shiftKey,n=t.altKey},f=()=>{r=!1,s=!1,n=!1};Ut.addEventListener("keydown",u),Ut.addEventListener("keyup",d),Ut.addEventListener("blur",f),t.addEventListener("dispose",()=>{Ut.removeEventListener("keydown",u),Ut.removeEventListener("keyup",d),Ut.removeEventListener("blur",f)});const g=()=>(p(),m(),y(),()=>{p=mu(t,"pointermove",h),m=mu(t,"pointerdown",l),y=yu(t,"pointerdown",c)});let p=mu(t,"pointermove",h),m=mu(t,"pointerdown",l),y=yu(t,"pointerdown",c);return{setUserInteractions:t=>{if(void 0===t)i={pan:!1,zoom:!1,rectangleZoom:!1,restoreDefault:!1,restorePrevious:!1,axes:!1,xAxis:!1,yAxis:!1};else if(0===Object.keys(t).length)i={};else for(const e of Object.keys(t))!1===t[e]||"object"==typeof t[e]?i[e]=t[e]:i[e]={}},getUserInteractions:o}})(this);const p={...null==o?void 0:o.legend};this.legend.setOptions(p)}get coordsAxis(){return{x:this.getDefaultAxisX(),y:this.getDefaultAxisY()}}getSeries(){return this.fv}restorePreviousZoomState(t){if(this.wm.length<=1)return this;this.wm.pop();const e=this.wm[this.wm.length-1];return e?(this.c_=Ut.performance.now(),this.forEachAxis(i=>{if((null==t?void 0:t.whitelist)&&!t.whitelist.includes(i))return;const s=e.get(i);s?i.li(s.start,s.end,null==t?void 0:t.animate,void 0!==(null==t?void 0:t.stopAxisAfter)?t.stopAxisAfter:s.stopped,"userSetInterval"):i.fit(null==t?void 0:t.animate,null==t?void 0:t.stopAxisAfter)}),this):this}clearPreviousZoomStateHistory(){if(void 0!==this.Qm)this.wm.length=0;else for(;this.wm.length>1;)this.wm.unshift();return this}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}solveNearest(t,e=this.getCursorMode()||"show-nearest"){return this.jm.solveNearest(t,e,this.fv,this.s_)}addCursor(t=uu){const e=this.Eg(),i=t.Am(e,this.Jw,this.Jw,this.Lg(e),this.bi);return i.nw=!0,this.Ug(i),i}getMinimumSize(){var t;const e={x:0,y:0};e.x+=this.ot.left+this.ot.right+this.Gn.left+this.Gn.right,e.y+=this.ot.top+this.ot.bottom+this.Gn.top+this.Gn.bottom;const i=this.Yr.Nh().bc(),s=v(Fu(this._A||Bu,null!==(t=this.bi.chartXYTitleMargin)&&void 0!==t?t:5),this.Wg);return e.x+=i.x+s.left+s.right,e.y+=i.y+s.top+s.bottom,this.d_&&(e.x+=this.d_.left,e.x+=this.d_.right,e.y+=this.d_.top,e.y+=this.d_.bottom),e.x+=Au.x,e.y+=Au.y,e}getLayout(){const t=this.f_;return this.pi.A_()||!t?new Promise(t=>{this.addEventListener("layoutchange",t,{once:!0}),this.f_=void 0}):new Promise(e=>{e(t)})}addAxisX(t){var e,i;const{opposite:s,type:r}=Fs(t);let n;n="linear"===r.type?this.Bg.d1({dimension:"x",scale1DConstructor:H}):"linear-highPrecision"===r.type?this.Bg.d1({dimension:"x",scale1DConstructor:H}).Ot():this.Bg.d1({dimension:"x",scale1DConstructor:ji}).hs(r.base),n.Z(this.Jw.x.kt());const o=s?this.IA:this.LA,a=new Ra(this.l_,this.jf,this.Zg,this.Hf,this.Wf,this.pi.vs,n,this.Jw.y,(h=()=>a.gA(),{...za,...au(h)}),this,s?100:0,this.Xf,this.n_,this.bi,this.Er,r);var h;let l,c;return void 0===(null==t?void 0:t.iParallel)&&void 0===(null==t?void 0:t.iStack)?(l=o.reduce((t,e)=>Math.max(t,e.iParallel+1),0),c=0):(l=null!==(e=t.iParallel)&&void 0!==e?e:0,c=null!==(i=t.iStack)&&void 0!==i?i:0),o.push({axis:a,iStack:c,iParallel:l}),this.pi.Bs(),this.D.R("axisadd",{axis:a}),this.Jm(a),a}addAxisY(t){var e,i;const{opposite:s,type:r}=Fs(t);let n;n="linear"===r.type?this.Bg.d1({dimension:"y",scale1DConstructor:H}):"linear-highPrecision"===r.type?this.Bg.d1({dimension:"y",scale1DConstructor:H}).Ot():this.Bg.d1({dimension:"y",scale1DConstructor:ji}).hs(r.base),n.Z(this.Jw.y.kt());const o=s?this.PA:this.BA,a=new Ra(this.l_,this.jf,this.Zg,this.Hf,this.Wf,this.pi.vs,n,this.Jw.x,(h=()=>a.gA(),{..._a,...hu(h)}),this,s?100:0,this.Xf,this.n_,this.bi,this.Er,r);var h;let l,c;return void 0===(null==t?void 0:t.iParallel)&&void 0===(null==t?void 0:t.iStack)?(l=o.reduce((t,e)=>Math.max(t,e.iParallel+1),0),c=0):(l=null!==(e=t.iParallel)&&void 0!==e?e:0,c=null!==(i=t.iStack)&&void 0!==i?i:0),o.push({axis:a,iParallel:l,iStack:c}),this.pi.Bs(),this.D.R("axisadd",{axis:a}),this.Jm(a),a}Jm(t){const e=()=>{const e=Ut.performance.now();void 0!==this.c_&&e-this.c_<=1e3||t.getVisible()&&(this.g_=e+300)};Ut.requestAnimationFrame(()=>{e()}),t.addEventListener("intervalchange",e),t.addEventListener("dispose",()=>{this.wm.forEach(e=>{e.delete(t)})})}swapAxes(t,e){const i=[this.LA,this.BA,this.PA,this.IA],s=i.find(e=>void 0!==e.find(e=>e.axis===t)),r=i.find(t=>void 0!==t.find(t=>t.axis===e));if(!s||!r)return this;if(s!==r)throw new Error("LightningChart JS ChartXY.swapAxes does not support swapping Axes that are on different sides.");const n=s.find(e=>e.axis===t),o=s.find(t=>t.axis===e);if(!n||!o)return this;const a=n.iParallel,h=n.iStack;n.iParallel=o.iParallel,n.iStack=o.iStack,o.iParallel=a,o.iStack=h,this.f_=void 0;const l=[];this.legend.getEntries().forEach(t=>{if(t.component&&t.component instanceof Cc){const e=t.component.axisX,i=t.component.axisY,r=s.find(t=>t.axis===e||t.axis===i);r&&l.push({iStack:r.iStack,entry:t.component})}});const c=l.sort((t,e)=>e.iStack-t.iStack).map(t=>t.entry);return this.Os.forEach(t=>t.Sg(c)),this.pi.Bs(),this}dispose(){return this.jm.G(),this.a_.G(),this.bx.G(),this.jf.G(),this.l_.forEach(t=>t.G()),this.Wf.G(),this.Hf.G(),this.ww().forEach(t=>t.dispose()),Vh(this.Jw),this.LA.slice().forEach(t=>t.axis.dispose()),this.BA.slice().forEach(t=>t.axis.dispose()),this.PA.slice().forEach(t=>t.axis.dispose()),this.IA.slice().forEach(t=>t.axis.dispose()),this.fv.slice().forEach(t=>{t.dispose()}),super.dispose()}getDefaultAxisX(){var t;return null===(t=[...this.LA,...this.IA].find(t=>t.axis.getVisible()))||void 0===t?void 0:t.axis}get axisX(){return this.getDefaultAxisX()}get xAxis(){return this.getDefaultAxisX()}getDefaultAxisY(){var t;return null===(t=[...this.BA,...this.PA].find(t=>t.axis.getVisible()))||void 0===t?void 0:t.axis}get axisY(){return this.getDefaultAxisY()}get yAxis(){return this.getDefaultAxisY()}getDefaultAxes(){return[this.getDefaultAxisX(),this.getDefaultAxisY()]}getAxes(...t){const i=t&&t.length>0?new Set(t):bu;return Xt(Array.from(i).map(t=>{switch(t){default:case e.AxisPosition.Top:return this.IA.slice().sort((t,e)=>t.iStack-e.iStack).map(t=>t.axis);case e.AxisPosition.Bottom:return this.LA.slice().sort((t,e)=>t.iStack-e.iStack).map(t=>t.axis);case e.AxisPosition.Left:return this.BA.slice().sort((t,e)=>t.iStack-e.iStack).map(t=>t.axis);case e.AxisPosition.Right:return this.PA.slice().sort((t,e)=>t.iStack-e.iStack).map(t=>t.axis)}}))}p_(t){let e;return this.forEachAxisX(i=>{e=t===i?"x":e}),this.forEachAxisY(i=>{e=t===i?"y":e}),e}forEachAxisX(t){this.LA.forEach((e,i,s)=>t(e.axis,i,s.map(t=>t.axis))),this.IA.forEach((e,i,s)=>t(e.axis,i,s.map(t=>t.axis)))}forEachAxisY(t){this.BA.forEach((e,i,s)=>t(e.axis,i,s.map(t=>t.axis))),this.PA.forEach((e,i,s)=>t(e.axis,i,s.map(t=>t.axis)))}setTitlePosition(t){return this._A=t,this.Os.forEach(t=>t.zs()),this.pi.Bs(),this}getTitlePosition(){return this._A}ir(t,e=!1){var i;super.ir(t);const s=Ut.performance.now();void 0!==this.g_&&this.g_<=s&&(this.km(),this.g_=void 0);for(const t of this.fv)t.cp();for(const t of this.fv)t.ir();const r=Ue(this.fv.map(t=>t.hl())),n=new Set(r.map(t=>t.jw));if(1===n.size){const t=Array.from(n)[0],e="x"===t?[this.LA,this.IA]:[this.BA,this.PA],i="y"===t?[this.LA,this.IA]:[this.BA,this.PA];e.forEach(t=>t.forEach(t=>t.axis.pn())),i.forEach(t=>t.forEach(t=>t.axis.pn()))}else this.BA.forEach(t=>t.axis.pn()),this.LA.forEach(t=>t.axis.pn()),this.IA.forEach(t=>t.axis.pn()),this.PA.forEach(t=>t.axis.pn());let o=!1;this.forEachAxis(t=>{(t.Sn()||t.bn())&&(o=!0)});const a=!this.Kw&&o,h=new Set(this.getAxes().map(t=>t.getStackIndex())).size>1;this.jm.ir(a,h?this.fv.sort((t,e)=>e.axisY.getStackIndex()-t.axisY.getStackIndex()):this.fv,this.s_,{afterCursorPointedAt:t=>{const e=this.pi.Ia();if(t.length>1&&e){const t=this.pi.il(e);this.jm.v_.sm({x:t.engineX,y:t.engineY},this.pi.ai)}},overrideCursorPositions:(t,e)=>t.map(t=>t.multiHit?t.multiHit.map(e=>({...t.cursorPosition,pointMarker:e})):[t.cursorPosition]).flat()});const c=(t,e,i,s,r={})=>{const n=Ru(t);let o=0;const a=[],h=n.parallels.map(t=>{const n=t.stacks.reduce((t,e)=>{var i,s;return t+(e.axis.getVisible()?(null!==(i=e.axis.kA)&&void 0!==i?i:0)+(null!==(s=e.axis.CA)&&void 0!==s?s:0):0)},0),h=t.stacks.reduce((t,e)=>t+(e.axis.getVisible()&&"pixels"in e.axis.vf?e.axis.vf.pixels:0),0),l=e-n-h;let c=0;const u=t.stacks.map(i=>{var n,h;const u=i.axis,d=u.getVisible(),f=Math.max(e-c,0),g=Math.min(d?"pixels"in u.vf?u.vf.pixels:u.vf.relative/t.sumRelativeSize*l:0,f),p=t.stacks.length,m={...r,availableSpace:e,stack:i,axisLength:g,axisLengthOffset:c,axisThicknessOffset:o,stackAxisCount:p},y=s(m,a);return a.push({...m,...y}),d&&(c+=g+(null!==(n=u.kA)&&void 0!==n?n:0)+(null!==(h=u.CA)&&void 0!==h?h:0)),{...y,stack:i,axis:u}}),d=u.reduce((t,e)=>e.axis.getVisible()?Math.max(t,e.yA):t,0),f=u.reduce((t,e)=>Math.max(t,e.pA),0);return u.forEach(t=>{t.pA=f}),o+=d*i,{...t,stacks:u}});return{parallels:h,thicknessTotal:Math.abs(o)}},u=this.getTitleFillStyle()!==ls&&this.getTitle().length>0,d=u?this.Yr.Nh().bc():{x:0,y:0},f=v(Fu(this._A,null!==(i=this.bi.chartXYTitleMargin)&&void 0!==i?i:5),this.Wg),g=u?Du(this._A,d,f):Xe,m=this.Os.reduce((t,e)=>{const i=e.Nh(g,this.Gn);return{top:Math.max(t.top,i.top),bottom:Math.max(t.bottom,i.bottom),left:Math.max(t.left,i.left),right:Math.max(t.right,i.right)}},{top:0,bottom:0,left:0,right:0}),y=this.Jw.x.getCellSize()-(this.Gn.left+this.Gn.right+g.left+g.right)-m.left-m.right,x=this.Jw.y.getCellSize()-(this.Gn.top+this.Gn.bottom+g.bottom+g.top)-m.top-m.bottom,A=new Map,S=(t,e)=>{const i=!!e.find(t=>!0===t.updatedTicks),s={physicalAxisSize:t.axisLength,xA:t.axisLength,y_:t.axisLengthOffset,SA:t.axisThicknessOffset,anyPreviousAxisUpdated:i,TA:t.stackAxisCount};return t.stack.axis.Nh(s)},b=c(this.BA,x,-1,S),M=c(this.PA,x,1,S),E=c(this.LA,y,-1,S),k=c(this.IA,y,1,S),T=[this.Gn.left+g.left+b.thicknessTotal+m.left,this.Gn.right+g.right+M.thicknessTotal+m.right],w=[this.Gn.bottom+E.thicknessTotal+g.bottom+m.bottom,this.Gn.top+g.top+k.thicknessTotal+m.top],C=this.Jw.x.getCellSize()-(T[0]+T[1]),B=this.Jw.y.getCellSize()-(w[0]+w[1]);this.Jw.x.W(0,C),this.Jw.y.W(0,B),this.Jw.x.St(T),this.Jw.y.St(w),super.Yg();const F=[...b.parallels,...E.parallels,...M.parallels,...k.parallels].map(t=>t.stacks).flat(),D=t=>{var e,i;const s=t.stack.axis,r=F.find(t=>t.axis===s);if(!r)throw new Error("LightningChart JS unexpected runtime error");const n=s.getVisible()?t.margins[0]+t.axisLengthOffset+(null!==(e=s.kA)&&void 0!==e?e:0):0,o=s.getVisible()?t.margins[1]+(t.availableSpace-t.axisLengthOffset)-t.axisLength-(null!==(i=s.kA)&&void 0!==i?i:0):0;s.ai.St([n,o]);const a=t.stack.axis.ir(r);return A.set(t.stack.axis,a),r},I=y-(b.thicknessTotal+M.thicknessTotal),R=x-(E.thicknessTotal+k.thicknessTotal);c(this.BA,R,-1,D,{margins:w}),c(this.PA,R,1,D,{margins:w}),c(this.LA,I,-1,D,{margins:T}),c(this.IA,I,1,D,{margins:T}),this.d_={left:b.thicknessTotal,top:k.thicknessTotal,right:M.thicknessTotal,bottom:E.thicknessTotal};const L={chartWidth:this.Jw.x.getCellSize(),chartHeight:this.Jw.y.getCellSize(),viewportWidth:C,viewportHeight:B,margins:{left:T[0],right:T[1],bottom:w[0],top:w[1]},axes:A},P=this.f_;if(e)this.D.R("layoutchange",{...L,userChangedLayout:()=>{}});else if(!P||Math.abs(P.chartWidth-L.chartWidth)>=1||Math.abs(P.chartHeight-L.chartHeight)>=1||Math.abs(P.viewportWidth-L.viewportWidth)>=1||Math.abs(P.viewportHeight-L.viewportHeight)>=1||this.getAxes().find(t=>{var e,i,s,r,n,o,a,h,l,c,u,d;const f=P.axes.get(t),g=L.axes.get(t);if(Math.abs((null!==(e=null==f?void 0:f.width)&&void 0!==e?e:0)-(null!==(i=null==g?void 0:g.width)&&void 0!==i?i:0))>=1||Math.abs((null!==(s=null==f?void 0:f.height)&&void 0!==s?s:0)-(null!==(r=null==g?void 0:g.height)&&void 0!==r?r:0))>=1||Math.abs((null!==(n=null==f?void 0:f.left)&&void 0!==n?n:0)-(null!==(o=null==g?void 0:g.left)&&void 0!==o?o:0))>=1||Math.abs((null!==(a=null==f?void 0:f.right)&&void 0!==a?a:0)-(null!==(h=null==g?void 0:g.right)&&void 0!==h?h:0))>=1||Math.abs((null!==(l=null==f?void 0:f.bottom)&&void 0!==l?l:0)-(null!==(c=null==g?void 0:g.bottom)&&void 0!==c?c:0))>=1||Math.abs((null!==(u=null==f?void 0:f.top)&&void 0!==u?u:0)-(null!==(d=null==g?void 0:g.top)&&void 0!==d?d:0))>=1)return t})){let e=!1;const i=()=>{e=!0};if(this.D.R("layoutchange",{...L,userChangedLayout:i}),this.Fg||e)return this.engine.layout(),this.h_({width:this.uiScale.kt().x,height:this.uiScale.kt().y,engineWidth:this.pi.ai.kt().x,engineHeight:this.pi.ai.kt().y}),this.Fg=!0,void this.ir(t,!0)}this.f_=L,this.yv.sr(l(0,0)).Z(l(C,B)),this.mv.sr(l(0,0)).Z(l(C,B));const z=Iu(this._A,d,f,this.uiScale.ni(),this.Gn,T,w,m);this.Yr.sr(z.position).Mn(z.margin).Yl(z.horizontalAlignment).Wl(z.verticalAlignment),this.Os.forEach(t=>t.ir(g,this.Gn));const _=p(this.Jw.x.bt(),this.Jw.y.bt(),this.Jw.x.wt(),this.Jw.y.wt());this.bx.Tm(_),this.Hf.Tm(_),this.Wf.Tm(_),this.kg&&this.kg();for(const t of this.fv)t.dp()}Zw(t){const e=Ue(this.fv.map(t=>t.hl())),i=new Set(e.map(t=>t.jw));if(1===i.size){const s=Array.from(i)[0],r="x"===s?[this.LA,this.IA]:[this.BA,this.PA],n="y"===s?[this.LA,this.IA]:[this.BA,this.PA];r.forEach(e=>e.forEach(e=>{const i=t.get(e.axis);i&&e.axis.fit(i.animate,i.stopAxisAfter)})),e.forEach(t=>t.Hw()),n.forEach(e=>e.forEach(e=>{const i=t.get(e.axis);i&&(e.axis.getScrollStrategy()&&void 0===e.axis.getDefaultInterval()?e.axis.setStopped(!1):e.axis.fit(i.animate,i.stopAxisAfter))}))}else t.forEach((t,e)=>e.fit(null==t?void 0:t.animate,null==t?void 0:t.stopAxisAfter))}j(){for(let t=0;t<this.LA.length;t+=1)this.LA[t].axis.j();for(let t=0;t<this.IA.length;t+=1)this.IA[t].axis.j();for(let t=0;t<this.BA.length;t+=1)this.BA[t].axis.j();for(let t=0;t<this.PA.length;t+=1)this.PA[t].axis.j();return super.j()}o_(t){if(this.Qw.has(t))return this.Qw.get(t);throw new Error("No attach handler for axis Make sure that passed axes definitely belong to this chart and that they haven't been disposed of.")}addPointLineAreaSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new gu(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,t);return this.xv(s,t),s}addLineSeries(t){return this.addPointLineAreaSeries(t).setAreaFillStyle(ls).setPointFillStyle(ls)}addPointSeries(t){return this.addPointLineAreaSeries(t).setAreaFillStyle(ls).setStrokeStyle(Bt)}addPointLineSeries(t){return this.addPointLineAreaSeries(t).setAreaFillStyle(ls)}addStepSeries(t){return this.addPointLineAreaSeries(t).setAreaFillStyle(ls).setCurvePreprocessing({type:"step"})}addSplineSeries(t){return this.addPointLineAreaSeries(t).setAreaFillStyle(ls).setCurvePreprocessing({type:"spline"})}addAreaSeries(t){return this.addPointLineAreaSeries(t).setPointFillStyle(ls)}addRectangleSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new _c(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,t);return this.xv(s,t),s}addPolygonSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY(),s=new Pc(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length);return this.xv(s,t),s}addSegmentSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new Nc(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length);return this.xv(s,t),s}addEllipseSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new Rc(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length);return this.xv(s,t),s}addBoxSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=t&&t.dimensionStrategy?t.dimensionStrategy:za,r=new Dc(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,s,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length);return this.xv(r,t),r}addTextSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new Gc(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length);return this.xv(s,t),s}addHeatmapGridSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();let s;if(void 0!==t.heatmapDataType&&"intensity"!==t.heatmapDataType)throw new Error(`Unsupported Heatmap Grid heatmapDataType: '${t.heatmapDataType}'`);return s=new Jc(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,t,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length),this.xv(s,t),s}addHeatmapScrollingGridSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();let s;if(void 0!==t.heatmapDataType&&"intensity"!==t.heatmapDataType)throw new Error(`Unsupported Heatmap Grid heatmapDataType: '${t.heatmapDataType}'`);return s=new tu(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,t,this.bi,this.pi.vs,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length),this.xv(s,t),s}addOHLCSeries(t){const e=(null==t?void 0:t.axisX)||(null==t?void 0:t.xAxis)||this.getDefaultAxisX(),i=(null==t?void 0:t.axisY)||(null==t?void 0:t.yAxis)||this.getDefaultAxisY();Eu(e,i);const s=new(t&&t.type?t.type:ou.Candlesticks)(this,this.gv,this.bx,e,i,this.o_(e),this.o_(i),this.Eg,this.bi,this.pi.vs);return this.xv(s,t),s}addOnScreenMenu(t,e){return new fu(this.Pg,t,this,e)}setZoomingRectangleFillStyle(t){return this.t_="function"==typeof t?t(this.t_):t,this.pi.Bs(),this}getZoomingRectangleFillStyle(){return this.t_}setZoomingRectangleStrokeStyle(t){return this.i_="function"==typeof t?t(this.i_):t,this.pi.Bs(),this}getZoomingRectangleStrokeStyle(){return this.i_}pan(t){this.forEachAxisX(e=>{e.setStopped(!0).pan(t.x)}),this.forEachAxisY(e=>{e.setStopped(!0).pan(t.y)})}zoom(t,e){this.forEachAxis(Mu),this.forEachAxisX(i=>{i.zoom(i.ai.Et(t.x),e.x)}),this.forEachAxisY(i=>{i.zoom(i.ai.Et(t.y),e.y)})}setAnimationsEnabled(t){return super.setAnimationsEnabled(t),this.forEachAxis(e=>e.setAnimationsEnabled(t)),this}bg(){const t=[];return this.forEachAxis(e=>e.cA(e=>t.push(e))),super.bg().concat(t)}ww(){return this.qw}Ye(){return this.Kg(this.bx)}setCursorEnabledDuringAxisAnimation(t){return this.Kw=t,this}getCursorEnabledDuringAxisAnimation(){return this.Kw}forEachAxis(t){return this.forEachAxisX(t),this.forEachAxisY(t),this}translateCoordinate(t,e,i){if(i){const s=t,r=e,n=Va(r)?r:Ms(r)?this.eA:void 0;if(n&&Ss(i)){const t=tt(s,n,this.pi.ai);return this.pi.sl({engineX:t.x,engineY:t.y})}if(n&&Ms(i))return tt(s,n,this.eA);if(n&&Va(i))return tt(s,n,i)}else{const i=t;if(Ms(e)){const t=this.pi.il(i);return tt({x:t.engineX,y:t.engineY},this.pi.ai,this.eA)}if(Va(e)){const t=e,s=this.pi.il(i);return tt({x:s.engineX,y:s.engineY},this.pi.ai,t)}}throw new Error("translateCoordinate unexpected error. Input or target coordinate system not recognized.")}addEventListener(t,e,i){this.D.addEventListener(t,e,i),"layoutchange"===t&&this.f_&&e({...this.f_,userChangedLayout:()=>{}})}removeEventListener(t,e){this.D.removeEventListener(t,e)}setUserInteractions(t){return this.Hm.setUserInteractions(t),this}getUserInteractions(){return this.Hm.getUserInteractions()}}e.ChartXYTitlePositionOptions=void 0,(wu=e.ChartXYTitlePositionOptions||(e.ChartXYTitlePositionOptions={})).CenterTop="center-top",wu.RightTop="right-top",wu.LeftTop="left-top",wu.CenterBottom="center-bottom",wu.RightBottom="right-bottom",wu.LeftBottom="left-bottom",wu.SeriesCenterTop="series-center-top",wu.SeriesRightTop="series-right-top",wu.SeriesLeftTop="series-left-top",wu.SeriesCenterBottom="series-center-bottom",wu.SeriesRightBottom="series-right-bottom",wu.SeriesLeftBottom="series-left-bottom";const Bu=e.ChartXYTitlePositionOptions.CenterTop,Fu=(t,e)=>{switch(t){case"center-top":case"series-center-bottom":return{left:0,right:0,top:0,bottom:e};case"left-top":return{left:20,right:0,top:0,bottom:e};case"right-top":return{left:0,right:20,top:0,bottom:e};case"center-bottom":return{left:0,right:0,top:0,bottom:0};case"left-bottom":return{left:20,right:0,top:0,bottom:0};case"right-bottom":return{left:0,right:20,top:0,bottom:0};case"series-center-top":return{left:0,right:0,top:e,bottom:0};case"series-left-top":return{left:e,right:0,top:e,bottom:0};case"series-right-top":return{left:0,right:e,top:e,bottom:0};case"series-left-bottom":return{left:e,right:0,top:0,bottom:e};case"series-right-bottom":return{left:0,right:e,top:0,bottom:e}}return Ye(0,`Unexpected ChartXY title position selection ${t}`)},Du=(t,e,i)=>{switch(t){case"center-top":case"left-top":case"right-top":return{top:e.y+i.top+i.bottom,right:0,bottom:0,left:0};case"center-bottom":case"left-bottom":case"right-bottom":return{bottom:e.y+i.top+i.bottom,right:0,left:0,top:0};default:return Xe}},Iu=(t,e,i,s,r,n,o,a)=>{const h=(i.left-i.right)*s.x,l=(i.bottom-i.top)*s.y,c={top:0,left:a.left+r.left,right:a.right+r.right,bottom:0};switch(t){case"center-top":return{horizontalAlignment:0,verticalAlignment:1,position:{x:50+h,y:100-(r.top+i.top)*s.y},margin:c};case"left-top":return{horizontalAlignment:-1,verticalAlignment:1,position:{x:h,y:100-(r.top-i.top)*s.y},margin:c};case"right-top":return{horizontalAlignment:1,verticalAlignment:1,position:{x:100+h,y:100-(r.top-i.top)*s.y},margin:c};case"center-bottom":return{horizontalAlignment:0,verticalAlignment:-1,position:{x:50+h,y:(r.bottom+i.bottom)*s.y},margin:c};case"left-bottom":return{horizontalAlignment:-1,verticalAlignment:-1,position:{x:h,y:(r.bottom+i.bottom)*s.y},margin:c};case"right-bottom":return{horizontalAlignment:1,verticalAlignment:-1,position:{x:100+h,y:(r.bottom+i.bottom)*s.y},margin:c};case"series-center-top":return{horizontalAlignment:0,verticalAlignment:1,position:{x:50+h,y:100-o[1]*s.y+l},margin:c};case"series-left-top":return{horizontalAlignment:-1,verticalAlignment:1,position:{x:n[0]*s.x+h,y:100-o[1]*s.y+l},margin:Xe};case"series-right-top":return{horizontalAlignment:1,verticalAlignment:1,position:{x:100-n[1]*s.x+h,y:100-o[1]*s.y+l},margin:Xe};case"series-center-bottom":return{horizontalAlignment:0,verticalAlignment:-1,position:{x:50,y:o[0]*s.y+l},margin:c};case"series-left-bottom":return{horizontalAlignment:-1,verticalAlignment:-1,position:{x:n[0]*s.x+h,y:o[0]*s.y+l},margin:Xe};case"series-right-bottom":return{horizontalAlignment:1,verticalAlignment:-1,position:{x:100-n[1]*s.x+h,y:o[0]*s.y+l},margin:Xe}}return Ye(0,`Unexpected ChartXY title position selection ${t}`)},Ru=t=>{const e=[];t.forEach((t,i)=>{const s=e.find(e=>e.iParallel===t.iParallel);s?(s.stacks.push({...t}),s.stacks.sort((t,e)=>t.iStack-e.iStack)):e.push({iParallel:t.iParallel,stacks:[{...t}]})});const i=e.map(t=>{const e=t.stacks.reduce((t,e)=>t+(e.axis.getVisible()&&"relative"in e.axis.vf?e.axis.vf.relative:0),0);return{...t,sumRelativeSize:e}});return i.sort((t,e)=>t.iParallel-e.iParallel),{parallels:i}},Lu=(t,e,i)=>{var s;const r=Array.from(new Set(i.map(t=>t.series.ws()))),n=1===r.length&&void 0!==r[0]?r[0]:void 0,o="ProgressiveY"===n||"RegressiveY"===n?{progressiveDimension:e.axisY.getTitle()||void 0,progressiveAxis:e.axisY,valueDimension:e.axisX.getTitle()||void 0,hitValueAxis:t=>t.axisX,value:t=>t.x,position:t=>t.y}:{progressiveDimension:e.axisX.getTitle()||void 0,progressiveAxis:e.axisX,valueDimension:e.axisY.getTitle()||void 0,hitValueAxis:t=>t.axisY,value:t=>t.y,position:t=>t.x};return it(e)?Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[t.getDefaultAxisX().getTitle()||"X","",{text:Bs(e.axisX.formatValue(e.x),e.axisX),font:{weight:"bold"}}],[t.getDefaultAxisY().getTitle()||"Y","",{text:Bs(e.axisY.formatValue(e.y),e.axisY),font:{weight:"bold"}}],void 0!==e.intensity?["Value","",{text:Bs(e.lut?os(e.lut,e.intensity):e.intensity.toFixed(2),null===(s=e.lut)||void 0===s?void 0:s.units),font:{weight:"bold"}}]:[]]):n?[[{text:Bs(o.progressiveAxis.formatValue(o.position(e)),o.progressiveAxis),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],...i.map(t=>t.multiHit?Jf(t,[[{component:t.series,componentColor:Qf(t)},""],[...o.valueDimension?[`${o.valueDimension}1`,""]:[],{text:Bs(o.hitValueAxis(t).formatValue(o.value(t.multiHit[0])),o.hitValueAxis(t)),font:{weight:"bold"}}],[...o.valueDimension?[`${o.valueDimension}2`,""]:[],{text:Bs(o.hitValueAxis(t).formatValue(o.value(t.multiHit[1])),o.hitValueAxis(t)),font:{weight:"bold"}}]]):Jf(t,[[{component:t.series,componentColor:Qf(t)},"",{text:Bs(o.hitValueAxis(t).formatValue(o.value(t)),o.hitValueAxis(t)),font:{weight:"bold"}}]])).flat()]:i.map(e=>Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[...o.progressiveDimension?[`${o.progressiveDimension}`,""]:[],{text:Bs(o.progressiveAxis.formatValue(o.position(e)),o.progressiveAxis),font:{weight:"bold"}}],[...o.valueDimension?[`${o.valueDimension}`,""]:[],{text:Bs(o.hitValueAxis(e).formatValue(o.value(e)),o.hitValueAxis(e)),font:{weight:"bold"}}]])).flat()};class Pu{constructor(t,e,i,s,r,n,o){var a;this.coordsRelative="relative",this.coordsClient="client",this.m_=[],this.x_=new Map,this.fv=new Map,this.S_=!0,this.b_=new Set,this.M_=()=>{this.w_.pi.Bs()},this.__=(t,e,i)=>{0!==this.fv.size&&void 0!==[...this.fv.values()].find(({series:t})=>!0===t.getVisible())||this.k_.li(e,i,!1,!1,"zoomBandChartOther"),this.w_.pi.Bs()},this.C_=!0,this.D=new vt,e.pi.La(Hn.Fo),this.Pg=t,this.ug=(null==n?void 0:n.orientation)||"x",this.T_=void 0!==(null==n?void 0:n.useSharedValueAxis)&&n.useSharedValueAxis,this.F_=s,this.so="x"===this.ug?za:_a;const h={...n,defaultAxisX:this.so.getWidth({x:null==n?void 0:n.defaultAxis,y:void 0}),defaultAxisY:this.so.getHeight({x:null==n?void 0:n.defaultAxis,y:void 0}),legend:null!==(a=null==n?void 0:n.legend)&&void 0!==a?a:{addEntriesAutomatically:!1}};this.w_=new Cu(t,e,i,jt,r,h,o).setTitle("Zoom Band Chart").setUserInteractions(void 0).setCursorMode(void 0),this.engine=this.w_.engine;const l=this.w_.getDefaultAxisX().setPointerEvents(!1),c=this.w_.getDefaultAxisY().setPointerEvents(!1);this.k_=this.so.getWidth({x:l,y:c}).setScrollStrategy(yn.fitting()).setAnimationScroll(!1).setStrokeStyle(Bt).setTickStrategy(xn.Empty),(null==n?void 0:n.useSharedValueAxis)?this.I_=this.so.getHeight({x:l,y:c}):this.so.getHeight({x:l,y:c}).dispose();const u=this.getTheme().zoomBandChartDefocusOverlayFillStyle||new fs({color:this.getTheme().isDark?M(0,0,0,180):M(255,255,255,180)});this.L_=[this.w_.jf.tr(this.k_.iA).qe(u).Ke(Bt),this.w_.jf.tr(this.k_.iA).qe(u).Ke(Bt)];const d=this.w_.jf.bA(this.k_.iA).cr(this.getTheme().zoomBandChartSplitterStrokeStyle||this.getTheme().chartXYSeriesBackgroundStrokeStyle);this.P_={collection:d,members:new Array(5).fill(0).map(t=>d.Ho())};const f=this.getTheme(),g="function"==typeof f.zoomBandChartKnobFillStyle?Ot({resourcesBaseUrl:this.Pg.me,styleFactory:f.zoomBandChartKnobFillStyle,apply:t=>this.setKnobFillStyle(t)}):f.zoomBandChartKnobFillStyle||ls;this.B_=[this.w_.jf.tr(this.w_.eA).qe(g).Ke(Bt),this.w_.jf.tr(this.w_.eA).qe(g).Ke(Bt)],this.D_=this.getTheme().zoomBandChartKnobSize||{x:0,y:0},this.E_()}get chart(){return this.w_}setUserInteractions(t){return this.ar=void 0===t?{pan:{drag:!1,click:!1},zoom:{wheel:void 0,dragKnob:!1}}:t,this}getUserInteractions(){return Nt({pan:{drag:!0,click:!0},zoom:{wheel:{},dragKnob:!0}},this.ar)}add(t){this.b_.has(t.chart)||(this.b_.add(t.chart),t.chart.addEventListener("layoutchange",this.M_));const e=this.m_.map(t=>t.axis),i="x"===this.ug?t.axisX:t.axisY;if(!e.includes(i)){const t=t=>{this.__(i,t.start,t.end)};i.addEventListener("intervalchange",t),this.m_.push({axis:i,deattach:()=>{i.removeEventListener("intervalchange",t)}}),this.k_.Bh(i.Ph(),i.getTickStrategy()),this.R_&&this.R_.remove(),this.R_=et(...this.m_.map(t=>t.axis))}const s=this.so.getHeight({x:t.axisX,y:t.axisY});let r;if(this.T_)r=this.I_;else{const t=this.x_.get(s);t?r=t:(r=this.so.getHeight({x:this.w_.addAxisX.bind(this.w_),y:this.w_.addAxisY.bind(this.w_)})({type:s.uh.type}),this.O_(r)),this.x_.set(s,r)}const n=this.so.getWidth({x:this.k_,y:r}),o=this.so.getHeight({x:this.k_,y:r});let a;const h=[];if(t instanceof gu)a=this.w_.addPointLineAreaSeries({...t.Da,axisX:n,axisY:o,xAxis:n,yAxis:o}).setStrokeStyle(t.getStrokeStyle()).setAreaFillStyle(t.getAreaFillStyle()).setPointFillStyle(t.getPointFillStyle()).setPointAlignment(t.getPointAlignment()).setPointRotation(t.getPointRotation()).setPointShape(t.getPointShape()).setPointSize(t.getPointSize()).setCurvePreprocessing(t.getCurvePreprocessing()),a.setDataSet(t.Yw(),t.getDataMapping());else if(t instanceof su){const e=this.w_.addPointLineAreaSeries({axisX:n,axisY:o,xAxis:n,yAxis:o});((t,e)=>{const i=t=>{if(0!==t.length)if("x"in t[0]){const i=t;e.appendJSON(i)}else{const i=t,s=[];for(let t=0;t<i.length;t+=1){const e=i[t];s.push({x:e[0],y:e[4]})}e.appendJSON(s)}},s=t.fM();i(s);const r=t=>{i(t.data)},n=()=>{e.clear()};t.addEventListener("dataadd",r),t.addEventListener("dataclear",n),h.push(()=>{t.removeEventListener("dataadd",r),t.removeEventListener("dataclear",n)})})(t,e),a=e}else if(t instanceof iu){const e=this.w_.addAreaRangeSeries({axisX:n,axisY:o,xAxis:n,yAxis:o}).setLowFillStyle(t.getLowFillStyle()).setHighFillStyle(t.getHighFillStyle()).setLowStrokeStyle(t.getLowStrokeStyle()).setHighStrokeStyle(t.getHighStrokeStyle()).add(t.fM()),i=t=>e.add(t.data);t.addEventListener("dataadd",i),h.push(()=>t.removeEventListener("dataadd",i)),a=e;const s=t=>e.clear();t.addEventListener("dataclear",s),h.push(()=>{t.removeEventListener("dataclear",s)})}else{if(!(t instanceof Kc))throw new Error("LightningChart JS Zoom Band Chart unsupported series type");{const e=this.w_.addHeatmapGridSeries({...t.fb,axisX:n,axisY:o,xAxis:n,yAxis:o}),i=()=>{e.setWireframeStyle(t.getWireframeStyle()).setIntensityInterpolation(t.getIntensityInterpolation()).setFillStyle(t.getFillStyle()).setContours(t.getContours())};i(),a=e,t.mb(a);const s=t=>e.invalidateIntensityValues(t.value);t.addEventListener("stylechange",i),h.push(()=>{t.removeEventListener("invalidateintensity",s),t.removeEventListener("stylechange",i)});const r=()=>{e.clear()};t.addEventListener("dataclear",r),h.push(()=>{t.removeEventListener("dataclear",r)})}}a.setPointerEvents(!1);const l=t=>{a.setVisible(t.isVisible)};t.addEventListener("visiblechange",l),h.push(()=>{t.removeEventListener("visiblechange",l)});const c=t=>{a.setHighlight(t.highlight)};h.push(()=>{t.addEventListener("highlightchange",c),t.removeEventListener("highlightchange",c)});const u=()=>{this.disposeSeries(t)};return t.addEventListener("dispose",u),h.push(()=>{t.removeEventListener("dispose",u)}),this.fv.set(t,{series:a,clearReferences:()=>h.forEach(t=>t())}),a}disposeSeries(t){const e=this.fv.get(t);if(e){const{clearReferences:i}=e;i(),this.fv.delete(t),e.series.dispose();const s=this.so.getHeight({x:t.axisX,y:t.axisY}),r=this.x_.get(s);r&&0===r.gA().length&&(this.x_.delete(s),r.dispose())}const i="x"===this.ug?t.axisX:t.axisY;if(!Array.from(this.fv.keys()).find(t=>i===("x"===this.ug?t.axisX:t.axisY))){const t=this.m_.findIndex(t=>t.axis===i);t>=0&&(this.m_[t].deattach(),this.m_.splice(t,1))}const s=Array.from(this.fv.keys()).find(t=>t.chart==t.chart);return s||(t.chart.removeEventListener("layoutchange",this.M_),this.b_.delete(t.chart)),this}setDefocusOverlayFillStyle(t){return this.L_.forEach(e=>e.qe(t)),this.w_.pi.Bs(),this}getDefocusOverlayFillStyle(){return this.L_[0].Mh()}setSplitterStrokeStyle(t){return this.P_.collection.cr(t),this.w_.pi.Bs(),this}getSplitterStrokeStyle(){return this.P_.collection.do()}setKnobFillStyle(t){return this.B_.forEach(e=>e.qe(t)),this.w_.pi.Bs(),this}getKnobFillStyle(){return this.B_[0].Mh()}setKnobStrokeStyle(t){return this.B_.forEach(e=>e.Ke(t)),this.w_.pi.Bs(),this}getKnobStrokeStyle(){return this.B_[0].Ja()}setKnobSize(t){return this.D_=t,this.w_.pi.Bs(),this}getKnobSize(){return this.D_}getDefaultAxisX(){return this.w_.getDefaultAxisX()}getDefaultAxisY(){return this.w_.getDefaultAxisY()}get axisX(){return this.getDefaultAxisX()}get xAxis(){return this.getDefaultAxisX()}get axisY(){return this.getDefaultAxisY()}get yAxis(){return this.getDefaultAxisY()}O_(t){t.setTickStrategy(xn.Empty).setPointerEvents(!1).setStrokeStyle(Bt)}setStopAxisOnInteraction(t){return this.S_=t,this}getStopAxisOnInteraction(){return this.S_}E_(){let t;const i=(t,e,i,s)=>{var r,n;const o="x"===this.ug?null===(r=Array.from(this.fv.keys())[0])||void 0===r?void 0:r.axisX:null===(n=Array.from(this.fv.keys())[0])||void 0===n?void 0:n.axisY;if(!o)return;const a=o.getInterval(),h=this.k_.getInterval(),l=Math.abs(this.k_.ai.Dt(t)-this.k_.ai.Dt(e));i.preventTooSmall&&l<10||Math.sign(e-t)!==Math.sign(a.end-a.start)||Math.min(t,e)<Math.min(h.start,h.end)||Math.max(t,e)>Math.max(h.start,h.end)&&Math.max(a.start,a.end)<Math.max(t,e)||o.li(t,e,i.animated,this.S_,s)};this.B_.forEach((s,r)=>{s.addEventListener("pointerenter",()=>{var i;(null===(i=this.getUserInteractions().zoom)||void 0===i?void 0:i.dragKnob)&&(t=this.engine.setMouseStyle(this.so.getWidth({x:e.MouseStyles.Horizontal,y:e.MouseStyles.Vertical}),t))}),s.addEventListener("pointerleave",()=>{t=this.engine.restoreMouseStyle(t)}),s.addEventListener("pointerdown",t=>{var e,s,n;if(!(null===(e=this.getUserInteractions().zoom)||void 0===e?void 0:e.dragKnob))return;const o="x"===this.ug?null===(s=Array.from(this.fv.keys())[0])||void 0===s?void 0:s.axisX:null===(n=Array.from(this.fv.keys())[0])||void 0===n?void 0:n.axisY;if(!o)return;fe(t);const a=e=>{if(e.pointerId!==t.pointerId)return;fe(e);const s=this.so.getWidth(this.w_.translateCoordinate(e,this.w_.coordsAxis)),n=o.getInterval(),a=0===r?s:n.start,h=1===r?s:n.end;i(a,h,{animated:!1,preventTooSmall:!0},"zoomBandChartOther")},h=e=>{e.pointerId===t.pointerId&&(fe(e),ei("click"),Ut.removeEventListener("pointermove",a),Ut.removeEventListener("pointerup",h))};Ut.addEventListener("pointermove",a),Ut.addEventListener("pointerup",h)})}),this.w_.seriesBackground.addEventListener("pointerenter",()=>{var i;(null===(i=this.getUserInteractions().pan)||void 0===i?void 0:i.drag)&&(t=this.engine.setMouseStyle(e.MouseStyles.Move,t))}),this.w_.seriesBackground.addEventListener("pointerleave",()=>{t=this.engine.restoreMouseStyle(t)});const s=(t,e)=>{var s,r,n;if(!(null===(s=this.getUserInteractions().pan)||void 0===s?void 0:s.drag))return;const o="x"===this.ug?null===(r=Array.from(this.fv.keys())[0])||void 0===r?void 0:r.axisX:null===(n=Array.from(this.fv.keys())[0])||void 0===n?void 0:n.axisY;if(!o)return;const a=o.getInterval(),h=this.k_.ai.Qt(a.start,this.so.getWidth(t)),l=this.k_.ai.Qt(a.end,this.so.getWidth(t));i(h,l,{animated:!1,preventTooSmall:!0},"zoomBandChartOther"),fe(e)};this.w_.seriesBackground.addEventListener("pointerdown",t=>{var e,i;if(!("x"===this.ug?null===(e=Array.from(this.fv.keys())[0])||void 0===e?void 0:e.axisX:null===(i=Array.from(this.fv.keys())[0])||void 0===i?void 0:i.axisY))return;fe(t);let r=t;const n=e=>{if(e.pointerId!==t.pointerId)return;const i={x:e.clientX-r.clientX,y:r.clientY-e.clientY};r=e,s(i,e)},o=e=>{e.pointerId===t.pointerId&&(fe(e),ii(),ei("click"),Ut.removeEventListener("pointermove",n),Ut.removeEventListener("pointerup",o))};Ut.addEventListener("pointermove",n),Ut.addEventListener("pointerup",o)}),this.w_.seriesBackground.addEventListener("wheel",t=>{var e,s,r,n;const o=this.getUserInteractions();if(!(null===(e=o.zoom)||void 0===e?void 0:e.wheel))return;const a="x"===this.ug?null===(s=Array.from(this.fv.keys())[0])||void 0===s?void 0:s.axisX:null===(r=Array.from(this.fv.keys())[0])||void 0===r?void 0:r.axisY;if(!a)return;const h=a.getInterval(),l=this.k_.getInterval(),c=this.so.getWidth(this.w_.translateCoordinate(t,this.w_.coordsAxis)),u=this.k_.ai.Dt(h.start),d=this.k_.ai.Dt(h.end),f=this.k_.ai.Dt(c),g=$t((f-u)/(d-u),0,1),p=.2*Math.abs(d-u)*(null!==(n=o.zoom.wheel.sensitivity)&&void 0!==n?n:1),m=g*p*-Math.sign(t.deltaY),y=(1-g)*p*Math.sign(t.deltaY),x=$t(this.k_.ai.Qt(h.start,m),l.start,l.end),v=$t(this.k_.ai.Qt(h.end,y),l.start,l.end);i(x,v,{animated:!1,preventTooSmall:!0},"zoomBandChartOther"),fe(t)}),this.L_.forEach((s,r)=>{s.addEventListener("pointerenter",()=>{var i;(null===(i=this.getUserInteractions().pan)||void 0===i?void 0:i.click)&&(t=this.engine.setMouseStyle(e.MouseStyles.Point,t))}),s.addEventListener("pointerleave",()=>{t=this.engine.restoreMouseStyle(t)}),s.addEventListener("click",t=>{var e,s,r;if(t.defaultPrevented)return;if(!(null===(e=this.getUserInteractions().pan)||void 0===e?void 0:e.click))return;const n="x"===this.ug?null===(s=Array.from(this.fv.keys())[0])||void 0===s?void 0:s.axisX:null===(r=Array.from(this.fv.keys())[0])||void 0===r?void 0:r.axisY;if(!n)return;const o=this.so.getWidth(this.w_.translateCoordinate(t,this.w_.coordsAxis)),a=n.getInterval(),h=this.k_.getInterval(),l=$t(o-(a.end-a.start)/2,Math.min(h.start,h.end),Math.max(h.start,h.end)-Math.abs(a.end-a.start)),c=l+(a.end-a.start);i(l,c,{animated:!0,preventTooSmall:!1},"zoomBandChartClick"),fe(t)})})}getSizePixels(){return this.w_.getSizePixels()}Mn(t){this.w_.Mn(t)}getMinimumSize(){return this.w_.getMinimumSize()}j(){return this.w_.j()}H(){return this.w_.H()}ir(t){var e,i,s,r;const n=Oe(Array.from(this.fv.keys()).map(t=>t.chart)),o="x"===this.ug?null===(e=Array.from(this.fv.keys())[0])||void 0===e?void 0:e.axisX:null===(i=Array.from(this.fv.keys())[0])||void 0===i?void 0:i.axisY,a=(()=>{var t;const e=null===(t=this.m_.find(t=>t.axis.getVisible()))||void 0===t?void 0:t.axis;return!!e&&Math.sign(e.getInterval().end-e.getInterval().start)})(),h=Math.sign(this.k_.getInterval().end-this.k_.getInterval().start);if(h!==a&&0!==h&&0!==a&&this.k_.li(this.k_.getInterval().end,this.k_.getInterval().start,!1,this.k_.getStopped(),"zoomBandChartOther"),this.fv.forEach((t,e)=>{const i=t.series;e instanceof gu&&i instanceof gu&&i.setDataSet(e.getDataSet(),e.getDataMapping())}),this.C_)if("x"===this.ug){const t=n.reduce((t,e)=>{const i=[];e.forEachAxisY(t=>{if(!t.getVisible()||0!==t.Qf)return;let e=i.find(e=>e.iParallel===t.getParallelIndex());e||(e={iParallel:t.getParallelIndex(),maxHeight:0},i.push(e)),e.maxHeight=Math.max(e.maxHeight,t.DA())});const s=i.reduce((t,e)=>t+e.maxHeight,0);return Math.max(t,s)},0),e=n.reduce((t,e)=>{const i=[];e.forEachAxisY(t=>{if(!t.getVisible()||100!==t.Qf)return;let e=i.find(e=>e.iParallel===t.getParallelIndex());e||(e={iParallel:t.getParallelIndex(),maxHeight:0},i.push(e)),e.maxHeight=Math.max(e.maxHeight,t.DA())});const s=i.reduce((t,e)=>t+e.maxHeight,0);return Math.max(t,s)},0),i=n.reduce((t,e)=>Math.max(t,e.getPadding().left),0),r=n.reduce((t,e)=>Math.max(t,e.getPadding().right),0);this.w_.forEachAxisY(t=>t.setThickness(0)),null===(s=this.getDefaultAxisY())||void 0===s||s.setThickness(t),this.w_.setPadding({left:i+(0===n.length?10:0),right:r+e+(0===n.length?10:0)})}else{const t=n.reduce((t,e)=>{const i=[];e.forEachAxisX(t=>{if(!t.getVisible()||0!==t.Qf)return;let e=i.find(e=>e.iParallel===t.getParallelIndex());e||(e={iParallel:t.getParallelIndex(),maxHeight:0},i.push(e)),e.maxHeight=Math.max(e.maxHeight,t.DA())});const s=i.reduce((t,e)=>t+e.maxHeight,0);return Math.max(t,s)},0),e=n.reduce((t,e)=>{const i=[];e.forEachAxisX(t=>{if(!t.getVisible()||100!==t.Qf)return;let e=i.find(e=>e.iParallel===t.getParallelIndex());e||(e={iParallel:t.getParallelIndex(),maxHeight:0},i.push(e)),e.maxHeight=Math.max(e.maxHeight,t.DA())});const s=i.reduce((t,e)=>t+e.maxHeight,0);return Math.max(t,s)},0),i=n.reduce((t,e)=>Math.max(t,e.getPadding().bottom),0),s=n.reduce((t,e)=>Math.max(t,e.getPadding().top),0);this.w_.forEachAxisX(t=>t.setThickness(0)),null===(r=this.getDefaultAxisX())||void 0===r||r.setThickness(t),this.w_.setPadding({bottom:i+(0===n.length?10:0),top:s+e+(0===n.length?10:0)})}this.w_.ir(t);const l=this.k_.getInterval().start,c=this.k_.getInterval().end,u=$t(o?o.getInterval().start:l,l,c),d=$t(o?o.getInterval().end:c,l,c),f=this.so.getHeight(this.w_.Jw.getInnerIntervalPixels());this.L_[0].sr(this.so.toPoint(l,0)).Z(this.so.toPoint(u-l,f)),this.L_[1].sr(this.so.toPoint(d,0)).Z(this.so.toPoint(c-d,f)),this.P_.members[0].wA(this.so.toPoint(l,f),this.so.toPoint(u,f)),this.P_.members[1].wA(this.so.toPoint(u,f),this.so.toPoint(u,0)),this.P_.members[2].wA(this.so.toPoint(u,0),this.so.toPoint(d,0)),this.P_.members[3].wA(this.so.toPoint(d,0),this.so.toPoint(d,f)),this.P_.members[4].wA(this.so.toPoint(d,f),this.so.toPoint(c,f));const g=tt(this.so.toPoint(u,f/2),this.k_.iA,this.w_.eA),p=tt(this.so.toPoint(d,f/2),this.k_.iA,this.w_.eA),m=this.D_;this.B_[0].sr({x:g.x-m.x/2,y:g.y-m.y/2}).Z({x:m.x,y:m.y}).Th(this.so.getWidth({x:0,y:90})),this.B_[1].sr({x:p.x-m.x/2,y:p.y-m.y/2}).Z({x:m.x,y:m.y}).Th(this.so.getWidth({x:0,y:90}))}setSeriesBackgroundFillStyle(t){return this.w_.setSeriesBackgroundFillStyle(t),this.w_.pi.Bs(),this}getSeriesBackgroundFillStyle(){return this.w_.getSeriesBackgroundFillStyle()}setSeriesBackgroundStrokeStyle(t){return this.w_.setSeriesBackgroundStrokeStyle(t),this.w_.pi.Bs(),this}getSeriesBackgroundStrokeStyle(){return this.w_.getSeriesBackgroundStrokeStyle()}setSeriesBackgroundEffect(t){return this.w_.setSeriesBackgroundEffect(t),this.w_.pi.Bs(),this}getSeriesBackgroundEffect(){return this.w_.getSeriesBackgroundEffect()}getTheme(){return this.w_.getTheme()}setTitle(t){return this.w_.setTitle(t),this}getTitle(){return this.w_.getTitle()}setTitleFillStyle(t){return this.w_.setTitleFillStyle(t),this}getTitleFillStyle(){return this.w_.getTitleFillStyle()}setTitleFont(t){return this.w_.setTitleFont(t),this}getTitleFont(){return this.w_.getTitleFont()}setTitleMargin(t){return this.w_.setTitleMargin(t),this}getTitleMargin(){return this.w_.getTitleMargin()}setPadding(t){return void 0===t?this.C_=!0:(this.C_=!1,this.w_.setPadding(t),this.w_.forEachAxis(t=>t.setThickness(void 0))),this.w_.pi.Bs(),this}getPadding(){return this.w_.getPadding()}setBackgroundFillStyle(t){return this.w_.setBackgroundFillStyle(t),this}getBackgroundFillStyle(){return this.w_.getBackgroundFillStyle()}setBackgroundStrokeStyle(t){return this.w_.setBackgroundStrokeStyle(t),this}getBackgroundStrokeStyle(){return this.w_.getBackgroundStrokeStyle()}translateCoordinate(t,e,i){return kh(t,e,i,this.w_.eA,this.w_.pi)}addUIElement(t,e){return this.w_.addUIElement(t,e)}saveToFile(t,e,i){return this.w_.saveToFile(t,e,i),this}dispose(){return this.w_.dispose(),this.x_.clear(),this.fv.clear(),this.F_(this),this}isDisposed(){return this.w_.isDisposed()}getLayout(){return this.w_.getLayout()}addEventListener(t,e,i){this.w_.addEventListener(t,e,i)}removeEventListener(t,e){this.w_.removeEventListener(t,e)}}class zu extends yc{constructor(t,i,s,r,n,o,a){super(t,i,s,r,n,a),this.Rs="Point Line Series",this.lS=[],this.uS=!1,this.cS=!1,this.z_=3,this._l=0,this.V_=e.PointShape.Circle,this.D=new vt,this.Ze=ze(this.bi.polarPointLineSeriesFillStyle,o),this.hc=ze(this.bi.polarPointLineSeriesStrokeStyle,o),this.AS=t.Np(r,void 0,[Wh.UserSeries]).cr(this.hc).Ii(this.getHighlight()),this._s(this.AS),this.N_=t.zd(r).Od(ls).cr(Bt).Rd(this.Ze).Vd(this.V_).Hd(this.z_).Ii(this.getHighlight()),this._s(this.N_)}solveNearest(t,e){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=this.AS.gS(s);if(!r)return;const n=Sc(r,this.scale);return{cursorPosition:{pointMarker:r,pointMarkerScale:this.scale,resultTable:r,resultTableScale:this.scale},series:this,...n}}Qi(t,e,i){return Je({series:this},{cursorPosition:0,amplitude:0,angle:0,color:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}setData(t){return 0!==this.lS.length&&this.chart.pi.La(Hn.Ro),this.lS=Ac(t),this.uS=!0,this.iS=vc(this.lS),this.Ws.Bs(),this}getData(){return this.lS}setStrokeStyle(t){this.hc="function"==typeof t?t(this.hc):t;const e=this.hc;return this.AS.cr(e),this.Ws.Bs(),this}getStrokeStyle(){return this.hc}setPointFillStyle(t){this.Ze="function"==typeof t?t(this.Ze):t;const e=this.Ze;return this.N_.Rd(e),this.Ws.Bs(),this}getPointFillStyle(){return this.Ze}setPointSize(t){return this.z_=t,this.N_.Hd(t),this.Ws.Bs(),this}getPointSize(){return this.z_}setPointShape(t){return this.V_=t,this.N_.Vd(this.V_),this}getPointShape(){return this.V_}setPointRotation(t){return this._l=t,this.N_.Gd(t),this.Ws.Bs(),this}getPointRotation(){return this._l}er(){return{fill:this.Ze,stroke:this.hc}}setConnectDataAutomaticallyEnabled(t){return this.cS=t,this.Ws.Bs(),this}getConnectDataAutomaticallyEnabled(){return this.cS}xp(){return this.rp&&this.lS.length>0&&this.getVisible()}rr(t,e){t.Ii(e),this.Ws.Bs()}ir(){if(this.uS||this.scale.ge()){const t=xc(this.lS,this.scale),e=bi(t);this.cS?(t.push({...t[0]}),this.AS.Lu(!0)):this.AS.Lu(!1),this.AS.Vi().bu(t).Ti(e),this.N_.Ed((new Vo).appendJSON(t),{x:"x",y:"y"}).Ti(e),this.uS=!1,this.AS.Nh(),this.N_.Nh()}}js(){return this.Es||this.V_}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class _u extends yc{constructor(t,i,s,r,n,o,a){super(t,i,s,r,n,a),this.Rs="Point Series",this.lS=[],this.uS=!1,this.z_=3,this._l=0,this.D=new vt,this.Ze=ze(this.bi.polarPointSeriesFillStyle,o),this.Je=ze(this.bi.polarPointSeriesStrokeStyle,o),this.Dd=new Vo({schema:{x:{pattern:null},y:{pattern:null},color:{pattern:null,storage:Uint32Array}}}),this.Cc=t.zd(r).cr(Bt).Od(ls).Rd(this.Ze).Yd(this.Je).Vd(e.PointShape.Circle).Hd(this.z_).Ii(this.getHighlight()).Ed(this.Dd,{x:"x",y:"y",color:"color"}),this._s(this.Cc)}solveNearest(t,e="show-nearest"){const i=this.chart.translateCoordinate(t,this.chart.coordsAxis),s=xc([i],this.scale)[0],r=this.Dd.yd({x:"x",y:"y",color:"color"},s,Kf(e),this.scale,this.chart.eA);if(!r)return;const n=Sc(r,this.scale);return{cursorPosition:{pointMarker:r,pointMarkerScale:this.scale,resultTable:r,resultTableScale:this.scale},series:this,...n}}Qi(t,e,i){return Je({series:this},{cursorPosition:0,amplitude:0,angle:0,color:0},()=>this.solveNearest(e,this.chart.getCursorMode()))}setData(t){return 0!==this.lS.length&&this.chart.pi.La(Hn.Ro),this.lS=Ac(t),this.uS=!0,this.iS=vc(this.lS),this.Ws.Bs(),this}getData(){return this.lS}setPointAlignment(t){return this.Cc.YA(t),this.chart.pi.Bs(),this}getPointAlignment(){return this.Cc.Gw()}setPointFillStyle(t){this.Ze="function"==typeof t?t(this.Ze):t;const e=this.Ze;return this.Cc.Rd(e),this.Ws.Bs(),this}getPointFillStyle(){return this.Ze}setPointStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.Cc.Yd(this.Je),this.Ws.Bs(),this}getPointStrokeStyle(){return this.Je}setPointSize(t){return this.z_=t,this.Cc.Hd(t),this.Ws.Bs(),this}getPointSize(){return this.z_}setPointShape(t){return this.Cc.Vd(t),this.chart.pi.Bs(),this}getPointShape(){return this.Cc.Nd()}setPointRotation(t){return this._l=t,this.Cc.Gd(t),this.Ws.Bs(),this}getPointRotation(){return this._l}xp(){return this.rp&&this.lS.length>0&&this.getVisible()}rr(t,e){t.Ii(e),this.Ws.Bs()}ir(){if(this.uS||this.scale.ge()){const t=xc(this.lS,this.scale),e=bi(t);this.Dd.clear().appendJSON(t),this.Cc.Ti(e),this.uS=!1,this.Cc.Nh()}}er(){return{fill:this.Ze}}js(){return this.Es||this.getPointShape()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Vu extends yc{constructor(t,e,i,s,r,n,o){super(t,e,i,s,r,n),this.Rs="Heatmap Series",this.G_=!0,this.gp=!1,this.D=new vt;const a=this.chart.getSeries().length;this.Ze=ze(this.bi.polarHeatmapSeriesFillStyle||this.bi.heatmapGridSeriesFillStyle,a);const h=o.amplitudeStart||0,l=o.amplitudeEnd?(o.amplitudeEnd-h)/(o.annuli-1):o.amplitudeStep||1,c={sectors:o.sectors,annuli:o.annuli,amplitudeStart:h,amplitudeStep:l,heatmapDataType:"intensity",dataOrder:o.dataOrder||"annuli"};this.Da=c,this.U_=t.Y_(s,[],c).qe(this.Ze).Ii(this.getHighlight()),this._s(this.U_);const u=Math.min(c.amplitudeStart,c.amplitudeStart+(c.annuli-1)*c.amplitudeStep),d=Math.max(c.amplitudeStart,c.amplitudeStart+(c.annuli-1)*c.amplitudeStep);this.iS={min:u,max:d},this.setHighlightOnHover(!1)}solveNearest(t,e="show-nearest"){const i=this.chart.pi.il(t),s={x:i.engineX,y:i.engineY},r=tt(s,this.chart.pi.ai,this.scale),n=Sc(r,this.scale),o=Kf(e)?this.U_.yb(n):this.U_.yd(n);if(!o)return;const a=xc([o],this.scale)[0];return{cursorPosition:{pointMarker:a,pointMarkerScale:this.scale,resultTable:a,resultTableScale:this.scale},series:this,angle:o.angle,amplitude:o.amplitude,intensity:o.cellValue,annulus:o.iAnnulus,sector:o.iSector,lut:vs(this.Ze)?this.Ze.lut:void 0}}Qi(t,e,i){return Je({series:this},{cursorPosition:0,amplitude:0,angle:0,color:0,intensity:0,sector:0,annulus:0,lut:vs(this.Ze)?this.Ze.lut:void 0},()=>this.solveNearest(e,this.chart.getCursorMode()))}invalidateIntensityValues(t){if(this.gp&&this.chart.pi.La(Hn.Ro),Array.isArray(t)){if(0===t.length||0===t[0].length)return this;const e={x:t.length,y:t[0].length,sectors:"annuli"===this.Da.dataOrder?t[0].length:t.length,annuli:"annuli"===this.Da.dataOrder?t.length:t[0].length},i="annuli"===this.Da.dataOrder?this.Da.annuli:this.Da.sectors,s="annuli"===this.Da.dataOrder?this.Da.sectors:this.Da.annuli;if(e.x>i||e.y>s){if(!0===this.chart.Pg.Ea){const t=`PolarHeatmapSeries.invalidateIntensityValues intensity matrix overflow.\nHeatmap ${i}x${s}, input ${e.x}x${e.y}.\nExcess data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(t)}const r=[];for(let e=0;e<i;e+=1)r[e]=t[e].slice(0,s);if(0===(t=r).length||0===t[0].length)return this}this.U_.Ay({type:"intensity",lengthPrimary:e.x,lengthSecondary:e.y,startPrimary:0,startSecondary:0,values:t})}else if("iSector"in t&&"iAnnulus"in t&&"values"in t){if(0===t.values.length||0===t.values[0].length)return this;const e={primary:t.values.length,secondary:t.values[0].length,sectors:"annuli"===this.Da.dataOrder?t.values[0].length:t.values.length,annuli:"annuli"===this.Da.dataOrder?t.values.length:t.values[0].length},i="annuli"===this.Da.dataOrder?t.iAnnulus:t.iSector,s=i+e.primary-1,r="annuli"===this.Da.dataOrder?t.iSector:t.iAnnulus,n=r+e.secondary-1,o="annuli"===this.Da.dataOrder?this.Da.annuli-1:this.Da.sectors-1,a="annuli"===this.Da.dataOrder?this.Da.sectors-1:this.Da.annuli-1;if(i<0||r<0){if(!0===this.chart.Pg.Ea){const e=`PolarHeatmapSeries.invalidateIntensityValues invalidation start below 0 not permitted.\niSector: ${t.iSector}, iAnnuli: ${t.iAnnulus}.\nNo intensity values will be invalidated.`;Ut.console.warn(e)}return this}if(s>o||n>a){if(!0===this.chart.Pg.Ea){const t=`PolarHeatmapSeries.invalidateIntensityValues intensity matrix overflow.\nMax indexes ${o}x${a}, input ${e.primary}x${e.secondary} starting at [${i},${r}].\nOut of bounds data will be automatically clipped. This can result in sub-optimal performance.`;Ut.console.warn(t)}const h=Math.max(s-o,0),l=e.primary-h,c=Math.max(n-a,0),u=[];for(let e=0;e<l;e+=1)u[e]=t.values[e].slice(0,c>0?-c:void 0);if(0===(t={iSector:t.iSector,iAnnulus:t.iAnnulus,values:u}).values.length||0===t.values[0].length)return this}this.U_.Ay({type:"intensity",lengthPrimary:t.values.length,lengthSecondary:t.values[0].length,startPrimary:i,startSecondary:r,values:t.values})}return this.Ws.Bs(),this.gp=!0,this}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.U_.qe(this.Ze),this.Ws.Bs(),this}getFillStyle(){return this.Ze}clear(){return this.U_.Vi(),this.Ws.Bs(),this}setIntensityInterpolation(t){return t=t||"disabled",this.U_.ly(t),this.Ws.Bs(),this}getIntensityInterpolation(){return this.U_.uy()}Ys(){return Re(this.Ze,this.U_._i())}xp(){return this.rp&&this.getVisible()}rr(t,e){t.Ii(e),this.Ws.Bs()}ir(){}er(){return{fill:this.Ze}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Nu extends uc{constructor(t,e,i,s,r,n,o,a){var h;super(t,Uu,e,i,s,r,n,o,a),this.j_=90,this.H_=12,this.W_=Ou,this.zp=this.zx._d(this.Nx).setPointerEvents(!1),this.Wx=t=>{if(0===this.getTitle().length||cs(this.getTitleFillStyle()))return;let e=180*(t.M-this.Nx.Ae())/Math.PI%360;for(;e<0;)e+=360;for(;e>360;)e-=360;return!(e>=0&&e<=20||e>=340&&e<=360)&&void 0},this.Rh=void 0,this.setTickStyle(i.polarRadialAxisTickStyle),this.setTitle("Degrees"),this.setNorth(this.j_),this.X_=null!==(h=this.bi.polarRadialAxisMarginAfterTicks)&&void 0!==h?h:7}setTickStyle(t){return this.Z_="function"==typeof t?t(this.Z_):t,this.J_(),this.zx.Bs(),this}getTickStyle(){return this.Z_}setTickFormattingFunction(t){return this.W_=t,this.J_(),this.zx.Bs(),this}getTickFormattingFunction(){return this.W_}setClockwise(t){this.Nx.ce(t);const e=this.j_*Math.PI/180;return t?this.Nx.fe(e+Math.PI/2):this.Nx.fe(e-Math.PI/2),this.zx.Bs(),this}getClockwise(){return!this.Nx.de()}setNorth(t){for(;t<0;)t+=360;t%=360,this.j_=t;const e=t*Math.PI/180;return this.getClockwise()?this.Nx.fe(e+Math.PI/2):this.Nx.fe(e-Math.PI/2),this.zx.Bs(),this}getNorth(){return 180*this.Nx.Ae()/Math.PI}setDivision(t){return this.H_=t,this.J_(),this.zx.Bs(),this}getDivision(){return this.H_}getMarginAfterTicks(){return this.X_}setMarginAfterTicks(t){return this.X_=t,this.chart.pi.Bs(),this}gA(){return[]}Qh(t,e,i){return{ticksInfo:e,yA:this.ln((t,e)=>{const i=e.kn.Fr,s=.5*this.Gx.getThickness()+i.tickLength+i.tickPadding+Math.abs(e.zh.Nh().bc().y);return Math.max(t,s)},0)+this.X_,updatedTicks:i}}vn(t,e){return e}xn(t,e,i){return{start:t,end:e}}Ux(t,e){const i=t.de()?1:-1,s=t.Ae(),r=t.ue()?t.le().end-t.le().start:t.le().start-t.le().end;return{x:Math.cos((e-s)*i)*r,y:Math.sin((e-s)*i)*r}}Yx(t,e){return t.dr(e)}Xx(t,e,i,s){const r=this.Z_,n=t.de()?1:-1,o=t.Ae(),a=(s.M-o)*n,h=Math.cos(a),l=Math.sin(a),c=t.ue()?t.le().end-t.le().start:t.le().start-t.le().end,u={x:h*c,y:l*c};e.gr({x:0,y:0}).Ar(u);const d={x:u.x+h*r.tickLength*t.ni().x,y:u.y+l*r.tickLength*t.ni().y};i.gr(u).Ar(d),e.cr(r.gridStrokeStyle),i.cr(r.tickStyle)}$x(t,e,i){const s=t.de()?1:-1;let r,n=(e-t.Ae())*s;for(;n<0;)n+=2*Math.PI;for(;n>=2*Math.PI;)n-=2*Math.PI;r=n>0&&n<=Math.PI?-n+Math.PI/2:-n-Math.PI/2;const o=Math.cos(n),a=Math.sin(n),h=i.tickLength+i.tickPadding;return{alignment:{x:0,y:0},padding:{x:o*h*t.ni().x,y:a*h*t.ni().y},rotation:180*r/Math.PI,offset:{x:0,y:0}}}jx(t,e,i){const s=t.ue()?t.le().end-t.le().start:t.le().start-t.le().end;this.zp.Qu(0).Ar(360).sc(0).Ku(s+.5*e.getThickness()*t.ni().x).rc(360).qe(ls).Ke(e)}Hx(t,e,i){const s=t.Ae(),r=this.$x(t,0+s,this.Z_),n=t.ue()?t.le().end-t.le().start:t.le().start-t.le().end;e.Zl(r.alignment).Th(r.rotation).$l(r.offset.x,r.offset.y).sr(Li({x:n,y:0},r.padding))}J_(){this.Bh({Mr:[],wr:[{zh:"Radial ticks",MA:0,Fr:this.Z_,mr:this.W_,Fn:(t,e,i,s)=>{const r=[],n=2*Math.PI/this.H_;for(let t=0;t<2*Math.PI;t+=n)r.push(t);return r},ih:{hn:()=>{},eh:()=>!1,an:"hide-label"},In:void 0}],_r:Ou,kr:void 0,Cr:void 0},"Numeric")}}const Ou=(t,e,i)=>(180*t/Math.PI).toFixed(0),Uu={dn:()=>{},fn:()=>{},gn:()=>{},Ex:t=>({getInnerStart:()=>0,getInnerEnd:()=>2*Math.PI,W:(t,e)=>{},et:(e,i,s,r,n)=>t.x.et(e,i,s,r,n)}),Rx:t=>t.radial},Gu=t=>!!(t&&"object"==typeof t&&"axisAmplitude"in t&&"axisRadial"in t),Yu=t=>!!(t&&"object"==typeof t&&"angle"in t&&"number"==typeof t.angle&&"amplitude"in t&&"number"==typeof t.amplitude);class Zu extends Ps{constructor(t,e,i,s,r,n){super(e,i,r,n),this.Rs="Sector",this.Q_=0,this.K_=1*Math.PI/2,this.q_=void 0,this.tk=void 0,this.D=new vt,this.Ws=t,this.Nx=s,this.fS=this.Ws.Tc(this.Nx).Ii(this.getHighlight()),this._s(this.fS),this.Ze=r.polarSectorFillStyle,this.Je=r.polarSectorStrokeStyle,this.setPointerEvents(!1)}setAngleStart(t){return this.Q_=t,this.Ws.Bs(),this}getAngleStart(){return this.Q_}setAngleEnd(t){return this.K_=t,this.Ws.Bs(),this}getAngleEnd(){return this.K_}setAmplitudeStart(t){return this.q_=t,this.Ws.Bs(),this}getAmplitudeStart(){return this.q_}setAmplitudeEnd(t){return this.tk=t,this.Ws.Bs(),this}getAmplitudeEnd(){return this.tk}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.Ws.Bs(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.Ws.Bs(),this}getStrokeStyle(){return this.Je}ir(){const t=this.Nx.le(),e=void 0!==this.q_?$t(this.q_,t.start,t.end):t.start,i=void 0!==this.tk?$t(this.tk,t.start,t.end):t.end,s=[],r=Math.min(this.Q_,this.K_),n=Math.max(this.Q_,this.K_);for(let t=r;t<=n;t+=1)s.push({angle:t,amplitude:e});for(let t=n;t>=r;t-=1)s.push({angle:t,amplitude:i});const o=xc(s,this.Nx);this.fS.au(o).qe(this.Ze).Ke(this.Je)}rr(t,e){t.Ii(e),this.Ws.Bs()}er(){return{fill:this.Ze,stroke:this.Je}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class Wu extends hl{constructor(t,e,i,s,r,n,o){var a;super(t,e,i,e.Hg("polarChart bg",0),s,e.pi.bi.polarChartBackgroundFillStyle,e.pi.bi.polarChartBackgroundStrokeStyle,e.pi.bi.polarChartTitleFont,e.pi.bi.polarChartTitleFillStyle,e.pi.bi.polarChartTitleShadow,o,null===(a=null==n?void 0:n.legend)||void 0===a?void 0:a.customLegend),this.coordsClient="client",this.Rf=[],this.ik=t=>{this.Nx.Z(t.engineWidth,t.engineHeight)},this.Nf=be(this.Rf),this.sk=t=>{this.Rf.push(t)},this.ek=()=>this.fv,this.D=new vt,this.pi.La(Hn.Co),this.a_=e.Rm("polarChart series bg",0),this.rk=e.Om("polarChart axis gridlines",0),this.hk=e.Om("polarChart series",1),this.nk=e.Om("polarChart axis lines",2),this.ak=e.Om("polarChart axis ticks",3),this.Nx=i.d2({scaleXYConstructor:Ar}),this.addEventListener("resize",this.ik),this.Yr.tn("Polar Chart"),this.yv=this.a_._d(this.Nx).qe(this.bi.polarChartSeriesBackgroundFillStyle).Ke(Bt).Qu(0).Ar(360).sc(0),this.mv=this.a_._d(this.Nx).qe(ls).Ke(this.bi.polarChartSeriesBackgroundStrokeStyle).Qu(0).Ar(360).sc(0),super.vv(this.yv,this.mv),this.jg(r,this.eA),this.lk=new fc(this,this.Nx,this.bi,!1!==(null==n?void 0:n.animationsEnabled),this.rk,this.nk,this.ak,this.vs,this.ek),this.uk=new Nu(this,this.Nx,this.bi,!1!==(null==n?void 0:n.animationsEnabled),this.rk,this.nk,this.ak,this.vs),this.coordsAxis={axisAmplitude:this.lk,axisRadial:this.uk};const h=e.Ym(),l=qt(n?n.cursorBuilder:void 0,Gl);this.jm=ig(this,h,l.Am(h,this.uiScale,this.uiScale,jt,this.bi),this,"show-nearest",Hu,(t,e)=>{const i=this.translateCoordinate(t,this.coordsClient);return Math.sqrt((i.clientX-e.clientX)**2+(i.clientY-e.clientY)**2)}),this.setAnimationsEnabled(!1!==(null==n?void 0:n.animationsEnabled));const c={backgroundVisible:!0,...null==n?void 0:n.legend};this.legend.setOptions(c)}getSeries(){return this.fv}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}solveNearest(t,e=this.getCursorMode()||"show-nearest"){return this.jm.solveNearest(t,e,this.fv,(t,e,i)=>t.solveNearest(e,i))}addCursor(t=Gl){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}translateCoordinate(t,e,i){if(i){const e=t,s=this.eA,r=i;if(Ss(r)){const t=tt(e,s,this.pi.ai);return this.pi.sl({engineX:t.x,engineY:t.y})}if(Ms(r))return e;if(Gu(r)){const t=tt(e,s,this.Nx);return Sc(t,this.Nx)}}else{const i=t,s=e;if(bs(i)){if(Gu(s)){const t=this.pi.il(i),e=tt({x:t.engineX,y:t.engineY},this.pi.ai,this.Nx);return Sc(e,this.Nx)}if(Ss(s))return i;if(Ms(s)){const t=this.pi.il(i);return tt({x:t.engineX,y:t.engineY},this.pi.ai,this.eA)}}else if(Yu(i)){if(Gu(s))return i;const t=xc([i],this.Nx)[0];if(Ss(s)){const e=tt(t,this.Nx,this.pi.ai),i={engineX:e.x,engineY:e.y};return this.pi.sl(i)}if(Ms(s))return tt(t,this.Nx,this.eA)}}throw new Error("translateCoordinate unexpected error. Input or target coordinate system not recognized.")}addLineSeries(t){const e=new kc(this.hk,this,this.gv,this.Nx,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs);return this.xv(e,t),e}addPointSeries(t){const e=new _u(this.hk,this,this.gv,this.Nx,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs);return this.xv(e,t),e}addPointLineSeries(t){const e=new zu(this.hk,this,this.gv,this.Nx,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs);return this.xv(e,t),e}addAreaSeries(t){const e=new Ec(this.hk,this,this.gv,this.Nx,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs);return this.xv(e,t),e}addPolygonSeries(t){const e=new bc(this.hk,this,this.gv,this.Nx,this.bi,void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,this.pi.vs);return this.xv(e,t),e}addHeatmapSeries(t){const e=new Vu(this.hk,this,this.gv,this.Nx,this.bi,this.pi.vs,t);return this.xv(e,t),e}addSector(t){const e=new Zu(this.hk,this,this.Nf,this.Nx,this.bi,this.pi.vs);return this.sk(e),this.Os.forEach(i=>{i.xg()&&null!==t&&i.bu(e,t)}),e}getAmplitudeAxis(){return this.lk}get amplitudeAxis(){return this.lk}get axisAmplitude(){return this.lk}getRadialAxis(){return this.uk}get radialAxis(){return this.uk}get axisRadial(){return this.uk}ir(t){super.ir(t);const e=Uh.tp(this.Yr,this.Wg),i=this.Os.reduce((t,i)=>{const s=i.Nh(e,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,i);for(const t of this.fv)t.cp();this.lk.pn(),this.uk.pn();for(const t of this.fv)t.ir();const s=this.Nx.getInnerIntervalPixels().x/2,r=this.lk.Nh({physicalAxisSize:s}),n=this.uk.Nh({physicalAxisSize:2*Math.PI*s});this.lk.ir(r),this.uk.ir(n);const o=[this.Gn.left+n.yA+i.left,this.Gn.right+n.yA+i.right],a=[this.Gn.bottom+n.yA+i.bottom,this.Gn.top+n.yA+e+i.top];this.Nx.qt(o).ti(a);const h=this.Nx.le().start,l=this.Nx.le().end,c=this.Nx.ue()?(n.yA||0)*this.Nx.x.getPixelSize()+l-h:(n.yA||0)*this.Nx.x.getPixelSize()+h-l;this.yv.Ku(c).rc(360),this.mv.Ku(c).rc(360);for(const t of this.Rf)t.ir();this.jm.ir(!1,this.fv,(t,e,i)=>t.solveNearest(e,i));for(const t of this.fv)t.dp();return super.Yg(),this.Os.forEach(t=>t.ir(e,this.Gn)),this.ck(),this}setAnimationsEnabled(t){return super.setAnimationsEnabled(t),this.lk.setAnimationsEnabled(t),this.uk.setAnimationsEnabled(t),this}getMinimumSize(){return l(ju,ju)}ck(){}forEachAxis(t){return t(this.lk),t(this.uk),this}dispose(){return this.Rf.slice().forEach(t=>t.dispose()),this.jm.G(),this.a_.G(),this.rk.G(),this.hk.G(),this.nk.G(),this.ak.G(),super.dispose()}bg(){return[...this.fv,...this.Rf]}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const ju=300,Hu=(t,e,i)=>{var s;return rt(e)?Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],["Angle","",{text:e.angle.toFixed(0),font:{weight:"bold"}}],["Amplitude","",{text:Bs(t.getAmplitudeAxis().formatValue(e.amplitude),t.amplitudeAxis),font:{weight:"bold"}}],["Intensity","",{text:Bs(e.lut?os(e.lut,e.intensity):e.intensity.toFixed(2),null===(s=e.lut)||void 0===s?void 0:s.units),font:{weight:"bold"}}]]):Jf(e,[[{component:e.series,componentColor:Qf(e),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],["Angle","",{text:e.angle.toFixed(0),font:{weight:"bold"}}],["Amplitude","",{text:Bs(t.getAmplitudeAxis().formatValue(e.amplitude),t.amplitudeAxis),font:{weight:"bold"}}]])};class $u extends Ps{constructor(t,e,i,s){super(t,e,i,s),this.Rs="Slice",this.M=0,Ut.requestAnimationFrame(()=>{this.addEventListener("pointermove",()=>{this.chart.pi.Bs()})})}}class Xu extends $u{}class qu extends Xu{constructor(t,e,i,s,r,n,o,a){super(s,n,o,a),this.Rs="Slice",this.M=0,this.dk=!1,this.fk=ls,this.Ak=ls,this.gk=this.M,this.pk=Mt(()=>this.chart.pi.Bs()),this.vk=()=>{this.yk=void 0},this.D=new vt,this.index=t,this.chart=s,this.scale=r,this.As=n,this.fS=e.Tc(r,To.Simple).Ii(this.getHighlight()),this._s(this.fS),this.zh=i._n(r).Ii(this.getHighlight()),this._s(this.zh,{isText:!0})}setValue(t){return this.chart.getAnimationsEnabled()?this.getVisible()&&this.mk(this.gk,t,()=>this.chart.Os.forEach(t=>t.zs())):this.gk=t,this.M=t,this.chart.Os.forEach(t=>t.zs()),this.chart.pi.Bs(),this}getValue(){return this.M}setVisible(t){return!1===t?this.chart.getAnimationsEnabled()&&Math.abs(this.gk)>0?(this.yk&&(this.yk.finish(!1),this.yk=void 0),this.mk(this.gk,0,()=>super.setVisible(!1))):(this.gk=0,super.setVisible(!1)):this.chart.getAnimationsEnabled()?(this.yk&&(this.yk.finish(!1),this.yk=void 0),super.setVisible(!0),this.mk(this.gk,this.M)):(this.gk=this.M,super.setVisible(!0)),this}mk(t,e,i){this.yk=this.pk(300,St.ease)([[t,e]],([t])=>{this.gk=t,this.chart.pi.Bs()}),this.yk.addEventListener("everyAnimationEnd",this.vk),i&&this.yk.addEventListener("end",i)}setStyle(t,e,i,s,r){this.fk=t,this.Ak=i,this.fS.qe(this.fk).Ke(e),this.zh.qe(this.Ak).Ch(s).qh(r)}getAnimatedValue(){return this.gk}rr(t,e){return t.Ii(e),this.chart.pi.Bs(),this}er(){return{fill:this.fk,stroke:this.fS.Ja()}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}var Ku;e.SliceLabelIndices=void 0,(Ku=e.SliceLabelIndices||(e.SliceLabelIndices={}))[Ku.LabelsInsideSlices=0]="LabelsInsideSlices",Ku[Ku.LabelsOnSides=1]="LabelsOnSides";const Ju={SortByName:(t,e)=>t.getName().localeCompare(e.getName(),void 0,{numeric:!0}),SortByValueAscending:(t,e)=>Math.abs(t.getAnimatedValue())-Math.abs(e.getAnimatedValue()),SortByValueDescending:(t,e)=>Math.abs(e.getAnimatedValue())-Math.abs(t.getAnimatedValue()),None:()=>0},Qu={Name:t=>`${t.getName()}`,NamePlusValue:t=>`${t.getName()}: ${Math.round(t.getAnimatedValue())}`,NamePlusRelativeValue:(t,e)=>`${t.getName()}: ${(100*e).toFixed(2)}%`};var td;e.FunnelSliceModes=void 0,(td=e.FunnelSliceModes||(e.FunnelSliceModes={}))[td.VariableHeight=0]="VariableHeight",td[td.VariableWidth=1]="VariableWidth";const ed=(t,e)=>{let i=100;return t<=0?t=0:(i=t>=100?100:t,t=e*(i/100)),t},id=(t,i,s,r,n,o=0,a=e.FunnelSliceModes.VariableHeight,h,l)=>{i=ed(i,r.x),s=ed(s,r.x);const c=t.length;let u=0,d=0;u=t.reduce((t,e)=>t+Math.abs(e.getAnimatedValue()),0);let f={x:h-i/2+l.left,y:r.y+n.bottom+l.bottom},g={x:h+i/2+l.left,y:r.y+n.bottom+l.bottom},p={x:0,y:n.bottom},m={x:0,y:n.bottom},y=0,x=0;if(o)for(let i=0;i<t.length;i+=1){const s=t[i],h=10;x+=Math.abs(s.getAnimatedValue());const l=a===e.FunnelSliceModes.VariableWidth?(r.y-o*c)/c:r.y+n.bottom-x/u*r.y;if(a===e.FunnelSliceModes.VariableWidth){o=l-o<h?Math.max(20,l-h):o;break}0!==y&&y-l-o<h&&(o=Math.max(0,y-l-h)),y=l}const v=(i-s)/2/r.y;for(let y=0;y<c;y+=1){const x=t[y];d+=Math.abs(x.getAnimatedValue());const A=a===e.FunnelSliceModes.VariableWidth?(r.y-o*c)/c:r.y+n.bottom-d/u*r.y;let S=0;y>0&&(f={x:p.x+v*o,y:p.y-o},g={x:m.x-v*o,y:m.y-o}),S=(i+d/u*(s-i))/2,p={x:h-S+l.left,y:a===e.FunnelSliceModes.VariableWidth?f.y-A:A+l.bottom},m={x:h+S+l.left,y:a===e.FunnelSliceModes.VariableWidth?g.y-A:A+l.bottom},g.x>=f.x&&m.x>p.x&&x.fS.au([p,f,g,m])}};class sd extends Oh{constructor(t,i,s,r,n,o,a){var h;super(t,i,s,i.Hg("funnelChart bg",0),r,i.pi.bi.funnelChartBackgroundFillStyle,i.pi.bi.funnelChartBackgroundStrokeStyle,i.pi.bi.funnelChartTitleFont,i.pi.bi.funnelChartTitleFillStyle,i.pi.bi.funnelChartTitleShadow,o,null===(h=null==a?void 0:a.legend)||void 0===h?void 0:h.customLegend),this.xk=[],this.Sk=Ju.None,this.bk=!0,this.Mk=this.bi.funnelChartSliceLabelShadow,this.wk=0,this._k=20,this.kk=5,this.Ck=e.FunnelSliceModes.VariableHeight,this.Tk=!0,this.Fk=t=>{const e=this.xk.indexOf(t);e>=0&&(this.xk.splice(e,1),this.Ik())},this.D=new vt,this.pi.La(Hn.wo),this.Lk=this.bi.effectsText,this.Pk=i.Om("funnelChart bottom",0),this.Bk=i.Om("funnelChart top",1),this.Yr.tn("Funnel Chart"),this.Dk=this.bi.funnelChartSliceFillStylePalette,this.Ek=this.bi.funnelChartSliceStrokeStyle,this.Rk=this.bi.funnelChartSliceLabelFont,this.Ok=this.bi.funnelChartSliceLabelFillStyle;const l=i.Ym(),c=qt(a?a.cursorBuilder:void 0,Ol);this.jm=ig(this,l,c.Am(l,this.uiScale,this.uiScale,jt,this.bi),void 0,"show-pointed",rd,()=>0),this.setAnimationsEnabled(!1!==(null==a?void 0:a.animationsEnabled)),this.jg(n,this.eA);const u={backgroundVisible:!0,...null==a?void 0:a.legend};this.legend.setOptions(u)}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Ol){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}addSlice(t,e){const i=new qu(this.wk,this.Pk,this.Bk,this,this.eA,this.Fk,this.bi,this.pi.vs);return this.wk+=1,i.setName(t),i.setValue(e),i.vs.xs.Ps(this.Lk),i.vs.Ss.Ps(this.Tk),this.xk.push(i),this.pi.Bs(),i.setHighlightOnHover(this.bk),this.Os.forEach(t=>{t.xg()&&t.bu(i)}),i}addSlices(t){const e=[];for(let i=0;i<t.length;i+=1)e.push(this.addSlice(t[i].name,t[i].value));return e}getSlices(){return this.xk}setNeckWidth(t){return this._k=$t(t,1,99),this.pi.Bs(),this}getNeckWidth(){return this._k}setSliceGap(t){return this.kk=Math.min(Math.max(t,0),20),this.pi.Bs(),this}setSliceMode(t){return this.Ck=t,this.pi.Bs(),this}getFunnelSliceMode(){return this.Ck}setLUT(t){return this.Sf=t,this.pi.Bs(),this}setSliceFillStyle(t){return this.Dk=t,this.pi.Bs(),this}getSliceFillStyle(){return this.Dk}setSliceStrokeStyle(t){return this.Ek="function"==typeof t?t(this.Ek):t,this.pi.Bs(),this}getSliceStrokeStyle(){return this.Ek}setSliceEffect(t){return this.Tk=t,this.xk.forEach(e=>e.vs.Ss.Ps(t)),this.pi.Bs(),this}getSliceEffect(){return this.Tk}setSliceSorter(t){return this.Sk=t,this.xk=this.xk.sort(this.Sk),this.pi.Bs(),this}getSliceSorter(){return this.Sk}setLabelFillStyle(t){return this.Ok="function"==typeof t?t(this.Ok):t,this.pi.Bs(),this}getLabelFillStyle(){return this.Ok}setLabelShadow(t){return this.Mk=t,this.pi.Bs(),this}getLabelShadow(){return this.Mk}setLabelFont(t){return this.Rk="function"==typeof t?t(this.Rk):t,this.pi.Bs(),this}getLabelFont(){return this.Rk}setLabelEffect(t){return this.Lk=t,this.xk.forEach(e=>e.vs.xs.Ps(t)),this.pi.Bs(),this}getLabelEffect(){return this.Lk}setLabelFormatter(t){return this.zk=t,this.pi.Bs(),this}getLabelFormatter(){return this.zk}setSliceHighlightOnHover(t){return this.bk=t,this.xk.forEach(e=>e.setHighlightOnHover(t)),this}ir(t){super.ir(t),super.Yg(),this.xk=this.xk.sort(this.Sk);for(let t=0,{length:e}=this.xk;t<e;t+=1)this.Vk(this.xk[t],t);const e=this.xk.filter(t=>Math.abs(t.getAnimatedValue())>0),i=Uh.tp(this.Yr,this.Wg),s=this.Os.reduce((t,e)=>{const s=e.Nh(i,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,s);const r=l(this.eA.x.getInnerInterval()-(this.Gn.left+this.Gn.right),this.eA.y.getInnerInterval()-(this.Gn.bottom+this.Gn.top+i)),n=l(r.x-s.left-s.right,r.y-s.top-s.bottom),o=l(this.Gn.left+(r.x+s.left-s.right)/2,this.Gn.bottom+(r.y+s.bottom-s.top)/2);let a=0;for(let t=0;t<e.length;t+=1)a+=Math.abs(e[t].getAnimatedValue());const h=[];for(let t=0;t<e.length;t+=1)h.push((c=Math.abs(e[t].getAnimatedValue()))>0?c/a:0);var c;for(let t=0;t<e.length;t+=1){const i=e[t];i.zh.tn(this.zk(i,h[t])).Nh()}h.push(a),this.jm.ir(!1,this.xk,(t,i,s)=>{const r=h[e.indexOf(t)]||0,n=this.pi.il(i);return{cursorPosition:{pointMarker:{x:n.engineX,y:n.engineY},pointMarkerScale:this.pi.ai,resultTable:{x:n.engineX,y:n.engineY},resultTableScale:this.pi.ai},slice:t,category:t.getName(),value:t.getValue(),relativeValue:r}}),this.Os.forEach(t=>t.ir(i,this.Gn)),this.Nk(e,h,o,n,s)}Vk(t,e){t.setStyle(this.Sf?new fs({color:this.Sf.getColors(t.getAnimatedValue(),void 0)}):this.Dk(e,t),this.Ek,this.Ok,this.Rk,this.Mk)}Ik(){this.xk=this.xk.sort(this.Sk),this.pi.Bs()}bg(){return this.xk}dispose(){return this.xk.slice().forEach(t=>t.dispose()),this.jm.G(),this.Pk.G(),this.Bk.G(),super.dispose()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const rd=(t,e,i)=>[[{component:e.slice,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[{text:e.value.toString(),font:{weight:"bold"}}]],nd=(t,i,s)=>{const r=t.lu();if(0===r.length)return{x:0,y:0};let n;const o=(r[1].y-r[0].y)/2+r[0].y;return n=i===e.FunnelLabelSide.Left?(r[0].x-r[1].x)/2+r[1].x-s:(r[2].x-(4===r.length?r[3].x:r[1].x))/2+(4===r.length?r[3].x:r[1].x)+s,{x:n,y:o}},od=t=>{const e=t.lu();if(e.length>0)return{x:(e[2].x-e[1].x)/2+e[1].x,y:(e[1].y-e[0].y)/2+e[0].y}};class ad extends sd{constructor(){super(...arguments),this.zk=Qu.NamePlusValue,this.Gk=0,this.$k=10,this.Uk=30,this.Yk=10,this.jk=e.FunnelLabelSide.Left,this.Hk=[],this.Wk=this.bi.funnelChartConnectorStrokeStyle}setLabelConnectorStyle(t){this.Wk=t;for(let t=0;t<this.Hk.length;t+=1)this.Hk[t].cr(this.Wk);return this.pi.Bs(),this}getLabelConnectorStyle(){return this.Wk}setLabelConnectorGapBeforeLabel(t){return this.$k=t,this.pi.Bs(),this}getLabelConnectorGapBeforeLabel(){return this.$k}setLabelConnectorGapBeforeSlice(t){return this.Gk=t,this.pi.Bs(),this}getLabelConnectorGapBeforeSlice(){return this.Gk}setLabelConnectorLengthAfterSlice(t){return this.Uk=t,this.pi.Bs(),this}getLabelConnectorLengthAfterSlice(){return this.Uk}setLabelConnectorMinLengthBeforeSlice(t){return this.Yk=t,this.pi.Bs(),this}getLabelConnectorMinLengthBeforeSlice(){return this.Yk}setLabelSide(t){return this.jk=t,this.pi.Bs(),this}getLabelSide(){return this.jk}Nk(t,i,s,r,n){let o=0,a=0;for(let e=0;e<t.length;e+=1){const i=t[e].zh.setVisible(!0).Nh().bc();o=Math.max(o,i.x),a+=i.y}const h=.4*r.x,l=r.x-h-(this.Gk+this.Uk+this.Yk+this.$k);let c=!0;l<50?c=!1:o>l&&(t.forEach(t=>{const e=t.zh.rn(),i=t.zh.bc().x/e.length,s=Math.floor(l/i);if(s<e.length){const i=e.slice(0,s-3)+"...";t.zh.tn(i).Nh()}}),a=0,o=t.reduce((t,e)=>{const i=e.zh.bc();return a+=i.y,Math.max(t,i.x)},0));const u=this.jk===e.FunnelLabelSide.Left?this.Gn.left+n.left:this.Gn.left+r.x,d=this.jk===e.FunnelLabelSide.Left?-1:1,f=r.y-a;f<0&&(c=!1);const g=c?o+this.$k+this.Yk+this.Uk+this.Gk:0,p=r.x-g,m=this.jk===e.FunnelLabelSide.Left?this.Gn.left+g:this.Gn.left,y=this.jk===e.FunnelLabelSide.Left?m+p:this.Gn.left+p,x=(m+y)/2;id(t,100,this._k,{x:p,y:r.y},this.Gn,this.kk,this.Ck,x,n);const v=t.filter(t=>c&&0!==t.fS.lu().length?(t.zh.setVisible(!0),!0):(t.zh.setVisible(!1),!1)),A=f/(v.length+1);let S=this.Gn.bottom+r.y-(this.Ck==e.FunnelSliceModes.VariableHeight?A:0)+n.bottom;this.Ck==e.FunnelSliceModes.VariableWidth&&(S-=a/t.length/2);const b=this.jk===e.FunnelLabelSide.Left?m:y,M=this.jk===e.FunnelLabelSide.Left?x-.5*this._k/100*p:x+.5*this._k/100*p,E=this.Gn.bottom+r.y+n.bottom,k=this.Gn.bottom+n.bottom;for(let t=0;t<this.Hk.length;t+=1)this.Hk[t].setVisible(!1);for(let t=0;t<v.length;t+=1){const i=v[t],s=i.fS,r=i.zh,n=r.bc(),o=nd(s,this.jk,this.Gk);if(this.Ck==e.FunnelSliceModes.VariableHeight){i.zh.sr({x:u,y:S}).Zl({x:d,y:1});const t=S-.5*n.y,s={x:this.jk===e.FunnelLabelSide.Left?Math.min(Us(b,M,(t-E)/(k-E))-this.Uk,o.x):Math.max(Us(b,M,(t-E)/(k-E))+this.Uk,o.x),y:t},a={x:this.jk===e.FunnelLabelSide.Left?r.Vl().x+n.x+this.$k:r.Vl().x-n.x-this.$k,y:t};this.Xk([o,s,a]),S-=n.y+A}else{const t=this.jk===e.FunnelLabelSide.Left?u+n.x+this.$k:u-n.x-this.$k;i.zh.sr({x:u,y:o.y}).Zl({x:d,y:0}),this.Xk([o,{x:t,y:o.y}])}}}getMinimumSize(){return l(500,300)}Xk(t){if(t){let e;for(let t=0;t<this.Hk.length;t+=1)if(!this.Hk[t].getVisible()){e=this.Hk[t].setVisible(!0);break}void 0===e&&(e=this.Bk.Np(this.eA,void 0,[Wh.InternalUI]).cr(this.Wk),this.Hk.push(e)),e.Vi().bu(t)}}}class hd extends sd{constructor(){super(...arguments),this.zk=Qu.Name}Nk(t,e,i,s,r){const n=this.Gn.left+s.x/2;id(t,100,this._k,s,this.Gn,this.kk,this.Ck,n,r);for(let e=0;e<t.length;e+=1){const i=t[e],s=i.fS,r=i.zh,n=od(s);n&&r.sr(n).Yl(0).Wl(0)}}getMinimumSize(){return l(200,200)}}const ld={LabelsOnSides:ad,LabelsInsideSlices:hd};var cd,ud;e.FunnelLabelSide=void 0,(cd=e.FunnelLabelSide||(e.FunnelLabelSide={}))[cd.Right=0]="Right",cd[cd.Left=1]="Left";class dd extends $u{}class fd extends dd{constructor(t,e,i,s,r,n,o,a){super(s,n,o,a),this.dk=!1,this.Zk=ls,this.Ak=ls,this.gk=this.M,this.Jk=this.dk?1:0,this.Qk=this.getVisible(),this.pk=Mt(()=>this.chart.pi.Bs()),this.Kk=Mt(()=>this.chart.pi.Bs()),this.vk=()=>{this.yk=void 0},this.qk=()=>{this.tC=void 0},this.D=new vt,this.index=t,this.chart=s,this.scale=r,this.As=n,this.iC=e._d(r).Ii(this.getHighlight()),this._s(this.iC),this.zh=i._n(r).Ii(this.getHighlight()),this._s(this.zh,{isText:!0}),this.addEventListener("click",t=>{t.defaultPrevented||((t,e)=>{fe(e),t.setExploded(!t.getExploded())})(this,t)})}setValue(t){return this.chart.getAnimationsEnabled()?this.Qk&&this.mk(this.gk,t,()=>this.chart.Os.forEach(t=>t.zs())):this.gk=t,this.M=t,this.chart.Os.forEach(t=>t.zs()),this.chart.pi.Bs(),this}getValue(){return this.M}setExploded(t){if(t&&!1===this.chart.getMultipleSliceExplosion()){const t=this.chart.getSlices();for(let e=0;e<t.length;e+=1)t[e]!==this&&t[e].getExploded()&&t[e].setExploded(!1)}return this.chart.getAnimationsEnabled()?(this.tC&&this.tC.finish(),this.tC=this.Kk(300,St.ease)([[this.Jk,t?1:0]],([t])=>{this.Jk=t,this.chart.pi.Bs()}),this.tC.addEventListener("everyAnimationEnd",this.qk),this.dk=!this.dk):!1!==this.chart.getMultipleSliceExplosion()||t?(this.Jk=this.dk?0:1,this.dk=!this.dk):(this.Jk=0,this.dk=!this.dk),this.chart.pi.Bs(),this}getExploded(){return this.dk}setVisible(t){return this.Qk=t,!1===t?this.chart.getAnimationsEnabled()&&Math.abs(this.gk)>0?(this.yk&&(this.yk.finish(!1),this.yk=void 0),this.mk(this.gk,0,()=>super.setVisible(!1))):(this.gk=0,super.setVisible(!1)):this.chart.getAnimationsEnabled()?(this.yk&&(this.yk.finish(!1),this.yk=void 0),super.setVisible(!0),this.mk(this.gk,this.M)):(this.gk=this.M,super.setVisible(!0)),this}mk(t,e,i){this.yk=this.pk(300,St.ease)([[t,e]],([t])=>{this.gk=t,this.chart.pi.Bs()}),this.yk.addEventListener("everyAnimationEnd",this.vk),i&&this.yk.addEventListener("end",i)}setStyle(t,e,i,s,r){this.Zk=t,this.Ak=i,this.iC.qe(this.Zk).Ke(e),this.zh.qe(this.Ak).Ch(s).qh(r)}getAnimatedValue(){return this.gk}getAnimatedExplosion(){return this.Jk}er(){return{fill:this.Zk,stroke:this.iC.Ja()}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class gd extends $u{}class pd extends gd{constructor(t,e,i,s,r,n,o,a){super(s,n,o,a),this.Rs="Slice",this.M=0,this.dk=!1,this.fk=ls,this.Ak=ls,this.gk=this.M,this.pk=Mt(()=>this.chart.pi.Bs()),this.vk=()=>{this.yk=void 0},this.D=new vt,this.index=t,this.chart=s,this.scale=r,this.As=n,this.fS=e.Tc(r,To.Simple).Ii(this.getHighlight()),this._s(this.fS),this.zh=i._n(r).Ii(this.getHighlight()),this._s(this.zh,{isText:!0})}setValue(t){return this.chart.getAnimationsEnabled()?this.getVisible()&&this.mk(this.gk,t,()=>this.chart.Os.forEach(t=>t.zs())):this.gk=t,this.M=t,this.chart.Os.forEach(t=>t.zs()),this.chart.pi.Bs(),this}getValue(){return this.M}setVisible(t){return!1===t?this.chart.getAnimationsEnabled()&&Math.abs(this.gk)>0?(this.yk&&(this.yk.finish(!1),this.yk=void 0),this.mk(this.gk,0,()=>super.setVisible(!1))):(this.gk=0,super.setVisible(!1)):this.chart.getAnimationsEnabled()?(this.yk&&(this.yk.finish(!1),this.yk=void 0),super.setVisible(!0),this.mk(this.gk,this.M)):(this.gk=this.M,super.setVisible(!0)),this}mk(t,e,i){this.yk=this.pk(300,St.ease)([[t,e]],([t])=>{this.gk=t,this.chart.pi.Bs()}),this.yk.addEventListener("everyAnimationEnd",this.vk),i&&this.yk.addEventListener("end",i)}setStyle(t,e,i,s,r){this.fk=t,this.Ak=i,this.fS.qe(this.fk).Ke(e),this.zh.qe(this.Ak).Ch(s).qh(r)}getAnimatedValue(){return this.gk}er(){return{fill:this.fk,stroke:this.fS.Ja()}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}e.PyramidSliceModes=void 0,(ud=e.PyramidSliceModes||(e.PyramidSliceModes={}))[ud.VariableHeight=0]="VariableHeight",ud[ud.VariableWidth=1]="VariableWidth";const md=(t,e)=>{let i=100;return t<=0?t=0:(i=t>=100?100:t,t=e*(i/100)),t},yd=(t,i,s,r,n,o=0,a=e.PyramidSliceModes.VariableHeight,h,l=Xe)=>{i=md(i,r.x),s=md(s,r.x);const c=t.length;let u=0,d=0;u=t.reduce((t,e)=>t+Math.abs(e.getAnimatedValue()),0);let f={x:h-i/2+l.left,y:r.y+n.bottom+l.bottom},g={x:h+i/2+l.left,y:r.y+n.bottom+l.bottom},p={x:0,y:n.bottom},m={x:0,y:n.bottom},y=0,x=0;if(o)for(let i=0;i<t.length;i+=1){const s=10;x+=Math.abs(t[i].getAnimatedValue());const h=a===e.PyramidSliceModes.VariableWidth?(r.y-o*c)/c:r.y+n.bottom-x/u*r.y;if(a===e.PyramidSliceModes.VariableWidth){o=h-o<s?Math.max(20,h-s):o;break}0!==y&&y-h-o<s&&(o=Math.max(0,y-h-s)),y=h}const v=(i-s)/2/r.y;for(let y=0;y<c;y+=1){const x=t[y];d+=Math.abs(x.getAnimatedValue());const A=a===e.PyramidSliceModes.VariableWidth?(r.y-o*c)/c:r.y+n.bottom-d/u*r.y;let S=0;y>0&&(f={x:p.x+v*o,y:p.y-o},g={x:m.x-v*o,y:m.y-o}),S=(i+d/u*(s-i))/2,p={x:h-S+l.left,y:a===e.PyramidSliceModes.VariableWidth?f.y-A:A+l.bottom},m={x:h+S+l.left,y:a===e.PyramidSliceModes.VariableWidth?g.y-A:A+l.bottom},g.x>=f.x&&m.x>=p.x&&x.fS.au([p,f,g,m])}};class xd extends Oh{constructor(t,i,s,r,n,o,a){var h;super(t,i,s,i.Hg("pyramidChart bg",0),r,i.pi.bi.pyramidChartBackgroundFillStyle,i.pi.bi.pyramidChartBackgroundStrokeStyle,i.pi.bi.pyramidChartTitleFont,i.pi.bi.pyramidChartTitleFillStyle,i.pi.bi.pyramidChartTitleShadow,o,null===(h=null==a?void 0:a.legend)||void 0===h?void 0:h.customLegend),this.xk=[],this.Sk=Ju.None,this.Dk=this.bi.pyramidChartSliceFillStylePalette,this.Ek=this.bi.pyramidChartSliceStrokeStyle,this.bk=!0,this.Rk=this.bi.pyramidChartSliceLabelFont,this.Ok=this.bi.pyramidChartSliceLabelFillStyle,this.Mk=this.bi.pyramidChartSliceLabelShadow,this.wk=0,this._k=100,this.kk=5,this.Ck=e.PyramidSliceModes.VariableHeight,this.Tk=!0,this.Fk=t=>{const e=this.xk.indexOf(t);e>=0&&(this.xk.splice(e,1),this.Ik())},this.D=new vt,this.pi.La(Hn.wo),this.Lk=this.bi.effectsText,this.Pk=i.Om("pyramidChart bottom",0),this.Bk=i.Om("pyramidChart top",1),this.Yr.tn("Pyramid Chart");const l=i.Ym(),c=qt(a?a.cursorBuilder:void 0,Ol);this.jm=ig(this,l,c.Am(l,this.uiScale,this.uiScale,jt,this.bi),void 0,"show-pointed",vd,()=>0),this.jg(n,this.eA),this.setAnimationsEnabled(!1!==(null==a?void 0:a.animationsEnabled));const u={backgroundVisible:!0,...null==a?void 0:a.legend};this.legend.setOptions(u)}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Ol){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}addSlice(t,e){const i=new pd(this.wk,this.Pk,this.Bk,this,this.eA,this.Fk,this.bi,this.pi.vs);return this.wk+=1,i.setName(t),i.setValue(e),i.vs.xs.Ps(this.Lk),i.vs.Ss.Ps(this.Tk),this.xk.push(i),this.pi.Bs(),this.Os.forEach(t=>{t.xg()&&t.bu(i)}),i}addSlices(t){const e=[];for(let i=0;i<t.length;i+=1)e.push(this.addSlice(t[i].name,t[i].value));return e}getSlices(){return this.xk}setNeckWidth(t){return this._k=$t(t,1,100),this.pi.Bs(),this}getNeckWidth(){return this._k}setSliceGap(t){return this.kk=Math.min(Math.max(t,0),20),this.pi.Bs(),this}setSliceMode(t){return this.Ck=t,this.pi.Bs(),this}getPyramidSliceMode(){return this.Ck}setLUT(t){return this.Sf=t,this.pi.Bs(),this}setSliceFillStyle(t){return this.Dk=t,this.pi.Bs(),this}getSliceFillStyle(){return this.Dk}setSliceStrokeStyle(t){return this.Ek="function"==typeof t?t(this.Ek):t,this.pi.Bs(),this}getSliceStrokeStyle(){return this.Ek}setSliceEffect(t){return this.Tk=t,this.xk.forEach(e=>e.vs.Ss.Ps(t)),this.pi.Bs(),this}getSliceEffect(){return this.Tk}setSliceSorter(t){return this.Sk=t,this.xk=this.xk.sort(this.Sk),this.pi.Bs(),this}getSliceSorter(){return this.Sk}setLabelFillStyle(t){return this.Ok="function"==typeof t?t(this.Ok):t,this.pi.Bs(),this}getLabelFillStyle(){return this.Ok}setLabelShadow(t){return this.Mk=t,this.pi.Bs(),this}getLabelShadow(){return this.Mk}setLabelFont(t){return this.Rk="function"==typeof t?t(this.Rk):t,this.pi.Bs(),this}getLabelFont(){return this.Rk}setLabelEffect(t){return this.Lk=t,this.xk.forEach(e=>e.vs.xs.Ps(t)),this.pi.Bs(),this}getLabelEffect(){return this.Lk}setLabelFormatter(t){return this.zk=t,this.pi.Bs(),this}getLabelFormatter(){return this.zk}setSliceHighlightOnHover(t){return this.bk=t,this.xk.forEach(e=>e.setHighlightOnHover(t)),this}ir(t){super.ir(t),super.Yg(),this.xk=this.xk.sort(this.Sk);for(let t=0,{length:e}=this.xk;t<e;t+=1)this.Vk(this.xk[t],t);const e=this.xk.filter(t=>Math.abs(t.getAnimatedValue())>0),i=Uh.tp(this.Yr,this.Wg),s=this.Os.reduce((t,e)=>{const s=e.Nh(i,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,s);const r=l(this.eA.x.getInnerInterval()-(this.Gn.left+this.Gn.right),this.eA.y.getInnerInterval()-(this.Gn.bottom+this.Gn.top+i)),n=l(r.x-s.left-s.right,r.y-s.top-s.bottom),o=l(this.Gn.left+(r.x+s.left-s.right)/2,this.Gn.bottom+(r.y+s.bottom-s.top)/2);let a=0;for(let t=0;t<e.length;t+=1)a+=Math.abs(e[t].getAnimatedValue());const h=[];for(let t=0;t<e.length;t+=1)h.push((c=Math.abs(e[t].getAnimatedValue()))>0?c/a:0);var c;for(let t=0;t<e.length;t+=1){const i=e[t];i.zh.tn(this.zk(i,h[t])).Nh()}h.push(a),this.jm.ir(!1,this.xk,(t,i,s)=>{const r=h[e.indexOf(t)]||0,n=this.pi.il(i);return{cursorPosition:{pointMarker:{x:n.engineX,y:n.engineY},pointMarkerScale:this.pi.ai,resultTable:{x:n.engineX,y:n.engineY},resultTableScale:this.pi.ai},slice:t,category:t.getName(),value:t.getValue(),relativeValue:r}}),this.Os.forEach(t=>t.ir(i,this.Gn)),this.Nk(e,h,o,n,s)}Vk(t,e){t.setStyle(this.Sf?new fs({color:this.Sf.getColors(t.getAnimatedValue(),void 0)}):this.Dk(e,t),this.Ek,this.Ok,this.Rk,this.Mk)}Ik(){this.xk=this.xk.sort(this.Sk),this.pi.Bs()}bg(){return this.xk}dispose(){return this.xk.slice().forEach(t=>t.dispose()),this.jm.G(),this.Pk.G(),this.Bk.G(),super.dispose()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const vd=(t,e,i)=>[[{component:e.slice,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[{text:e.value.toString(),font:{weight:"bold"}}]],Ad=(t,i,s)=>{const r=t.lu();if(0===r.length)return{x:0,y:0};let n;const o=(r[1].y-r[0].y)/2+r[0].y;return n=i===e.PyramidLabelSide.Left?(r[0].x-r[1].x)/2+r[1].x-s:(r[2].x-(4===r.length?r[3].x:r[1].x))/2+(4===r.length?r[3].x:r[1].x)+s,{x:n,y:o}},Sd=t=>{const e=t.lu();if(e.length>0)return{x:(e[2].x-e[1].x)/2+e[1].x,y:(e[1].y-e[0].y)/2+e[0].y}};class bd extends xd{constructor(){super(...arguments),this.zk=Qu.NamePlusValue,this.Gk=0,this.$k=10,this.Uk=30,this.Yk=10,this.jk=e.PyramidLabelSide.Left,this.sC=e.SliceLabelIndices.LabelsOnSides,this.Hk=[],this.Wk=this.bi.pyramidChartConnectorStrokeStyle}setLabelConnectorStyle(t){this.Wk=t;for(let t=0;t<this.Hk.length;t+=1)this.Hk[t].cr(this.Wk);return this.pi.Bs(),this}getLabelConnectorStyle(){return this.Wk}setLabelConnectorGapBeforeLabel(t){return this.$k=t,this.pi.Bs(),this}getLabelConnectorGapBeforeLabel(){return this.$k}setLabelConnectorGapBeforeSlice(t){return this.Gk=t,this.pi.Bs(),this}getLabelConnectorGapBeforeSlice(){return this.Gk}setLabelConnectorLengthAfterSlice(t){return this.Uk=t,this.pi.Bs(),this}getLabelConnectorLengthAfterSlice(){return this.Uk}setLabelConnectorMinLengthBeforeSlice(t){return this.Yk=t,this.pi.Bs(),this}getLabelConnectorMinLengthBeforeSlice(){return this.Yk}setLabelSide(t){return this.jk=t,this.pi.Bs(),this}getLabelSide(){return this.jk}Nk(t,i,s,r,n){let o=0,a=0;for(let e=0;e<t.length;e+=1){const i=t[e].zh.bc();o=Math.max(o,i.x),a+=i.y}const h=.4*r.x,l=r.x-h-(this.Gk+this.Uk+this.Yk+this.$k);let c=!0;l<50?c=!1:o>l&&(t.forEach(t=>{const e=t.zh.rn(),i=t.zh.bc().x/e.length,s=Math.floor(l/i);if(s<e.length){const i=e.slice(0,s-3)+"...";t.zh.tn(i).Nh()}}),a=0,o=t.reduce((t,e)=>{const i=e.zh.bc();return a+=i.y,Math.max(t,i.x)},0));const u=this.jk===e.PyramidLabelSide.Left?this.Gn.left+n.left:this.Gn.left+r.x,d=this.jk===e.PyramidLabelSide.Left?-1:1,f=r.y-a;f<0&&(c=!1);const g=c?o+this.$k+this.Yk+this.Uk+this.Gk:0,p=r.x-g,m=this.jk===e.PyramidLabelSide.Left?this.Gn.left+g:this.Gn.left,y=this.jk===e.PyramidLabelSide.Left?m+p:this.Gn.left+p,x=(m+y)/2;yd(t,.001,this._k,{x:p,y:r.y},this.Gn,this.kk,this.Ck,x,n);const v=t.filter(t=>c&&0!==t.fS.lu().length?(t.zh.setVisible(!0),!0):(t.zh.setVisible(!1),!1)),A=f/(v.length+1);let S=this.Gn.bottom+r.y-(this.Ck==e.PyramidSliceModes.VariableHeight?A:0)+n.bottom;this.Ck==e.PyramidSliceModes.VariableWidth&&(S-=a/t.length/2);const b=x,M=this.jk===e.PyramidLabelSide.Left?m:y,E=this.Gn.bottom+r.y+n.bottom,k=this.Gn.bottom+n.bottom;for(let t=0;t<this.Hk.length;t+=1)this.Hk[t].setVisible(!1);for(let t=0;t<v.length;t+=1){const i=v[t],s=i.fS,r=i.zh,n=r.bc(),o=Ad(s,this.jk,this.Gk);if(this.Ck==e.PyramidSliceModes.VariableHeight){i.zh.sr({x:u,y:S}).Zl({x:d,y:1});const t=S-.5*n.y,s={x:this.jk===e.PyramidLabelSide.Left?Math.min(Us(b,M,(t-E)/(k-E))-this.Uk,o.x):Math.max(Us(b,M,(t-E)/(k-E))+this.Uk,o.x),y:t},a={x:this.jk===e.PyramidLabelSide.Left?r.Vl().x+n.x+this.$k:r.Vl().x-n.x-this.$k,y:t};this.Xk([o,s,a]),S-=n.y+A}else{const t=this.jk===e.PyramidLabelSide.Left?u+n.x+this.$k:u-n.x-this.$k;i.zh.sr({x:u,y:o.y}).Zl({x:d,y:0}),this.Xk([o,{x:t,y:o.y}])}}}getMinimumSize(){return l(500,300)}Xk(t){let e;for(let t=0;t<this.Hk.length;t+=1)if(!this.Hk[t].getVisible()){e=this.Hk[t].setVisible(!0);break}void 0===e&&(e=this.Bk.Np(this.eA,void 0,[Wh.InternalUI]).cr(this.Wk),this.Hk.push(e)),e.Vi().bu(t)}}class Md extends xd{constructor(){super(...arguments),this.zk=Qu.Name,this.sC=e.SliceLabelIndices.LabelsInsideSlices}Nk(t,e,i,s,r){const n=this.Gn.left+s.x/2;yd(t,.001,this._k,s,this.Gn,this.kk,this.Ck,n,r);for(let e=0;e<t.length;e+=1){const i=t[e].fS,s=t[e].zh,r=Sd(i);r&&s.sr(r).Yl(0).Wl(0)}}getMinimumSize(){return l(200,200)}}const Ed={LabelsOnSides:bd,LabelsInsideSlices:Md};var kd,Td;e.PyramidLabelSide=void 0,(kd=e.PyramidLabelSide||(e.PyramidLabelSide={}))[kd.Right=0]="Right",kd[kd.Left=1]="Left",e.SpiderWebMode=void 0,(Td=e.SpiderWebMode||(e.SpiderWebMode={}))[Td.Normal=0]="Normal",Td[Td.Circle=1]="Circle";class wd{constructor(t,e,i,s,r,n,o,a,h){this.Rr=!1,this.eC=yn.fitting({start:!1}),this.rC=t=>this.axisScale.Xt(t,Qi.Numeric),this.formatValue=t=>this.rC(t,{start:this.axisScale.$,end:this.axisScale.U}),this.hC=t,this.Cn=e,this.scale=i,this.chart=s,this.tag=r,this.axisScale=J.d1({scale1DConstructor:H,dimension:"x"}).W(0,1),this.nC=n,this.eC=a,h&&(this.rC=h),o&&this.setInterval(o),this.oC=this.hC.dr(this.scale).setPointerEvents(!1),this.aC=this.Cn._n(this.scale).tn(this.tag).setPointerEvents(!1),this.lC=this.hC.Np(this.scale,void 0,[Wh.InternalUI]).cr(this.chart.getNibStyle()),this.nC.ks([this.aC])}Nk(t,i,s,r,n,o,a){const h=i.length,c=i[s>0?s-1:h-1],u=i[s],d=i[s<h-1?s+1:0],f=this.chart.getNibLength();this.oC.gr(t).Ar(u).cr(this.chart.getAxisStyle()),this.lC.Vi().bu(o===e.SpiderWebMode.Normal?[Ai(u,c,$t(.5*f/Ii(Pi(c,u)),0,1)),u,Ai(u,d,$t(.5*f/Ii(Pi(d,u)),0,1))]:((t,e,i,s,r=2)=>{const n=s/i,o=[];for(let a=-s/2;a<=s/2;a+=r){const r=n*(a/s)+e,h=l(t.x+Math.cos(r)*i,t.y+Math.sin(r)*i);o.push(h)}return o})(t,r,n,f)),a?this.aC.setVisible(!0).sr(Li(u,l(a.paddingX,a.paddingY))).Yl(a.alignmentX).Wl(a.alignmentY):this.aC.setVisible(!1)}pn(t){if(this.eC&&!this.Rr){const e=this.eC.apply({axis:this,curStart:this.axisScale.getInnerStart(),curEnd:this.axisScale.getInnerEnd(),seriesDataRange:t});e&&this.axisScale.W(e.start,e.end)}}getLabelSize(){return this.aC.Ch(this.chart.getAxisLabelFont()).qe(this.chart.getAxisLabelStyle()).Nh().kt()}dispose(){this.oC&&this.oC.dispose(),this.aC&&this.aC.dispose(),this.lC&&this.lC.dispose()}getTag(){return this.tag}setInterval(t){const{start:e,end:i,stopAxisAfter:s}=t;return void 0!==s&&(this.Rr=s),this.axisScale.W(null!=e?e:this.axisScale.getInnerStart(),null!=i?i:this.axisScale.getInnerEnd()),this.chart.pi.Bs(),this}getInterval(){return{start:this.axisScale.getInnerStart(),end:this.axisScale.getInnerEnd()}}setScaleLabelFormatter(t){return this.rC=t,this.chart.pi.Bs(),this}setScrollStrategy(t){return this.eC=Fn(t),this.chart.pi.Bs(),this}getScrollStrategy(){return this.eC}}const Cd=(t,e,i,s,r,n)=>(t.alignmentX=(r+Math.PI/2)%(2*Math.PI)<=Math.PI?-1:1,t.alignmentY=r%(2*Math.PI)<=Math.PI?-1:1,t.paddingX=Math.cos(r)*n,t.paddingY=Math.sin(r)*n,t),Bd=t=>{if(0===t.axisIndex)return t.paddingX=t.labelPadding,t.alignmentX=-1,t;let e=!1;const i=t.chart.getAxes();if(i.length>1){const t=i[0].getInterval();e=i.some(e=>{const i=e.getInterval();return i.start!==t.start||i.end!==t.end})}return e?(t.paddingX=t.labelPadding,t.alignmentX=-1,t):void 0};class Fd extends mc{constructor(t,i,s,r,n,o,a,h,l,c,u,d){super(t,l,c,d),this.Rs="Spider Series",this.uC=new Map,this.cC=new Map,this.ds=e.HighlightModes.onHover,this.z_=8,this._l=0,this.dC=(()=>{const t=Mt(()=>{});let e;return(i,s,r,n)=>{const o=null==n?void 0:n.onStart,a=null==n?void 0:n.onCompleted,h=(null==n?void 0:n.easing)||St.ease,l=(null==n?void 0:n.durationMs)||1e3;let c;if(e)if(0===e.nextAnimations.length){const t=e.NextAnimation([[i,s]],([i])=>{e=t,r(i)},l,h);c=t}else{i=e.nextAnimations.pop().values[0][0];const t=e.NextAnimation([[i,s]],([i])=>{e=t,r(i)},l,h);c=t}else c=t(l,h)([[i,s]],([t])=>{r(t)}),e=c;c.addEventListener("end",()=>{e=void 0}),o&&c.addEventListener("start",o),a&&c.addEventListener("end",a)}})(),this.fC={},this.AC={},this.Qk=this.getVisible(),this.gC=1,this.pC=((t,e)=>{const i=Mt(()=>{});let s,r,n=1;return(o,a,h)=>{if(o===r)return;r=o;const l=(null==h?void 0:h.easing)||St.ease,c=(null==h?void 0:h.durationMs)||1e3;s&&(s.finish(!1),s=void 0),!1===o?a&&n&&(s=i(c,l)([[n,0]],([e])=>{n=e,t(n)}),s.addEventListener("end",()=>{s=void 0,e(!1)}),n=0,e(!1)):a?(e(!0),s=i(c,l)([[n,1]],([e])=>{n=e,t(n)}),s.addEventListener("end",()=>{s=void 0})):(n=1,e(!0))}})(t=>{this.gC=t,this.Ws.pi.Bs()},t=>{super.setVisible(t)}),this.vC=!1,this.D=new vt,this.chart=t,this.Ws=i,this.V_=r,this.yC=n,this.zm=o,this.mC=a,this.xC=h,this.scale=s,this.SC=ze(c.spiderSeriesFillStyle,u),this.bC=ze(c.spiderSeriesStrokeStyle,u),this.MC=ze(c.spiderSeriesPointFillStyle,u)}wC(){return this.vC}Qi(t,e,i){const s=this.xC(e);if(void 0!==s&&this.uC.has(s.tag)){const t=this.uC.get(s.tag),e=this.mC(s.tag,t);return{cursorPosition:{pointMarker:e,pointMarkerScale:this.scale,resultTable:e,resultTableScale:this.scale},series:this,axis:s.tag,value:t}}}xp(){return this.rp&&this.uC.size>0&&this.getVisible()}addPoints(...t){const e=0===this.uC.size;e||this.chart.pi.La(Hn.Ro),t=t.filter(t=>void 0!==t.axis);for(let e=0;e<t.length;e+=1){const i=t[e].axis;this.yC(i)}if(this.chart.getAnimationsEnabled()&&void 0!==this.fC){let i;t.forEach(t=>this.cC.set(t.axis,t.value)),this.dC(0,1,t=>{this.cC.forEach((e,s)=>{const r=(null==i?void 0:i.get(s))||0;this.uC.set(s,r+t*(e-r)),this.Ws.pi.Bs()})},{easing:this.fC.easing,durationMs:this.fC.durationMs,onStart:()=>{this.vC=e,i=new Map(this.uC)},onCompleted:()=>{this.vC=!1}})}else for(let e=0;e<t.length;e+=1){const i=t[e].axis;this.uC.set(i,t[e].value),this.cC.set(i,t[e].value)}return this.Ws.Bs(),this}getValue(t,e=!1){if(this.chart.getAxis(t))return e?this.uC.get(t):this.cC.get(t)}setAnimationAddPoints(t,e){return this.fC=t?{easing:t,durationMs:e}:void 0,this.Ws.Bs(),this}setVisibleStateChangedAnimation(t,e){return this.AC=t?{easing:t,durationMs:e}:void 0,this.Ws.Bs(),this}setFillStyle(t){return this.SC="function"==typeof t?t(this.SC):t,this.fS&&(this.fS.qe(this.SC),this.Ws.Bs()),this}getFillStyle(){return this.SC}setStrokeStyle(t){return this.bC="function"==typeof t?t(this.bC):t,this.fS&&(this.fS.Ke(this.bC),this.Ws.Bs()),this}getStrokeStyle(){return this.bC}setPointFillStyle(t){return this.MC="function"==typeof t?t(this.MC):t,this.N_&&(this.N_.Rd(this.MC),this.Ws.Bs()),this}getPointFillStyle(){return this.MC}setPointSize(t){return this.z_=t,this.N_&&this.N_.Hd(t),this}getPointSize(){return this.z_}getPointShape(){return this.V_}setPointRotation(t){return this._l=t,this.N_&&this.N_.Gd(t),this.Ws.Bs(),this}getPointRotation(){return this._l}ir(){if(super.ir(),!this.ci){const t=new Array(this.zm.length);for(let e=0;e<this.zm.length;e+=1){const i=this.zm[e].getInterval().start,s=this.uC.get(this.zm[e].tag);t[e]=void 0!==s?this.mC(this.zm[e].tag,i+this.gC*(s-i)):this.mC(this.zm[e].tag,i)}Ee(t),t.length>=3&&(this.fS||(this.fS=this.Ws.Tc(this.scale,To.Simple).Ke(this.bC).qe(this.SC).Ii(this.getHighlight()),this._s(this.fS)),this.fS.au(t),this.N_||(this.N_=this.Ws.zd(this.scale).Od(ls).cr(Bt).Hd(this.z_).Vd(this.V_).Gd(this._l).Rd(this.MC).Ii(this.getHighlight()),this._s(this.N_)),this.N_.Ed(new Vo({schema:{x:{pattern:null},y:{pattern:null}}}).appendJSON(t),{x:"x",y:"y"}))}}er(){return{fill:this.SC,stroke:this.bC}}js(){return this.Es||this.V_}rr(t,e){return t.Ii(e),this.Ws.Bs(),this}setVisible(t){var e,i;return this.Qk=t,this.pC(t,this.chart.getAnimationsEnabled()&&void 0!==this.AC,{easing:null===(e=this.AC)||void 0===e?void 0:e.easing,durationMs:null===(i=this.AC)||void 0===i?void 0:i.durationMs}),this}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Dd=(t,e)=>{const i=Math.PI/2-2*t*Math.PI/e;return i>=0?i:i+2*Math.PI},Id=t=>t.aC.mc(),Rd=t=>t.mc(),Ld=(t,i,s,r)=>t.sc(0).sr(s).Qu(90).Ar(-270).rc(i===e.SpiderWebMode.Circle?void 0:r.length),Pd={alignmentX:0,alignmentY:0,paddingX:0,paddingY:0},zd={alignmentX:0,alignmentY:0,paddingX:0,paddingY:0},_d=()=>{zd.alignmentX=0,zd.alignmentY=0,zd.paddingX=0,zd.paddingY=0};class Vd extends hl{constructor(t,i,s,r,n,o,a){var h;super(t,i,s,i.Hg("spiderChart bg",0),r,i.pi.bi.spiderChartBackgroundFillStyle,i.pi.bi.spiderChartBackgroundStrokeStyle,i.pi.bi.spiderChartTitleFont,i.pi.bi.spiderChartTitleFillStyle,i.pi.bi.spiderChartTitleShadow,a,null===(h=null==o?void 0:o.legend)||void 0===h?void 0:h.customLegend),this.zm=[],this._C=[],this.kC=[],this.eC=yn.fitting({start:!1}),this.CC=!0,this.TC=Bd,this.FC=Cd,this.IC=e.SpiderWebMode.Normal,this.LC=4,this.PC=this.bi.spiderChartWebStyle,this.BC=this.bi.spiderChartScaleLabelFillStyle,this.DC=this.bi.spiderChartScaleLabelShadow,this.EC=this.bi.spiderChartScaleLabelFont,this.RC=5,this.OC=this.bi.spiderChartAxisLabelFillStyle,this.zC=this.bi.spiderChartAxisLabelFont,this.VC=5,this.NC=this.bi.spiderChartAxisStrokeStyle,this.GC=this.bi.spiderChartAxisNibStrokeStyle,this.$C=10,this.UC=y(),this.hasAxis=t=>this.zm.reduce((e,i)=>e||i.tag===t,!1),this.YC=()=>{const t=this.zm.map(Id).concat(this.kC.map(Rd));return fi(t)},this.jC=()=>this.HC._d(this.eA).setPointerEvents(!1),this.WC=t=>t.dispose(),this.XC=()=>this.jf._n(this.eA).setPointerEvents(!1),this.ZC=t=>t.dispose(),this.JC=t=>{this.CC&&!this.hasAxis(t)&&this.addAxis(t)},this.mC=(t,e)=>{for(const i of this.zm)if(i.tag===t){const t=Math.max(Math.min((e-i.axisScale.getInnerStart())/(i.axisScale.getInnerEnd()-i.axisScale.getInnerStart()),1),0);return Ai(i.oC.Yt(),i.oC.$t(),t)}},this.xC=t=>{if(0===this.zm.length)return;const e=Pi(this.translateCoordinate(t,this.coordsRelative),this.zm[0].oC.Yt()),i=Math.atan2(e.y,e.x);let s,r=ni;for(const t of this.zm){const e=Pi(t.oC.$t(),t.oC.Yt()),n=Math.atan2(e.y,e.x),o=Math.abs(i-n);o<r&&(s=t,r=o)}return s},this.D=new vt,this.pi.La(Hn.ko),this.a_=i.Rm("spiderChart series bg",0),this.HC=i.Om("spiderChart web shapes",0),this.QC=i.Om("spiderChart axis bg",1),this.bx=i.Om("spiderChart plotting",2),this.jf=i.Om("spiderChart fg",3),this.nC=this.vs.aA().Ps(this.bi.effectsText),this.Yr.tn("Spider Chart"),this.yv=this.a_._d(this.eA).qe(this.bi.spiderChartSeriesBackgroundFillStyle).Ke(Bt).Qu(90).Ar(-270).sc(0),this.mv=this.a_._d(this.eA).qe(ls).Ke(this.bi.spiderChartSeriesBackgroundStrokeStyle).Qu(90).Ar(-270).sc(0),super.vv(this.yv,this.mv);const l=i.Ym(),c=qt(o?o.cursorBuilder:void 0,Vl);this.jm=ig(this,l,c.Am(l,this.uiScale,this.uiScale,jt,this.bi),this,"show-pointed",Nd,()=>0),this.setAnimationsEnabled(!1!==(null==o?void 0:o.animationsEnabled)),this.jg(n,this.eA);const u={backgroundVisible:!0,...null==o?void 0:o.legend};this.legend.setOptions(u)}getSeries(){return this.fv}getAxes(){return this.zm}getAxis(t){const e=this.zm.find(e=>e.getTag()===t);if(!e)throw new Error(`Axis with tag "${t}" was not found.`);return e}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Vl){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}addAxis(t){const e=this.zm.find(e=>e.tag===t);if(e)return e;const i=new wd(this.QC,this.jf,this.eA,this,t,this.nC,this.KC,this.eC,this.scaleLabelFormatter);return this.zm.push(i),this.nC.ks(this.zm.map(t=>t.aC)),this.pi.Bs(),i}addSeries(t){const i=void 0!==(null==t?void 0:t.pointShape)?t.pointShape:e.PointShape.Circle,s=void 0!==(null==t?void 0:t.automaticColorIndex)?t.automaticColorIndex:this.fv.length,r=new Fd(this,this.bx,this.eA,i,this.JC,this.zm,this.mC,this.xC,this.gv,this.bi,s,this.pi.vs);return this.xv(r,t),r}getSeriesCount(){return this.fv.length}setWebMode(t){return this.IC=t,this.pi.Bs(),this}getWebMode(){return this.IC}setWebCount(t){return this.LC=t,this.pi.Bs(),this}getWebCount(){return this.LC}setWebStyle(t){return this.PC="function"==typeof t?t(this.PC):t,this.pi.Bs(),this}getWebStyle(){return this.PC}setScaleLabelStyle(t){return this.BC="function"==typeof t?t(this.BC):t,this.pi.Bs(),this}getScaleLabelStyle(){return this.BC}setScaleLabelShadow(t){return this.DC=t,this.pi.Bs(),this}getScaleLabelShadow(){return this.DC}setScaleLabelFont(t){return this.EC="function"==typeof t?t(this.EC):t,this.pi.Bs(),this}getScaleLabelFont(){return this.EC}setScaleLabelPadding(t){return this.RC=t,this.pi.Bs(),this}getScaleLabelPadding(){return this.RC}setScaleLabelStrategy(t){return this.TC=t,this.pi.Bs(),this}setScaleLabelFormatter(t){return this.scaleLabelFormatter=t,this.zm.forEach(e=>{e.setScaleLabelFormatter(t)}),this.pi.Bs(),this}setAxisLabelStyle(t){return this.OC="function"==typeof t?t(this.OC):t,this.pi.Bs(),this}getAxisLabelStyle(){return this.OC}setAxisLabelFont(t){return this.zC="function"==typeof t?t(this.zC):t,this.pi.Bs(),this}getAxisLabelFont(){return this.zC}setAxisLabelEffect(t){return this.nC.Ps(t),this.pi.Bs(),this}getAxisLabelEffect(){return this.nC.Ds()}setAxisLabelPadding(t){return this.VC=t,this.pi.Bs(),this}getAxisLabelPadding(){return this.VC}setAxisLabelStrategy(t){return this.FC=t,this.pi.Bs(),this}setAxisStyle(t){return this.NC="function"==typeof t?t(this.NC):t,this.pi.Bs(),this}getAxisStyle(){return this.NC}setNibStyle(t){return this.GC="function"==typeof t?t(this.GC):t,this.pi.Bs(),this}getNibStyle(){return this.GC}setNibLength(t){return this.$C=t,this.pi.Bs(),this}getNibLength(){return this.$C}setAutoAxis(t){return this.CC=t,this}getAutoAxis(){return this.CC}setScrollStrategy(t){return this.eC=Fn(t),this.zm.forEach(e=>e.setScrollStrategy(t)),this.pi.Bs(),this}setAxisInterval(t){return this.KC=t,this.zm.forEach(e=>e.setInterval(t)),this}ir(t){super.ir(t);const e=this.zm.length,i=Uh.tp(this.Yr,this.Wg),s=this.Os.reduce((t,e)=>{const s=e.Nh(i,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,s);const r=l(this.eA.x.getInnerInterval()-(this.Gn.left+this.Gn.right),this.eA.y.getInnerInterval()-(this.Gn.bottom+this.Gn.top+i)),n=l(r.x-s.left-s.right,r.y-s.top-s.bottom),o=((t=0,e=0,i=0,s=0)=>({left:t,top:e,right:i,bottom:s}))(0,0,0,0);if(void 0!==this.FC){const t=Math.min(n.x,n.y)/2;for(let i=0;i<e;i+=1){const s=Dd(i,e),r=Math.cos(s),n=Math.sin(s),a=this.zm[i].getLabelSize();_d();const h=this.FC(zd,i,e,this.zm[i].tag,s,this.VC),c=l(r*t+h.paddingX,n*t+h.paddingY);r>0?o.right=Math.max(o.right,c.x+.5*(1-h.alignmentX)*a.x-t):o.left=Math.max(o.left,-c.x+.5*(h.alignmentX+1)*a.x-t),n>0?o.top=Math.max(o.top,c.y+.5*(1-h.alignmentY)*a.y-t):o.bottom=Math.max(o.bottom,-c.y+.5*(h.alignmentY+1)*a.y-t)}}this.zm.forEach(t=>{const e=!this.getSeries().some(t=>t.wC())&&this.getSeriesCount()>1,i=this.qC(t.tag,e);i&&t.pn(i)});const a=l(this.eA.x.getInnerStart()+this.Gn.left+s.left+n.x/2,this.eA.y.getInnerStart()+this.Gn.bottom+s.bottom+n.y/2),h=Math.min(n.x/2-(o.left+o.right)/2,n.y/2-(o.bottom+o.top)/2);this.UC=y(this.ot.left+this.Gn.left+o.left,this.ot.top+this.Gn.top+i+o.top,this.ot.right+this.Gn.right+o.right,this.ot.bottom+this.Gn.bottom+o.bottom),this.Nk(a,h);for(const t of this.fv)t.cp();for(const t of this.fv)t.ir();this.jm.ir(!1,this.fv,void 0),super.Yg(),this.Os.forEach(t=>t.ir(i,this.Gn));for(const t of this.fv)t.dp()}dispose(){return this.a_.G(),this.HC.G(),this.QC.G(),this.bx.G(),this.jf.G(),this.jm.G(),super.dispose()}getMinimumSize(){return l(this.UC.left+this.UC.right+100,this.UC.bottom+this.UC.top+100)}Nk(t,e){const i=this.zm.length,s=[];for(let r=0;r<i;r+=1){const n=Dd(r,i),o=l(t.x+Math.cos(n)*e,t.y+Math.sin(n)*e);s.push(o)}Ld(this.yv,this.IC,t,s),Ld(this.mv,this.IC,t,s),this.yv.Ku(e),this.mv.Ku(e),((t,e,i,s,r,n,o,a)=>{const h=t.length,l=n.length,c=e>0&&l>1;for(let l=0;l<Math.max(e,h);l+=1)if(c&&l<e){l>=h&&t.push(o());const a=t[l];Ld(a,i,s,n);const c=r*((l+1)/e);a.Ku(c)}else l<t.length&&a(t[l]);t.length=c?e:0})(this._C,this.LC,this.IC,t,e,s,this.jC,this.WC);for(const t of this._C)t.qe(ls).Ke(this.PC);for(let r=0;r<i;r+=1){const n=this.zm[r],o=Dd(r,i);_d();const a=void 0!==this.FC?this.FC(zd,r,i,this.zm[r].tag,o,this.VC):void 0;n.Nk(t,s,r,o,e,this.IC,a)}((t,e,i,s,r,n,o,a,h)=>{const c=r.length,u=t.length;let d=0;void 0!==e&&r.forEach((r,h)=>{var f,g,p,m;const y=r.tag,x=Dd(h,c);for(let v=0;v<i;v+=1){Pd.alignmentX=0,Pd.alignmentY=0,Pd.paddingX=0,Pd.paddingY=0;const A=e({...Pd,chart:r.chart,axis:r,axisIndex:h,axisCount:c,axisTag:y,axisAngle:x,webIndex:v,webCount:i,labelPadding:s});if(void 0!==A){d>=u&&t.push(a());const e=t[d];d+=1;const s=(i-v)/i,c=r.formatValue(r.axisScale.getInnerStart()+s*(r.axisScale.getInnerEnd()-r.axisScale.getInnerStart())),y=Ai(n,o[h],s);e.sr(Li(y,l(null!==(f=A.paddingX)&&void 0!==f?f:0,null!==(g=A.paddingY)&&void 0!==g?g:0))).Yl(null!==(p=A.alignmentX)&&void 0!==p?p:0).Wl(null!==(m=A.alignmentY)&&void 0!==m?m:0).tn(c)}}});for(let e=d;e<u;e+=1)h(t[e]);t.length=d})(this.kC,this.TC,this.LC,this.RC,this.zm,t,s,this.XC,this.ZC);for(const t of this.kC)t.qe(this.BC).Ch(this.EC).qh(this.DC)}qC(t,e){let i,s;const r=this.getAxis(t);for(const t of this.fv){const n=t.getValue(r.tag,e);void 0!==n&&(i=void 0===i?n:Math.min(i,n),s=void 0===s?n:Math.max(s,n))}if(void 0!==i&&void 0!==s)return g(i,s)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Nd=(t,e,i)=>Jf(e,[[{component:e.series,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[e.axis],[{text:t.getAxis(e.axis).formatValue(e.value),font:{weight:"bold"}}]]),Od={Rr:!1,Or:0,zr:!1,Nr:0,Vr:!1,Gr:0,$r:0,Rh:yn.fitting({})},Ud=t=>{if(!t||"object"!=typeof t||null===t)return!1;const e=t.type;return!(!e||!["spark-line","spark-bar","spark-win-loss","spark-area","spark-pie"].includes(e))},Gd=(t,e,i,s,r,n,o,a)=>{const{type:h,data:l}=t;if(0===l.length)return;const c=[s,r];"spark-line"===h&&Kd(t,e,c,n,o,a),"spark-bar"===h&&Jd({...t,winLoss:!1},e,c,n,o,a),"spark-win-loss"===h&&Jd({...t,winLoss:!0},e,c,n,o,a),"spark-area"===h&&Qd(t,e,c,n,o,a),"spark-pie"===h&&tf(t,e,c,n,o,a)},Yd=(t,e,i,s)=>({x:Wd(t.x,e.x,i.x,s),y:jd(t.y,e.y,i.y,s)}),Zd=(t,e,i,s)=>({position:Wd(t.position,e.x,i.x,s),high:jd(t.high,e.y,i.y,s),low:jd(t.low,e.y,i.y,s)}),Wd=(t,e,i,s)=>{const r=$t(t,e,e+i);return s[0].x+s[1].x*(r-e)/i},jd=(t,e,i,s)=>{const r=$t(t,e,e+i);return s[0].y+s[1].y*(r-e)/i},Hd=(t,e,i,s,r,n,o,a)=>{for(const h of t)"point"===h.type&&$d(h,e,i,r,n,o,a),"axis-band"===h.type&&Xd(h,i,r,n,o,a),"constant-line"===h.type&&qd(h,i,s,r,n,o,a)},$d=(t,i,s,r,n,o,a)=>{const{value:h,fillStyle:l,shape:c,size:u,rotation:d}=t;let f={x:NaN,y:NaN};if("start"===h&&(f=i[0]),"end"===h&&(f=i[i.length-1]),"min"===h){f=i[0];for(const t of i)f=f.y<t.y?f:t}if("max"===h){f=i[0];for(const t of i)f=f.y>t.y?f:t}("object"!=typeof h||(f=Yd(h,s,r,n),((t,e)=>{const i=e[0],s=e[1],r=t.x,n=t.y;return i.x<=r&&r<=i.x+s.x&&i.y<=n&&n<=i.y+s.y})(f,n)))&&o.pointSet.add().Vd(void 0!==c?c:e.PointShape.Circle).Gd(d||0).Hd(u||5).Rd(l||a.sparkPointChartFillStyle).Ed((new Vo).appendSample(f),{x:"x",y:"y"})},Xd=(t,e,i,s,r,n)=>{const{axis:o,start:a,end:h,fillStyle:c,strokeStyle:u}=t;let d=l(oi,ni),f=l(oi,ni);"x"===o&&(d=Yd({x:a,y:oi},e,i,s),f=Yd({x:h,y:ni},e,i,s)),"y"===o&&(d=Yd({x:oi,y:a},e,i,s),f=Yd({x:ni,y:h},e,i,s));const g=s[0],p=s[1],m=$t(d.x,g.x,g.x+p.x),y=$t(d.y,g.y,g.y+p.y),x=$t(f.x,g.x,g.x+p.x),v=$t(f.y,g.y,g.y+p.y);r.rect.add().tu(m).iu(y).Z(l(x-m,v-y)).qe(c||n.sparkChartBandFillStyle).Ke(u||n.sparkChartBandStrokeStyle).Ke(Bt)},qd=(t,e,i,s,r,n,o)=>{const{axis:a,value:h,strokeStyle:c}=t,u=h||0,d=e.y,f=i.y,g=e.x,p=i.x,m=[];if("y"===a&&d<=u&&u<=f){const t=Yd(l(g,u),{x:g,y:d},s,r),e=Yd(l(p,u),{x:g,y:d},s,r);m.push([t,e])}if("x"===a&&g<=u&&u<=p){const t=Yd(l(u,d),{x:g,y:d},s,r),e=Yd(l(u,f),{x:g,y:d},s,r);m.push([t,e])}m.length>0&&n.line.add().cr(c||o.sparkChartConstantLineStrokeStyle).gr(m[0][0]).Ar(m[0][1])},Kd=(t,e,i,s,r,n)=>{const{strokeStyle:o,data:a,markers:h}=t,l=a.length;l>1e4&&r.Ea&&Ut.console.warn("LightningChart JS warning: SparkLineChart has over 10000 data points. This feature is not designed for large data sets which might show as performance drop. If you want to request improvements to this, contact https://lightningchart.com/js-charts/docs/contact. To disable this warning, use LightningChartOptions.warning property (refer to API documentation for more detail).");let c=ni,u=oi,d=ni,f=oi;for(let t=0;t<l;t+=1){const e=a[t];c=Math.min(c,e.x),u=Math.max(u,e.x),d=Math.min(d,e.y),f=Math.max(f,e.y)}const g={x:u-c,y:f-d},p=a.map(t=>Yd(t,{x:c,y:d},g,i));e.lineSet.add().Ii(n).cr(o||s.sparkLineChartStrokeStyle).Vi().bu(p),h&&Hd(h,p,{x:c,y:d},{x:u,y:f},g,i,e,s)},Jd=(t,e,i,s,r,n)=>{const{data:o,fillStyle:a,strokeStyle:h,threshold:l,winFillStyle:c,lossFillStyle:u}=t,d=t.barSize||1,f=t.gap||1,g=t.winLoss,p=l||0,m=f/d*1;let y=ni,x=oi;if(g)y=-1,x=1;else for(const t of o)y=Math.min(y,t),x=Math.max(x,t);const v={x:0,y:g?-1:Math.min(0,y)},A={x:1*o.length+(o.length-1)*m,y:g?2:Math.max(x,1e-5)};o.map((t,e)=>{const s={x:1*(e+1)+e*m,y:g?t>=p?1:0:t},r=Yd({x:1*e+e*m,y:g?t>=p?0:-1:0},v,A,i),n=Yd(s,v,A,i);return{value:t,position:r,width:n.x-r.x,height:n.y-r.y}}).forEach(t=>{var i;e.rect.add().Ii(n).sr(t.position).eu(t.height).su(t.width).qe((i=t.value,g?(i>=p?c:u)||s.sparkBarChartFillStyle:a||s.sparkBarChartFillStyle)).Ke(h||s.sparkBarChartStrokeStyle)})},Qd=(t,e,i,s,r,n)=>{const{data:o,fillStyle:a,strokeStyle:h,markers:l}=t,c=o.length;c>1e4&&r.Ea&&Ut.console.warn("LightningChart JS warning: SparkAreaChart has over 10000 data points. This feature is not designed for large data sets which might show as performance drop. If you want to request improvements to this, contact https://lightningchart.com/js-charts/docs/contact. To disable this warning, use LightningChartOptions.warning property (refer to API documentation for more detail).");let d=ni,f=oi,g=ni,p=oi;for(let t=0;t<c;t+=1){const e=o[t];d=Math.min(d,e.x),f=Math.max(f,e.x),g=Math.min(g,e.y),p=Math.max(p,e.y)}const m={x:f-d,y:p-g},y=[],x=[];for(const t of o){const e=u(t.x,t.y,g);y.push(Zd(e,{x:d,y:g},m,i)),x.push(Yd(t,{x:d,y:g},m,i))}e.junction.add().Ii(n).Vi().bu(y).qe(a||s.sparkAreaChartFillStyle),e.lineSet.add().Ii(n).Vi().bu(x).cr(h||s.sparkAreaChartStrokeStyle),l&&Hd(l,x,{x:d,y:g},{x:f,y:p},m,i,e,s)},tf=(t,e,i,s,r,n)=>{const{data:o,strokeStyle:a}=t,h=o.map(t=>"number"==typeof t?t:t.value),c=o.map(t=>"object"==typeof t?t.fillStyle:void 0),u=h.reduce((t,e)=>t+e,0),d=Yd(l(50,50),{x:0,y:0},{x:100,y:100},i),f=i[1],g=f.x<=f.y?f.x/2:f.y/2;let p=90;h.forEach((t,i)=>{const r=t/u*360;e.arc.add().Ii(n).sr(d).Ku(g).sc(0).Qu(p).Ar(p+r).qe(c[i]||ze(s.sparkPieChartFillStyle,i)).Ke(a||s.sparkPieChartStrokeStyle),p+=r})},ef={XY:uu,Spider:Vl,BarChart:Nl,Map:Yl,Polar:Gl,D3:Bl},sf={Column:ca,Row:ua},rf=(t,i)=>{const s=(t=>{const i=M(0,0,0),s=M(255,255,255),r=new fs({color:t.uiStrokeColorContrastHigh}),n=new fs({color:t.uiStrokeColorContrastMedium}),o=new fs({color:t.uiStrokeColorContrastLow}),a=new I({family:t.fontFamily,weight:"normal",style:"normal"}),h=t.isDark?M(0,0,0,255):void 0,l=a.setSize(18*t.fontScaler),c=a.setSize(16*t.fontScaler),u=a.setSize(14*t.fontScaler),d=a.setSize(10*t.fontScaler),f=a.withMutations(e=>e.set("size",14*t.fontScaler).set("weight","bold")),g=a.setSize(13*t.fontScaler),p=new lr({thickness:2,fillStyle:o}),m=new fs({color:t.dataHighlightOverlayColor}),y=new lr({thickness:2,fillStyle:t.legendBackgroundBorderFillStyle}),x=t.dataColorPalette.map(t=>new fs({color:t.stroke})),v=t=>x[t%x.length],A=x.map(t=>new lr({thickness:2,fillStyle:t})),S=t=>A[t%A.length],b=t.dataColorPalette.map(t=>new fs({color:t.border})).map(t=>new lr({thickness:2,fillStyle:t})),k=t=>b[t%b.length],T=t.dataColorPalette.map(t=>{const e=t.area;return new U({angle:0,stops:[{offset:0,color:e.setA(0)},{offset:.8,color:e}]})}),w=t=>T[t%T.length],C=t.dataColorPaletteInverted.map(t=>{const e=t.area;return new U({angle:180,stops:[{offset:0,color:e.setA(0)},{offset:.8,color:e}]})}),B=t=>C[t%C.length],F=t.dataColorPalette.map(t=>{const e=t.area;return new U({angle:180,stops:[{color:at(e,M(255,255,255,e.getA()),.3),offset:0},{color:e,offset:.5},{color:at(e,M(0,0,0,e.getA()),.3),offset:1}]})}),D=t=>F[t%F.length],R=t.dataColorPaletteInverted.map(t=>new fs({color:t.border})).map(t=>new lr({thickness:2,fillStyle:t})),L=t=>R[t%R.length],P=new fs({color:t.dataColorPositive}),z=new fs({color:t.dataColorNegative}),_=new lr({thickness:1,fillStyle:new fs({color:t.dataStrokeColorContrastHigh.setA(50)})}),V=new lr({thickness:2,fillStyle:t.axisLineFillStyle}),N=new fs({color:M(0,0,0,1)}),O=new lr({thickness:1,fillStyle:t.axisGridMajorFillStyle}),G=new lr({thickness:1,fillStyle:t.axisTickMajorFillStyle}),Y=u,Z=t.axisLabelMajorFillStyle,W=new lr({thickness:1,fillStyle:t.axisGridMinorFillStyle}),j=new lr({thickness:1,fillStyle:t.axisTickMinorFillStyle}),H=d,$=Z,X=Ga,q=new Oa({gridStrokeStyle:O,tickStyle:G,tickLength:7,tickPadding:5,labelFont:Y,labelFillStyle:Z,labelShadow:h}),K=new Oa({gridStrokeStyle:W,tickStyle:j,tickLength:4,tickPadding:10,labelFont:H,labelFillStyle:$,labelShadow:h}),J=new Sh({extremeTickStyle:X,majorTickStyle:q,minorTickStyle:K.setLabelFillStyle(ls)}),Q=new fh({greatTickStyle:Ga,majorTickStyle:q,minorTickStyle:K}),tt=Q,et=Q,it=new Qa({majorTickStyle:q,minorTickStyle:K}),st=new fs({color:t.dataHighlightOverlayColor}),rt=new lr({thickness:1,fillStyle:n}),nt=new lr({thickness:2,fillStyle:n}),ot=t=>new ar.Triangulated({shape:"sphere",size:10,fillStyle:x[t%x.length]}),ht=x[0],lt=t.uiTextFillStyle,ct=t.legendBackgroundFillStyle,ut=new lr({thickness:1,fillStyle:t.legendBackgroundBorderFillStyle}),dt=De(t.legendButtonDefaultColor),ft=De(t.isDark?M(70,70,70,255):M(170,170,170,255)),gt=new fs({color:t.isDark?M(70,70,70,255):M(170,170,170,255)}),pt=new lr({thickness:1,fillStyle:r}),mt=new fr({thickness:1,fillStyle:t.cursorGridFillStyle,pattern:ur.DashedEqual,patternScale:3}),yt=new lr({thickness:1,fillStyle:t.cursorGridFillStyle}),xt=t.zoomBandChartDefocusOverlayFillStyle,vt=new lr({thickness:2,fillStyle:new fs({color:t.zoomBandChartSplitterColor})}),At=new fs({color:t.uiBackgroundColor}),St=new lr({thickness:1,fillStyle:new fs({color:t.isDark?s:i})});let bt={isDark:t.isDark,effect:t.effect,effectsText:t.effectsText,effectsDashboardSplitters:t.effectsDashboardSplitters,lcjsBackgroundFillStyle:t.lcjsBackgroundFillStyle,lcjsBackgroundStrokeStyle:Bt,highlightColorOffset:t.highlightColorOffset,highlightColorOffsetAxisOverlay:t.highlightColorOffsetAxisOverlay,dashboardSplitterStyle:new lr({thickness:4,fillStyle:t.dashboardSplitterFillStyle}),panelPadding:7,chartXYBackgroundFillStyle:t.panelBackgroundFillStyle,chartXYBackgroundStrokeStyle:Bt,chartXYTitleFont:l,chartXYTitleFillStyle:t.titleFillStyle,chartXYTitleShadow:h,chartXYTitleMargin:5,chartXYSeriesBackgroundFillStyle:t.seriesBackgroundFillStyle,chartXYSeriesBackgroundStrokeStyle:p,chartXYZoomingRectangleFillStyle:m,chartXYZoomingRectangleStrokeStyle:y,lineSeriesStrokeStyle:S,pointLineSeriesStrokeStyle:S,pointLineSeriesFillStyle:v,pointSeriesFillStyle:v,pointSeriesStrokeStyle:St,ellipseSeriesFillStyle:v,ellipseSeriesStrokeStyle:S,polygonSeriesFillStyle:v,polygonSeriesStrokeStyle:S,rectangleSeriesFillStyle:v,rectangleSeriesStrokeStyle:Bt,segmentSeriesStrokeStyle:S,boxSeriesBodyFillStyle:v(0),boxSeriesBodyStrokeStyle:Bt,boxSeriesStrokeStyle:new lr({thickness:1,fillStyle:x[0]}),boxSeriesMedianStrokeStyle:new lr({thickness:1,fillStyle:new fs({color:i})}),ohlcCandleThicknessPixels:5,ohlcCandleBodyFillStylePositive:P,ohlcCandleBodyFillStyleNegative:z,ohlcCandleTailStrokeStylePositive:new lr({thickness:1,fillStyle:new fs({color:t.uiStrokeColorContrastHigh})}),ohlcCandleTailStrokeStyleNegative:new lr({thickness:1,fillStyle:new fs({color:t.uiStrokeColorContrastHigh})}),ohlcBarThicknessPixels:10,ohlcBarStrokeStylePositive:new lr({thickness:2,fillStyle:P}),ohlcBarStrokeStyleNegative:new lr({thickness:2,fillStyle:z}),heatmapGridSeriesFillStyle:v,heatmapGridSeriesWireframeStyle:_,heatmapScrollingGridSeriesFillStyle:v,heatmapScrollingGridSeriesWireframeStyle:_,heatmapGridSeriesContourStrokeStyle:new lr({thickness:1,fillStyle:new fs({color:M(0,0,0)})}),heatmapGridSeriesContourLabelColor:gs(lt)?lt.getColor():ht.getColor(),heatmapGridSeriesContourLabelFont:g,heatmapGridSeriesContourLabelShadow:h,areaRangeSeriesFillStyle:w,areaRangeSeriesStrokeStyle:k,areaRangeSeriesFillStyleInverted:B,areaRangeSeriesStrokeStyleInverted:L,areaSeriesBipolarHighFillStyle:w,areaSeriesBipolarHighStrokeStyle:k,areaSeriesBipolarLowFillStyle:B,areaSeriesBipolarLowStrokeStyle:L,areaSeriesPositiveFillStyle:w,areaSeriesPositiveStrokeStyle:k,areaSeriesNegativeFillStyle:B,areaSeriesNegativeStrokeStyle:L,xAxisTitleFont:c,xAxisTitleFillStyle:t.axisTitleFillStyle,xAxisStrokeStyle:V,xAxisOverlayStyle:N,xAxisZoomingBandFillStyle:m,xAxisZoomingBandStrokeStyle:Bt,xAxisNumericTicks:J,xAxisDateTimeTicks:tt,xAxisTimeTicks:it,yAxisTitleFont:c,yAxisTitleFillStyle:t.axisTitleFillStyle,yAxisStrokeStyle:V,yAxisOverlayStyle:N,yAxisZoomingBandFillStyle:m,yAxisZoomingBandStrokeStyle:Bt,yAxisNumericTicks:J,yAxisDateTimeTicks:et,yAxisTimeTicks:it,bandFillStyle:st,bandStrokeStyle:rt,constantLineStrokeStyle:nt,barChartBackgroundFillStyle:t.panelBackgroundFillStyle,barChartBackgroundStrokeStyle:Bt,barChartTitleFont:l,barChartTitleFillStyle:t.titleFillStyle,barChartTitleShadow:h,barChartSeriesBackgroundFillStyle:ls,barChartSeriesBackgroundStrokeStyle:Bt,barChartBarFillStyle:v,barChartBarStrokeStyle:new lr({thickness:1,fillStyle:o}),barChartValueAxisTitleFont:c,barChartValueAxisTitleFillStyle:t.axisTitleFillStyle,barChartValueAxisStrokeStyle:V,barChartValueAxisTicks:J.setMajorTickStyle(t=>t.setGridStrokeStyle(Bt)).setMinorTickStyle(t=>t.setGridStrokeStyle(Bt)),barChartCategoryAxisTitleFont:c,barChartCategoryAxisTitleFillStyle:t.axisTitleFillStyle,barChartCategoryAxisStrokeStyle:V,barChartCategoryLabels:{formatter:(t,e)=>t,labelFillStyle:J.majorTickStyle.labelFillStyle,labelFont:J.majorTickStyle.labelFont,labelMargin:8,labelRotation:0,labelAlignment:0,tickStyle:J.majorTickStyle.tickStyle,tickLength:0,labelShadow:h},barChartValueLabelsAfterBars:{position:"after-bar",formatter:t=>t.chart.valueAxis.formatValue(t.value),labelFillStyle:J.majorTickStyle.labelFillStyle,labelFont:J.majorTickStyle.labelFont,labelMargin:8,labelRotation:0,labelAlignment:0,displayStackedIndividuals:!1,displayStackedSum:!0,labelShadow:h},barChartValueLabelsInsideBars:{position:"inside-bar",formatter:t=>t.chart.valueAxis.formatValue(t.value),labelFillStyle:J.majorTickStyle.labelFillStyle,labelFont:J.majorTickStyle.labelFont,labelMargin:8,labelRotation:0,labelAlignment:0,displayStackedIndividuals:!1,displayStackedSum:!0,labelShadow:h},barChartCornerRadius:10,chart3DBackgroundFillStyle:t.panelBackgroundFillStyle,chart3DBackgroundStrokeStyle:Bt,chart3DTitleFont:l,chart3DTitleFillStyle:t.titleFillStyle,chart3DTitleShadow:h,chart3DSeriesBackgroundFillStyle:t.seriesBackgroundFillStyle,chart3DSeriesBackgroundStrokeStyle:p,chart3DBoundingBoxStrokeStyle:Bt,xAxis3DTitleFont:c,xAxis3DTitleFillStyle:t.axisTitleFillStyle,xAxis3DStrokeStyle:V,xAxis3DNumericTicks:J,xAxis3DDateTimeTicks:Q,xAxis3DTimeTicks:it,yAxis3DTitleFont:c,yAxis3DTitleFillStyle:t.axisTitleFillStyle,yAxis3DStrokeStyle:V,yAxis3DNumericTicks:J,yAxis3DDateTimeTicks:Q,yAxis3DTimeTicks:it,zAxis3DTitleFont:c,zAxis3DTitleFillStyle:t.axisTitleFillStyle,zAxis3DStrokeStyle:V,zAxis3DNumericTicks:J,zAxis3DDateTimeTicks:Q,zAxis3DTimeTicks:it,lineSeries3DStrokeStyle:S,pointLineSeries3DStrokeStyle:S,pointLineSeries3DPointStyle:ot,pointSeries3DPointStyle:ot,pointCloudSeries3DPointStyle:t=>new ar.Pixelated({size:5,fillStyle:x[t%x.length]}),surfaceGridSeries3DFillStyle:v,surfaceGridSeries3DWireframeStyle:_,surfaceGridSeriesContourStrokeStyle:A[0],surfaceScrollingGridSeries3DFillStyle:v,surfaceScrollingGridSeries3DWireframeStyle:_,boxSeries3DFillStyle:v,meshModel3DFillStyle:v(0),polarChartBackgroundFillStyle:t.panelBackgroundFillStyle,polarChartBackgroundStrokeStyle:Bt,polarChartTitleFont:l,polarChartTitleFillStyle:t.titleFillStyle,polarChartTitleShadow:h,polarChartSeriesBackgroundFillStyle:t.seriesBackgroundFillStyle,polarChartSeriesBackgroundStrokeStyle:p,polarSectorFillStyle:st,polarSectorStrokeStyle:rt,polarAmplitudeAxisTitleFont:c,polarAmplitudeAxisTitleFillStyle:t.axisTitleFillStyle,polarAmplitudeAxisTitleShadow:h,polarAmplitudeAxisStrokeStyle:V,polarAmplitudeAxisNumericTicks:J,polarAmplitudeAxisDateTimeTicks:Q,polarAmplitudeAxisTimeTicks:it,polarRadialAxisTitleFont:c,polarRadialAxisTitleFillStyle:t.axisTitleFillStyle,polarRadialAxisStrokeStyle:V,polarRadialAxisTickStyle:q.setTickPadding(10),polarRadialAxisMarginAfterTicks:0,polarLineSeriesStrokeStyle:S,polarPointLineSeriesFillStyle:v,polarPointLineSeriesStrokeStyle:S,polarPointSeriesFillStyle:v,polarPointSeriesStrokeStyle:St,polarPolygonSeriesFillStyle:D,polarPolygonSeriesStrokeStyle:k,polarAreaSeriesFillStyle:D,polarAreaSeriesStrokeStyle:k,polarHeatmapSeriesFillStyle:v,mapChartBackgroundFillStyle:t.panelBackgroundFillStyle,mapChartBackgroundStrokeStyle:Bt,mapChartTitleFont:l,mapChartTitleFillStyle:t.titleFillStyle,mapChartTitleShadow:h,mapChartFillStyle:ht,mapChartStrokeStyle:new lr({thickness:1,fillStyle:new fs({color:t.dataStrokeColorContrastMedium})}),mapChartOutlierRegionFillStyle:ls,mapChartOutlierRegionStrokeStyle:new lr({thickness:1,fillStyle:o}),mapChartSeparateRegionFillStyle:ct,mapChartSeparateRegionStrokeStyle:ut,dataGridBackgroundFillStyle:t.panelBackgroundFillStyle,dataGridBackgroundStrokeStyle:Bt,dataGridTitleFont:l,dataGridTitleFillStyle:t.titleFillStyle,dataGridTitleShadow:h,dataGridTextFont:u,dataGridTextFillStyle:ht,dataGridCellBackgroundFillStyle:new fs({color:t.uiBackgroundColor}),dataGridBorderStrokeStyle:new lr({thickness:.4,fillStyle:new fs({color:t.uiBackgroundBorderColor})}),dataGridScrollBarBackgroundFillStyle:t.seriesBackgroundFillStyle,dataGridScrollBarBackgroundStrokeStyle:Bt,dataGridScrollBarFillStyle:t.seriesBackgroundFillStyle,dataGridScrollBarStrokeStyle:ut,dataGridScrollBarButtonFillStyle:t.seriesBackgroundFillStyle,dataGridScrollBarButtonStrokeStyle:ut,dataGridScrollBarButtonArrowFillStyle:new fs({color:t.legendButtonDefaultColor}),dataGridScrollBarThickness:20,dataGridCellPadding:5,sparkLineChartStrokeStyle:S(0),sparkPointChartFillStyle:v(0),sparkBarChartFillStyle:v(0),sparkBarChartStrokeStyle:k(0),sparkAreaChartFillStyle:w(0),sparkAreaChartStrokeStyle:k(0),sparkPieChartFillStyle:v,sparkPieChartStrokeStyle:ut,sparkChartBandFillStyle:st,sparkChartBandStrokeStyle:rt,sparkChartConstantLineStrokeStyle:nt,dataGridTextShadow:h,textSeriesShadow:h,spiderChartBackgroundFillStyle:t.panelBackgroundFillStyle,spiderChartBackgroundStrokeStyle:Bt,spiderChartTitleFont:l,spiderChartTitleFillStyle:t.titleFillStyle,spiderChartTitleShadow:h,spiderChartSeriesBackgroundFillStyle:t.seriesBackgroundFillStyle,spiderChartSeriesBackgroundStrokeStyle:p,spiderChartWebStyle:new lr({thickness:2,fillStyle:o}),spiderChartScaleLabelFillStyle:t.axisLabelMajorFillStyle,spiderChartScaleLabelFont:u,spiderChartAxisLabelFillStyle:t.axisTitleFillStyle,spiderChartAxisLabelFont:c,spiderChartAxisStrokeStyle:new lr({thickness:2,fillStyle:n}),spiderChartAxisNibStrokeStyle:new lr({thickness:2,fillStyle:r}),spiderSeriesFillStyle:D,spiderSeriesStrokeStyle:k,spiderSeriesPointFillStyle:v,spiderChartScaleLabelShadow:h,pieChartBackgroundFillStyle:t.panelBackgroundFillStyle,pieChartBackgroundStrokeStyle:Bt,pieChartTitleFont:l,pieChartTitleFillStyle:t.titleFillStyle,pieChartTitleShadow:h,pieChartSliceFillStylePalette:v,pieChartSliceStrokeStyle:ut,pieChartSliceLabelFont:g,pieChartSliceLabelFillStyle:t.uiTextFillStyle,pieChartConnectorStrokeStyle:pt,pieChartSliceLabelShadow:h,funnelChartBackgroundFillStyle:t.panelBackgroundFillStyle,funnelChartBackgroundStrokeStyle:Bt,funnelChartTitleFont:l,funnelChartTitleFillStyle:t.titleFillStyle,funnelChartTitleShadow:h,funnelChartSliceFillStylePalette:v,funnelChartSliceStrokeStyle:ut,funnelChartSliceLabelFont:g,funnelChartSliceLabelFillStyle:t.uiTextFillStyle,funnelChartConnectorStrokeStyle:pt,funnelChartSliceLabelShadow:h,pyramidChartBackgroundFillStyle:t.panelBackgroundFillStyle,pyramidChartBackgroundStrokeStyle:Bt,pyramidChartTitleFont:l,pyramidChartTitleFillStyle:t.titleFillStyle,pyramidChartTitleShadow:h,pyramidChartSliceFillStylePalette:v,pyramidChartSliceStrokeStyle:ut,pyramidChartSliceLabelFont:g,pyramidChartSliceLabelFillStyle:t.uiTextFillStyle,pyramidChartConnectorStrokeStyle:pt,gaugeChartValueLabelFont:g.setSize(60),gaugeChartUnitLabelFont:g.setSize(40),gaugeChartTickFont:g.setSize(30),gaugeChartBarThickness:40,gaugeChartValueIndicatorThickness:10,gaugeChartRoundedEdges:!0,gaugeChartNeedleLength:40,gaugeChartStartAngle:225,gaugeChartEndAngle:-45,gaugeChartNeedleAlignment:0,gaugeChartGapBetweenBarAndValueIndicators:10,gaugeChartTickFillStyle:t.uiTextFillStyle,gaugeChartBarGradient:!0,gaugeChartBarStrokeStyle:Bt,gaugeChartUnitLabelFillStyle:t.uiTextFillStyle,gaugeChartValueLabelFillStyle:t.uiTextFillStyle,gaugeChartBarColor:s,gaugeChartGlowColor:M(255,255,64),gaugeChartNeedleFillStyle:new fs({color:s}),gaugeChartNeedleThickness:10,gaugeChartNeedleStrokeStyle:new lr({thickness:2,fillStyle:new fs({color:i})}),pyramidChartSliceLabelShadow:h,gaugeChartBackgroundFillStyle:t.panelBackgroundFillStyle,gaugeChartBackgroundStrokeStyle:Bt,gaugeChartTitleFont:l,gaugeChartTitleFillStyle:t.titleFillStyle,gaugeChartTitleShadow:h,treeMapChartBackgroundFillStyle:t.panelBackgroundFillStyle,treeMapChartBackgroundStrokeStyle:Bt,treeMapChartParentColor:t.treeMapChartParentColor,treeMapChartNodeColors:t.treeMapChartNodeColors,treeMapChartNodeStrokeStyle:new lr({thickness:1,fillStyle:new fs({color:E("000")})}),treeMapChartTitleFillStyle:t.titleFillStyle,treeMapChartTitleShadow:h,treeMapChartTitleFont:l,treeMapChartPathLabelFillStyle:lt,treeMapChartPathLabelFont:g,treeMapChartLabelHeaderFillStyle:t.treeMapChartLabelHeaderFillStyle,treeMapChartLabelHeaderFont:l,treeMapChartLabelFillStyle:t.treeMapChartLabelFillStyle,treeMapChartLabelFont:g,treeMapChartCornerRadius:8,uiPanelBackgroundFillStyle:t.panelBackgroundFillStyle,uiPanelBackgroundStrokeStyle:Bt,zoomBandChartDefocusOverlayFillStyle:xt,zoomBandChartSplitterStrokeStyle:vt,zoomBandChartKnobFillStyle:t.zoomBandChartKnobFillStyle,zoomBandChartKnobSize:t.zoomBandChartKnobSize,onScreenMenuBackgroundColor:M(254,204,0,.7),parallelCoordinateChartBackgroundFillStyle:t.panelBackgroundFillStyle,parallelCoordinateChartBackgroundStrokeStyle:Bt,parallelCoordinateChartTitleFont:l,parallelCoordinateChartTitleFillStyle:t.titleFillStyle,parallelCoordinateChartTitleShadow:h,parallelCoordinateChartSeriesBackgroundFillStyle:t.seriesBackgroundFillStyle,parallelCoordinateChartSeriesBackgroundStrokeStyle:p,parallelCoordinateChartSeriesColor:e=>t.dataColorPalette[e%t.dataColorPalette.length].stroke,parallelCoordinateChartSeriesColorUnselected:t.dataColorUnselected,parallelCoordinateChartSeriesLineThickness:2,parallelCoordinateChartPointedSeriesLineStyle:A[0],parallelCoordinateAxisTitleFont:c,parallelCoordinateAxisTitleFillStyle:t.axisTitleFillStyle,parallelCoordinateAxisNumericTicks:J,parallelCoordinateAxisDateTimeTicks:Q,parallelCoordinateAxisTimeTicks:it,parallelCoordinateAxisStrokeStyle:V,parallelCoordinateAxisRangeSelectorFillStyle:t.seriesBackgroundFillStyle,parallelCoordinateAxisRangeSelectorStrokeStyle:ut,parallelCoordinateAxisBackgroundFillStyle:new U({angle:90,stops:[{offset:0,color:t.isDark?M(0,0,0,0):M(255,255,255,0)},{offset:1,color:t.isDark?M(0,0,0,255):M(255,255,255,180)}]}),uiButtonFillStyle:dt,uiButtonFillStyleHidden:ft,uiButtonStrokeStyle:t.isDark?Bt:new lr({thickness:1,fillStyle:new fs({color:i})}),uiButtonSize:10,uiBackgroundFillStyle:ct,uiBackgroundStrokeStyle:ut,uiTextFillStyle:lt,uiTextFillStyleHidden:gt,uiTextFont:g,uiTextPadding:5,legendTitleFillStyle:lt,legendTitleFont:f,legendBorderRadius:5,legendPadding:5,legendLUTLabelMargin:7,legendLUTUnitLabelMargin:7,legendLUTCornerRadius:5,legendLUTLengthHorizontal:160,legendLUTThicknessHorizontal:15,legendLUTLengthVertical:140,legendLUTThicknessVertical:25,cursorTickMarkerXBackgroundFillStyle:ct,cursorTickMarkerXBackgroundStrokeStyle:ut,cursorTickMarkerXTextFillStyle:lt,cursorTickMarkerXTextFont:g,cursorTickMarkerYBackgroundFillStyle:ct,cursorTickMarkerYBackgroundStrokeStyle:ut,cursorTickMarkerYTextFillStyle:lt,cursorTickMarkerYTextFont:g,cursorPointMarkerSize:{x:9,y:9},cursorPointMarkerShape:e.PointShape.Circle,cursorPointMarkerFillStyle:mt.getFillStyle(),cursorPointMarkerStrokeStyle:Bt,cursorDynamicBehavior:{pointMarkerFill:e=>new fs({color:at(e,t.isDark?i:s,.2,230)}),pointMarkerStroke:e=>new lr({thickness:2,fillStyle:new fs({color:at(e,t.isDark?s:i,t.isDark?.8:.6,204)})}),pointMarkerSize:t=>({x:t+3,y:t+3})},cursorResultTableFillStyle:t.resultTableBackgroundFillStyle,cursorResultTableStrokeStyle:new lr({thickness:1,fillStyle:t.resultTableBackgroundBorderFillStyle}),cursorResultTableTextFillStyle:lt,cursorResultTableTextFont:g,cursorResultTableHeaderBackgroundFillStyle:t.resultTableHeaderBackgroundFillStyle,cursorResultTableBorderRadius:5,cursorGridStrokeStyleX:mt,cursorGridStrokeStyleY:mt,cursor3DGridStrokeStyleX:yt,cursor3DGridStrokeStyleY:yt,cursor3DGridStrokeStyleZ:yt,cursor3DTickStrokeStyleX:q.tickStyle,cursor3DTickStrokeStyleY:q.tickStyle,cursor3DTickStrokeStyleZ:q.tickStyle,cursor3DTickLabelFillStyleX:lt,cursor3DTickLabelFillStyleY:lt,cursor3DTickLabelFillStyleZ:lt,cursor3DTickLabelFontX:g,cursor3DTickLabelFontY:g,cursor3DTickLabelFontZ:g,cursor3DTickLabelBackgroundFillStyleX:At,cursor3DTickLabelBackgroundFillStyleY:At,cursor3DTickLabelBackgroundFillStyleZ:At,cursor3DTickLabelBackgroundStrokeStyleX:ut,cursor3DTickLabelBackgroundStrokeStyleY:ut,cursor3DTickLabelBackgroundStrokeStyleZ:ut,cursor3DTickLabelPaddingX:{left:4,right:4,top:4,bottom:4},cursor3DTickLabelPaddingY:{left:4,right:4,top:4,bottom:4},cursor3DTickLabelPaddingZ:{left:4,right:4,top:4,bottom:4}};return t.overrideThemeProperties&&(bt={...bt,...t.overrideThemeProperties}),bt})(t),r={...i,header1Font:s.xAxisTitleFont,header2Font:s.xAxisNumericTicks.getMajorTickStyle().labelFont,header3Font:s.uiTextFont,mainDataColor:t.dataColorPalette[0].stroke};return{...s,examples:r}},nf="Segoe UI, -apple-system, Verdana, Helvetica",of=(t,e)=>{const i=new Image;i.crossOrigin="*";const s=`${t}/${e}`;return i.src=s,i},af=(t,e,i)=>s=>{const r=!0===t?e[s%e.length].stroke:at(e[s%e.length].stroke,M(255,255,255),.5);return new V({stops:[{color:at(r,M(255,255,255),.5*i).setA(100),offset:0},{color:r.setA(100),offset:.5},{color:at(r,M(30,30,30),.5*i).setA(100),offset:1}]})},hf=(t,e,i)=>s=>{const r=!0===t?e[s%e.length].stroke:at(e[s%e.length].stroke,M(255,255,255),.2);return new V({stops:[{color:at(r,M(255,255,255),.2*i),offset:0},{color:r,offset:.5},{color:at(r,M(0,0,0),.2*i),offset:1}]})},lf=(t,e,i)=>s=>{const r=!0===t?e[s%e.length].stroke:at(e[s%e.length].stroke,M(255,255,255),.2);return new U({angle:90,stops:[{color:at(r,M(255,255,255),.5*i),offset:0},{color:r,offset:.35},{color:at(r,M(30,30,30),.5*i),offset:1}]})},cf=(t,e,i)=>(()=>{const i=new Map;return s=>{const r=i.get(s);if(r)return r;const n=(i=>{const s=!0===t?e[i%e.length].stroke:at(e[i%e.length].stroke,M(255,255,255),.3);return new U({angle:90,stops:[{color:at(s,M(255,255,255),.5),offset:0},{color:s,offset:.35},{color:at(s,M(30,30,30),.5),offset:1}]})})(s);return i.set(s,n),n}})(),uf=Ze(()=>{const t=M(255,255,255),i=new fs({color:t}),s=!0,r=new vr({spread:1,blur:9,offset:{x:0,y:0},color:M(0,0,0,150)}),n=new V({position:{x:.8,y:.8},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.ellipse,stops:[{offset:0,color:M(50,51,52)},{offset:.5,color:M(14,15,16)},{offset:1,color:M(0,0,0)}]}),o=new fs({color:M(45,45,45)}),a=new V({position:{x:.5,y:.5},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.circle,stops:[{offset:0,color:M(120,120,120,100)},{offset:1,color:M(0,0,0,50)}]}),h=new V({position:{x:.5,y:.5},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.circle,stops:[{offset:0,color:M(30,30,30,200)},{offset:1,color:M(0,0,0,255)}]}),l=nf,c=new fs({color:M(255,255,220)}),u=new fs({color:M(255,255,166)}),d=new fs({color:M(255,255,220)}),f=new fs({color:M(255,255,200)}),g=f,p=g,m=new U({angle:45,stops:[{offset:0,color:M(230,230,230)},{offset:1,color:M(150,150,150)}]}),y=new fs({color:M(220,220,220)}),x=new fs({color:M(200,200,200,50)}),v=new fs({color:M(200,200,200,150)}),A=new fs({color:M(200,200,200,20)}),S=new fs({color:M(220,220,220)}),b=new U({angle:0,stops:[{offset:0,color:M(10,10,10,220)},{offset:1,color:M(30,30,30,220)}]}),E=i,k=M(255,255,200),T=new fs({color:M(0,0,0,224)}),w=new fs({color:M(166,166,166)}),C=new fs({color:M(49,53,58)}),B=M(20,20,20),F=M(0,0,0),D=t,I=M(150,150,150),R=M(50,50,50),L=M(50,50,50),P=M(100,100,100),z=M(200,200,200),_=[M(255,255,91,255),M(255,205,91,255),M(255,155,91,255),M(255,196,188,255),M(255,148,184,255),M(219,148,198,255),M(235,196,224,255),M(169,148,198,255),M(148,226,198,255),M(148,255,176,255),M(180,255,165,255)].map(t=>({stroke:t,border:t,area:t.setA(180)})),N=t.setA(20),O=M(176,255,157,255),G=M(255,112,76,255),Y={mapChartFillStyle:new U({angle:135,stops:[{color:M(255,255,91,255),offset:0},{color:M(255,155,91,255),offset:1}]}),spiderSeriesFillStyle:af(s,_,.5),pieChartSliceFillStylePalette:hf(s,_,1),funnelChartSliceFillStylePalette:lf(s,_,1),pyramidChartSliceFillStylePalette:lf(s,_,1),rectangleSeriesFillStyle:cf(s,_),gaugeChartBarColor:M(255,255,91,255),gaugeChartGlowColor:M(255,255,91,64)},Z=new fs({color:M(176,255,157,255)}),W=new fs({color:M(255,146,146,255)}),j=new fs({color:M(176,255,157,255)}),H=new fs({color:M(230,63,63,255)}),$=new fs({color:M(176,255,157,120)}),X=new fs({color:M(229,63,63,180)}),q=new fs({color:M(27,37,36,255)}),K=new fs({color:M(62,27,27,255)}),J=[M(255,0,0),M(255,255,0),M(0,255,0)],Q=[M(10,10,255),M(10,190,255),M(251,255,0),M(255,38,0)],tt=[M(255,255,0),M(255,204,0),M(255,128,0),M(255,0,0)],et=[M(0,0,0),M(167,4,69,255),M(255,0,0),M(252,252,168,255)],it=new V({stops:[{color:M(61,61,80,100),offset:0},{color:M(44,44,55,30),offset:1}]}),st=new fs({color:M(148,148,198,255)}),rt=$.getColor().setA(255),nt=M(100,100,100),ot=[M(255,241,149,200),M(255,230,65,200),M(238,211,32,200),M(238,176,32,200),M(255,159,13,200),M(254,120,37,200),M(253,91,56,200),M(253,75,84,200),M(254,95,124,200),M(227,56,160,200),M(226,53,134,200),M(216,90,166,200),M(254,151,206,200),M(237,151,254,200),M(243,177,255,200),M(233,133,252,200),M(210,101,230,200),M(178,61,200,200),M(193,81,156,200),M(217,95,145,200)];return rf({isDark:s,highlightColorOffset:M(60,60,60,60),highlightColorOffsetAxisOverlay:M(255,255,255,40),effect:r,effectsText:!0,effectsDashboardSplitters:!0,lcjsBackgroundFillStyle:n,dashboardSplitterFillStyle:o,panelBackgroundFillStyle:a,seriesBackgroundFillStyle:h,fontFamily:l,fontScaler:1,titleFillStyle:c,axisTitleFillStyle:u,axisLabelMajorFillStyle:d,uiTitleFillStyle:f,uiTextFillStyle:g,cursorTextFillStyle:p,axisLineFillStyle:m,axisTickMajorFillStyle:y,axisGridMajorFillStyle:x,axisTickMinorFillStyle:v,axisGridMinorFillStyle:A,cursorGridFillStyle:S,legendBackgroundFillStyle:b,legendBackgroundBorderFillStyle:E,legendButtonDefaultColor:k,resultTableBackgroundFillStyle:T,resultTableBackgroundBorderFillStyle:w,resultTableHeaderBackgroundFillStyle:C,uiBackgroundColor:B,uiBackgroundBorderColor:F,uiStrokeColorContrastHigh:D,uiStrokeColorContrastMedium:I,uiStrokeColorContrastLow:R,dataStrokeColorContrastHigh:L,dataStrokeColorContrastMedium:P,dataStrokeColorContrastLow:z,dataColorPalette:_,dataColorPaletteInverted:[{area:M(190,50,50,100),border:M(210,80,80)}],dataHighlightOverlayColor:N,dataColorPositive:O,dataColorNegative:G,zoomBandChartDefocusOverlayFillStyle:new fs({color:M(0,0,0,180)}),zoomBandChartSplitterColor:M(251,251,90),zoomBandChartKnobFillStyle:t=>new Tt({source:of(t,"zoomBandChart/darkgold-selector.png"),fitMode:e.ImageFitMode.Fill}),zoomBandChartKnobSize:{x:14,y:30},dataColorUnselected:M(255,255,255,24),overrideThemeProperties:Y,treeMapChartParentColor:M(24,30,33),treeMapChartNodeColors:ot,treeMapChartLabelFillStyle:new fs({color:M(33,33,33)}),treeMapChartLabelHeaderFillStyle:new fs({color:M(250,250,250)})},{positiveTextFillStyle:Z,negativeTextFillStyle:W,positiveFillStyle:j,negativeFillStyle:H,positiveAreaFillStyle:$,negativeAreaFillStyle:X,positiveBackgroundFillStyle:q,negativeBackgroundFillStyle:K,badGoodColorPalette:J,coldHotColorPalette:Q,intensityColorPalette:tt,spectrogramColorPalette:et,bollingerFillStyle:it,bollingerBorderFillStyle:st,highlightPointColor:t,highlightDataGridColor:rt,unfocusedDataColor:nt})}),df=Ze(()=>{const t=M(255,255,255),i=new fs({color:t}),s=!0,r=new vr({spread:0,blur:9,offset:{x:0,y:0},color:M(105,255,236,40)}),n=new fs({color:M(2,21,30)}),o=new V({stops:[{color:M(19,40,66,150),offset:0},{color:M(0,0,0,150),offset:1}]}),a=new fs({color:M(0,5,8,150)}),h=nf,l=i,c=i,u=i,d=i,f=i,g=f,p=new fs({color:M(20,224,250,255)}),m=i,y=new fs({color:M(61,94,110,100)}),x=new fs({color:M(61,94,110,255)}),v=new fs({color:M(61,94,110,40)}),A=i,S=new fs({color:M(0,18,23,255)}),b=i,E=t,k=new fs({color:M(0,0,0,225)}),T=i,w=new fs({color:M(18,66,75)}),C=M(0,38,48,220),B=M(0,0,0),F=t,D=M(150,150,150),I=M(19,78,93),R=M(50,50,50),L=M(0,36,48),P=M(200,200,200),z=[M(45,253,253,255),M(44,172,247,255),M(46,100,248,255),M(96,84,199,255),M(184,104,245,255),M(98,160,218,255),M(43,238,245,255),M(38,140,206,255),M(112,96,224,255),M(206,157,255,255)].map(t=>({stroke:t,border:t,area:t.setA(180)})),_=t.setA(50),N=M(3,217,194,255),O=M(230,63,63,255),G={mapChartFillStyle:new U({angle:135,stops:[{color:M(118,248,231,255),offset:0},{color:M(45,177,255,255),offset:1}]}),spiderSeriesFillStyle:af(s,z,1),pieChartSliceFillStylePalette:hf(s,z,1),funnelChartSliceFillStylePalette:lf(s,z,1),pyramidChartSliceFillStylePalette:lf(s,z,1),rectangleSeriesFillStyle:cf(s,z),gaugeChartBarColor:M(3,217,194,255),gaugeChartGlowColor:M(3,217,194,120)},Y=new fs({color:M(45,253,253,255)}),Z=new fs({color:M(255,146,146,255)}),W=new fs({color:M(45,253,253,255)}),j=new fs({color:M(230,63,63,255)}),H=new fs({color:M(1,190,164,120)}),$=new fs({color:M(229,63,63,180)}),X=new fs({color:M(1,53,57,255)}),q=new fs({color:M(62,27,27,255)}),K=[M(1,104,119,255),M(0,165,144,255),M(0,246,214,255)],J=[M(0,87,95,255),M(0,125,124,255),M(1,209,182,255),M(0,255,221,255),M(218,112,112,255),M(172,47,47,255)],Q=[M(126,255,253,255),M(50,233,230,255),M(0,196,193,255),M(62,138,178,255),M(139,88,191,255),M(162,55,143,255)],tt=[M(13,31,52,255),M(101,50,118,255),M(1,142,172,255),M(2,196,170,255),M(0,255,221,255)],et=new V({stops:[{color:M(122,103,254,70),offset:0},{color:M(178,168,255,10),offset:1}]}),it=new fs({color:M(122,103,254,255)}),st=H.getColor().setA(255),rt=M(15,83,83),nt=[M(139,252,252,150),M(60,239,239,150),M(2,201,201,150),M(26,159,159,150),M(15,146,187,150),M(65,168,200,150),M(67,146,207,150),M(64,108,209,150),M(189,64,233,150),M(219,84,238,150),M(192,55,212,150),M(212,98,229,150),M(248,110,211,150),M(251,154,225,150),M(251,154,184,150),M(233,105,144,150),M(255,133,170,150),M(249,110,135,150),M(245,72,101,150),M(210,57,84,150)];return rf({isDark:s,highlightColorOffset:M(60,60,60,60),highlightColorOffsetAxisOverlay:M(255,255,255,40),effect:r,effectsText:!1,effectsDashboardSplitters:!0,lcjsBackgroundFillStyle:t=>new Tt({source:of(t,"themes/turquoiseHexagon.jpg"),fitMode:e.ImageFitMode.Fill}),dashboardSplitterFillStyle:n,panelBackgroundFillStyle:o,seriesBackgroundFillStyle:a,fontFamily:h,fontScaler:1,titleFillStyle:l,axisTitleFillStyle:c,axisLabelMajorFillStyle:u,uiTitleFillStyle:d,uiTextFillStyle:f,cursorTextFillStyle:g,axisLineFillStyle:p,axisTickMajorFillStyle:m,axisGridMajorFillStyle:y,axisTickMinorFillStyle:x,axisGridMinorFillStyle:v,cursorGridFillStyle:A,legendBackgroundFillStyle:S,legendBackgroundBorderFillStyle:b,legendButtonDefaultColor:E,resultTableBackgroundFillStyle:k,resultTableBackgroundBorderFillStyle:T,resultTableHeaderBackgroundFillStyle:w,uiBackgroundColor:C,uiBackgroundBorderColor:B,uiStrokeColorContrastHigh:F,uiStrokeColorContrastMedium:D,uiStrokeColorContrastLow:I,dataStrokeColorContrastHigh:R,dataStrokeColorContrastMedium:L,dataStrokeColorContrastLow:P,dataColorPalette:z,dataColorPaletteInverted:[{area:M(170,60,210,100),border:M(210,100,250)}],dataHighlightOverlayColor:_,dataColorPositive:N,dataColorNegative:O,zoomBandChartDefocusOverlayFillStyle:new fs({color:M(0,0,0,180)}),zoomBandChartSplitterColor:M(43,244,244),zoomBandChartKnobFillStyle:t=>new Tt({source:of(t,"zoomBandChart/turquoise-selector.png"),fitMode:e.ImageFitMode.Fill}),zoomBandChartKnobSize:{x:14,y:30},dataColorUnselected:M(255,255,255,24),overrideThemeProperties:G,treeMapChartParentColor:M(0,35,41),treeMapChartNodeColors:nt,treeMapChartLabelFillStyle:new fs({color:M(33,33,33)}),treeMapChartLabelHeaderFillStyle:new fs({color:M(250,250,250)})},{positiveTextFillStyle:Y,negativeTextFillStyle:Z,positiveFillStyle:W,negativeFillStyle:j,positiveAreaFillStyle:H,negativeAreaFillStyle:$,positiveBackgroundFillStyle:X,negativeBackgroundFillStyle:q,badGoodColorPalette:K,coldHotColorPalette:J,intensityColorPalette:Q,spectrogramColorPalette:tt,bollingerFillStyle:et,bollingerBorderFillStyle:it,highlightPointColor:t,highlightDataGridColor:st,unfocusedDataColor:rt})}),ff=Ze(()=>{const t=!1,i=new vr({spread:0,blur:6,offset:{x:2,y:-2},color:M(0,0,0,30)}),s=new V({position:{x:.8,y:.8},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.ellipse,stops:[{offset:0,color:M(255,255,255)},{offset:1,color:M(255,255,255)}]}),r=new fs({color:M(219,227,233,255)}),n=new V({position:{x:.5,y:.5},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.circle,stops:[{offset:0,color:M(255,255,255,200)},{offset:1,color:M(240,244,246,200)}]}),o=new V({position:{x:.5,y:.5},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.circle,stops:[{offset:0,color:M(255,255,255,255)},{offset:1,color:M(255,255,255,255)}]}),a=nf,h=new fs({color:M(33,43,49)}),l=new fs({color:M(33,43,49)}),c=new fs({color:M(33,43,49)}),u=new fs({color:M(33,43,49)}),d=u,f=d,g=new U({angle:45,stops:[{offset:0,color:M(225,225,225)},{offset:1,color:M(225,225,225)}]}),p=new fs({color:M(150,150,150,255)}),m=new fs({color:M(150,150,150,170)}),y=new fs({color:M(150,150,150,150)}),x=new fs({color:M(150,150,150,100)}),v=new fs({color:M(60,70,80)}),A=new U({angle:0,stops:[{offset:0,color:M(255,255,255,240)},{offset:1,color:M(255,255,255,240)}]}),S=new fs({color:M(168,186,199)}),b=M(150,150,150),E=new fs({color:M(255,255,255,230)}),k=new fs({color:M(168,186,199)}),T=new fs({color:M(228,235,243)}),w=M(255,255,255,255),C=M(168,168,199,255),B=M(168,186,199,255),F=M(168,186,199,255),D=M(168,186,199,255),I=M(168,186,199,255),R=M(100,100,100),L=M(200,200,200),P=[M(28,181,140,255),M(255,132,0,255),M(240,39,39,255),M(86,121,251,255),M(2,181,213,255),M(13,212,158,255),M(22,167,3,255),M(234,103,232,255),M(62,183,179,255),M(140,93,3,255),M(155,158,186,255)].map(t=>({stroke:t,border:t,area:t.setA(180)})),z=M(150,150,150,80),_=M(46,182,120,255),N=M(255,66,66,255),O=new lr({thickness:2,fillStyle:new fs({color:M(168,186,199,255)})}),G={mapChartFillStyle:new U({angle:-45,stops:[{color:M(2,181,213,255),offset:0},{color:M(175,243,255,255),offset:1}]}),spiderSeriesFillStyle:af(t,P,.8),pieChartSliceFillStylePalette:hf(t,P,.8),funnelChartSliceFillStylePalette:lf(t,P,.5),pyramidChartSliceFillStylePalette:lf(t,P,.5),rectangleSeriesFillStyle:cf(t,P),gaugeChartBarColor:M(46,182,120,255),gaugeChartGlowColor:M(46,182,120,120),chartXYSeriesBackgroundStrokeStyle:O,chart3DSeriesBackgroundStrokeStyle:O,polarChartSeriesBackgroundStrokeStyle:O,spiderChartSeriesBackgroundStrokeStyle:O,dataGridTextFillStyle:new fs({color:M(0,88,64,255)})},Y=new fs({color:M(4,146,108,255)}),Z=new fs({color:M(240,39,39,255)}),W=new fs({color:M(28,181,140,255)}),j=new fs({color:M(230,88,88,255)}),H=new fs({color:M(28,181,140,180)}),$=new fs({color:M(230,88,88,180)}),X=new fs({color:M(229,243,228)}),q=new fs({color:M(232,225,216)}),K=[M(193,48,48,255),M(240,234,60,255),M(45,191,55,255)],J=[M(10,19,255,255),M(15,191,250,255),M(249,255,2,255),M(253,133,0,255),M(255,24,0,255)],Q=[M(50,99,213),M(8,179,77),M(255,246,0),M(255,126,0),M(189,36,30)],tt=[M(16,64,176),M(8,179,77),M(255,246,0),M(255,126,0),M(168,6,0)],et=new fs({color:M(185,198,207,255)}),it=new V({stops:[{color:M(151,190,220,10),offset:0},{color:M(151,190,220,50),offset:1}]}),st=H.getColor().setA(255),rt=M(150,150,150),nt=[M(255,243,136,125),M(254,237,99,125),M(255,216,109,125),M(255,172,100,125),M(255,133,101,125),M(255,113,142,125),M(230,103,129,125),M(242,126,219,125),M(255,155,235,125),M(255,181,240,125),M(203,143,255,125),M(208,154,255,125),M(171,188,255,125),M(197,209,255,125),M(171,187,255,125),M(84,167,239,125),M(38,196,214,125),M(38,214,196,125),M(69,225,141,125),M(36,191,88,125)];return rf({isDark:t,highlightColorOffset:M(-60,-60,-60,60),highlightColorOffsetAxisOverlay:M(0,0,0,40),effect:i,effectsText:!1,effectsDashboardSplitters:!0,lcjsBackgroundFillStyle:s,dashboardSplitterFillStyle:r,panelBackgroundFillStyle:n,seriesBackgroundFillStyle:o,fontFamily:a,fontScaler:1,titleFillStyle:h,axisTitleFillStyle:l,axisLabelMajorFillStyle:c,uiTitleFillStyle:u,uiTextFillStyle:d,cursorTextFillStyle:f,axisLineFillStyle:g,axisTickMajorFillStyle:p,axisGridMajorFillStyle:m,axisTickMinorFillStyle:y,axisGridMinorFillStyle:x,cursorGridFillStyle:v,legendBackgroundFillStyle:A,legendBackgroundBorderFillStyle:S,legendButtonDefaultColor:b,resultTableBackgroundFillStyle:E,resultTableBackgroundBorderFillStyle:k,resultTableHeaderBackgroundFillStyle:T,uiBackgroundColor:w,uiBackgroundBorderColor:C,uiStrokeColorContrastHigh:B,uiStrokeColorContrastMedium:F,uiStrokeColorContrastLow:D,dataStrokeColorContrastHigh:I,dataStrokeColorContrastMedium:R,dataStrokeColorContrastLow:L,dataColorPalette:P,dataColorPaletteInverted:[{area:M(190,50,50,100),border:M(210,80,80)}],dataHighlightOverlayColor:z,dataColorPositive:_,dataColorNegative:N,zoomBandChartDefocusOverlayFillStyle:new fs({color:M(255,255,255,180)}),zoomBandChartSplitterColor:M(80,93,101),zoomBandChartKnobFillStyle:t=>new Tt({source:of(t,"zoomBandChart/light-selector.png"),fitMode:e.ImageFitMode.Fill}),zoomBandChartKnobSize:{x:14,y:30},dataColorUnselected:M(0,0,0,24),overrideThemeProperties:G,treeMapChartParentColor:M(217,217,217),treeMapChartNodeColors:nt,treeMapChartLabelFillStyle:new fs({color:M(0,0,0)}),treeMapChartLabelHeaderFillStyle:new fs({color:M(33,33,33)})},{positiveTextFillStyle:Y,negativeTextFillStyle:Z,positiveFillStyle:W,negativeFillStyle:j,positiveAreaFillStyle:H,negativeAreaFillStyle:$,positiveBackgroundFillStyle:X,negativeBackgroundFillStyle:q,badGoodColorPalette:K,coldHotColorPalette:J,intensityColorPalette:Q,spectrogramColorPalette:tt,bollingerFillStyle:it,bollingerBorderFillStyle:et,highlightPointColor:M(0,0,0),highlightDataGridColor:st,unfocusedDataColor:rt})}),gf=Ze(()=>{const t=!1,i=new V({position:{x:.8,y:.8},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.ellipse,stops:[{offset:0,color:M(255,255,255)},{offset:1,color:M(255,255,255)}]}),s=new fs({color:M(214,236,216,255)}),r=new V({position:{x:.5,y:.5},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.circle,stops:[{offset:0,color:M(233,244,231,70)},{offset:1,color:M(233,244,231,200)}]}),n=new V({position:{x:.5,y:.5},extent:e.GradientExtent.farthestCorner,shape:e.GradientShape.circle,stops:[{offset:0,color:M(255,255,255,255)},{offset:1,color:M(255,255,255,255)}]}),o=nf,a=new fs({color:M(1,61,53)}),h=new fs({color:M(1,61,53)}),l=new fs({color:M(1,61,53)}),c=new fs({color:M(1,61,53)}),u=c,d=u,f=new U({angle:45,stops:[{offset:0,color:M(225,225,225)},{offset:1,color:M(225,225,225)}]}),g=new fs({color:M(188,211,186,255)}),p=new fs({color:M(188,211,186,150)}),m=new fs({color:M(188,211,186,50)}),y=new fs({color:M(188,211,186,50)}),x=new fs({color:M(104,148,111,255)}),v=new U({angle:0,stops:[{offset:0,color:M(255,255,255,240)},{offset:1,color:M(255,255,255,240)}]}),A=new fs({color:M(104,148,111)}),S=M(150,150,150),b=new fs({color:M(255,255,255,230)}),E=new fs({color:M(104,148,111)}),k=new fs({color:M(226,236,224)}),T=M(255,255,255,255),w=M(179,201,183,255),C=M(188,211,186,255),B=M(188,211,186,255),F=M(188,211,186,255),D=M(188,211,186,255),I=M(100,100,100),R=M(200,200,200),L=[M(138,195,142,255),M(193,161,114,255),M(178,99,99,255),M(142,156,210,255),M(154,209,219,255),M(164,212,199,255),M(104,156,97,255),M(196,147,195,255),M(92,190,187,255),M(126,100,51,255),M(136,138,157,255)].map(t=>({stroke:t,border:t,area:t.setA(180)})),P=M(150,150,150,80),z=M(46,182,84,255),_=M(232,96,96,255),N=new lr({thickness:2,fillStyle:new fs({color:M(188,211,186,255)})}),O={mapChartFillStyle:new U({angle:-45,stops:[{color:M(118,160,121,255),offset:0},{color:M(174,227,178,255),offset:1}]}),spiderSeriesFillStyle:af(t,L,.8),pieChartSliceFillStylePalette:hf(t,L,.8),pyramidChartSliceFillStylePalette:lf(t,L,.5),funnelChartSliceFillStylePalette:lf(t,L,.5),rectangleSeriesFillStyle:cf(t,L),gaugeChartBarColor:M(46,182,84,255),gaugeChartGlowColor:M(46,182,84,120),chartXYSeriesBackgroundStrokeStyle:N,chart3DSeriesBackgroundStrokeStyle:N,polarChartSeriesBackgroundStrokeStyle:N,spiderChartSeriesBackgroundStrokeStyle:N,dataGridTextFillStyle:new fs({color:M(77,66,21,255)})},G=new fs({color:M(93,151,97,255)}),Y=new fs({color:M(178,99,99,255)}),Z=new fs({color:M(138,195,142,255)}),W=new fs({color:M(178,99,99,255)}),j=new fs({color:M(138,195,142,180)}),H=new fs({color:M(178,99,99,180)}),$=new fs({color:M(224,240,237)}),X=new fs({color:M(251,227,227)}),q=[M(178,99,99,255),M(215,224,111,255),M(80,186,88,255)],K=[M(62,64,142,255),M(66,131,77,255),M(250,250,135,255),M(202,161,78,255),M(179,53,53,255)],J=[M(64,86,138),M(123,192,205),M(255,252,149),M(220,155,92),M(184,78,74)],Q=[M(64,86,138),M(123,192,205),M(255,252,149),M(220,155,92),M(132,60,57)],tt=new fs({color:M(185,198,207,255)}),et=new V({stops:[{color:M(151,190,220,10),offset:0},{color:M(151,190,220,50),offset:1}]}),it=j.getColor().setA(255),st=M(150,150,150),rt=[M(242,239,210,150),M(243,238,183,150),M(210,222,136,150),M(204,217,148,150),M(157,190,124,150),M(143,178,72,150),M(198,147,88,150),M(216,148,71,150),M(229,142,103,150),M(225,174,152,150),M(219,149,203,150),M(216,188,209,150),M(109,198,189,150),M(172,206,202,150),M(164,223,217,150),M(174,215,233,150),M(203,225,235,150),M(220,227,243,150),M(207,213,227,150),M(171,182,209,150)];return rf({isDark:t,highlightColorOffset:M(-60,-60,-60,60),highlightColorOffsetAxisOverlay:M(0,0,0,40),effect:void 0,effectsText:!1,effectsDashboardSplitters:!1,lcjsBackgroundFillStyle:i,dashboardSplitterFillStyle:s,panelBackgroundFillStyle:r,seriesBackgroundFillStyle:n,fontFamily:o,fontScaler:1,titleFillStyle:a,axisTitleFillStyle:h,axisLabelMajorFillStyle:l,uiTitleFillStyle:c,uiTextFillStyle:u,cursorTextFillStyle:d,axisLineFillStyle:f,axisTickMajorFillStyle:g,axisGridMajorFillStyle:p,axisTickMinorFillStyle:m,axisGridMinorFillStyle:y,cursorGridFillStyle:x,legendBackgroundFillStyle:v,legendBackgroundBorderFillStyle:A,legendButtonDefaultColor:S,resultTableBackgroundFillStyle:b,resultTableBackgroundBorderFillStyle:E,resultTableHeaderBackgroundFillStyle:k,uiBackgroundColor:T,uiBackgroundBorderColor:w,uiStrokeColorContrastHigh:C,uiStrokeColorContrastMedium:B,uiStrokeColorContrastLow:F,dataStrokeColorContrastHigh:D,dataStrokeColorContrastMedium:I,dataStrokeColorContrastLow:R,dataColorPalette:L,dataColorPaletteInverted:[{area:M(210,70,70,100),border:M(200,110,110)}],dataHighlightOverlayColor:P,dataColorPositive:z,dataColorNegative:_,zoomBandChartDefocusOverlayFillStyle:new fs({color:M(255,255,255,180)}),zoomBandChartSplitterColor:M(68,106,64),zoomBandChartKnobFillStyle:t=>new Tt({source:of(t,"zoomBandChart/lightnature-selector.png"),fitMode:e.ImageFitMode.Fill}),zoomBandChartKnobSize:{x:14,y:30},dataColorUnselected:M(0,0,0,24),overrideThemeProperties:O,treeMapChartParentColor:M(239,247,238),treeMapChartNodeColors:rt,treeMapChartLabelFillStyle:new fs({color:M(0,0,0)}),treeMapChartLabelHeaderFillStyle:new fs({color:M(33,33,33)})},{positiveTextFillStyle:G,negativeTextFillStyle:Y,positiveFillStyle:Z,negativeFillStyle:W,positiveAreaFillStyle:j,negativeAreaFillStyle:H,positiveBackgroundFillStyle:$,negativeBackgroundFillStyle:X,badGoodColorPalette:q,coldHotColorPalette:K,intensityColorPalette:J,spectrogramColorPalette:Q,bollingerFillStyle:et,bollingerBorderFillStyle:tt,highlightPointColor:M(0,0,0),highlightDataGridColor:it,unfocusedDataColor:st})}),pf=Ze(()=>{const t=M(255,255,255),i=new fs({color:t}),s=!0,r=new vr({spread:1,blur:9,offset:{x:0,y:0},color:M(255,255,255,30)}),n=new fs({color:M(6,15,36)}),o=new V({stops:[{color:M(46,13,87,50),offset:0},{color:M(0,0,0,150),offset:1}]}),a=new fs({color:M(0,5,8,150)}),h=nf,l=i,c=i,u=i,d=i,f=i,g=f,p=new U({angle:45,stops:[{offset:0,color:M(241,133,255,255)},{offset:1,color:M(115,207,238,255)}]}),m=i,y=new fs({color:M(61,94,110,100)}),x=new fs({color:M(61,94,110,255)}),v=new fs({color:M(61,94,110,40)}),A=i,S=new fs({color:M(0,18,23,255)}),b=i,E=M(115,207,238,255),k=new fs({color:M(0,0,0,224)}),T=i,w=new fs({color:M(68,31,78)}),C=M(0,38,48,255),B=M(0,0,0),F=t,D=M(150,150,150),I=M(19,57,93),R=M(50,50,50),L=M(0,17,48),P=M(200,200,200),z=[M(20,211,237,255),M(98,147,252,255),M(164,73,250,255),M(129,117,253,255),M(95,134,252,255),M(22,133,212,255),M(35,200,242,255),M(104,121,233,255),M(137,69,232,255),M(70,72,241,255)].map(t=>({stroke:t,border:t,area:t.setA(180)})),_=t.setA(50),N=M(3,217,194,255),O=M(243,21,110,255),G={mapChartFillStyle:new U({angle:135,stops:[{color:M(118,248,231,255),offset:0},{color:M(45,177,255,255),offset:1}]}),spiderSeriesFillStyle:af(s,z,.5),pieChartSliceFillStylePalette:hf(s,z,2),funnelChartSliceFillStylePalette:lf(s,z,1),pyramidChartSliceFillStylePalette:lf(s,z,1),rectangleSeriesFillStyle:cf(s,z),gaugeChartBarColor:M(3,217,194,255),gaugeChartGlowColor:M(3,217,194,150)},Y=new fs({color:M(20,211,237,255)}),Z=new fs({color:M(253,145,178,255)}),W=new fs({color:M(20,211,237,255)}),j=new fs({color:M(239,68,121,255)}),H=new fs({color:M(20,211,237,120)}),$=new fs({color:M(239,68,121,180)}),X=new fs({color:M(1,53,57,255)}),q=new fs({color:M(94,19,42,255)}),K=[M(174,51,132,255),M(204,107,218,255),M(189,215,253,255)],J=[M(0,63,95,255),M(0,149,255,255),M(0,225,255,255),M(255,154,254,255),M(204,98,170,255),M(139,39,84,255)],Q=[M(197,241,255,255),M(70,210,255,255),M(0,164,217,255),M(90,99,222,255),M(138,75,192,255),M(151,27,162,255)],tt=[M(13,31,52,255),M(129,54,130,255),M(131,108,176,255),M(7,162,213,255),M(26,247,255,255)],et=new V({stops:[{color:M(219,42,235,60),offset:0},{color:M(237,73,252,10),offset:1}]}),it=new fs({color:M(237,73,252,255)}),st=H.getColor().setA(255),rt=M(8,70,100),nt=[M(149,230,255,150),M(93,213,243,150),M(20,189,223,150),M(5,151,181,150),M(2,138,198,150),M(2,113,198,150),M(97,148,236,150),M(93,111,230,150),M(151,120,223,150),M(128,87,227,150),M(153,52,230,150),M(179,92,245,150),M(248,110,211,150),M(255,155,228,150),M(251,88,207,150),M(255,0,162,150),M(214,73,177,150),M(209,71,159,150),M(238,101,169,150),M(210,57,134,150)];return rf({isDark:s,highlightColorOffset:M(60,60,60,60),highlightColorOffsetAxisOverlay:M(255,255,255,40),effect:r,effectsText:!0,effectsDashboardSplitters:!0,lcjsBackgroundFillStyle:t=>new Tt({source:of(t,"themes/cyberSpace.jpg"),fitMode:e.ImageFitMode.Fill}),dashboardSplitterFillStyle:n,panelBackgroundFillStyle:o,seriesBackgroundFillStyle:a,fontFamily:h,fontScaler:1,titleFillStyle:l,axisTitleFillStyle:c,axisLabelMajorFillStyle:u,uiTitleFillStyle:d,uiTextFillStyle:f,cursorTextFillStyle:g,axisLineFillStyle:p,axisTickMajorFillStyle:m,axisGridMajorFillStyle:y,axisTickMinorFillStyle:x,axisGridMinorFillStyle:v,cursorGridFillStyle:A,legendBackgroundFillStyle:S,legendBackgroundBorderFillStyle:b,legendButtonDefaultColor:E,resultTableBackgroundFillStyle:k,resultTableBackgroundBorderFillStyle:T,resultTableHeaderBackgroundFillStyle:w,uiBackgroundColor:C,uiBackgroundBorderColor:B,uiStrokeColorContrastHigh:F,uiStrokeColorContrastMedium:D,uiStrokeColorContrastLow:I,dataStrokeColorContrastHigh:R,dataStrokeColorContrastMedium:L,dataStrokeColorContrastLow:P,dataColorPalette:z,dataColorPaletteInverted:[{area:M(41,130,255,100),border:M(45,110,240)}],dataHighlightOverlayColor:_,dataColorPositive:N,dataColorNegative:O,zoomBandChartDefocusOverlayFillStyle:new fs({color:M(0,0,0,180)}),zoomBandChartSplitterColor:M(219,119,255),zoomBandChartKnobFillStyle:t=>new Tt({source:of(t,"zoomBandChart/cyberspace-selector.png"),fitMode:e.ImageFitMode.Fill}),zoomBandChartKnobSize:{x:14,y:30},dataColorUnselected:M(255,255,255,24),overrideThemeProperties:G,treeMapChartParentColor:M(30,30,59),treeMapChartNodeColors:nt,treeMapChartLabelFillStyle:new fs({color:M(33,33,33)}),treeMapChartLabelHeaderFillStyle:new fs({color:M(250,250,250)})},{positiveTextFillStyle:Y,negativeTextFillStyle:Z,positiveFillStyle:W,negativeFillStyle:j,positiveAreaFillStyle:H,negativeAreaFillStyle:$,positiveBackgroundFillStyle:X,negativeBackgroundFillStyle:q,badGoodColorPalette:K,coldHotColorPalette:J,intensityColorPalette:Q,spectrogramColorPalette:tt,bollingerFillStyle:et,bollingerBorderFillStyle:it,highlightPointColor:t,highlightDataGridColor:st,unfocusedDataColor:rt})}),mf={};Object.defineProperty(mf,"darkGold",{get:uf,enumerable:!0}),Object.defineProperty(mf,"turquoiseHexagon",{get:df,enumerable:!0}),Object.defineProperty(mf,"light",{get:ff,enumerable:!0}),Object.defineProperty(mf,"lightNature",{get:gf,enumerable:!0}),Object.defineProperty(mf,"cyberSpace",{get:pf,enumerable:!0});const yf=mf,xf=yf.darkGold;class vf extends Oh{constructor(t,i,s,r,n,o){var a,h,l,c;let u;super(t,i,s,i.Hg("dataGrid bg",0),r,i.pi.bi.dataGridBackgroundFillStyle,i.pi.bi.dataGridBackgroundStrokeStyle,i.pi.bi.dataGridTitleFont,i.pi.bi.dataGridTitleFillStyle,i.pi.bi.dataGridTitleShadow,o),this.tT=[],this.iT=[],this.sT=[],this.eT=new Map,this.rT=!0,this.hT=!0,this.nT=!0,this.oT=!0,this.aT=!0,this.lT=!0,this.uT=!0,this.cT=!0,this.dT=!0,this.fT=!0,this.AT=!0,this.gT=!0,this.pT=!0,this.vT=!0,this.yT=!0,this.mT=!0,this.xT=new Set,this.ST=new Set,this.bT=!0,this.MT=!0,this.wT=(t,e)=>{t.borders=void 0===e?Mf:{...t.borders,...e},this._T(t),this.gT=!0,this.pi.Bs()},this._T=t=>{t.borders&&(!1===t.borders.top&&this.kT(t.column,t.row-1,t=>{t.borders=t.borders?{...null==t?void 0:t.borders,bottom:!1}:{...this.CT,bottom:!1}}),!1===t.borders.bottom&&this.kT(t.column,t.row+1,t=>{t.borders=t.borders?{...t.borders,top:!1}:{...this.CT,top:!1}}),!1===t.borders.left&&this.kT(t.column-1,t.row,t=>{t.borders=t.borders?{...t.borders,right:!1}:{...this.CT,right:!1}}),!1===t.borders.right&&this.kT(t.column+1,t.row,t=>{t.borders=t.borders?{...t.borders,left:!1}:{...this.CT,left:!1}}),!0===t.borders.top&&this.kT(t.column,t.row-1,t=>{t.borders=t.borders?{...null==t?void 0:t.borders,bottom:!0}:{...this.CT,bottom:!0}}),!0===t.borders.bottom&&this.kT(t.column,t.row+1,t=>{t.borders=t.borders?{...t.borders,top:!0}:{...this.CT,top:!0}}),!0===t.borders.left&&this.kT(t.column-1,t.row,t=>{t.borders=t.borders?{...t.borders,right:!0}:{...this.CT,right:!0}}),!0===t.borders.right&&this.kT(t.column+1,t.row,t=>{t.borders=t.borders?{...t.borders,left:!0}:{...this.CT,left:!0}}))},this.TT={x:0,y:0},this.cells=new vt,this.D=new vt,this.pi.La(Hn.yo),this.Yr.tn("Data Grid"),this.FT=s.d2({scaleXYConstructor:q}),this.FT.x.Jf=Od,this.IT=s.d2({scaleXYConstructor:q}),this.LT={x:0,y:0},this.PT=this.bi.dataGridTextFont,this.BT=this.bi.dataGridTextFillStyle,this.CT={top:!0,bottom:!0,left:!0,right:!0},this.DT=this.bi.dataGridCellBackgroundFillStyle,this.ET=this.bi.dataGridBorderStrokeStyle,this.RT="left-center",this.OT={left:null!==(a=this.bi.dataGridCellPadding)&&void 0!==a?a:5,right:null!==(h=this.bi.dataGridCellPadding)&&void 0!==h?h:5,bottom:null!==(l=this.bi.dataGridCellPadding)&&void 0!==l?l:5,top:null!==(c=this.bi.dataGridCellPadding)&&void 0!==c?c:5},this.zT=i.Rm("dataGrid grid bg",0),this.VT=i.Rm("dataGrid cell bg",1),this.NT=i.Om("dataGrid cell content",0),this.GT=i.Om("dataGrid scrollbar bg",1),this.$T=i.Om("dataGrid scrollbar fg",2),this.UT=this.zT.Tc(this.IT).qe(this.bi.dataGridBackgroundFillStyle).Ke(Bt).setPointerEvents(!1),this.YT=this.NT.bA(this.FT).setPointerEvents(!1),this.jT=new Th(()=>{const t=this.VT.tr(this.FT).setPointerEvents(!0);return this.cells.zi(t,{getExtraData:()=>this.eT.get(t),continueIfNotPrevented:(t,e,i)=>{const s=Ts(this.getUserInteractions().scroll,"wheel",e,e.shiftKey,e.ctrlKey,e.altKey);if(s&&"wheel"===t&&e instanceof WheelEvent){fe(e),this.HT({x:!0===s.x?Math.sign(e.deltaY):0,y:!0===s.y?Math.sign(e.deltaY):0});const t=s.on;t&&t({event:e})}}}),t}),this.WT=new Th(()=>this.NT.tr(this.FT).setPointerEvents(!1)),this.XT=new Th(()=>this.NT._n(this.FT,!1).setPointerEvents(!1)),this.ZT=new Th(()=>this.NT.Np(this.FT,{},[Wh.InternalUI,{type:"DataPattern",args:{pattern:"ProgressiveX"}}]).setPointerEvents(!1)),this.JT=new Th(()=>this.NT.dr(this.FT).setPointerEvents(!1)),this.QT=new Th(()=>this.NT.zd(this.FT).Od(ls).cr(Bt).setPointerEvents(!1)),this.KT=new Th(()=>this.NT.tr(this.FT).setPointerEvents(!1)),this.qT=new Th(()=>this.NT.qb(this.FT).setPointerEvents(!1)),this.tF=new Th(()=>this.NT._d(this.FT).setPointerEvents(!1)),this.iF={background:this.GT.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarBackgroundFillStyle).Ke(this.bi.dataGridScrollBarBackgroundStrokeStyle),scrollbar:this.$T.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarFillStyle).Ke(this.bi.dataGridScrollBarStrokeStyle),button1:this.GT.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarButtonFillStyle).Ke(this.bi.dataGridScrollBarButtonStrokeStyle),button2:this.GT.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarButtonFillStyle).Ke(this.bi.dataGridScrollBarButtonStrokeStyle),buttonIcon1:this.$T.zd(this.IT).setPointerEvents(!1).cr(Bt).Rd(this.bi.dataGridScrollBarButtonArrowFillStyle).Vd(e.PointShape.Triangle),buttonIcon2:this.$T.zd(this.IT).setPointerEvents(!1).cr(Bt).Rd(this.bi.dataGridScrollBarButtonArrowFillStyle).Vd(e.PointShape.Triangle)},this.sF={background:this.GT.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarBackgroundFillStyle).Ke(this.bi.dataGridScrollBarBackgroundStrokeStyle),scrollbar:this.$T.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarFillStyle).Ke(this.bi.dataGridScrollBarStrokeStyle),button1:this.GT.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarButtonFillStyle).Ke(this.bi.dataGridScrollBarButtonStrokeStyle),button2:this.GT.tr(this.IT).setPointerEvents(!0).qe(this.bi.dataGridScrollBarButtonFillStyle).Ke(this.bi.dataGridScrollBarButtonStrokeStyle),buttonIcon1:this.$T.zd(this.IT).setPointerEvents(!1).cr(Bt).Rd(this.bi.dataGridScrollBarButtonArrowFillStyle).Vd(e.PointShape.Triangle),buttonIcon2:this.$T.zd(this.IT).setPointerEvents(!1).cr(Bt).Rd(this.bi.dataGridScrollBarButtonArrowFillStyle).Vd(e.PointShape.Triangle)},this.iF.scrollbar.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Vertical,u)}),this.iF.scrollbar.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.iF.scrollbar.addEventListener("pointerdown",t=>{fe(t);let e=t;const i=t=>{const i=t.clientY-e.clientY;e=t,this.eF({x:0,y:-i})},s=e=>{e.pointerId===t.pointerId&&(Ut.removeEventListener("pointermove",i),Ut.removeEventListener("pointerup",s))};Ut.addEventListener("pointermove",i),Ut.addEventListener("pointerup",s)}),this.iF.scrollbar.addEventListener("wheel",t=>{fe(t),this.HT({x:0,y:Math.sign(t.deltaY)})}),this.iF.background.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Vertical,u)}),this.iF.background.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.iF.background.addEventListener("click",t=>{fe(t);const e=this.pi.il(t),i=tt({x:e.engineX,y:e.engineY},this.pi.ai,this.IT);this.HT({x:0,y:i.y>this.iF.scrollbar.Vl().y?-1:1})}),this.iF.background.addEventListener("wheel",t=>{fe(t),this.HT({x:0,y:Math.sign(t.deltaY)})}),this.iF.button1.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Point,u)}),this.iF.button1.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.iF.button1.addEventListener("click",t=>{fe(t),this.HT({x:0,y:1})}),this.iF.button2.addEventListener("click",t=>{fe(t),this.HT({x:0,y:-1})}),this.iF.button2.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Point,u)}),this.iF.button2.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.sF.scrollbar.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Horizontal,u)}),this.sF.scrollbar.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.sF.scrollbar.addEventListener("pointerdown",t=>{fe(t);let e=t;const i=t=>{const i=t.clientX-e.clientX;e=t,this.eF({x:i,y:0})},s=e=>{e.pointerId===t.pointerId&&(Ut.removeEventListener("pointermove",i),Ut.removeEventListener("pointerup",s))};Ut.addEventListener("pointermove",i),Ut.addEventListener("pointerup",s)}),this.sF.scrollbar.addEventListener("wheel",t=>{fe(t),this.HT({x:Math.sign(t.deltaY),y:0})}),this.sF.background.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Horizontal,u)}),this.sF.background.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.sF.background.addEventListener("click",t=>{fe(t);const e=this.pi.il(t),i=tt({x:e.engineX,y:e.engineY},this.pi.ai,this.IT);this.HT({x:i.x<this.sF.scrollbar.Vl().x?-1:1,y:0})}),this.sF.background.addEventListener("wheel",t=>{fe(t),this.HT({x:Math.sign(t.deltaY),y:0})}),this.sF.button1.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Point,u)}),this.sF.button1.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.sF.button1.addEventListener("click",t=>{fe(t),this.HT({x:-1,y:0})}),this.sF.button2.addEventListener("click",t=>{fe(t),this.HT({x:1,y:0})}),this.sF.button2.addEventListener("pointerenter",t=>{u=this.engine.setMouseStyle(e.MouseStyles.Point,u)}),this.sF.button2.addEventListener("pointerleave",t=>{u=this.engine.restoreMouseStyle(u)}),this.jg(n,this.uiScale),this.addEventListener("resize",()=>{this.rT=!0,this.pi.Bs(),this.FT.Z(this.eA.kt()),this.IT.Z(this.eA.kt())}),this.rF=this.vs.aA([this.UT])}getMinimumSize(){return{x:200,y:200}}setAnimationsEnabled(t){return this}bg(){return[]}dispose(){return super.dispose(),this.zT.G(),this.VT.G(),this.NT.G(),this.GT.G(),this.$T.G(),Vh(this.FT),Vh(this.IT),this.XT.UA(),this.jT.UA(),this.WT.UA(),this.ZT.UA(),this.JT.UA(),this.QT.UA(),this.KT.UA(),this.qT.UA(),this.tF.UA(),this}j(){return super.j(),this.FT.j(),this.IT.j(),this}H(){return super.H(),this.FT.H(),this.IT.H(),this}setBackgroundEffect(t){return this.rF.Ps(t),this.pi.Bs(),this}getBackgroundEffect(){return this.rF.Ds()}setUserInteractions(t){return this.ar=void 0===t?{scroll:!1}:t,this}getUserInteractions(){return Nt({scroll:{wheel:{x:!1,y:!0},ctrl:{wheel:{x:!0,y:!1}}}},this.ar)}setGridBackgroundFillStyle(t){return this.UT.qe(t),this.pi.Bs(),this}getGridBackgroundFillStyle(){return this.UT.Mh()}setCellContent(t,e,i,s,r){if("number"==typeof i&&void 0!==s&&void 0!==r){const n=i,o=s,a=r;let h=[];for(let i=t;i<t+n;i+=1)for(let t=e;t<e+o;t+=1){const e=this.kT(i,t);e&&h.push(e)}h=Oe(h);let l={highlight:0};for(const t of h){const e=this.tT.indexOf(t);e<0||(l={...l,highlight:t.highlight,textFont:t.textFont,textFillStyle:t.textFillStyle,contentAlignment:t.contentAlignment,borders:t.borders,padding:t.padding,backgroundFillStyle:t.backgroundFillStyle},this.tT.splice(e,1))}const c={...l,column:t,row:e,columnSpan:n,rowSpan:o,content:a};this.tT.push(c),this.oT=!0,"string"==typeof c.content||"number"==typeof c.content?this.hT=!0:this.nT=!0,this.pi.Bs()}else this.hF(t,e,i);return this}setColumnContent(t,e){const i=e.length;if(0===i)return this;for(let s=0;s<i;s+=1){const i=e[s];this.hF(t,s,i)}return this}setRowContent(t,e){const i=e.length;if(0===i)return this;for(let s=0;s<i;s+=1){const i=e[s];this.hF(s,t,i)}return this}setTableContent(t){const e=t.length;if(0===e)return this;const i=t[0].length;if(0===i)return this;for(let s=0;s<i;s+=1)for(let i=0;i<e;i+=1){const e=t[i][s];this.hF(s,i,e)}return this}setColumnWidth(t,e){let i=this.iT.find(e=>e.column===t);return i||(i={column:t,min:void 0,max:void 0},this.iT.push(i)),"object"==typeof e?(i.min=e.min,i.max=e.max):void 0===e?this.iT.splice(this.iT.indexOf(i),1):(i.min=e,i.max=e),this.lT=!0,this.pi.Bs(),this}setRowHeight(t,e){let i=this.sT.find(e=>e.row===t);return i||(i={row:t,min:void 0,max:void 0},this.sT.push(i)),"object"==typeof e?(i.min=e.min,i.max=e.max):void 0===e?this.sT.splice(this.sT.indexOf(i),1):(i.min=e,i.max=e),this.lT=!0,this.pi.Bs(),this}setColumnPaddings(t,e){return"number"==typeof e&&(e=x(e,e,e,e)),this.nF(t,t=>this.oF(t,e)),this}setRowPaddings(t,e){return"number"==typeof e&&(e=x(e,e,e,e)),this.aF(t,t=>this.oF(t,e)),this}setCellPadding(t,e,i){return"number"==typeof i&&(i=x(i,i,i,i)),this.kT(t,e,t=>this.oF(t,i)),this}setCellsPaddings(t){return"number"==typeof t&&(t=x(t,t,t,t)),this.OT={...this.OT,...t},this.lF(t=>this.oF(t,this.OT)),this}setCellBorders(t,e,i){return this.kT(t,e,t=>this.wT(t,i)),this}setRowBorders(t,e){return this.aF(t,t=>this.wT(t,e)),this}setColumnBorders(t,e){return this.nF(t,t=>this.wT(t,e)),this}setCellsBorders(t){return this.CT=void 0===t?Mf:t,this.lF(t=>this.wT(t,this.CT)),this}setCellsBorderStrokeStyle(t){return this.ET="function"==typeof t?t(this.ET):t,this.vT=!0,this.pi.Bs(),this}setColumnTextFillStyle(t,e){return this.nF(t,t=>this.uF(t,e)),this}setRowTextFillStyle(t,e){return this.aF(t,t=>this.uF(t,e)),this}setCellTextFillStyle(t,e,i){return this.kT(t,e,t=>this.uF(t,i)),this}setCellsTextFillStyle(t){return this.BT="function"==typeof t?t(this.BT):t,this.lF(t=>this.uF(t,this.BT)),this}setColumnTextFont(t,e){return this.nF(t,t=>this.cF(t,e)),this}setRowTextFont(t,e){return this.aF(t,t=>this.cF(t,e)),this}setCellTextFont(t,e,i){return this.kT(t,e,t=>this.cF(t,i)),this}setCellsTextFont(t){return this.PT="function"==typeof t?t(this.PT):t,this.lF(t=>this.cF(t,this.PT)),this}setColumnContentAlignment(t,e){return this.nF(t,t=>this.dF(t,e)),this}setRowContentAlignment(t,e){return this.aF(t,t=>this.dF(t,e)),this}setCellContentAlignment(t,e,i){return this.kT(t,e,t=>this.dF(t,i)),this}setCellsContentAlignment(t){return this.RT=t,this.lF(t=>this.dF(t,this.RT)),this}setCellBackgroundFillStyle(t,e,i){return this.kT(t,e,t=>this.fF(t,i)),this}setColumnBackgroundFillStyle(t,e){return this.nF(t,t=>this.fF(t,e)),this}setRowBackgroundFillStyle(t,e){return this.aF(t,t=>this.fF(t,e)),this}setCellsBackgroundFillStyle(t){return this.DT="function"==typeof t?t(this.DT):t,this.lF(t=>this.fF(t,this.DT)),this}setCellHighlight(t,e,i){return this.kT(t,e,t=>{t.highlight=Ge(i)}),this.pT=!0,this.pi.Bs(),this}setColumnHighlight(t,e){const i=Ge(e);return this.nF(t,t=>{t.highlight=i}),this.pT=!0,this.pi.Bs(),this}setRowHighlight(t,e){const i=Ge(e);return this.aF(t,t=>{t.highlight=i}),this.pT=!0,this.pi.Bs(),this}removeCell(t,e){return this.kT(t,e,t=>this.tT.splice(this.tT.indexOf(t),1)),this.aT=!0,this.pi.Bs(),this}removeRow(t){return this.aF(t,t=>this.tT.splice(this.tT.indexOf(t),1)),this.tT.filter(e=>e.row>t).forEach(t=>{t.row-=1}),this.aT=!0,this.pi.Bs(),this}removeColumn(t){return this.nF(t,t=>this.tT.splice(this.tT.indexOf(t),1)),this.tT.filter(e=>e.column>t).forEach(t=>{t.column-=1}),this.aT=!0,this.pi.Bs(),this}removeCells(){return this.tT.splice(0),this.aT=!0,this.pi.Bs(),this}getColumnMax(){return 0===this.tT.length?0:this.tT.reduce((t,e)=>Math.max(t,e.column+e.columnSpan-1),0)}getRowMax(){return 0===this.tT.length?0:this.tT.reduce((t,e)=>Math.max(t,e.row+e.rowSpan-1),0)}ir(t){var e;super.ir(t),Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn),super.Yg();const i=Math.round(this.ET.ji()),s=i/2;let r=this.hT||this.nT||this.oT||this.aT||this.lT||this.uT||this.AT||this.gT||this.vT||this.mT;if(r){this.tT.forEach(t=>{this.ST.add(t.column)}),this.tT.forEach(t=>{this.xT.add(t.row)});const t=this.XT.VA(),e=this.AF(s,t);t.finishPlot();const n=this.gF(this.ST.size,e),o=this.pF(this.xT.size,e),a=n.reduce(gi,0)+i,h=o.reduce(gi,0)+i,l=new Array(n.length+1).fill(0).map((t,e)=>n.reduce((t,i,s)=>t+(s<e?i:0),0)),c=new Array(o.length+1).fill(0).map((t,e)=>o.reduce((t,i,s)=>t+(s<e?i:0),0));if(this.vF){const t=this.vF.columnWidths.every((t,e)=>t===n[e]),e=this.vF.rowHeights.every((t,e)=>t===o[e]);t&&e&&(r=!1)}this.vF={columnWidths:n,rowHeights:o,dataGridWidth:a,dataGridHeight:h,columnWidthsCumulative:l,rowHeightsCumulative:c,cellsContentSizes:e}}const n=r||this.nT||this.oT||this.aT||this.cT||this.dT||this.fT||this.gT||this.pT||this.vT||this.rT||this.mT;if((n||this.yT)&&this.vF){const t=this.eA.getInnerIntervalPixels(),r=Uh.tp(this.Yr,this.Wg),o=[this.Gn.left+s,this.Gn.right+s],a=[this.Gn.bottom+s,this.Gn.top+r+s],h={x:t.x-o[0]-o[1],y:t.y-a[0]-a[1]},l=[this.Gn.left,this.Gn.right],c=[this.Gn.bottom,this.Gn.top+r],u={x:Math.round(t.x-l[0]-l[1]),y:Math.round(t.y-c[0]-c[1])},d={x:Math.ceil(s),y:Math.floor(u.y-s)};this.IT.qt(o).ti(a).ii(0,h.x).si(0,h.y);const f=null!==(e=this.bi.dataGridScrollBarThickness)&&void 0!==e?e:20,g={x:Math.min(h.x,this.vF.dataGridWidth+f)-f,y:Math.min(h.y,this.vF.dataGridHeight+f)-f};0===this.TT.x&&0===this.TT.y||(this.LT.y+=this.vF.dataGridHeight*this.TT.y/g.y,this.LT.x+=this.vF.dataGridWidth*this.TT.x/g.x,this.TT.x=0,this.TT.y=0),this.LT.y=$t(this.LT.y,h.y-this.vF.dataGridHeight-f,0),this.LT.x=$t(this.LT.x,0,this.vF.dataGridWidth-h.x+f);const p=this.LT;this.FT.qt(l).ti(c).ii(p.x,u.x+p.x).si(p.y,u.y+p.y);const m={x:this.FT.x.bt(),y:this.FT.y.bt()+f,width:this.FT.x.wt()+i-f,height:this.FT.y.wt()+i-f};this.NT.Tm(m),this.VT.Tm(m);const y=this.vF,x=[{x:this.FT.x.getInnerStart(),y:this.FT.y.getInnerStart()},{x:this.FT.x.getInnerEnd(),y:this.FT.y.getInnerStart()},{x:this.FT.x.getInnerEnd(),y:this.FT.y.getInnerEnd()},{x:this.FT.x.getInnerStart(),y:this.FT.y.getInnerEnd()}];y.cellsContentSizes.forEach(t=>{var e;const i={x:d.x+y.columnWidthsCumulative[t.cell.column],y:d.y-y.rowHeightsCumulative[t.cell.row+t.cell.rowSpan]},s={x:i.x+y.columnWidths[t.cell.column],y:i.y+y.rowHeights[t.cell.row]},r=ui([i,{x:s.x,y:i.y},s,{x:i.x,y:s.y}],x);null===(e=t.text)||void 0===e||e.setVisible(r)}),n&&this.yF(d,this.vF,i);const v=h.y-f<this.vF.dataGridHeight;this.iF.background.setVisible(v).sr({x:g.x,y:f}).Z({x:f,y:g.y}),this.iF.scrollbar.setVisible(v).sr({x:g.x,y:f+g.y-f+-(g.y-2*f)*(-this.LT.y/this.vF.dataGridHeight)}).Z({x:f,y:-(g.y-2*f)*(g.y/this.vF.dataGridHeight)}),this.iF.button1.setVisible(v).sr({x:g.x,y:f}).Z({x:f,y:f}),this.iF.buttonIcon1.setVisible(v).Hd(.5*f).Gd(0).Ed((new Vo).appendSample({x:g.x+f/2,y:1.5*f}),{x:"x",y:"y"}),this.iF.button2.setVisible(v).sr({x:g.x,y:g.y}).Z({x:f,y:f}),this.iF.buttonIcon2.setVisible(v).Hd(.5*f).Gd(180).Ed((new Vo).appendSample({x:g.x+f/2,y:g.y+f/2}),{x:"x",y:"y"});const A=h.x-f<this.vF.dataGridWidth,S=Math.max(h.y-this.vF.dataGridHeight-f,0);this.sF.background.setVisible(A).sr({x:0,y:S}).Z({x:g.x,y:f}),this.sF.scrollbar.setVisible(A).sr({x:f+(g.x-2*f)*(this.LT.x/this.vF.dataGridWidth),y:S}).Z({x:(g.x-2*f)*(g.x/this.vF.dataGridWidth),y:f}),this.sF.button1.setVisible(A).sr({x:0,y:S}).Z({x:f,y:f}),this.sF.buttonIcon1.setVisible(A).Hd(.5*f).Gd(90).Ed((new Vo).appendSample({x:f/2,y:S+f/2}),{x:"x",y:"y"}),this.sF.button2.setVisible(A).sr({x:g.x-f,y:S}).Z({x:f,y:f}),this.sF.buttonIcon2.setVisible(A).Hd(.5*f).Gd(270).Ed((new Vo).appendSample({x:g.x-f/2,y:S+f/2}),{x:"x",y:"y"}),this.UT.au([d,{x:d.x+g.x+(v?f:0),y:d.y},{x:d.x+g.x+(v?f:0),y:d.y-g.y},{x:d.x+g.x,y:d.y-g.y},{x:d.x+g.x,y:d.y-g.y-(A?f:0)},{x:d.x,y:d.y-g.y-(A?f:0)}])}this.rT=!1,this.hT=!1,this.nT=!1,this.oT=!1,this.aT=!1,this.lT=!1,this.uT=!1,this.cT=!1,this.dT=!1,this.fT=!1,this.AT=!1,this.gT=!1,this.pT=!1,this.vT=!1,this.yT=!1,this.mT=!1}AF(t,e){const i=[],s={left:Math.ceil(t),right:Math.ceil(t),top:Math.ceil(t),bottom:Math.ceil(t)};for(const t of this.tT){const{content:r}=t,n={...this.OT,...t.padding};let o,a,h,l={x:0,y:0};if("string"==typeof r||"number"==typeof r){const i=String(r);o=e.add(),l=o.tn(i).Ch(t.textFont||this.PT).Nh().bc()}if(Ud(r)&&(a=r,l={x:200,y:50}),yr(r)){const t=this.pi.mF(r);t.xF()?(h=r,l=h.kt()):t.SF(()=>{this.mT=!0,this.pi.Bs()})}if(o||a||h){n.top=Math.round(n.top),n.left=Math.round(n.left),n.right=Math.round(n.right),n.bottom=Math.round(n.bottom);const e={x:Math.round(l.x+n.left+n.right+s.left+s.right),y:Math.round(l.y+n.top+n.bottom+s.top+s.bottom)};i.push({cell:t,contentSize:e,text:o,sparkChart:a,icon:h,cellPadding:n,cellMargin:s})}}return i}yF(t,i,s){const{cellsContentSizes:r,columnWidths:n,columnWidthsCumulative:o,rowHeights:a,rowHeightsCumulative:h}=i;this.YT.cr(this.ET),this.eT.clear();const l={cellBackground:this.jT.VA(),cellIconRect:this.WT.VA(),lineSet:this.ZT.VA(),line:this.JT.VA(),pointSet:this.QT.VA(),rect:this.KT.VA(),junction:this.qT.VA(),arc:this.tF.VA()},c=[];for(const i of r){const{cell:r,text:u,sparkChart:d,icon:f,cellPadding:g,cellMargin:p}=i,m={column:r.column,row:r.row},y={x:t.x+o[r.column],y:t.y-h[r.row+r.rowSpan]},x={x:y.x+p.left,y:y.y+p.bottom},v={x:x.x+g.left,y:x.y+g.bottom},A={x:new Array(r.columnSpan).fill(0).reduce((t,e,i)=>t+n[r.column+i],0),y:new Array(r.rowSpan).fill(0).reduce((t,e,i)=>t+a[r.row+i],0)},S={x:A.x-p.left-p.right,y:A.y-p.top-p.bottom},b={x:S.x-g.left-g.right,y:S.y-g.top-g.bottom};if(u){const t=bf(v,b,r.contentAlignment||this.RT);u.sr(t[0]).Zl({x:t[1],y:t[2]}).qe(this.bF(r.textFillStyle||this.BT,r.content,this.BT)).Ii(r.highlight).qh(this.bi.dataGridTextShadow)}const M=this.bF(r.backgroundFillStyle||this.DT,r.content);if(M!==ls){const t=l.cellBackground.add();t.sr(y).Z(A).qe(M).Ke(Bt).Ii(r.highlight),this.eT.set(t,m)}const E=r.borders||this.CT;if(E&&Sf(y,A,E,s,c),d){const t=v,e=b;Gd(d,l,this.FT,t,e,this.bi,this.Pg,r.highlight)}if(f){const t=f.kt(),i=bf(v,b,r.contentAlignment||this.RT);l.cellIconRect.add().sr({x:i[0].x+t.x*(-.5-i[1]/2),y:i[0].y+t.y*(-.5-i[2]/2)}).Z(t).qe(new Tt({source:f.Js,fitMode:e.ImageFitMode.Stretch})).Ke(Bt).Ii(r.highlight)}}this.YT.Vi();for(const t of c)this.YT.Ho().wA(t[0],t[1]);l.cellBackground.finishPlot(),l.cellIconRect.finishPlot(),l.lineSet.finishPlot(),l.line.finishPlot(),l.pointSet.finishPlot(),l.rect.finishPlot(),l.junction.finishPlot(),l.arc.finishPlot()}gF(t,e){const i=new Array(t).fill(0);for(const t of this.ST.values()){const s=e.filter(e=>t>=e.cell.column&&t+1<=e.cell.column+e.cell.columnSpan).reduce((t,e)=>{const i=e.contentSize.x/e.cell.columnSpan;return Math.max(t,i)},0),r=this.iT.find(e=>e.column===t),n=r?$t(s,void 0!==r.min?r.min:oi,void 0!==r.max?r.max:ni):s;i[t]=n}return i}pF(t,e){const i=new Array(t).fill(0);for(const t of this.xT.values()){const s=e.filter(e=>t>=e.cell.row&&t+1<=e.cell.row+e.cell.rowSpan).reduce((t,e)=>{const i=e.contentSize.y/e.cell.rowSpan;return Math.max(t,i)},0),r=this.sT.find(e=>e.row===t),n=r?$t(s,void 0!==r.min?r.min:oi,void 0!==r.max?r.max:ni):s;i[t]=n}return i}bF(t,e,i){if(vs(t)){try{const i=Number(e);return new fs({color:t.getPalette().getColors(i,void 0)})}catch(t){}return i||ls}return t}uF(t,e){t.textFillStyle="function"==typeof e?e(t.textFillStyle||this.BT):e,this.fT=!0,this.pi.Bs()}cF(t,e){t.textFont="function"==typeof e?e(t.textFont||this.PT):e,this.AT=!0,this.pi.Bs()}fF(t,e){t.backgroundFillStyle="function"==typeof e?e(t.backgroundFillStyle||this.DT):e,this.dT=!0,this.pi.Bs()}dF(t,e){t.contentAlignment=e,this.cT=!0,this.pi.Bs()}oF(t,e){t.padding={...t.padding,...e},this.uT=!0,this.pi.Bs()}hF(t,e,i){let s=this.kT(t,e);s?s.content=i:(s={column:t,row:e,columnSpan:1,rowSpan:1,content:i,highlight:0},this.tT.push(s),this.oT=!0),"string"==typeof s.content||"number"==typeof s.content?this.hT=!0:this.nT=!0,this.pi.Bs()}lF(t){this.tT.forEach(e=>t(e))}kT(t,e,i){const s=this.tT.find(i=>t>=i.column&&t+1<=i.column+i.columnSpan&&e>=i.row&&e+1<=i.row+i.rowSpan);return s&&i&&i(s),s}nF(t,e){const i=this.tT.filter(e=>t>=e.column&&t+1<=e.column+e.columnSpan);for(const t of i)t&&e(t)}aF(t,e){const i=this.tT.filter(e=>t>=e.row&&t+1<=e.row+e.rowSpan);for(const t of i)t&&e(t)}HT(t){var e,i,s,r,n,o;if(this.vF){if(0!==t.y){const r=null!==(i=null===(e=this.vF.rowHeightsCumulative.map((t,e)=>({value:t,index:e})).reverse().find(e=>-this.LT.y+(t.y>0?1:0)>=e.value))||void 0===e?void 0:e.index)&&void 0!==i?i:0,n=null!==(s=this.vF.rowHeightsCumulative[r+t.y])&&void 0!==s?s:0;this.LT.y=-n,this.yT=!0,this.pi.Bs()}if(0!==t.x){const e=null!==(n=null===(r=this.vF.columnWidthsCumulative.map((t,e)=>({value:t,index:e})).reverse().find(e=>this.LT.x+(t.x>0?1:0)>=e.value))||void 0===r?void 0:r.index)&&void 0!==n?n:0,i=null!==(o=this.vF.columnWidthsCumulative[e+t.x])&&void 0!==o?o:0;this.LT.x=i,this.yT=!0,this.pi.Bs()}}}eF(t){this.vF&&(this.TT.x+=t.x,this.TT.y+=t.y,this.yT=!0,this.pi.Bs())}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}var Af;e.DataGridCellContentAlignmentOptions=void 0,(Af=e.DataGridCellContentAlignmentOptions||(e.DataGridCellContentAlignmentOptions={})).Center="center",Af.RightCenter="right-center",Af.LeftCenter="left-center",Af.RightTop="right-top",Af.LeftTop="left-top",Af.RightBottom="right-bottom",Af.LeftBottom="left-bottom",Af.CenterTop="center-top",Af.CenterBottom="center-bottom";const Sf=(t,e,i,s,r)=>{const n={x:t.x,y:t.y},o={x:t.x,y:t.y+e.y},a={x:t.x+e.x,y:t.y},h={x:t.x+e.x,y:t.y+e.y};i.top&&r.push([o,h]),i.bottom&&r.push([n,a]),i.left&&r.push([n,o]),i.right&&r.push([a,h])},bf=(t,e,i)=>{const s=t.x,r=t.x+e.x,n=t.x+e.x/2,o=t.y+e.y,a=t.y,h=t.y+e.y/2;switch(i){case"left-center":return[l(s,h),-1,0];case"right-center":return[l(r,h),1,0];case"center":return[l(n,h),0,0];case"left-bottom":return[l(s,a),-1,-1];case"right-bottom":return[l(r,a),1,-1];case"center-bottom":return[l(n,a),0,-1];case"left-top":return[l(s,o),-1,1];case"right-top":return[l(r,o),1,1];case"center-top":return[l(n,o),0,1]}return Ye(0,`Unidentified DataGrid cell content alignment option: ${i}`)},Mf={top:!1,bottom:!1,left:!1,right:!1};class Ef extends Rn{constructor(t,e,i,s,r,n){super(t,{fn(){},dn(){},gn(){}},s,e,i,{numeric:e.xAxisNumericTicks.setFallBackToExtremeTicksAutomatically(!1),datetime:e.xAxisDateTimeTicks,time:e.xAxisTimeTicks},{type:"linear"}),this.D=new vt,this.chart=t,this.vs=n,this.Ws=r,this.Jr=r._n(t.MF).Ch(this.bi.barChartCategoryAxisTitleFont||this.bi.xAxisTitleFont).qe(this.bi.barChartCategoryAxisTitleFillStyle||this.bi.xAxisTitleFillStyle),this.setTitleRotation(this.chart.Xs.getWidth({x:0,y:-90})),this.Ih=this.vs.aA([this.Jr]).Ps(e.effectsText),this.wF=r.dr(t.MF).cr(e.barChartCategoryAxisStrokeStyle||e.xAxisStrokeStyle)}setThickness(t){return"number"==typeof t?(this.fA=t,this.AA=t):"object"==typeof t&&(this.fA=t.min,this.AA=t.max),this.chart.pi.Bs(),this}getThickness(){return{min:this.fA,max:this.AA}}setStrokeStyle(t){return this.wF.cr(t),this.chart.pi.Bs(),this}getStrokeStyle(){return this.wF.do()}ir(t){const e=this.getInterval(),i=this.chart.valueAxis.getInterval();this.wF.gr(this.chart.Xs.toPoint(e.start,i.start)).Ar(this.chart.Xs.toPoint(e.end,i.start)).setVisible(this.di),this.Jr.sr(this.chart.Xs.toPoint(.5*(e.start+e.end),this.chart.valueAxis.ai.Qt(i.start,-t.pA))).Zl(this.chart.Xs.toPoint(0,1)).setVisible(this.di),t.ticksInfo.forEach((t,e)=>{e.zh.sr(t.labelPosition).Zl(t.labelAlignment).Th(t.labelRotation).$l(t.labelOffset.x,t.labelOffset.y)})}Yh(t){return{}}Xh(t,e,i,s){return{keyValue:t,tickLevel:e,labelText:i,labelAlignment:{x:0,y:0},labelPosition:{x:0,y:0},labelOffset:{x:0,y:0},labelRotation:0}}sn(t,e){return new Ln(e,t,this.Ws,this.chart.MF)}Qh(t,e,i){const s=t.pA,r=this.chart.Xs.getHeight(this.Jr.Nh().bc());return{vA:r,yf:$t(this.wF.do().ji()/2+s+r,void 0!==this.fA?this.fA:0,void 0!==this.AA?this.AA:ni),ticksInfo:e,updatedTicks:i}}Kr(){return this.chart.uiScale}vn(t,e){return e}xn(t,e,i){return{start:t,end:e}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}}class kf extends Rn{constructor(t,e,i,s,r,n,o){super(t,{fn:()=>{var e;if(t._F){if("positive"===t.kF||"bipolar"===t.kF){if("after-bar"===(null===(e=t.CF)||void 0===e?void 0:e.position)){const e=this.ai.wt();return this.ai.Qt(t._F.max,Math.min(this.chart.Xs.getHeight(this.chart.TF())+t.CF.labelMargin,.3*e))}return t._F.max}return t.FF?$t(-1,-1e-6,t._F.max):0}},dn:()=>{var e;if(t._F){if("negative"===t.kF||"bipolar"===t.kF){if("after-bar"===(null===(e=t.CF)||void 0===e?void 0:e.position)){const e=this.ai.wt();return this.ai.Qt(t._F.min,-Math.min(this.chart.Xs.getHeight(this.chart.TF())+t.CF.labelMargin,.3*e))}return t._F.min}return t.FF?$t(1,1e-6,t._F.min):0}},gn:()=>{}},s,e,i,{numeric:e.barChartValueAxisTicks||e.yAxisNumericTicks,datetime:e.yAxisDateTimeTicks,time:e.yAxisTimeTicks},o),this.D=new vt,this.chart=t,this.vs=n,this.Ws=r,this.Jr=r._n(t.MF).Ch(this.bi.barChartValueAxisTitleFont||this.bi.yAxisTitleFont).qe(this.bi.barChartValueAxisTitleFillStyle||this.bi.yAxisTitleFillStyle),this.setTitleRotation(this.chart.Xs.getHeight({x:0,y:-90})),this.Ih=this.vs.aA([this.Jr]).Ps(e.effectsText),this.wF=r.dr(t.MF).cr(e.barChartValueAxisStrokeStyle||this.bi.yAxisStrokeStyle)}setThickness(t){return"number"==typeof t?(this.fA=t,this.AA=t):"object"==typeof t&&(this.fA=t.min,this.AA=t.max),this.chart.pi.Bs(),this}getThickness(){return{min:this.fA,max:this.AA}}setStrokeStyle(t){return this.wF.cr(t),this.chart.pi.Bs(),this}getStrokeStyle(){return this.wF.do()}setTickStrategy(t,e){return super.fh(t,e)}ir(t){const e=this.getInterval();this.wF.gr(this.chart.Xs.toPoint(-.5,this.Ah)).Ar(this.chart.Xs.toPoint(-.5,this.gh)).setVisible(this.di);const i="logarithmic"===this.uh.type?Math.sqrt(e.start+e.end):.5*(e.start+e.end),s=this.chart.Xs.toPoint(this.chart.categoryAxis.ai.Qt(-.5,t.pA*this.chart.Xs.IF),i),r=this.chart.Xs.toPoint(this.chart.Xs.LF,0);this.Jr.sr(s).Zl(r).setVisible(this.di),t.ticksInfo.forEach((e,i)=>{i.zh.sr(e.labelPosition).Zl(e.labelAlignment).Th(e.labelRotation).$l(e.labelOffset.x,e.labelOffset.y);const s=i.kn.Fr;s.tickStyle!==Bt&&0!==s.tickLength&&t.plotLines.add({positions:[e.positionTicklineStart,e.positionTicklineEnd]},{lineStyle:s.tickStyle}),s.gridStrokeStyle!==Bt&&s.gridStrokeLength>0&&t.plotLines.add({positions:[e.positionTicklineStart,e.positionGridlineEnd]},{lineStyle:s.gridStrokeStyle})})}Yh(t){return{}}Xh(t,e,i,s,r){const n=e.Fr,o=this.chart.Xs.toPoint(-.5,t),a=this.chart.MF.Qt(o,this.chart.Xs.toPoint(n.getTickLength()*this.chart.Xs.IF,0)),h=this.chart.MF.Qt(o,this.chart.Xs.toPoint(n.gridStrokeLength*s.oppositeAxisSize*-this.chart.Xs.IF,0));return{keyValue:t,tickLevel:e,labelText:i,labelPosition:this.chart.MF.Qt(a,this.chart.Xs.toPoint(n.getTickPadding()*this.chart.Xs.IF,0)),labelAlignment:this.chart.Xs.toPoint(this.chart.Xs.LF,n.getLabelAlignment()),labelOffset:{x:0,y:0},labelRotation:e.Fr.labelRotation,positionTicklineStart:o,positionTicklineEnd:a,positionGridlineEnd:h}}sn(t,e){return new Ln(e,t,this.Ws,this.chart.MF)}Qh(t,e,i){let s=0;for(const t of this.Pr.values())for(const e of t.values()){const t=e.kn.Fr,i=this.chart.Xs.getWidth(e.zh.Nh().bc()),r=t.getTickLength()+t.getTickPadding()+i;s=Math.max(s,r)}const r=s+this.wF.do().ji()/2,n=this.chart.Xs.getWidth(this.Jr.Nh().bc());return{pA:r,vA:n,yf:$t(r+n,void 0!==this.fA?this.fA:0,void 0!==this.AA?this.AA:ni),ticksInfo:e,updatedTicks:i}}Kr(){return this.chart.MF}vn(t,e){return"linear"===this.uh.type?Ds(t,e,this.ai):Is(t,e,this.ai)}xn(t,e,i){return{start:t,end:e}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}}class Tf extends mc{constructor(t,e,i,s,r,n,o){super(t,e,i,s),this.xi=qe(),this.M=0,this.PF=!1,this.D=new vt,this.chart=t,this.chart=t,this.category=r,this.subCategory=n,this.Rs=r,this.Ze=ze(i.barChartBarFillStyle||i.rectangleSeriesFillStyle,o),this.Je=ze(i.barChartBarStrokeStyle||i.rectangleSeriesStrokeStyle,o),this.addEventListener("visiblechange",()=>this.chart.BF()),this.addEventListener("dispose",()=>{this.chart.BF(),this.chart.DF.delete(this.category),this.chart.EF.delete(this)})}Qi(t,e,i){const s=this.chart.pi.il(e);return{cursorPosition:{pointMarker:{x:s.engineX,y:s.engineY},pointMarkerScale:this.chart.pi.ai,resultTable:{x:s.engineX,y:s.engineY},resultTableScale:this.chart.pi.ai},category:this.category,subCategory:this.subCategory,bar:this,value:this.getValue()}}setValue(t){return this.PF=!0,this.M=t,this.chart.BF(),this.chart.pi.Bs(),this.chart.DF.delete(this.category),this.chart.EF.delete(this),this}getValue(){return this.M}get value(){return this.M}setFillStyle(t){return this.Ze="function"==typeof t?t(this.Ze):t,this.chart.BF(),this}getFillStyle(){return this.Ze}setStrokeStyle(t){return this.Je="function"==typeof t?t(this.Je):t,this.chart.BF(),this}getStrokeStyle(){return this.Je}xp(){return this.rp}setEffect(t){return this.chart.setBarsEffect(t),this}er(){return{fill:this.Ze,lutValue:this.value}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const wf=t=>!!(t&&"object"==typeof t&&"iCategory"in t&&"number"==typeof t.iCategory&&"value"in t&&"number"==typeof t.value);class Cf extends hl{constructor(t,e,i,s,r,n,o){var a,h;let l;super(t,e,i,e.Hg("barChart bg",0),s,e.pi.bi.barChartBackgroundFillStyle||e.pi.bi.chartXYBackgroundFillStyle,e.pi.bi.barChartBackgroundStrokeStyle||e.pi.bi.chartXYBackgroundStrokeStyle,e.pi.bi.barChartTitleFont||e.pi.bi.chartXYTitleFont,e.pi.bi.barChartTitleFillStyle||e.pi.bi.chartXYTitleFillStyle,e.pi.bi.barChartTitleShadow||e.pi.bi.chartXYTitleShadow,n,null===(a=null==o?void 0:o.legend)||void 0===a?void 0:a.customLegend),this.coordsBars="barChart",this.RF=Bf.Descending,this.OF=this.bi.barChartCategoryLabels,this.CF=this.bi.barChartValueLabelsAfterBars,this.zF=!0,this.rb=$e(),this.DF=new Map,this.EF=new Map,this.kF="positive",this.VF="columns",this.NF=!0,this.GF=new Map,this.$F={speed:1},this.yk={speed:1},this.UF=.08,this.YF=[],this.jF=new Map,this.HF=!1,this.WF={left:2,right:2,top:2,bottom:2},this.XF=[],this.xa=t=>{this.MF.Z(t.engineWidth,t.engineHeight),this.HF=!0},this.D=new vt,this.pi.La(Hn.Mo),this.ZF=this.bi.barChartCornerRadius,this.Xs="horizontal"===(null==o?void 0:o.type)?Df:Ff,this.Yr.tn("Bar Chart"),this.JF=e.Om("barChart plotting 1",0),this.QF=e.Om("barChart plotting 2",1),this.FF="logarithmic"===(null===(h=null==o?void 0:o.valueAxis)||void 0===h?void 0:h.type),this.FF?"horizontal"===this.Xs.KF?(l=i.d1({scale1DConstructor:H,dimension:"y"}),this.MF=(new K).Kt(i.d1({scale1DConstructor:ji,dimension:"x"}),l)):(l=i.d1({scale1DConstructor:H,dimension:"x"}),this.MF=(new K).Kt(l,i.d1({scale1DConstructor:ji,dimension:"y"}))):(this.MF=i.d2({scaleXYConstructor:q}),l=this.Xs.getWidth(this.MF)),this.qF=this.vs.aA(),this.nb=new $h(()=>this.rb.Ji(this.JF.md(this.MF).nl(0)),(t,e,i)=>(t.qe(i.fillStyle).Ke(i.strokeStyle),e.map(e=>{const i=e.existingMember||t.Ho();return i.Md(e.x1,e.y1,e.x2,e.y2).bd(e.rounding),this.rb.Ki(i,e.bar),e.bar.Ts([i]),i})),()=>{this.rb.Vi()},t=>{this.qF.ks(t)}),this.yv=this.Ig.tr(this.MF).qe(this.bi.barChartSeriesBackgroundFillStyle||ls).Ke(Bt),this.mv=this.Ig.tr(this.MF).qe(ls).Ke(this.bi.barChartSeriesBackgroundStrokeStyle||Bt).setPointerEvents(!1),super.vv(this.yv,this.mv),this.categoryAxis=new Ef(this,this.bi,!1!==(null==o?void 0:o.animationsEnabled),l,this.QF,this.vs),this.categoryAxis.setInterval(this.Xs.getWidth({x:{start:-.5,end:.5},y:{start:.5,end:-.5}}));const c=Fs(null==o?void 0:o.valueAxis);this.valueAxis=new kf(this,this.bi,!1!==(null==o?void 0:o.animationsEnabled),this.Xs.getHeight(this.MF),this.QF,this.vs,c.type),this.tI=new Th(()=>this.QF._n(this.MF).wn(Xe).Mn(Xe).nl(1)),this.iI=new $h(()=>this.Ig.bA(this.MF).setPointerEvents(!1),(t,e,i)=>(t.cr(i.lineStyle),e.map(({positions:e,existingMember:i})=>(i||t.Ho()).wA(e[0],e[1]))));const u=e.Ym(),d=qt(o?o.cursorBuilder:void 0,Nl);this.jm=ig(this,u,d.Am(u,this.uiScale,this.uiScale,jt,this.bi),this,"show-pointed",If,()=>0),this.addEventListener("resize",this.xa),this.jg(r,this.MF),this.setAnimationsEnabled(!1!==(null==o?void 0:o.animationsEnabled)),void 0!==(null==o?void 0:o.legend)&&this.legend.setOptions(o.legend)}getSeries(){return this.fv}setCornerRadius(t){return this.ZF=t,this.zF=!0,this.pi.Bs(),this}getCornerRadius(){return this.ZF}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Nl){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}setBarsMargin(t){return this.UF=$t(t,0,.49),this.zF=!0,this.pi.Bs(),this}getBarsMargin(){return this.UF}setBarsEffect(t){return this.qF.Ps(t),this.pi.Bs(),this}getBarsEffect(){return this.qF.Ds()}setData(t){let e;if(Array.isArray(t))e=[],t.forEach((t,i)=>{"string"==typeof t?e.push({category:t}):"number"==typeof t?e.push({category:`Category ${i+1}`,value:t}):"object"==typeof t&&e.push(t)});else{e=[];const i=Object.keys(t);for(const s of i){const i=t[s];e.push({category:s,value:"number"==typeof i?i:void 0})}}return this.sI("columns",e),this}setDataStacked(t,e){const i=[];return e.forEach(e=>{const{subCategory:s,values:r}=e;r.forEach((e,r)=>{const n=t[r];i.push({category:n,subCategory:s,value:e})})}),this.sI("stacks",i),this}setDataGrouped(t,e){const i=[];return e.forEach(e=>{const{subCategory:s,values:r}=e;r.forEach((e,r)=>{const n=t[r];i.push({category:n,subCategory:s,value:e})})}),this.sI("groups",i),this}sI(t,e){this.fv.length>0&&this.pi.La(Hn.Ro),this.VF=t,this.XF=e.map(t=>({category:t.category,subCategory:t.subCategory})),this.eI(e);const i=Oe(e.map(t=>t.category)),s=i.length,r=Oe(e.map(t=>t.subCategory)).filter(t=>void 0!==t);if(e.forEach(e=>{let s=this.fv.find(t=>t.category===e.category&&t.subCategory===e.subCategory);if(!s){const n=i.indexOf(e.category),o=void 0!==e.subCategory&&r.includes(e.subCategory)?r.indexOf(e.subCategory):void 0;s=new Tf(this,this.gv,this.bi,this.pi.vs,e.category,e.subCategory,qt(o,n)),this.xv(s,"groups"===t||"stacks"===t?{legend:null}:void 0),this.GF.set(s,{category:n,valueStart:this.FF?1e-6:0,valueEnd:void 0!==e.value?e.value:0})}void 0!==e.value&&s.setValue(e.value)}),this.fv.slice().forEach(t=>{void 0===e.find(e=>e.category===t.category&&e.subCategory===t.subCategory)&&(t.dispose(),this.GF.delete(t))}),this.categoryAxis.setInterval(this.Xs.getWidth({x:{start:-.5,end:Math.max(s,1)-.5},y:{start:Math.max(s,1)-.5,end:-.5}})),this._F=0===this.fv.length?void 0:"stacks"!==t?this.fv.reduce((t,e)=>({min:Math.min(t.min,e.getValue()),max:Math.max(t.max,e.getValue())}),{min:ni,max:oi}):{min:0,max:i.reduce((t,i)=>Math.max(t,e.reduce((t,e)=>e.category!==i?t:void 0!==e.value?t+e.value:t,0)),0)},this._F&&(this.kF=this._F.min>=0?"positive":this._F.max<=0?"negative":"bipolar",("bipolar"===this.kF||"negative"===this.kF)&&this.FF))throw new Error("LightningChart JS BarChart bipolar/negative data + logarithmic value axis combination not supported.");if(this.rI&&this.rI(),"groups"===t||"stacks"===t){const t=r.map(t=>(t=>{let e=!1;const i=new Array;return t.forEach(s=>{const r=i=>{e||(e=!0,t.forEach(t=>s!==t?t.setHighlight(i.highlight):void 0),e=!1)};s.addEventListener("highlightchange",r),i.push(()=>s.removeEventListener("highlightchange",r))}),t.forEach(e=>{const s=()=>{const i=t.indexOf(e);i>=0&&t.splice(i,1)};e.addEventListener("dispose",s),i.push(()=>e.removeEventListener("dispose",s))}),()=>{i.forEach(t=>t())}})(this.fv.filter(e=>e.subCategory===t)));this.rI=()=>t.forEach(t=>t())}const n=new Set(r);for(const t of this.jF.keys())n.has(t)||(this.Os.forEach(e=>{if(e.xg()){const i=e.getEntries(),s=this.jF.get(t),r=i.find(t=>t.component===s);s&&r&&e.remove(s)}}),this.jF.delete(t));this.Os.forEach(t=>{t.xg()&&t.add(this)}),this.eI(this.fv),this.DF.clear(),this.EF.clear(),this.zF=!0,this.pi.Bs()}setCategoryLabels(t){const e="function"==typeof t?this.OF?t(this.OF):this.OF:t;return this.OF=e?{...this.bi.barChartCategoryLabels,...e}:void 0,this.DF.clear(),this.pi.Bs(),this.HF=!0,this}getCategoryLabels(){return this.OF}setValueLabels(t){var e;const i="function"==typeof t?this.CF?t(this.CF):this.CF:t,s=(null==i?void 0:i.position)||(null===(e=this.CF)||void 0===e?void 0:e.position);return i&&s?"after-bar"===s?this.CF={...this.bi.barChartValueLabelsAfterBars,...i}:"inside-bar"!==s&&"inside-bar-start"!==s&&"inside-bar-centered"!==s&&"inside-bar-end"!==s||(this.CF={...this.bi.barChartValueLabelsInsideBars,...i}):this.CF=void 0,this.EF.clear(),this.pi.Bs(),this.HF=!0,this}getValueLabels(){return this.CF}setLabelFittingEnabled(t){return this.NF=t,this.pi.Bs(),this}getLabelFittingEnabled(){return this.NF}setLabelFittingMargins(t){return this.WF="object"==typeof t?t:"number"==typeof t?{left:t,right:t,top:t,bottom:t}:Xe,this.HF=!0,this.pi.Bs(),this}getLabelFittingMargins(){return this.WF}getBar(t,e){if(("groups"===this.VF||"stacks"===this.VF)&&void 0===e)throw new Error("LightningChart JS BarChart.getBar() | `subCategory` parameter is required for grouped and stacked bar charts!");const i=this.fv.find(i=>i.category===t&&(void 0===e||e===i.subCategory));if(!i)throw new Error(`BarChart.getBar() no such bar: "${t}" ${e?`"${e}"`:""}`);return i}getBars(){return this.fv}setSorting(t){this.RF=t;const e=this.fv.slice();return this.fv.length=0,this.fv.push(...Ue(this.XF.map(t=>e.find(e=>e.category===t.category&&(void 0===t.subCategory||t.subCategory===e.subCategory))))),this.eI(this.fv),this.pi.Bs(),this.zF=!0,this}getSorting(){return this.RF}setAnimationCategoryPosition(t,e=1){return this.$F=t?{speed:e}:void 0,this.pi.Bs(),this}setAnimationValues(t,e=1){return this.yk=t?{speed:e}:void 0,this.pi.Bs(),this}translateCoordinate(t,e,i){if(i&&Es(t)&&Ms(e))return super.translateCoordinate(t,e,i);const s=e;let r;if(bs(t))r=this.pi.il(t);else if(Es(t)){const e=tt(t,this.eA,this.pi.ai);r={engineX:e.x,engineY:e.y}}else{if(!wf(t))throw new Error("LightningChart JS BarChart.translateCoordinate unexpected error. Input coordinate system not recognized.");{const e=tt(this.Xs.toPoint(t.iCategory,t.value),this.MF,this.pi.ai);r={engineX:e.x,engineY:e.y}}}if(Ss(s))return this.pi.sl(r);if("barChart"===s){const t=tt({x:r.engineX,y:r.engineY},this.pi.ai,this.MF);return{iCategory:this.Xs.getWidth(t),value:this.Xs.getHeight(t)}}if(Ms(s))return tt({x:r.engineX,y:r.engineY},this.pi.ai,this.eA);throw new Error("LightningChart JS BarChart.translateCoordinate unexpected error. Target coordinate system not recognized.")}bg(){if("columns"===this.VF)return this.fv;const t=Oe(Ue(this.fv.map(t=>t.subCategory)));return Ue(t.map(t=>{if(this.jF.has(t))return this.jF.get(t);const e=this.fv.filter(e=>e.subCategory===t),i=e[0];if(!i)return;const s={Ys:()=>{},getVisible:()=>i.getVisible(),setVisible:t=>{e.forEach(e=>e.setVisible(t))},getName:()=>t,er:()=>i.er()};return this.jF.set(t,s),s}))}ir(t){var e,i,s;super.ir(t);const r=this.tI.VA(),n=this.iI.VA(),o=this.fv.filter(t=>t.getVisible()&&t.PF),a=Oe(o.map(t=>t.category)),h=Oe(Ue(o.map(t=>t.subCategory))),l=5e-4*t*((null===(e=this.$F)||void 0===e?void 0:e.speed)||0),c=.003*t*((null===(i=this.$F)||void 0===i?void 0:i.speed)||0),u=this.valueAxis.ai,d=u instanceof H?(t,e)=>{var i;return Ds(t,e,u,(null===(i=this.yk)||void 0===i?void 0:i.speed)||0)}:(t,e)=>{var i;return Is(t,e,u,(null===(i=this.yk)||void 0===i?void 0:i.speed)||0)};let f;const g=null!==(s="positive"===this.kF&&this._F?Math.min(this._F.min,this.valueAxis.getInterval().start,this.valueAxis.getInterval().end)-(this._F.max-this._F.min):"negative"===this.kF&&this._F?Math.max(this._F.max,this.valueAxis.getInterval().start,this.valueAxis.getInterval().end)+(this._F.max-this._F.min):void 0)&&void 0!==s?s:0;"columns"===this.VF?f=o.map(t=>({bar:t,position:{category:a.indexOf(t.category),valueStart:this.FF?1e-6:g,valueEnd:t.value}})):"groups"===this.VF?f=o.map(t=>{const e=a.indexOf(t.category),i=h.indexOf(t.subCategory),s=1/(h.length+2*(h.length+1)*this.UF),r=this.UF*s;return{bar:t,position:{category:e+(i-(h.length-1)/2)*(s+r),valueStart:this.FF?1e-6:g,valueEnd:t.value}}}):(f=[],a.forEach(t=>{const e=o.filter(e=>e.category===t);let i=this.FF?1e-6:0;e.forEach(e=>{f.push({bar:e,position:{category:a.indexOf(t),valueStart:i,valueEnd:i+e.value}}),i+=e.value})})),f.forEach(t=>{const{bar:e,position:i}=t;let s,r,n=this.GF.get(e);void 0===n&&(n=i);const o=i.valueStart;if(this.$F&&n.category!==i.category){const t=Math.sign(i.category-n.category);s=n.category+l*t+c*(i.category-n.category),t!==Math.sign(i.category-s)&&(s=i.category)}else s=i.category;if(this.yk&&n.valueEnd!==i.valueEnd){const t=Math.sign(i.valueEnd-n.valueEnd);r=d(n.valueEnd,i.valueEnd),t!==Math.sign(i.valueEnd-r)&&(r=i.valueEnd)}else r=i.valueEnd;this.GF.set(e,{category:s,valueStart:o,valueEnd:r}),s===i.category&&r===i.valueEnd||this.pi.Bs(!0),s===n.category&&r===n.valueEnd||(this.zF=!0)});const p=[...this.fv];(this.YF.length!==p.length||this.YF.some((t,e)=>t!==p[e]))&&(this.Os.forEach(t=>t.Sg(this.fv)),this.YF=p);const m=Uh.tp(this.Yr,this.Wg),y=this.Os.reduce((t,e)=>{const i=e.Nh(m,this.Gn);return{top:Math.max(t.top,i.top),bottom:Math.max(t.bottom,i.bottom),left:Math.max(t.left,i.left),right:Math.max(t.right,i.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,y);const x=o.length>0;this.categoryAxis.pn(),this.valueAxis.pn();const{labelMarginBeforeCategoryAxisPixels:v,labels:A}=x?this.hI(a,h,o,r,n):{labelMarginBeforeCategoryAxisPixels:0,labels:[]},S=this.categoryAxis.Nh({physicalAxisSize:this.categoryAxis.ai.wt(),pA:v}),b=this.valueAxis.Nh({plotLines:n,physicalAxisSize:this.valueAxis.ai.wt(),oppositeAxisSize:this.Xs.getWidth(this.MF).wt()});this.MF.ti([this.ot.bottom+this.Gn.bottom+y.bottom+("vertical"===this.Xs.KF?S.yf:0),this.ot.top+this.Gn.top+m+y.top+("horizontal"===this.Xs.KF?b.yf:0)]),this.MF.qt([this.ot.left+this.Gn.left+y.left+this.Xs.getHeight({x:S.yf,y:b.yf}),this.ot.right+this.Gn.right+y.right]),this.JF.Tm({x:this.MF.x.bt(),y:this.MF.y.bt(),width:this.MF.x.wt(),height:this.MF.y.wt()}),this.kg&&this.kg();const M={x:Math.min(this.MF.x.getInnerStart(),this.MF.x.getInnerEnd()),y:Math.min(this.MF.y.getInnerStart(),this.MF.y.getInnerEnd())},E=Math.max(this.MF.x.getInnerStart(),this.MF.x.getInnerEnd()),k=Math.max(this.MF.y.getInnerStart(),this.MF.y.getInnerEnd()),T={x:E-M.x,y:k-M.y};if(this.yv.sr(M),this.yv.Z(T),this.mv.sr(M),this.mv.Z(T),this.categoryAxis.ir(S),this.valueAxis.ir(b),super.Yg(),this.jm.ir(!1,this.fv,void 0),(this.zF||this.HF)&&this.NF){const t=A.map(t=>{const e=t.setVisible(!0).Nh().mc();if(0!==this.WF.bottom||0!==this.WF.left||0!==this.WF.right||0!==this.WF.top){const i=Math.sign(this.MF.x.U-this.MF.x.$),s=Math.sign(this.MF.y.U-this.MF.y.$),r=s>0?e.min.y:e.max.y,n=s>0?e.max.y:e.min.y,o=i>0?e.min.x:e.max.x,a=i>0?e.max.x:e.min.x,h=t.ai.Qt({x:o,y:r},{x:-this.WF.left,y:-this.WF.bottom}),l=t.ai.Qt({x:a,y:n},{x:this.WF.right,y:this.WF.top});return{min:{x:Math.min(h.x,l.x),y:Math.min(h.y,l.y)},max:{x:Math.max(h.x,l.x),y:Math.max(h.y,l.y)}}}return e});for(let e=0;e<A.length;e+=1){if(!A[e].getVisible())continue;const i=t[e];let s;do{s=A.findIndex((s,r)=>r!==e&&A[r].getVisible()&&ci(i,t[r])),s>=0&&A[s].setVisible(!1)}while(s>=0)}}if(this.zF){const t=this.nb.VA(),e="groups"===this.VF?1/(h.length+2*(h.length+1)*this.UF):1-2*this.UF;o.forEach(i=>{const s=this.GF.get(i);if(void 0===s)return;const r=s.category-.5*e,n=s.category+.5*e,o=this.Xs.toPoint(r,s.valueStart),a=this.Xs.toPoint(n,s.valueEnd);let l;this.ZF&&(l={extent:this.ZF,c_x1_y2:"vertical"===this.Xs.KF,c_x2_y2:"vertical"===this.Xs.KF||"horizontal"===this.Xs.KF,c_x1_y1:!1,c_x2_y1:"horizontal"===this.Xs.KF},"stacks"===this.VF&&i.subCategory&&h.indexOf(i.subCategory)!==h.length-1&&(l=void 0)),t.add({xi:i.xi,bar:i,x1:o.x,y1:o.y,x2:a.x,y2:a.y,rounding:l},{fillStyle:i.Ze,strokeStyle:i.Je})}),t.finishPlot()}r.finishPlot(),n.finishPlot(),this.zF=!1,this.HF=!1,this.Os.forEach(t=>t.ir(m,this.Gn))}setAnimationsEnabled(t){return super.setAnimationsEnabled(t),this.setAnimationCategoryPosition(t),this.setAnimationValues(t),this.valueAxis.setAnimationsEnabled(t),this.categoryAxis.setAnimationsEnabled(t),this}dispose(){return this.QF.G(),this.JF.G(),this.jm.G(),super.dispose()}eI(t){const e=this.RF;e&&t.sort((i,s)=>e({category:i.category,value:t.reduce((t,e)=>t+(e.category===i.category&&e.value||0),0)},{category:s.category,value:t.reduce((t,e)=>t+(e.category===s.category&&e.value||0),0)}))}hI(t,e,i,s,r){let n=0;const o=this.OF,a=this.CF,h=this.valueAxis.getInterval(),l=[];if(o&&o.labelFillStyle!==ls){const e=o.tickLength+o.labelMargin,a=this.Xs.toPoint(o.labelAlignment,1),c={af:t.map((t,s)=>{const r=i.reduce((e,i)=>i.category!==t?e:e+i.value,0),n=o.formatter(t,r);if(!n)return;const l=s;return void 0!==l?{text:n,position:this.Xs.toPoint(l,this.valueAxis.ai.Qt(h.start,-e)),alignment:a,rotation:o.labelRotation,sizePixels:this.nI(t,r)}:void 0}),qn:o.labelFont,ai:this.MF};c.af.forEach(t=>{t&&l.push(s.add().tn(t.text).sr(t.position).Zl(t.alignment).Th(t.rotation).qe(o.labelFillStyle).Ch(o.labelFont).qh(o.labelShadow))}),o.tickStyle!==Bt&&0!==o.tickLength&&c.af.forEach(t=>{if(!t)return;const e=this.Xs.getWidth(t.position);r.add({positions:[this.Xs.toPoint(e,this.valueAxis.ai.getInnerStart()),this.Xs.toPoint(e,this.valueAxis.ai.Qt(h.start,-o.tickLength))]},{lineStyle:o.tickStyle})}),n=c.af.reduce((t,e)=>e?Math.max(t,this.Xs.getHeight(e.sizePixels)):t,0)+o.tickLength+o.labelMargin}if(a&&a.labelFillStyle!==ls){const r={af:[],qn:a.labelFont,ai:this.MF};"stacks"===this.VF&&a.displayStackedSum&&r.af.push(...t.map((t,s)=>{const r=i.reduce((e,i)=>e+(i.category===t?i.value:0),0),n=a.formatter({chart:this,bar:void 0,category:t,value:r,subCategory:void 0});if(!n)return;const o=i.filter(e=>e.category===t).sort((t,i)=>{var s,r;return e.indexOf(null!==(s=t.subCategory)&&void 0!==s?s:"")-e.indexOf(null!==(r=i.subCategory)&&void 0!==r?r:"")}),h=o[o.length-1],l=this.GF.get(h);return void 0!==l?{text:n,position:this.Xs.toPoint(l.category,this.valueAxis.ai.Qt(l.valueEnd,a.labelMargin*Math.sign(l.valueEnd))),alignment:this.Xs.toPoint(0,-1*Math.sign(l.valueEnd)),rotation:a.labelRotation,sizePixels:this.pi.th.Tr(n,a.labelFont,a.labelRotation)}:void 0})),"after-bar"!==a.position||"stacks"===this.VF&&!a.displayStackedIndividuals?"inside-bar"!==a.position&&"inside-bar-start"!==a.position&&"inside-bar-centered"!==a.position&&"inside-bar-end"!==a.position||r.af.push(...i.map((t,e)=>{const i=a.formatter({chart:this,bar:t,category:t.category,value:t.value,subCategory:t.subCategory});if(!i)return;const s=this.GF.get(t);if(void 0===s)return;const r="bipolar"===this.kF?Math.sign(s.valueEnd):"negative"===this.kF?-1:1,n=this.Xs.toPoint(0,"inside-bar"===a.position||"inside-bar-end"===a.position?1*r:"inside-bar-centered"===a.position?0:-1*r);return{text:i,position:this.Xs.toPoint(s.category,"inside-bar"===a.position||"inside-bar-end"===a.position?this.valueAxis.ai.Qt(s.valueEnd,-a.labelMargin*r):"inside-bar-centered"===a.position?(s.valueStart+s.valueEnd)/2:this.valueAxis.ai.Qt(s.valueStart,a.labelMargin*r)),alignment:n,rotation:a.labelRotation,sizePixels:this.oI(t)}})):r.af.push(...i.map((t,e)=>{const i=a.formatter({chart:this,bar:t,category:t.category,value:t.value,subCategory:t.subCategory});if(!i)return;const s=this.GF.get(t);return void 0!==s?{text:i,position:this.Xs.toPoint(s.category,this.valueAxis.ai.Qt(s.valueEnd,a.labelMargin*Math.sign(s.valueEnd))),alignment:this.Xs.toPoint(a.labelAlignment,-1*Math.sign(s.valueEnd)),rotation:a.labelRotation,sizePixels:this.oI(t)}:void 0})),r&&r.af.forEach(t=>{t&&l.push(s.add().tn(t.text).sr(t.position).Zl(t.alignment).Th(t.rotation).qe(a.labelFillStyle).Ch(a.labelFont).qh(a.labelShadow).setPointerEvents(!1))})}return{labelMarginBeforeCategoryAxisPixels:n,labels:l}}nI(t,e){if(!this.OF||this.OF.labelFillStyle===ls)return{x:0,y:0};const i=this.DF.get(t);if(i)return i;const s=this.OF.formatter(t,e),r=this.pi.th.Tr(s,this.OF.labelFont,this.OF.labelRotation);return r.isEstimate?this.pi.Bs(!0):this.DF.set(t,r),r}oI(t){if(!this.CF||this.CF.labelFillStyle===ls)return{x:0,y:0};const e=this.EF.get(t);if(e)return e;const i=this.pi.th.Tr(this.CF.formatter({chart:this,bar:t,category:t.category,value:t.value,subCategory:t.subCategory}),this.CF.labelFont,this.CF.labelRotation);return i.isEstimate?this.pi.Bs(!0):this.EF.set(t,i),i}TF(){return this.fv.reduce((t,e)=>{const i=this.oI(e);return{x:Math.max(t.x,i.x),y:Math.max(t.y,i.y)}},{x:0,y:0})}BF(){this.zF=!0,this.pi.Bs()}j(){return super.j(),this.MF.j(),this}H(){return super.H(),this.MF.H(),this}getMinimumSize(){return{x:200,y:200}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Bf={Disabled:void 0,None:void 0,Ascending:(t,e)=>t.value-e.value,Descending:(t,e)=>e.value-t.value,Alphabetical:(t,e)=>t.category.localeCompare(e.category)},Ff={...za,KF:"vertical",IF:-1,LF:1},Df={..._a,KF:"horizontal",IF:1,LF:-1},If=(t,e,i)=>{const s=[[{component:e.bar,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}]],r=t.valueAxis.getTitle();return r&&s.push([r]),e.subCategory?s.push([e.subCategory,"",{text:Bs(t.valueAxis.formatValue(e.bar.getValue()),t.valueAxis),font:{weight:"bold"}}]):s.push({text:Bs(t.valueAxis.formatValue(e.bar.getValue()),t.valueAxis),font:{weight:"bold"}}),s},Rf=(t,e)=>Math.abs(t)+Math.abs(e);function Lf(t,e){const i=t.reduce(Rf,0),s=(r=t,Math.max(...r.map(t=>t)));var r;const n=(t=>Math.min(...t.map(t=>t)))(t);return Math.max(e**2*s/i**2,i**2/(e**2*n))}const Pf=({height:t,width:e})=>t>e?{value:e,vertical:!1}:{value:t,vertical:!0},zf=({data:t,dimensions:e})=>{const{x:i,y:s,width:r,height:n}=e,o=t.map(t=>t.value).reduce(Rf,0),a=t.map(t=>t.animatedValue).reduce(Rf,0),h=t.map(t=>t.animatedValue*n*r/a),l=h.reduce((t,e)=>t+e,0),c=h.map(t=>t/l*100),u=h.filter((t,e)=>c[e]),d={children:[],id:0,parentID:-1,name:"Main Rectangle",value:o,animatedValue:a,x:i,y:s,width:r,height:n,nodeIndex:-1,userNode:{name:"Main Rectangle",value:o}};if(1===t.length){const i={...t[0],x:e.x,y:e.y,width:e.width,height:e.height,userNode:{...t[0].userNode,value:t[0].value}};d.children.push(i)}else Vf(u,Pf(d).value,t,d);return d.children},_f=(t,e,i,s,r)=>{const n=t.reduce(Rf,0)/e;t.forEach((t,e)=>{const o=Math.abs(t)/n,{x:a,y:h,children:l}=r,c=s[l.length],u={...c,x:a,y:h,width:i?n:o,height:i?o:n,userNode:{...c.userNode,value:c.value}};i?r.y-=o:r.x+=o,l.push(u)}),i?(r.x+=n,r.y+=e,r.width-=n):(r.x-=e,r.y-=n,r.height-=n)},Vf=(t,e,i,s)=>{const r=[{children:t,width:e,row:[]}];for(;r.length>0;){const t=r.pop();if(!t)continue;const{children:e,width:n,row:o}=t;let a=0;const h=[...o];for(;a<e.length;){const t=[...h,e[a]],o=Lf(h,n),l=Lf(t,n);if(!(0===h.length||o>l)){_f(h,n,Pf(s).vertical,i,s),r.push({children:e.slice(a),width:Pf(s).value,row:[]});break}h.push(e[a]),a+=1}a===e.length&&_f(h,n,Pf(s).vertical,i,s)}};class Nf extends Oh{constructor(t,i,s,r,n,o,a){var h;if(super(t,i,s,i.Hg("treeMapChart bg",0),r,i.pi.bi.treeMapChartBackgroundFillStyle||i.pi.bi.chartXYSeriesBackgroundFillStyle,i.pi.bi.treeMapChartBackgroundStrokeStyle||i.pi.bi.chartXYBackgroundStrokeStyle,i.pi.bi.treeMapChartTitleFont||i.pi.bi.chartXYTitleFont,i.pi.bi.treeMapChartTitleFillStyle||i.pi.bi.chartXYTitleFillStyle,i.pi.bi.treeMapChartTitleShadow||i.pi.bi.chartXYTitleShadow,a,null===(h=null==o?void 0:o.legend)||void 0===h?void 0:h.customLegend),this.aI=new Map,this.lI=[],this.uI={},this.cI=m([]),this.yk={speed:1},this.dI=ni,this.fI="Go Back",this.AI=[],this.gI=this.bi.treeMapChartPathLabelFillStyle||this.bi.uiTextFillStyle,this.pI=this.bi.treeMapChartPathLabelFont||this.bi.uiTextFont,this.vI=this.bi.treeMapChartLabelHeaderFillStyle||this.bi.uiTextFillStyle,this.yI=this.bi.treeMapChartLabelHeaderFont||this.bi.uiTextFont,this.mI=this.bi.treeMapChartLabelFillStyle||this.bi.uiTextFillStyle,this.xI=this.bi.treeMapChartLabelFont||this.bi.uiTextFont,this.gx=!0,this.tg=!1,this.SI=this.bi.treeMapChartParentColor||B,this.bI=this.bi.treeMapChartNodeStrokeStyle||this.bi.uiBackgroundStrokeStyle,this.MI=Xe,this.eb=this.bi.treeMapChartCornerRadius,this.yx=()=>{this.pi.Bs(),this.tg=!0},this.wI=(t,i)=>{var s;const{collectionMember:r}=i,n=this._I(r);n&&(this.Dx=this.kI(n,t),this.gx&&this.pi.Ms.Vs(r,!0),(null===(s=this.getUserInteractions().drillDown)||void 0===s?void 0:s.click)&&this.engine.setMouseStyle(e.MouseStyles.Point),this.pi.Bs())},this.CI=(t,i)=>{const{collectionMember:s}=i;this._I(s)&&(this.Dx=void 0,this.gx&&this.pi.Ms.Vs(s,!1),this.engine.setMouseStyle(e.MouseStyles.Default),this.pi.Bs())},this.TI=(t,i)=>{var s;const{collectionMember:r}=i,n=this._I(r);n&&(this.Dx=this.kI(n,t),this.gx&&this.pi.Ms.Vs(r,!0),(null===(s=this.getUserInteractions().drillDown)||void 0===s?void 0:s.click)&&this.engine.setMouseStyle(e.MouseStyles.Point),this.pi.Bs())},this.FI=(t,e)=>{var i;if(t.defaultPrevented)return;const{collectionMember:s}=e,r=this._I(s);if(r){if(null===(i=this.getUserInteractions().drillDown)||void 0===i?void 0:i.click){const e=(null==r?void 0:r.children.length)?r:r.parentID?this.uI[r.parentID]:void 0;e&&(this.cI.C([e]),this.Dx=void 0,this.D.R("viewchange",{nodes:this.cI.T().map(t=>t.userNode)}),this.tg=!0),t&&fe(t)}this.pi.Bs()}},this.II=t=>{const e=this.uI[this.AI[t].id]?[this.uI[this.AI[t].id]]:this.lI;this.cI.C(e),this.D.R("viewchange",{nodes:e.map(t=>t.userNode)}),this.tg=!0,this.pi.Bs()},this.nodes=new vt,this.D=new vt,this.bi.treeMapChartNodeColors)this.LI=this.bi.treeMapChartNodeColors;else{const t=this.bi.pointSeriesFillStyle,e=t=>gs(t)?t.getColor():B;this.LI="function"==typeof t?new Array(5).fill(0).map((i,s)=>e(t(s))):[e(t)]}this.pi.La(Hn.Vo),this.Pk=i.Rm("TreeMapChart plotting",0),this.Bk=i.Rm("TreeMap UI plotting",1),this.addEventListener("resize",this.yx),this.Yr.tn("TreeMap Chart");const l=i.Ym(),c=qt(o?o.cursorBuilder:void 0,Ul);this.jm=ig(this,l,c.Am(l,this.uiScale,this.uiScale,jt,this.bi),void 0,"show-pointed",Of,()=>0),this.BI=this.vs.aA(),this.jg(n,this.uiScale),this.ff=this.Pk.md(this.eA).qe(new ps).Ke(this.bI),this.DI=this.pi.Ms.jo(this,{animationEnabled:!1!==(null==o?void 0:o.animationsEnabled)}),this.EI=new Th(()=>this.Bk._n(this.eA).setPointerEvents(!1)),this.RI=new Th(()=>this.Bk._n(this.uiScale)),this.ff.setPointerEvents(!0),this.nodes.Ni(this.ff,t=>{const e=this._I(t);if(e)return e.userNode}),this.setAnimationsEnabled(!1!==(null==o?void 0:o.animationsEnabled)),this.ff.addEventListener("pointerenter",this.wI),this.ff.addEventListener("pointerleave",this.CI),this.ff.addEventListener("click",this.FI),this.ff.addEventListener("pointermove",this.TI),void 0!==(null==o?void 0:o.legend)&&this.legend.setOptions(o.legend)}setCornerRadius(t){return this.eb=t,this.tg=!0,this.pi.Bs(),this}getCornerRadius(){return this.eb}setData(t){t=Array.isArray(t)?t.slice():[t];const{OI:e}=(()=>{let t=0;return{OI:e=>{var i;const s=e.map((t,e)=>({node:t,parent:null})),r=[];for(;s.length>0;){const e=s.pop();if(!e)continue;const{node:n,parent:o}=e;t+=1;const a={id:t,parentID:null==o?void 0:o.id,name:n.name,value:Number(n.value)||0,animatedValue:Number(n.value)||0,children:[],nodeIndex:o?o.nodeIndex:-1,userNode:n};o?o.children.push(a):r.push(a),null===(i=n.children)||void 0===i||i.forEach(t=>{s.push({node:t,parent:a})})}const n=t=>{t.children.forEach(n),t.children.length>0&&(t.value+=t.children.reduce((t,e)=>t+e.value,0),t.animatedValue+=t.children.reduce((t,e)=>t+e.animatedValue,0),t.children.sort((t,e)=>e.animatedValue-t.animatedValue))};r.forEach(n);const o=1===e.length?r[0].children:r;return o.sort((t,e)=>e.animatedValue-t.animatedValue),o.forEach((t,e)=>{t.nodeIndex=e;const i=e=>{e.children.forEach(e=>{e.nodeIndex=t.nodeIndex,i(e)})};i(t)}),r}}})(),i=e(t);return i.forEach(t=>{const e=this.uI[t.id];e&&this.zI(t,e)}),this.Dx=void 0,this.cI.C(i),this.lI=i,this.uI=this.VI(i),this.tg=!0,this.pi.Bs(),this}setAnimationValues(t,e=1){return this.yk=t?{speed:e}:void 0,this.pi.Bs(),this}setInitPathButtonText(t){return this.fI=t,this.tg=!0,this.pi.Bs(),this}setDisplayedLevelsCount(t){return this.dI=t,this.tg=!0,this.pi.Bs(),this}setDrillDownNode(t){var e,i;if(this.Dx=void 0,void 0===t)this.cI.C(this.lI);else{const s=[...this.lI];for(;s.length>0;){const r=s.pop();if(r){if(void 0!==r.value&&r.userNode===t||r.parentID&&Array.isArray(t)&&(null===(i=null===(e=this.uI[r.parentID])||void 0===e?void 0:e.userNode)||void 0===i?void 0:i.children)===t){const t=r.children.length?r:r.parentID?this.uI[r.parentID]:this.lI[0];this.cI.C([t]);break}if(r.children)for(let t=r.children.length-1;t>=0;t-=1)s.push(r.children[t])}}}return this.D.R("viewchange",{nodes:this.cI.T().map(t=>t.userNode)}),this.tg=!0,this.pi.Bs(),this}setNodeColoring(t){return t instanceof Array?(this.ff.qe(new ps),this.LI=t):(this.ff.qe(t),this.Os.forEach(t=>{t.xg()&&t.add(this)})),this.Os.forEach(t=>t.zs()),this.tg=!0,this.pi.Bs(),this}setParentNodeColor(t){return this.SI=t,this.tg=!0,this.pi.Bs(),this}setPathLabelFillStyle(t){return this.gI="function"==typeof t?t(this.gI):t,this.tg=!0,this.pi.Bs(),this}getPathLabelFillStyle(){return this.gI}setPathLabelFont(t){return R(t)?this.pI=t:this.pI=t(this.pI),this.tg=!0,this.pi.Bs(),this}getPathLabelFont(){return this.pI}setHeaderFont(t){return R(t)?this.yI=t:this.yI=t(this.yI),this.tg=!0,this.pi.Bs(),this}getHeaderFont(){return this.yI}setHeaderFillStyle(t){return this.vI="function"==typeof t?t(this.vI):t,this.tg=!0,this.pi.Bs(),this}getHeaderFillStyle(){return this.vI}setLabelFont(t){return R(t)?this.xI=t:this.xI=t(this.xI),this.tg=!0,this.pi.Bs(),this}getLabelFont(){return this.xI}setLabelFillStyle(t){return this.mI="function"==typeof t?t(this.mI):t,this.tg=!0,this.pi.Bs(),this}getLabelFillStyle(){return this.mI}setNodeBorderStyle(t){return this.ff.Ke(t),this.tg=!0,this.pi.Bs(),this}getNodeBorderStyle(){return this.ff.Ja()}setNodeEffect(t){return this.BI.Ps(t),this.pi.Bs(),this}getNodeEffect(){return this.BI.Ds()}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Ul){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}setAnimationHighlight(t){return this.DI.Xo(t),this}getAnimationHighlight(){return this.DI.Zo()}setHighlightOnHover(t){return this.gx=t,this}getHighlightOnHover(){return this.gx}kI(t,e){const i=this.pi.il(e);return{cursorPosition:{pointMarker:{x:i.engineX,y:i.engineY},pointMarkerScale:this.pi.ai,resultTable:{x:i.engineX,y:i.engineY},resultTableScale:this.pi.ai},name:t.name,value:t.value,node:t.userNode}}getMinimumSize(){}bg(){return[this]}ir(t){super.ir(t),super.Yg();const i=Uh.tp(this.Yr,this.Wg),s=this.Os.reduce((t,e)=>{const s=e.Nh(i,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});if(s.bottom===this.MI.bottom&&s.right===this.MI.right&&s.top===this.MI.top&&s.left===this.MI.left||(this.tg=!0,this.MI=s),Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,s),this.tg&&this.cI.T().length){this.ff.Vi(),this.aI.clear(),this.DI.Wo(),this.Er&&this.NI(t);const r=zf({data:this.cI.T(),dimensions:{x:0+this.Gn.left+s.left,y:this.eA.y.getInnerEnd()-i-this.Gn.top-s.top,width:this.eA.x.getInnerEnd()-this.Gn.right-this.Gn.left-s.right-s.left,height:this.eA.y.getInnerEnd()-i-this.Gn.top-this.Gn.bottom-s.top-s.bottom}}),n=this.EI.VA();this.GI(r,n),n.finishPlot(),this.$I(),this.lI!==this.cI.T()&&this.lI.length>1&&this.AI.unshift({name:this.fI,id:0});let o=0;const a=this.RI.VA(),h=this.pI;this.AI.forEach((t,i)=>{const s=a.add(),r=this.pi.th.Tr(t.name,h,0);let n;s.tn(`← ${t.name}`).Ch(h).sr({x:0,y:100}).Zl({x:-1,y:1}).Mn({left:this.Gn.left+o,top:this.Gn.top,right:0,bottom:0}).qe(this.gI),s.addEventListener("click",()=>this.II(i)),s.addEventListener("pointerenter",()=>{n=this.engine.setMouseStyle(e.MouseStyles.Point,n)}),s.addEventListener("pointerleave",()=>{this.engine.restoreMouseStyle(n)}),o+=r.x+25}),a.finishPlot(),this.cI.T().every(t=>t.value===t.animatedValue)?this.tg=!1:this.pi.Bs(!0)}return this.jm.ir(!1,[],void 0,{explicitTarget:this.Dx}),this.Os.forEach(t=>t.ir(i,this.Gn)),this}dispose(){return this.Bk.G(),this.Pk.G(),this.jm.G(),this.ff.dispose(),this.aI.clear(),this.EI.UA(),this.RI.UA(),super.dispose()}j(){return super.j(),this}H(){return super.H(),this}Ys(){return Re(this.ff.Mh(),this.ff._i())}GI(t,e,i=!1,s=0){const r=t.map((t,e)=>({node:t,isChild:i,visibleDepth:s})),n=this.eb?{extent:this.eb,c_x1_y1:!0,c_x1_y2:!0,c_x2_y1:!0,c_x2_y2:!0}:void 0;for(;r.length>0;){const t=r.pop();if(!t)continue;const{node:i,visibleDepth:s,opacity:o}=t,{x:a,y:h,height:l,width:c,children:u,animatedValue:d,name:f,nodeIndex:g}=i,p=this.LI,m=0===s&&1===this.cI.T().length?this.SI:p[g%p.length],y=this.ff.Ho().Md(a,h,a+c,h-l).UI(m.setA(m.getA()*((null!=o?o:255)/255))).Bx(d).bd(n);this.aI.set(y,i),this.DI.Ho(y,t=>y.Ii(t));const x=a+5,v=h+25+5,A=Math.max(l-25-5,0),S=Math.max(c-5-5,0);if(u&&u.length&&s<this.dI&&S>15&&A>15){const t=zf({data:u,dimensions:{x:S>0?x:a,y:A>0?h-25:v,width:S,height:A}});for(let e=0;e<t.length;e+=1){const n=(255-(u.length>7?50:150))/(u.length-1),a=1===i.id&&1===this.lI.length||this.lI===this.cI.T()?255:o?o/(s+1):255-e*n;r.push({node:t[e],isChild:!0,visibleDepth:s+1,opacity:a})}}const b=0===s&&1===this.cI.T().length?this.vI:this.mI,M=0===s?this.yI:this.xI,E=this.YI(f,c-25,M),k=this.pi.th.Tr(E,M,0),T=e.add();c-25>k.x&&l>25?T.tn(E).sr({x:a+5,y:h-2.5}).Zl({x:-1,y:1}).qe(b).Ch(M):T.tn("")}}VI(t){const e={},i=[...t];for(;i.length>0;){const t=i.pop();t&&(e[t.id]=t,t.children&&i.push(...t.children))}return e}_I(t){if(!this.tg&&t)return this.aI.get(t)}$I(){this.AI=[];const t=this.cI.T()[0].id;let e=this.uI[t].parentID;for(;e;)this.AI.push({name:this.uI[e].name,id:e}),e=this.uI[e].parentID;return this.AI.reverse()}YI(t,e,i){let s=this.pi.th.Tr(t,i,0).x;if(s<=e)return t;const r=t.split(" ");let n=t;for(;r.length>1&&s>e;)r.pop(),n=`${r.join(" ")}...`,s=this.pi.th.Tr(n,i,0).x;if(s>e)for(n=`${r[0]}...`,s=this.pi.th.Tr(n,i,0).x;n.length>3&&s>e;)n=`${n.substring(0,n.length-4)}...`,s=this.pi.th.Tr(n,i,0).x;return n.length<=3&&s>e?"":n}NI(t){var e;const i=[...this.lI];for(;i.length>0;){const s=i.pop();if(!s)continue;const r=s.value-s.animatedValue;if(Math.abs(r)<.0015*s.value||void 0===this.yk)s.animatedValue=s.value;else{const i=r/255*((null===(e=this.yk)||void 0===e?void 0:e.speed)||1)*t;s.animatedValue+=i,(r>0&&s.animatedValue>s.value||r<0&&s.animatedValue<s.value)&&(s.animatedValue=s.value)}s.children&&s.children.length>0&&i.push(...s.children)}}zI(t,e){const i=[{current:t,previous:e}];for(;i.length>0;){const t=i.pop();if(!t)continue;const{current:e,previous:s}=t;e.animatedValue=this.Er?s.animatedValue:e.value,s.nodeIndex<0?e.nodeIndex=0:e.nodeIndex=s.nodeIndex;const r=new Map(s.children.map(t=>[t.id,t]));e.children.forEach((t,e)=>{const n=r.get(t.id);i.push({current:t,previous:n||s})})}}setUserInteractions(t){return this.ar=void 0===t?{drillDown:{click:!1}}:t,this}getUserInteractions(){return Nt({drillDown:{click:!0}},this.ar)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Of=(t,e,i)=>[[{text:e.name,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[{text:e.value.toString(),font:{weight:"bold"}}]];class Uf extends Oh{constructor(t,e,i,s,r,n,o){var a;super(t,e,i,e.Hg("gaugeChart bg",0),s,e.pi.bi.gaugeChartBackgroundFillStyle,e.pi.bi.gaugeChartBackgroundStrokeStyle,e.pi.bi.gaugeChartTitleFont,e.pi.bi.gaugeChartTitleFillStyle,e.pi.bi.gaugeChartTitleShadow,n,null===(a=null==o?void 0:o.legend)||void 0===a?void 0:a.customLegend),this.Gu=this.bi.gaugeChartStartAngle,this.$u=this.bi.gaugeChartEndAngle,this.jI={start:0,end:100},this.M=0,this.HI=[],this.WI=this.bi.gaugeChartBarThickness,this.XI=this.bi.gaugeChartValueIndicatorThickness,this.ZI=this.bi.gaugeChartNeedleLength,this.JI=this.bi.gaugeChartNeedleThickness,this.QI=this.bi.gaugeChartNeedleFillStyle,this.KI=this.bi.gaugeChartNeedleStrokeStyle,this.Sd=this.bi.gaugeChartRoundedEdges,this.qI=!0,this.tL=!0,this.iL=!0,this.sL=[],this.eL=[],this.rL=!0,this.hL=!0,this.gk=this.M,this.nL=t=>Number.isInteger(t)?t.toString():t.toFixed(2),this.oL=this.bi.gaugeChartBarGradient,this.aL=t=>Number.isInteger(t)?t.toString():t.toFixed(2),this.lL=this.bi.gaugeChartTickFont,this.uL=this.bi.gaugeChartValueLabelFont,this.cL=this.bi.gaugeChartValueLabelFillStyle,this.dL=this.bi.gaugeChartUnitLabelFont,this.fL=this.bi.gaugeChartUnitLabelFillStyle,this.AL=this.bi.gaugeChartTickFillStyle,this.gL=this.bi.gaugeChartBarColor,this.pL=this.bi.gaugeChartGlowColor,this.vL=this.bi.gaugeChartGlowColor.getA(),this.yL=1,this.mL=1,this.xL=this.bi.gaugeChartNeedleAlignment,this.SL=!1,this.bL=this.bi.gaugeChartGapBetweenBarAndValueIndicators,this.ML=this.bi.gaugeChartBarStrokeStyle,this.MI=Xe,this.wL=!1,this.D=new vt,this.pi.La(Hn._o),this.Yr.tn("Gauge Chart"),this.jg(r,this.eA),this.setAnimationsEnabled(!1!==(null==o?void 0:o.animationsEnabled)),this._L=this.gL,this.kL=this.pL,this.CL=M(0,0,0,0),this.TL=this.vs.aA(),this.FL=this.vs.aA().Ps(this.bi.effectsText),this.IL=this.Ig.Tc(this.eA).Ke(this.ML).setPointerEvents(!1),this.LL=this.Ig._d(this.eA).Qu(0).Ar(360).sc(0).Ke(Bt).setPointerEvents(!1),this.PL=this.Zg.dr(this.eA).cr(this.bi.gaugeChartNeedleStrokeStyle).setPointerEvents(!1),this.BL=this.Zg.dr(this.eA).cr(new lr({thickness:this.JI,fillStyle:this.QI})).setPointerEvents(!1),this.DL=this.Zg._n(this.eA).Ch(this.uL).qe(this.cL).setPointerEvents(!1),this.Af=this.Zg._n(this.eA).Ch(this.dL).qe(this.fL).tn("").setPointerEvents(!1),this.EL=this.Ig._n(this.eA).Ch(this.lL).qe(this.AL).setPointerEvents(!1),this.RL=this.Ig._n(this.eA).Ch(this.lL).qe(this.AL).setPointerEvents(!1),this.TL.ks([this.IL]),this.FL.ks([this.DL,this.Af,this.EL,this.RL]),this.OL(),this.addEventListener("resize",()=>{this.SL=!0});const h={backgroundVisible:!0,...null==o?void 0:o.legend};this.legend.setOptions(h)}OL(){this.BL.cr(t=>t.setThickness(this.JI)),this.PL.cr(t=>t.setThickness(2*this.KI.getThickness()+this.JI))}setAnimationsEnabled(t){return this.Er=t,this.hL=t,this.rL=t,this}setInterval(t,e){return this.jI={start:t,end:e},this.SL=!0,this.pi.Bs(),this}getInterval(){return this.jI}setTickFillStyle(t){return this.AL="function"==typeof t?t(this.AL):t,this.eL.forEach(e=>{e.start.qe(t),e.end.qe(t)}),this.EL.qe(t),this.RL.qe(t),this.SL=!0,this.pi.Bs(),this}getTickFillStyle(){return this.AL}setTickFont(t){return this.lL="function"==typeof t?t(this.lL):t,this.eL.forEach(e=>{e.start.Ch(t),e.end.Ch(t)}),this.EL.Ch(t),this.RL.Ch(t),this.SL=!0,this.pi.Bs(),this}getTickFont(){return this.lL}setTickFormatter(t){return this.nL=t,this.SL=!0,this.pi.Bs(),this}getTickFormatter(){return this.nL}setValueLabelFillStyle(t){return this.cL="function"==typeof t?t(this.cL):t,this.DL.qe(t),this.SL=!0,this.pi.Bs(),this}getValueLabelFillStyle(){return this.DL.Mh()}setValueLabelFont(t){return this.uL="function"==typeof t?t(this.uL):t,this.DL.Ch(t),this.SL=!0,this.pi.Bs(),this}getValueLabelFont(){return this.DL.kh()}setValueFormatter(t){return this.aL="string"==typeof t?e=>t:t,this.SL=!0,this.pi.Bs(),this}getValueLabel(){return this.DL.rn()||this.aL}setUnitLabelFillStyle(t){return this.fL="function"==typeof t?t(this.fL):t,this.Af.qe(t),this.SL=!0,this.pi.Bs(),this}getUnitLabelFillStyle(){return this.Af.Mh()}setUnitLabelFont(t){return this.dL="function"==typeof t?t(this.dL):t,this.Af.Ch(t),this.SL=!0,this.pi.Bs(),this}getUnitLabelFont(){return this.Af.kh()}setUnitLabel(t){return this.Af.tn(t),this.SL=!0,this.pi.Bs(),this}getUnitLabel(){return this.Af.rn()}setNeedleFillStyle(t){return this.QI="function"==typeof t?t(this.QI):t,this.BL.cr(e=>e.setFillStyle(t)),this.SL=!0,this.pi.Bs(),this}getNeedleFillStyle(){return this.BL.do().getFillStyle()}setNeedleThickness(t){return this.JI=t,this.OL(),this.SL=!0,this.pi.Bs(),this}getNeedleThickness(){return this.JI}setNeedleStrokeStyle(t){return this.KI="function"==typeof t?t(this.KI):t,this.PL.cr(t),this.OL(),this.SL=!0,this.pi.Bs(),this}getNeedleStrokeStyle(){return this.PL.do()}setNeedleLength(t){return this.ZI=t,this.SL=!0,this.pi.Bs(),this}getNeedleLength(){return this.ZI}setBarColor(t){return this.gL=t,this.SL=!0,this.pi.Bs(),this}getBarColor(){return this._L}setBarGradient(t){return this.oL=t,this.SL=!0,this.pi.Bs(),this}getBarGradient(){return this.oL}setBarStrokeStyle(t){return this.ML="function"==typeof t?t(this.ML):t,this.IL.Ke(t),this.SL=!0,this.pi.Bs(),this}getBarStrokeStyle(){return this.IL.Ja()}setBarThickness(t){return this.WI=t,this.SL=!0,this.pi.Bs(),this}getBarThickness(){return this.WI}setAngleInterval(t,e){return Math.abs(t-e)>360&&(e=t<e?t+360:t-360),this.Gu=t,this.$u=e,this.SL=!0,this.pi.Bs(),this}getAngleInterval(){return{start:this.Gu,end:this.$u}}setValue(t){return this.wL&&this.pi.La(Hn.Ro),this.wL=!0,this.M=t,this.rL||(this.gk=this.M),this.SL=!0,this.pi.Bs(),this}getValue(){return this.M}setValueAnimation(t,e=1){return this.rL=t,this.yL=Math.max(0,e),this.SL=!0,this.pi.Bs(),this}setColorAnimation(t,e=1){return this.hL=t,this.mL=Math.max(0,e),this.SL=!0,this.pi.Bs(),this}setRoundedEdges(t){return this.Sd=t,this.SL=!0,this.pi.Bs(),this}getRoundedEdges(){return this.Sd}setValueIndicators(t){return this.HI=t,this.sL.forEach(t=>{t.dispose()}),this.sL.length=0,this.eL.forEach(t=>{t.start.dispose(),t.end.dispose()}),this.eL.length=0,this.HI.forEach(t=>{const e=new fs({color:t.color}),i=this.Ig.Tc(this.eA).Ke(Bt).qe(e).setPointerEvents(!1);this.sL.push(i);const s=this.Ig._n(this.eA).Ch(this.lL).qe(this.AL).setPointerEvents(!1),r=this.Ig._n(this.eA).Ch(this.lL).qe(this.AL).setPointerEvents(!1);this.eL.push({start:s,end:r})}),this.TL.ks([this.IL,...this.sL]),this.FL.ks([this.DL,this.Af,this.EL,this.RL,...this.eL.map(t=>[t.start,t.end]).flat()]),this.SL=!0,this.pi.Bs(),this}getValueIndicators(){return this.HI}setValueIndicatorThickness(t){return this.XI=t,this.SL=!0,this.pi.Bs(),this}getValueIndicatorThickness(){return this.XI}setAutomaticBarColoring(t){return this.iL=!!t,this.SL=!0,this.pi.Bs(),this}getAutomaticBarColoring(){return this.iL}setGlowColor(t){return void 0===t?(this.qI=!1,this.kL=void 0):"object"==typeof t&&"auto"in t?(this.tL=t.auto,t.auto&&(this.kL=void 0),void 0!==t.alpha&&(this.vL=t.alpha),this.qI=!0):(this.kL=t,this.vL=t.getA(),this.tL=!1,this.qI=!0),this.SL=!0,this.pi.Bs(),this}getAutomaticGlowColoring(){return this.tL}setNeedleAlignment(t){return this.xL=t,this.SL=!0,this.pi.Bs(),this}getNeedleAlignment(){return this.xL}setGapBetweenBarAndValueIndicators(t){return this.bL=t,this.SL=!0,this.pi.Bs(),this}getGapBetweenBarAndValueIndicators(){return this.bL}setBarEffect(t){return this.TL.Ps(t),this.pi.Bs(),this}getBarEffect(){return this.TL.Ds()}setLabelEffect(t){return this.FL.Ps(t),this.pi.Bs(),this}getLabelEffect(){return this.FL.Ds()}ir(t){var i;if(super.ir(t),super.Yg(),this.gk!==this.M){if(this.rL){const e=5e-4*t,i=.003*t,s=Math.sign(this.M-this.gk);this.gk=this.gk+e*s+i*this.yL*(this.M-this.gk),s!==Math.sign(this.M-this.gk)?this.gk=this.M:this.pi.Bs(!0)}else this.gk=this.M;this.SL=!0}let s=this.HI.find(t=>this.gk>=t.start&&this.gk<=t.end);if(s||(this.gk<this.jI.start?s=this.HI.find(t=>t.start===this.jI.start):this.gk>this.jI.end&&(s=this.HI.find(t=>t.end===this.jI.end))),this._L=this.iL&&s?s.color:this.gL,this.hL){if(this.CL!==this._L){const e=this.CL.getR(),i=this.CL.getG(),s=this.CL.getB(),r=this._L.getR(),n=this._L.getG(),o=this._L.getB(),a=Math.sign(r-e),h=Math.sign(n-i),l=Math.sign(o-s),c=.005*t,u=.003*t;this.CL=M(e+c*a+u*this.mL*(r-e),i+c*h+u*this.mL*(n-i),s+c*l+u*this.mL*(o-s));const d=Math.abs(r-this.CL.getR()),f=Math.abs(n-this.CL.getG()),g=Math.abs(o-this.CL.getB());d<1&&f<1&&g<1?this.CL=this._L:this.pi.Bs(!0),this.SL=!0}}else this.CL=this._L;const r=Uh.tp(this.Yr,this.Wg),n=this.Os.reduce((t,e)=>{const i=e.Nh(r,this.Gn);return{top:Math.max(t.top,i.top),bottom:Math.max(t.bottom,i.bottom),left:Math.max(t.left,i.left),right:Math.max(t.right,i.right)}},{top:0,bottom:0,left:0,right:0});if(n.right===this.MI.right&&n.bottom===this.MI.bottom&&n.top===this.MI.top&&n.left===this.MI.left||(this.SL=!0,this.MI=n),this.SL){let t=ni,o=oi,a=ni,h=oi;if(new Array(100).fill(0).forEach((e,i,s)=>{const r=this.Gu+i/s.length*(this.$u-this.Gu),n=Math.sin(r*Math.PI/180),l=Math.cos(r*Math.PI/180);n<t&&(t=n),n>o&&(o=n),l<a&&(a=l),l>h&&(h=l)}),this.oL?this.IL.qe(new V({stops:[{offset:0,color:E("#000000")},{offset:1,color:this.CL}],position:{x:.5,y:.5}})):this.IL.qe(new fs({color:this.CL})),this.qI){const t=this.tL&&s?this.CL:null!==(i=this.kL)&&void 0!==i?i:this.pL;this.LL.qe(new V({stops:[{offset:0,color:t.setA(this.vL)},{offset:1,color:t.setA(0)}],position:{x:.5,y:.5},extent:e.GradientExtent.farthestSide}))}else this.LL.qe(ls);const l=this.nL(this.jI.start),c=this.nL(this.jI.end);let u=0,d=0;const f=this.pi.th.Tr(l,this.EL.kh(),this.EL.Fh()),g=this.pi.th.Tr(c,this.RL.kh(),this.RL.Fh());f.x>u&&(u=f.x),f.y>d&&(d=f.y),g.x>u&&(u=g.x),g.y>d&&(d=g.y),this.eL.forEach((t,e)=>{if(e>=this.HI.length)return;const i=this.HI[e],s=this.nL(i.start),r=this.nL(i.end),n=this.pi.th.Tr(s,t.start.kh(),t.start.Fh()),o=this.pi.th.Tr(r,t.end.kh(),t.end.Fh());n.x>u&&(u=n.x),n.y>d&&(d=n.y),o.x>u&&(u=o.x),o.y>d&&(d=o.y)});const p=this.HI.length>0?this.XI:0,m=this.eA.getInnerIntervalPixels();Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,n);const y={x:m.x-(this.Gn.left+this.Gn.right),y:m.y-(this.Gn.bottom+this.Gn.top)-r},x={x:y.x-n.left-n.right,y:y.y-n.top-n.bottom},v={x:this.Gn.left+(y.x+n.left-n.right)/2,y:this.Gn.bottom+(y.y+n.bottom-n.top)/2},A=p+2*this.bL+this.WI/2,S=u+A,b=d+A,M=b+r,k=x.y-(M+b),T=x.x-(S+S),w=Math.max(0,k<T?k:T),C=.5*w,B=.5*C,F=(t+o)*B,D=(a+h)*B,I={x:v.x-D,y:v.y-F},R=w>0;if(this.IL.setVisible(R),this.sL.forEach(t=>t.setVisible(R)),this.BL.setVisible(R),this.PL.setVisible(R),this.LL.setVisible(R),this.Af.setVisible(R),this.DL.setVisible(R),this.EL.setVisible(R),this.RL.setVisible(R),this.eL.forEach(t=>{t.start.setVisible(R),t.end.setVisible(R)}),!R)return;const L={x:v.x-.5*D,y:v.y-.5*F};this.LL.sr(v).Ku(.5*Math.min(x.x,m.y)),this.DL.sr(L).tn(this.aL(this.gk));let P=this.DL.bc(),z=this.Af.bc();0===P.y&&(P=this.pi.th.Tr(this.DL.rn(),this.DL.kh(),this.DL.Fh())),0===z.y&&(z=this.pi.th.Tr(this.Af.rn(),this.Af.kh(),this.Af.Fh())),this.Af.sr({x:L.x,y:L.y-P.y-z.y/4});const _=Zf(this.jI,this.Gu,this.$u,this.gk,I,C+this.xL*(this.ZI/2+this.WI/2)),N=_.angle*(Math.PI/180),O=.5*this.ZI,U=Math.cos(N),G=Math.sin(N);this.BL.gr({x:_.x+O*U,y:_.y+O*G}).Ar({x:_.x-O*U,y:_.y-O*G}),this.PL.gr({x:_.x+O*U,y:_.y+O*G}).Ar({x:_.x-O*U,y:_.y-O*G});const Y=Gf(I,C,this.Gu,this.$u,this.WI,this.Sd,!1,!1);this.IL.au(Y).Ti({min:{x:I.x-C,y:I.y-C},max:{x:I.x+C,y:I.y+C}});const Z=I.y+C,W=I.y-C,j=I.x+C,H=I.x-C,[$,X]=this.jI.start<this.jI.end?[this.jI.start,this.jI.end]:[this.jI.end,this.jI.start],q=C+.5*this.WI+p/2+this.bL,K=q+p/2;this.HI.forEach((t,e)=>{var i,s;const r=t.start>=$&&t.end<=X;this.sL[e].setVisible(r),this.eL[e].start.setVisible(r),this.eL[e].end.setVisible(r);const n=Zf(this.jI,this.Gu,this.$u,t.start,I,K),o=Zf(this.jI,this.Gu,this.$u,t.end,I,K),a=Gf(I,q,n.angle,o.angle,this.XI,this.Sd,!(0===e),!(e===this.HI.length-1));this.sL[e].au(a);const h=this.jI.start===t.start||this.jI.end===t.start,l=this.jI.start===t.end||this.jI.end===t.end||this.HI.some(e=>e.start===t.end&&e!==t);this.eL[e].start.sr({x:n.x,y:n.y}).Zl({x:Math.min(1,Math.max(-1,2*(n.x-j)/(H-j)-1)),y:Math.min(1,Math.max(-1,2*(n.y-Z)/(W-Z)-1))}).tn(null!==(i=t.startLabel)&&void 0!==i?i:h?"":this.nL(t.start)),this.eL[e].end.sr({x:o.x,y:o.y}).Zl({x:Math.min(1,Math.max(-1,2*(o.x-j)/(H-j)-1)),y:Math.min(1,Math.max(-1,2*(o.y-Z)/(W-Z)-1))}).tn(null!==(s=t.endLabel)&&void 0!==s?s:l?"":this.nL(t.end))});const J=this.HI.some(t=>t.start<t.end?this.jI.start>=t.start&&this.jI.start<=t.end:this.jI.start<=t.start&&this.jI.start>=t.end),Q=Zf(this.jI,this.Gu,this.$u,this.jI.start,I,J?K:q-this.bL);this.EL.sr({x:Q.x,y:Q.y}).Zl({x:Math.min(1,Math.max(-1,2*(Q.x-j)/(H-j)-1)),y:Math.min(1,Math.max(-1,2*(Q.y-Z)/(W-Z)-1))}).tn(l);const tt=this.HI.some(t=>t.start<t.end?this.jI.end>=t.start&&this.jI.end<=t.end:this.jI.end<=t.start&&this.jI.end>=t.end),et=Zf(this.jI,this.Gu,this.$u,this.jI.end,I,tt?K:q-this.bL);this.RL.sr({x:et.x,y:et.y}).Zl({x:Math.min(1,Math.max(-1,2*(et.x-j)/(H-j)-1)),y:Math.min(1,Math.max(-1,2*(et.y-Z)/(W-Z)-1))}).tn(c),this.SL=!1}this.Os.forEach(t=>t.ir(r,this.Gn))}getMinimumSize(){return{x:150,y:150}}bg(){return[]}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Gf=(t,e,i,s,r,n=!0,o=!0,a=!0)=>{const h=[],l=.5*r,c=i>s,u=Math.sign(i-s),d=-1*u;if(n){const t=l/(2*Math.PI*e)*360+.1;o&&(i+=t*d),a&&(s+=t*u)}else i+=.1*d,s+=.1*u;const f=Yf(t,e+l,i,s,c);if(h.push(...f),n){const r={x:t.x+e*Math.cos(s*(Math.PI/180)),y:t.y+e*Math.sin(s*(Math.PI/180))};let n;n=i>s?Yf(r,l,s+180,s+360,c):Yf(r,l,s-180,s-360,c),h.push(...n)}const g=Yf(t,e-l,s,i,!c);if(h.push(...g),n){const r={x:t.x+e*Math.cos(i*(Math.PI/180)),y:t.y+e*Math.sin(i*(Math.PI/180))};let n;n=i>s?Yf(r,l,i-180,i-360,c):Yf(r,l,i+180,i+360,c),h.push(...n)}return h},Yf=(t,e,i,s,r)=>{i<s&&([i,s]=[s,i]);const n=[],o=r?-2:2,a=r?t=>t>s:t=>t<i;for(let h=r?i:s;a(h);h+=o){const i=h*(Math.PI/180),s=t.x+e*Math.cos(i),r=t.y+e*Math.sin(i);n.push({x:s,y:r})}const h=(r?s:i)*(Math.PI/180),l=t.x+e*Math.cos(h),c=t.y+e*Math.sin(h);return n.push({x:l,y:c}),n},Zf=(t,e,i,s,r,n)=>{const[o,a]=t.start<t.end?[t.start,t.end]:[t.end,t.start],h=Math.max(o,Math.min(a,s)),l=t.start<t.end?i-e:e-i,c=t.start<t.end?e+(h-t.start)/(t.end-t.start)*l:e-(h-t.start)/(t.end-t.start)*l,u=c*(Math.PI/180);return{x:r.x+n*Math.cos(u),y:r.y+n*Math.sin(u),angle:Math.round(c)}};class Wf extends jh{constructor(t,e,i,s,r,n,o,a,h,l,c){super(t,e,i,s,r,n,o,a,h,l),this.zL=c}setLabelAlignment(t){return this.zL=t,this.Bs(),this}getLabelAlignment(){return this.zL}}class jf extends Rn{constructor(t,i,s,r,n,o,a){let h;super(t,{fn:()=>t.VL?t.VL[this.key].max:void 0,dn:()=>t.VL?t.VL[this.key].min:void 0,gn:()=>{}},o,i,s,{numeric:i.parallelCoordinateAxisNumericTicks||i.yAxisNumericTicks,datetime:i.parallelCoordinateAxisDateTimeTicks||i.yAxisDateTimeTicks,time:i.parallelCoordinateAxisTimeTicks||i.yAxisTimeTicks},{type:"linear"}),this.NL=[],this.Bf=[],this.GL=8,this.ci=!1,this.D=new vt,this.chart=t,this.key=r,this.userID=n,this.vs=this.chart.pi.vs.ys(this,{}),this.Ws=a,this.$L=a.tr(t.UL).qe(this.bi.parallelCoordinateAxisBackgroundFillStyle||ls).Ke(Bt).setPointerEvents(!1),this.Jr=a._n(t.UL).Ch(this.bi.parallelCoordinateAxisTitleFont||this.bi.yAxisTitleFont).qe(this.bi.parallelCoordinateAxisTitleFillStyle||this.bi.yAxisTitleFillStyle).setPointerEvents(!1).Mn(Xe).wn(Xe),this.Ih=this.vs.aA([this.Jr]).Ps(i.effectsText),this.wF=a.dr(t.UL).cr(i.parallelCoordinateAxisStrokeStyle||i.yAxisStrokeStyle),this.setAnimationsEnabled(!1),this.addEventListener("intervalchange",e=>{t.YL(this,e.start,e.end)}),this.wF.addEventListener("pointerenter",()=>{var t,i;(null===(i=null===(t=this.chart.getUserInteractions().rangeSelectors)||void 0===t?void 0:t.create)||void 0===i?void 0:i.doubleClickAxis)&&(h=this.chart.engine.setMouseStyle(e.MouseStyles.Point))}),this.wF.addEventListener("pointerleave",()=>{h=this.chart.engine.restoreMouseStyle(h)}),this.wF.addEventListener("dblclick",t=>{var e,i;t.defaultPrevented||(null===(i=null===(e=this.chart.getUserInteractions().rangeSelectors)||void 0===e?void 0:e.create)||void 0===i?void 0:i.doubleClickAxis)&&(this.addRangeSelector(),fe(t))}),this.setTitle(r)}setBackgroundFillStyle(t){return this.$L.qe(t),this.Ws.Bs(),this}getBackgroundFillStyle(){return this.$L.Mh()}setStrokeStyle(t){const e="function"==typeof t?t(this.wF.do()):t,i=e.getFillStyle();return vs(i)?(this.jL=i.lut,this.chart.HL=!0):this.jL=void 0,this.wF.cr(e),this.chart.pi.Bs(),this}getStrokeStyle(){return this.wF.do()}setTickStrategy(t,e){return super.fh(t,e)}getTickStrategy(){return this.Lr}addRangeSelector(){const t=this.Gh(),i=this.Ws.tr(this.chart.UL).qe(this.bi.parallelCoordinateAxisRangeSelectorFillStyle||this.bi.dataGridScrollBarFillStyle).Ke(this.bi.parallelCoordinateAxisRangeSelectorStrokeStyle||this.bi.dataGridScrollBarStrokeStyle);let s;const r=t=>{var i,r;(null===(r=null===(i=this.chart.getUserInteractions().rangeSelectors)||void 0===i?void 0:i.move)||void 0===r?void 0:r.drag)&&(s=this.chart.engine.setMouseStyle(e.MouseStyles.Vertical,s))},n=t=>{s=this.chart.engine.restoreMouseStyle(s)};i.addEventListener("pointermove",r),i.addEventListener("pointerleave",n),i.addEventListener("pointerdown",t=>{var e,a;if(!(null===(a=null===(e=this.chart.getUserInteractions().rangeSelectors)||void 0===e?void 0:e.move)||void 0===a?void 0:a.drag))return;const h=this.chart.getCursorMode();let l;this.chart.setCursorMode(void 0);const c=this.chart.pi.il(t),u=tt({x:c.engineX,y:c.engineY},this.chart.pi.ai,this.chart.UL),d=this.chart.UL.y.Qt(i.Xi(),10),f=this.chart.UL.y.Qt(i.Zi(),-10);l=u.y<=d?"scaleMin":u.y>=f?"scaleMax":"move",fe(t);let g=t;const p=t=>{if(void 0===this.WL)return;const e=.05*Math.abs(this.gh-this.Ah),i=(t.clientX,g.clientX,t.clientY-g.clientY);if(g=t,"move"===l){const t=o.max-o.min,e=this.chart.XL(o.max,this.WL,this).y,s=this.chart.UL.y.Qt(e,-i),r=this.chart.ZL(s,this.WL,this);o.max=$t(r,Math.max(this.Ah,this.gh),Math.min(this.Ah,this.gh)+t),o.min=o.max-t}else if("scaleMax"===l){const t=this.chart.XL(o.max,this.WL,this).y,s=this.chart.UL.y.Qt(t,-i),r=this.chart.ZL(s,this.WL,this);o.max=$t(r,o.min+e,Math.max(this.Ah,this.gh))}else if("scaleMin"===l){const t=this.chart.XL(o.min,this.WL,this).y,s=this.chart.UL.y.Qt(t,-i),r=this.chart.ZL(s,this.WL,this);o.min=$t(r,o.max-e,Math.min(this.Ah,this.gh))}this.chart.JL(),fe(t)},m=e=>{e.pointerId===t.pointerId&&(this.chart.setCursorMode(h),i.addEventListener("pointermove",r),i.addEventListener("pointerleave",n),Ut.removeEventListener("pointermove",p),Ut.removeEventListener("pointerup",m),s=this.chart.engine.restoreMouseStyle(s))};i.removeEventListener("pointermove",r),i.removeEventListener("pointerleave",n),Ut.addEventListener("pointermove",p),Ut.addEventListener("pointerup",m)}),i.addEventListener("dblclick",t=>{var e,i;if(!(null===(i=null===(e=this.chart.getUserInteractions().rangeSelectors)||void 0===e?void 0:e.dispose)||void 0===i?void 0:i.doubleClick))return;const s=this.NL.indexOf(o);s>=0&&this.NL.splice(s,1),o.shape.dispose(),this.chart.JL(),fe(t)});const o={min:t.min+.25*(t.max-t.min),max:t.max-.25*(t.max-t.min),shape:i};this.NL.push(o),this.chart.JL();const a={setInterval:(t,e)=>(o.min=Math.min(t,e),o.max=Math.max(t,e),this.chart.JL(),a),setPointerEvents:t=>(i.setPointerEvents(t),a),dispose:()=>{const t=this.NL.indexOf(o);return t>=0&&(this.NL.splice(t,1),this.chart.JL()),a}};return a}addCustomTick(){const t=new Wf(()=>this.chart.pi.Bs(),()=>{const e=this.Bf.indexOf(t);e>=0&&this.Bf.splice(e,1)},(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.tickStyle,(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.tickLength,(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.gridStrokeStyle,(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.tickPadding,(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.labelRotation,(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.labelFillStyle,(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.labelFont,t=>this.formatValue(t),(this.bi.parallelCoordinateAxisNumericTicks||this.bi.yAxisNumericTicks).majorTickStyle.labelAlignment);return this.Bf.push(t),this.chart.pi.Bs(),t}getCustomTicks(){return[...this.Bf]}ir(t){this.WL=t.parallelAxisIndex;const e=Math.min(this.Ah,this.gh),i=Math.max(this.Ah,this.gh);for(const[e,i]of this.Pr)for(const[,s]of i){const i=t.ticksInfo.get(s);i&&(t.plotAxisLines.add({positions:[i.positionTicklineStart,i.positionTicklineEnd]},{lineStyle:e.Fr.tickStyle}),s.zh.sr(i.labelPosition).Zl(i.labelAlignment).Th(i.labelRotation).$l(i.labelOffset.x,i.labelOffset.y))}this.Bf.forEach(s=>{if(!s.di||s.M<e||s.M>i)return;const r=this.QL(t.parallelAxisIndex,t.halfAxisThickness,s.M,s.Mp,s._p,s.zL);t.plotAxisLines.add({positions:[r.positionTicklineStart,r.positionTicklineEnd]},{lineStyle:s.bp}),t.plotAxisText.add().sr(r.labelPosition).Zl(r.labelAlignment).qe(s.kp).Ch(s.Cp).tn(s.co(s.M)).Th(s.cf).setPointerEvents(s.ui)}),this.wF.gr({x:t.parallelAxisIndex,y:0}).Ar({x:t.parallelAxisIndex,y:1}),this.Jr.sr({x:t.parallelAxisIndex,y:this.chart.UL.y.Qt(0,-(t.halfAxisThickness+this.GL))}).Th(this.getTitleRotation()).Zl({x:0,y:1});const s=0===t.parallelAxisIndex?t.parallelAxisIndex:this.chart.UL.x.Qt(t.parallelAxisIndex,-1.2*t.pA);this.$L.sr({x:s,y:0}).Z({x:t.parallelAxisIndex-s,y:1});const r=this.chart.UL.ni();this.NL.forEach(e=>{const i=this.chart.XL(e.min,t.parallelAxisIndex,this),s=this.chart.XL(e.max,t.parallelAxisIndex,this),n={x:t.parallelAxisIndex-10*r.x*.5,y:i.y},o=t.parallelAxisIndex+10*r.x*.5,a=s.y;e.shape.sr(n).Z({x:o-n.x,y:a-n.y})})}G(){this.$L.dispose(),this.Jr.dispose(),this.wF.dispose(),this.NL.forEach(t=>t.shape.dispose()),this.NL.length=0,this.Lh(),this.Jh(),this.ci=!0,this.D.R("dispose",{})}isDisposed(){return this.ci}QL(t,e,i,s,r,n){const o=this.chart.UL.Qt({x:t,y:(i-this.Ah)/(this.gh-this.Ah)},{x:0-e,y:0}),a=this.chart.UL.Qt(o,{x:-s,y:0});return{positionTicklineStart:o,positionTicklineEnd:a,labelPosition:this.chart.UL.Qt(a,{x:-r,y:0}),labelAlignment:{x:1,y:n}}}Yh(t){const e=this.wF.do();return{halfAxisThickness:cr(e)?e.getThickness()/2:0}}Xh(t,e,i,s,r){const n=e.Fr,o=this.getInterval();return{...this.QL(s.parallelAxisIndex,r.halfAxisThickness,t,n.getTickLength(),n.getTickPadding(),2*(t-o.start)/(o.end-o.start)-1),keyValue:t,tickLevel:e,labelText:i,labelRotation:n.labelRotation,labelOffset:{x:0,y:0}}}sn(t,e){return new Ln(e,t,this.Ws,this.chart.UL)}Qh(t,e,i){const s=this.Jr&&this.Jr.rn().length>0&&this.getTitleFillStyle()!==ls?this.Jr.Nh().bc():{x:0,y:0};let r=0;this.Pr.forEach((t,e)=>{const i=e.Fr.tickLength+e.Fr.tickPadding;t.forEach(t=>{if(!t.zh.getVisible())return void(r=Math.max(r,i));const e=i+t.zh.Nh().bc().x;r=Math.max(r,e)})});const n=this.Bf.reduce((t,e)=>Math.max(t,e.di?this.chart.pi.th.Tr(e.co(e.M),e.Cp,e.cf).x+e.Mp+e._p:0),0);r=Math.max(r,n);const o=s.y+this.GL;r=Math.max(r,s.x/2);const a=r;return{pA:r,KL:o,qL:s.x,yf:a,ticksInfo:e,updatedTicks:i}}Kr(){return this.chart.UL}vn(t,e){return Ds(t,e,this.ai)}xn(t,e,i){return{start:t,end:e}}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}setPointerEvents(t){return this.D.setPointerEvents(t),this}getPointerEvents(){return this.D.getPointerEvents()}}class Hf extends mc{constructor(t,e,i,s,r){super(t,e,i,s),this.Rs="Parallel Coordinate Series",this.tP=!1,this.D=new vt,this.chart=t;const n=void 0!==(null==r?void 0:r.automaticColorIndex)?r.automaticColorIndex:this.chart.getSeries().length;this.iP=ze(this.bi.parallelCoordinateChartSeriesColor,n)||(()=>{const t=ze(this.bi.lineSeriesStrokeStyle,n).getFillStyle();return(gs(t)?t.getColor():void 0)||M(255,255,0)})(),this.addEventListener("visiblechange",t=>{this.chart.sP()}),this.addEventListener("dispose",t=>{this.chart.sP()}),this.setHighlightOnHover(!1)}setData(t){const e=void 0!==this.eP;return this.eP=this.chart.rP(t),e&&this.chart.hP(),this}getData(){return this.eP}setColor(t){const e="function"==typeof t?t(this.iP):t;return e===this.iP||(this.iP=e,this.chart.pi.Bs(),this.chart.nP(this)),this}getColor(){return this.iP}xp(){return this.getAutoScrollingEnabled()}cp(){}ir(){}dp(){}er(){return{fill:new fs({color:this.iP})}}ap(){return super.ap()&&!this.tP}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}class $f extends hl{constructor(t,e,i,s,r,n,o){var a,h,l;super(t,e,i,e.Hg("parallelAxisChart bg",0),s,e.pi.bi.parallelCoordinateChartBackgroundFillStyle||e.pi.bi.chartXYBackgroundFillStyle,e.pi.bi.parallelCoordinateChartBackgroundStrokeStyle||e.pi.bi.chartXYBackgroundStrokeStyle,e.pi.bi.parallelCoordinateChartTitleFont||e.pi.bi.chartXYTitleFont,e.pi.bi.parallelCoordinateChartTitleFillStyle||e.pi.bi.chartXYTitleFillStyle,e.pi.bi.parallelCoordinateChartTitleShadow||e.pi.bi.chartXYTitleShadow,n,null===(a=null==o?void 0:o.legend)||void 0===a?void 0:a.customLegend),this.axes=[],this.oP=!0,this.aP=$e(),this.lP=new Map,this.uP=this.bi.parallelCoordinateChartSeriesColorUnselected||M(255,255,255,30),this.cP=m({resolution:32}),this.HL=!1,this.dP=!1,this.fP=!0,this.AP=!1,this.gP=!1,this.pP=!1,this.vP=!1,this.xa=t=>{this.UL.Z(t.engineWidth,t.engineHeight)},this.D=new vt,this.hk=e.Om("parallelAxisChart series",0),this.yP=e.Om("parallelAxisChart labels",1),this.Yr.tn("Parallel Coordinate Chart"),this.pi.La(Hn.No),this.UL=this.Bg.d2({scaleXYConstructor:q}).si(0,1),this.jg(r,this.UL),this.yv=this.Ig.tr(this.UL).sr({x:0,y:0}).Z({x:0,y:1}).qe(this.bi.parallelCoordinateChartSeriesBackgroundFillStyle||this.bi.chartXYSeriesBackgroundFillStyle).Ke(Bt).setPointerEvents(!0),this.mv=this.Ig.tr(this.UL).sr({x:0,y:0}).Z({x:0,y:1}).qe(ls).Ke(this.bi.parallelCoordinateChartSeriesBackgroundStrokeStyle||this.bi.chartXYBackgroundStrokeStyle).setPointerEvents(!1),super.vv(this.yv,this.mv),this.setSeriesBackgroundEffect(!1),this.mP=new lr({thickness:null!==(h=this.bi.parallelCoordinateChartSeriesLineThickness)&&void 0!==h?h:2,fillStyle:new ps}),this.xP=new lr({thickness:null!==(l=this.bi.parallelCoordinateChartSeriesLineThickness)&&void 0!==l?l:2,fillStyle:new fs({color:this.bi.parallelCoordinateChartSeriesColorUnselected})}),this.SP=this.aP.Ji(this.hk.bA(this.UL)).cr(this.mP),this.SP.dc=5e4,this.bP=this.hk.bA(this.UL).cr(this.bi.parallelCoordinateChartPointedSeriesLineStyle||ze(this.bi.lineSeriesStrokeStyle,0)).setPointerEvents(!1),this.MP=new Th(()=>this.yP._n(this.UL)),this.wP=new $h(()=>this.yP.bA(this.UL).setPointerEvents(!1),(t,e,i)=>(t.Vi().cr(i.lineStyle),e.map(({positions:e})=>t.Ho().wA(e[0],e[1]))));const c=e.Ym(),u=qt(o?o.cursorBuilder:void 0,Zl);this.jm=ig(this,c,u.Am(c,this.uiScale,this.uiScale,jt,this.bi),this,"show-nearest",Xf,()=>0),this.addEventListener("resize",this.xa),void 0!==(null==o?void 0:o.legend)&&this.legend.setOptions(o.legend)}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Zl){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}setUnselectedSeriesColor(t){return this.uP="function"==typeof t?t(this.uP):t,this.xP=new lr({thickness:this.getSeriesStrokeThickness(),fillStyle:new fs({color:this.uP})}),this.pi.Bs(),this}getUnselectedSeriesColor(){return this.uP}setPointedSeriesStrokeStyle(t){return this.bP.cr(t),this.pi.Bs(),this}getPointedSeriesStrokeStyle(){return this.bP.do()}setSpline(t,e){return t?this.cP.C({resolution:void 0!==(null==e?void 0:e.resolution)?e.resolution:32}):this.cP.C(void 0),this.pi.Bs(),this}setAxes(t){const e=Array.isArray(t)?t.map((t,e)=>({key:t,id:e})):"object"==typeof t?Object.entries(t).map((t,e)=>({key:t[0],id:t[1]})):void 0;if(!e)return this;const i=e.filter(t=>void 0===this.axes.find(e=>e.key===t.key)),s=this.axes.filter(t=>void 0===e.find(e=>t.key===e.key));return i.forEach(t=>{const e=this._P(),i=new jf(this,this.bi,!this.Er,t.key,t.id,e,this.yP),s=()=>{this.fP=!0};i.addEventListener("visiblechange",s),i.addEventListener("dispose",()=>i.removeEventListener("visiblechange",s)),this.axes.push(i)}),s.forEach(t=>{t.G();const e=this.axes.indexOf(t);e>=0&&this.axes.splice(e,1)}),this.axes=e.map(t=>this.axes.find(e=>e.key===t.key)),this.fP=!0,this.VL=void 0,this.pi.Bs(),this}getAxis(t){const e=this.kP(t);if(!e)throw new Error(`ParallelAxisChart.getAxis | no such axis: "${t}". Found: ${this.axes.map(t=>void 0!==t.userID?`${t.key}, ${t.userID}`:t.key).join(", ")}`);return e}hasAxis(t){return void 0!==this.kP(t)}addSeries(t){var e,i;const s=new Hf(this,this.gv,this.bi,this.pi.vs,t);return super.xv(s,{...t,legend:{...null==t?void 0:t.legend,show:null!==(i=null===(e=null==t?void 0:t.legend)||void 0===e?void 0:e.show)&&void 0!==i&&i}}),this.gP=!0,this.VL=void 0,this.pi.Bs(),s}setSeriesStrokeThickness(t){return this.mP=this.mP.setThickness(t),this.xP=this.xP.setThickness(t),this.SP.cr(this.mP),this.pi.Bs(),this}getSeriesStrokeThickness(){return this.mP.getThickness()}setLUT(t){return this.Sf=t,this.Sf&&0===this.Sf.lut.units.length&&(this.Sf.lut=this.Sf.lut.setUnits(this.Sf.axis.getTitle())),this.Os.forEach(t=>{t.xg()&&t.add(this)}),this.vP=!0,this.Os.forEach(t=>t.zs()),this.pi.Bs(),this}ir(t){super.ir(t);const e=this.axes.filter(t=>t.getVisible());this.UL.ii(0,e.length-1),this.yv.Z({x:e.length-1,y:1}),this.mv.Z({x:e.length-1,y:1});const i=void 0===this.VL;if(!this.VL){const t={};e.forEach(e=>{t[e.key]={min:ni,max:oi}}),this.fv.forEach(e=>{e.eP&&Object.entries(e.eP).forEach(([e,i])=>{const s=t[e];s&&!Number.isNaN(i)&&(s.min=Math.min(s.min,i),s.max=Math.max(s.max,i))})}),this.VL=t}if(this.pP||this.AP||this.gP){const t=e.map((t,e)=>t.NL);this.fv.forEach(i=>{const s=i.eP;if(!s)return;let r=!1;for(let i=0;i<e.length;i+=1){const n=e[i],o=t[i],a=void 0!==o.find(t=>mi(s[n.key],t.min,t.max));if(o.length>0&&!a){r=!0;break}}i.tP=r});const i=this.fv.filter(t=>!t.tP);this.D.R("seriesselect",{selectedSeries:i})}for(const t of this.fv)t.cp();for(const t of this.fv)t.ir();super.Yg();const s=this.pi.Us(this.yv)||void 0!==this.fv.find(t=>t.getPointed())?this.CP():void 0;this.jm.ir(!1,this.fv,void 0,{explicitTarget:s,afterCursorPointedAt:t=>{const e=this.pi.Ia();if(t.length>1&&e){const t=this.pi.il(e);this.jm.v_.sm({x:t.engineX,y:t.engineY},this.pi.ai)}}});const r=Uh.tp(this.Yr,this.Wg),n=this.Os.reduce((t,e)=>{const i=e.Nh(r,this.Gn);return{top:Math.max(t.top,i.top),bottom:Math.max(t.bottom,i.bottom),left:Math.max(t.left,i.left),right:Math.max(t.right,i.right)}},{top:0,bottom:0,left:0,right:0});if(Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,n),e.length>=2){const t=this.MP.VA(),s=this.wP.VA(),o=e.map((e,i)=>(e.pn(),e.Nh({plotAxisLines:s,plotAxisText:t,physicalAxisSize:this.UL.y.wt(),parallelAxisIndex:i})));this.UL.qt([this.ot.left+this.Gn.left+o[0].yf+n.left,this.ot.right+this.Gn.right+o[o.length-1].qL/2+n.right]),this.UL.ti([this.ot.bottom+this.Gn.bottom+o.reduce((t,e)=>Math.max(t,e.KL),0)+n.bottom,this.ot.top+this.Gn.top+r+n.top]),o.forEach((t,i)=>e[i].ir(t)),t.finishPlot(),s.finishPlot(),(i||this.HL)&&e.forEach((t,e)=>{if(!t.jL)return;const i=t.jL.steps.map(i=>({...i,value:this.XL(i.value,e,t).y})),s=t.jL.setSteps(i);t.wF.cr(t=>t.setFillStyle(new xs({lookUpProperty:"y",lut:s})))});const a=this.fP||this.AP||this.oP||this.cP.u;a&&(this.SP.Vi(),this.aP.Vi(),this.lP.clear(),this.fv.forEach(t=>{const i=t.eP;if(!t.getVisible()||!i)return;const s=this.TP(t,i,e,this.SP,this.aP);this.lP.set(t,s),t.Ts(s)})),(a||this.pP||this.vP||this.AP)&&this.FP(this.fv),!a&&this.gP&&this.fv.forEach(t=>{if(t.fs.length>0)return;const i=t.eP;if(!t.getVisible()||!i)return;const s=this.TP(t,i,e,this.SP,this.aP);this.lP.set(t,s),t.Ts(s),this.FP([t])}),this.fv.find(t=>t.eP&&Object.keys(t.eP).length>0)&&(this.dP=!0)}const o=1===(null==s?void 0:s.length)?s[0]:void 0;(o!==this.IP||this.AP)&&(this.bP.Vi(),o&&o.series.eP?(this.TP(o.series,o.series.eP,e,this.bP,void 0),this.SP.cr(this.xP)):this.SP.cr(this.mP));const a=p(this.UL.x.bt(),this.UL.y.bt(),this.UL.x.wt(),this.UL.y.wt());this.hk.Tm(a),this.Os.forEach(t=>t.ir(r,this.Gn));for(const t of this.fv)t.dp();this.oP=!1,this.pP=!1,this.fP=!1,this.AP=!1,this.gP=!1,this.vP=!1,this.cP.u=!1,this.HL=!1,this.IP=o}FP(t){const e=this.Sf&&{lut:this.Sf.lut,key:this.Sf.axis.key};t.forEach(t=>{const i=t.eP,s=this.lP.get(t);if(!i||!s)return;let r;if(t.tP)r=this.uP;else if(e){const t=i[e.key],s=this.VL&&this.VL[e.key];r=e.lut.getColors(t,s)}else r=t.iP;s.forEach(t=>t.UI(r))})}sP(){this.AP=!0,this.pi.Bs()}hP(){this.dP&&this.pi.La(Hn.Ro),this.AP=!0,this.pi.Bs()}kP(t){return this.axes.find(e=>e.key===t)||this.axes.find(e=>e.userID===t)}_P(){return J.d1({scale1DConstructor:H,dimension:"x"}).W(0,1)}rP(t){if(this.VL=void 0,this.pi.Bs(),Array.isArray(t)){const e={};return t.forEach((t,i)=>{var s;if("number"==typeof t){const r=null===(s=this.axes[i])||void 0===s?void 0:s.key;if(!r)throw new Error("ParallelCoordinateSeries Axis count doesnt match supplied data");e[r]=t}else"object"==typeof t&&(e[t.key]=t.value)}),e}if("object"==typeof t)return t;throw new Error("ParallelCoordinateSeries unidentified data format")}YL(t,e,i){this.oP=!0,this.pi.Bs()}XL(t,e,i){return{x:e,y:(t-i.ai.$)/(i.ai.U-i.ai.$)}}ZL(t,e,i){const s=i.getInterval();return s.start+t*(s.end-s.start)}nP(t){this.vP=!0,this.pi.Bs()}JL(){this.pP=!0,this.pi.Bs()}getSeries(){return this.fv}bg(){return[this]}Ys(){return this.Sf?{lut:this.Sf.lut}:void 0}getMinimumSize(){return{x:200,y:200}}forEachAxis(t){return this.axes.slice().forEach(e=>t(e)),this}dispose(){return super.dispose(),this.axes.forEach(t=>t.G()),this.jm.G(),this.hk.G(),this.yP.G(),this}TP(t,e,i,s,r){const n=[];let o;for(let a=0;a<i.length;a+=1){const h=i[a],l=e[h.key],c=this.XL(l,a,h),u=this.cP.T();if(u){if(void 0!==o){const e=u.resolution;let i;for(let a=0;a<=e;a+=1){const h=(a-1)/e,l=a/e,u=l<.5?4*l*l*l:1-(-2*l+2)**3/2;if(void 0!==i){const e={x:o.x+h*(c.x-o.x),y:o.y+i*(c.y-o.y)},a={x:o.x+l*(c.x-o.x),y:o.y+u*(c.y-o.y)},d=s.Ho();r&&r.Ki(d,t),n.push(d),d.wA(e,a)}i=u}}}else if(void 0!==o){const e=s.Ho();r&&r.Ki(e,t),n.push(e),e.wA(o,c)}o=c}return n}CP(){const t=this.getCursorMode(),e=this.pi.Ia();if(t&&e){const i=this.pi.il(e),s=tt({x:i.engineX,y:i.engineY},this.pi.ai,this.UL),r=Math.round(s.x),n=this.axes.filter(t=>t.getVisible())[r];if(!n)return;const o=n.key,a=Ue(this.fv.map(t=>{if(!t.eP||!t.ap())return;const e=t.eP[o],i=this.XL(e,r,n);return{cursorPosition:{pointMarker:i,pointMarkerScale:this.UL,resultTable:i,resultTableScale:this.UL},value:e,series:t,axis:n}}));return"show-nearest"===t?[a.filter(t=>!Number.isNaN(t.cursorPosition.pointMarker.y)).sort((t,e)=>Math.abs(t.cursorPosition.pointMarker.y-s.y)-Math.abs(e.cursorPosition.pointMarker.y-s.y))[0]]:("show-nearest-interpolated"!==t&&"show-all-interpolated"!==t||Ut.console.warn('LightningChart JS ParallelCoordinateChart does not support "interpolated" cursor modes.'),a)}}setUserInteractions(t){return this.ar=void 0===t?{rangeSelectors:{create:{doubleClickAxis:!1},move:{drag:!1},dispose:{doubleClick:!1}}}:t,this}getUserInteractions(){return Nt({rangeSelectors:{create:{doubleClickAxis:!0},move:{drag:!0},dispose:{doubleClick:!0}}},this.ar)}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Xf=(t,e,i)=>{if(i.length>1)return[[{text:i[0].axis.getTitle(),rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],...Ue(i.map(t=>{const e=t.series.getData(),i=e?e[t.axis.key]:void 0;if(void 0!==i)return Jf(t,[[t.series,"",Bs(t.axis.formatValue(i),t.axis)]])}).flat())];const s=i[0],r=[[{component:s.series,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}]];return t.axes.forEach(e=>{const i=s.series.getData();if(!i)return;const n=i[e.key];if(void 0===n)return;const o=t.axes.filter(t=>t.getVisible())[s.cursorPosition.pointMarker.x]===e?{weight:"bold"}:{};r.push([{text:e.getTitle(),font:o},"",{text:e.formatValue(n),font:o}])}),r};class qf extends Nh{constructor(t,i,s,r,n,o,a){var h;super(t,i,s,r,n,o),this.legend=new zh(wh,this,this.Og,this.eA),this.legend.setOptions({position:e.LegendPosition.LeftTop,autoHideThreshold:1,...a}),null===(h=this.Os)||void 0===h||h.push(this.legend)}add(t){return t instanceof vg?(t.getCells().forEach(t=>{t.panel instanceof Oh&&this.add(t.panel)}),this.pi.Bs(),this):(this.legend.add(t),this.pi.Bs(),this)}getMinimumSize(){return super.getMinimumSize()}}const Kf=t=>"show-all-interpolated"===t||"show-nearest-interpolated"===t||"show-pointed-interpolated"===t,Jf=(t,e)=>{const i="series"in t?t.series:void 0;if(!i||!("getCursorFormattingOverride"in i))return e;const s=i.getCursorFormattingOverride();return s?s(t,e):e},Qf=t=>{var e,i;const s="series"in t?t.series:"slice"in t?t.slice:"bar"in t?t.bar:void 0,r=s&&Ih(s)&&s.Ys(),n="x"in t&&t.x,o="y"in t&&t.y,a="z"in t&&t.z,h="color"in t&&t.color,l=null!==(i=null!==(e="lookupValue"in t?t.lookupValue:void 0)&&void 0!==e?e:"intensity"in t?t.intensity:void 0)&&void 0!==i?i:"value"in t?t.value:void 0;if(void 0!==l&&r&&"value"===r.lookUpProperty)return r.lut.getColors(l,r.valueRange);if(void 0!==n&&!1!==n&&r&&"x"===r.lookUpProperty)return r.lut.getColors(n,tg(s)?{min:s.getXMin(),max:s.getXMax()}:void 0);if(void 0!==o&&!1!==o&&r&&"y"===r.lookUpProperty)return r.lut.getColors(o,tg(s)?{min:s.getYMin(),max:s.getYMax()}:void 0);if(void 0!==a&&!1!==a&&r&&"z"===r.lookUpProperty)return r.lut.getColors(a,eg(s)?{min:s.getZMin(),max:s.getZMax()}:void 0);if(h)return"number"==typeof h?T(h):h;if(s){const t=s.er(),e=Ie(s.chart.getTheme(),!0,t);if(gs(e))return e.getColor()}},tg=t=>!(!t||"object"!=typeof t||!("getXMin"in t)),eg=t=>!(!t||"object"!=typeof t||!("getZMin"in t)),ig=(t,e,i,s,r,n,o)=>{let a,h,l,c=r,u=t.getTheme().cursorDynamicBehavior,d=n,f=null,g=!0;s&&(g=!1,s.seriesBackground.addEventListener("pointerenter",()=>{var e;g=!0,t.getCursorMode()&&(h&&m&&!("explicitTarget"in(null!==(e=m[3])&&void 0!==e?e:{}))?p():t.pi.Bs())}),s.seriesBackground.addEventListener("pointerleave",()=>{var e;g=!1,t.getCursorMode()&&(h&&m&&!("explicitTarget"in(null!==(e=m[3])&&void 0!==e?e:{}))?p():t.pi.Bs())}),s.seriesBackground.addEventListener("pointermove",()=>{var e;g=!0,t.getCursorMode()&&(h&&m&&!("explicitTarget"in(null!==(e=m[3])&&void 0!==e?e:{}))?p():t.pi.Bs())}),s.addEventListener("seriesadd",e=>{const i=e.series;i.addEventListener("pointerenter",(e,s)=>{var r;i.ap()&&(h||t.pi.Bs(),a=s||void 0),t.getCursorMode()&&(h&&m&&!("explicitTarget"in(null!==(r=m[3])&&void 0!==r?r:{}))?p():t.pi.Bs())}),i.addEventListener("pointermove",(e,s)=>{var r;i.ap()&&(h||t.pi.Bs(),a=s||void 0),t.getCursorMode()&&(h&&m&&!("explicitTarget"in(null!==(r=m[3])&&void 0!==r?r:{}))?p():t.pi.Bs())}),i.addEventListener("pointerleave",e=>{var s;i.ap()&&(h||t.pi.Bs(),a=void 0),t.getCursorMode()&&(h&&m&&!("explicitTarget"in(null!==(s=m[3])&&void 0!==s?s:{}))?p():t.pi.Bs())})}));const p=()=>{if(l&&(Ut.cancelAnimationFrame(l),l=void 0),!m)return;const t=m;l=Ut.requestAnimationFrame(()=>y.ir(...t))};let m;const y={setCursor:e=>(e(i),t),getCursor:()=>i,setCursorMode:e=>(c=e,t.pi.Bs(),t),getCursorMode:()=>c,setCustomCursor:t=>{h=t},tx:e=>{u=e,t.pi.Bs()},setCursorFormatting:e=>(d=e,t.pi.Bs(),t),getCursorFormatting:()=>d,G:()=>{i.dispose(),e.G()},ir:(e,s,r,n)=>{l&&(Ut.cancelAnimationFrame(l),l=void 0),m=[e,s,r,n];const p=t.pi.Ia();let y=[];if((null==n?void 0:n.explicitTarget)&&c)y=Array.isArray(n.explicitTarget)?n.explicitTarget:[n.explicitTarget];else if(!e&&c){const t=s.find(t=>t.getPointed()),e=p&&t&&(!t.getCursorEnabled||t.getCursorEnabled())&&t.Is?t.Is(p):void 0;if(a=e||a,a&&"show-all"!==c&&"show-all-interpolated"!==c)y=[a];else if("show-all"===c||"show-all-interpolated"===c||"show-nearest"===c||"show-nearest-interpolated"===c){if((g||void 0!==t)&&p&&r){for(const t of s){if(!t.getVisible()||t.getCursorEnabled&&!t.getCursorEnabled())continue;const e=r(t,p,c);e&&y.push(e)}"show-nearest"!==c&&"show-nearest-interpolated"!==c||(y.sort((t,e)=>o(t,p)-o(e,p)),y.length=1)}}else if(("show-pointed"===c||"show-pointed-interpolated"===c)&&p&&t&&(!t.getCursorEnabled||t.getCursorEnabled())&&r){const e=r(t,p,c);e&&(y=[e])}}y=Ue(y.map(t=>Qe(t)));const x=(null==n?void 0:n.overrideCursorPositions)||((t,e)=>e),v=y[0],A=y.length>0?y:void 0;if(v!==f&&p&&(h&&h({hit:v,hits:A,mouseLocation:p}),t.D.R("cursortargetchange",{hit:v,hits:A,mouseLocation:p}),f=v),h)i.getVisible()&&(i.setVisible(!1),i.Nh().ir());else{let e=!1;if(y&&y.length>0){const s=d(t,y[0],y);i.setVisible(!0).setPosition(...x(y,y.map(t=>{const e=t.cursorPosition;if(u){const i=Qf(t);void 0!==i&&(e.pointMarkerFillStyle=u.pointMarkerFill&&u.pointMarkerFill(i),e.pointMarkerStrokeStyle=u.pointMarkerStroke&&u.pointMarkerStroke(i));const s=(t=>{if(ot(t))return void 0!==t.size?t.size:t.series instanceof gu?t.series.getPointSize():void 0})(t);if(void 0!==s&&(e.pointMarkerSize=u.pointMarkerSize&&u.pointMarkerSize(s)),!1!==u.matchPointMarkerShape){const i=(t=>{const e=ot(t)&&t.series instanceof gu?t.series.getPointShape():void 0;return void 0===e||yr(e)?void 0:e})(t);void 0!==i&&(e.pointMarkerShape=i)}}return e}))).setResultTable(t=>t.setContent(s)),e=!0}else i.getVisible()&&(i.setVisible(!1).setPosition().setResultTable(t=>t.setContent([])),e=!0);(null==n?void 0:n.afterCursorPointedAt)&&n.afterCursorPointedAt(y),e&&(i.Nh(),i.ir())}},solveNearest:(e,i,s,r)=>{const n=e||t.pi.Ia();if(!n)return[];let a=[];if("show-all"===i||"show-all-interpolated"===i||"show-nearest"===i||"show-nearest-interpolated"===i){for(const t of s){if(!t.getCursorEnabled()||!t.getVisible())continue;const e=r(t,n,i);e&&a.push(e)}"show-nearest"!==i&&"show-nearest-interpolated"!==i||(a.sort((t,e)=>o(t,n)-o(e,n)),a.length=1)}return a=Ue(a.map(t=>Qe(t))),a},v_:i};return y},sg=(t,e,i)=>Li(e,Ri(Yi(.5*(t.ju()+t.$t())*Math.PI/180),i)),rg=(t,e,i,s,r,n)=>{const o=t.length;let a=90;for(let h=0;h<o;h+=1){const l=t[h],c=a-360*e[h],u=l.getAnimatedExplosion();if(0===u||1===o)l.iC.sr(i);else{const t=Li(i,Ri(Yi(.5*(a+c)*Math.PI/180),n*u));l.iC.sr(t)}l.iC.Qu(a).Ar(c).qu(s).tc(s).sc(r),a=c}};class ng extends Oh{constructor(t,e,i,s,r,n,o){var a;super(t,e,i,e.Hg("pieChart bg",0),s,e.pi.bi.pieChartBackgroundFillStyle,e.pi.bi.pieChartBackgroundStrokeStyle,e.pi.bi.pieChartTitleFont,e.pi.bi.pieChartTitleFillStyle,e.pi.bi.pieChartTitleShadow,n,null===(a=null==o?void 0:o.legend)||void 0===a?void 0:a.customLegend),this.xk=[],this.Sk=Ju.SortByName,this.zu=0,this.Dk=this.bi.pieChartSliceFillStylePalette,this.Ek=this.bi.pieChartSliceStrokeStyle,this.bk=!0,this.Rk=this.bi.pieChartSliceLabelFont,this.Ok=this.bi.pieChartSliceLabelFillStyle,this.Mk=this.bi.pieChartSliceLabelShadow,this.wk=0,this.LP=!1,this.PP=20,this.Tk=!0,this.Lk=!0,this.Fk=t=>{const e=this.xk.indexOf(t);e>=0&&(this.xk.splice(e,1),this.Ik())},this.D=new vt,this.pi.La(Hn.wo),this.Pk=e.Om("pieChart bottom",0),this.Bk=e.Om("pieChart top",1),this.Yr.tn("Pie Chart"),this.jg(r,this.eA),this.background.addEventListener("dblclick",t=>{t.defaultPrevented||(()=>{const t=this.getSlices();for(let e=0;e<t.length;e+=1)t[e].setExploded(!1)})()});const h=e.Ym(),l=qt(o?o.cursorBuilder:void 0,Ol);this.jm=ig(this,h,l.Am(h,this.uiScale,this.uiScale,jt,this.bi),void 0,"show-pointed",og,()=>0),this.setAnimationsEnabled(!1!==(null==o?void 0:o.animationsEnabled));const c={backgroundVisible:!0,...null==o?void 0:o.legend};this.legend.setOptions(c)}setCursor(t){return this.jm.setCursor(t),this}getCursor(){return this.jm.getCursor()}setCursorMode(t){return this.jm.setCursorMode(t),this}getCursorMode(){return this.jm.getCursorMode()}setCustomCursor(t){return this.jm.setCustomCursor(t),this}setCursorDynamicBehavior(t){return this.jm.tx(t),this}setCursorFormatting(t){return this.jm.setCursorFormatting(t),this}getCursorFormatting(){return this.jm.getCursorFormatting()}addCursor(t=Ol){const e=this.Eg(),i=t.Am(e,this.uiScale,this.uiScale,this.Lg(e),this.bi);return this.Ug(i),i}addSlice(t,e){const i=new fd(this.wk,this.Pk,this.Bk,this,this.eA,this.Fk,this.bi,this.pi.vs);this.wk+=1,i.setName(t);const s=this.Er;return this.Er=!1,i.setValue(e),this.Er=s,i.setEffect(this.Tk),this.Vk(i),this.xk.push(i),this.Ik(),i.setHighlightOnHover(this.bk),this.Os.forEach(t=>{t.xg()&&t.bu(i)}),i}addSlices(t){const e=[];for(let i=0;i<t.length;i+=1)e.push(this.addSlice(t[i].name,t[i].value));return e}getSlices(){return this.xk}setMultipleSliceExplosion(t){return this.LP=t,this}getMultipleSliceExplosion(){return this.LP}setInnerRadius(t){return this.zu=t,this.pi.Bs(),this}getInnerRadius(){return this.zu}setSliceExplosionOffset(t){return this.PP=t,this.pi.Bs(),this}getSliceExplosionOffset(){return this.PP}setLUT(t){return this.Sf=t,this.pi.Bs(),this}setSliceFillStyle(t){this.Dk=t;for(let t=0;t<this.xk.length;t+=1)this.Vk(this.xk[t]);return this.pi.Bs(),this}getSliceFillStyle(){return this.Dk}setSliceStrokeStyle(t){this.Ek="function"==typeof t?t(this.Ek):t;for(let t=0;t<this.xk.length;t+=1)this.Vk(this.xk[t]);return this.pi.Bs(),this}getSliceStrokeStyle(){return this.Ek}setSliceEffect(t){return this.Tk=t,this.xk.forEach(e=>e.vs.Ss.Ps(t)),this.pi.Bs(),this}getSliceEffect(){return this.Tk}setSliceSorter(t){return this.Sk=t,this.xk=this.xk.sort(this.Sk),this.pi.Bs(),this}getSliceSorter(){return this.Sk}setLabelFillStyle(t){this.Ok="function"==typeof t?t(this.Ok):t;for(let t=0;t<this.xk.length;t+=1)this.Vk(this.xk[t]);return this.pi.Bs(),this}getLabelFillStyle(){return this.Ok}setLabelShadow(t){return this.Mk=t,this.pi.Bs(),this}getLabelShadow(){return this.Mk}setLabelFont(t){this.Rk="function"==typeof t?t(this.Rk):t;for(let t=0;t<this.xk.length;t+=1)this.Vk(this.xk[t]);return this.pi.Bs(),this}getLabelFont(){return this.Rk}setLabelEffect(t){return this.Lk=t,this.xk.forEach(e=>e.vs.xs.Ps(t)),this.pi.Bs(),this}getLabelEffect(){return this.Lk}setLabelFormatter(t){return this.zk=t,this.pi.Bs(),this}getLabelFormatter(){return this.zk}setSliceHighlightOnHover(t){return this.bk=t,this.xk.forEach(e=>e.setHighlightOnHover(t)),this}ir(t){super.ir(t),super.Yg();const e=Uh.tp(this.Yr,this.Wg),i=this.Os.reduce((t,i)=>{const s=i.Nh(e,this.Gn);return{top:Math.max(t.top,s.top),bottom:Math.max(t.bottom,s.bottom),left:Math.max(t.left,s.left),right:Math.max(t.right,s.right)}},{top:0,bottom:0,left:0,right:0});Uh.ip(this.Yr,this.Wg,this.uiScale.ni(),this.Gn,i);const s=l(this.eA.x.getInnerInterval()-(this.Gn.left+this.Gn.right),this.eA.y.getInnerInterval()-(this.Gn.bottom+this.Gn.top+e)),r=l(s.x-i.left-i.right,s.y-i.top-i.bottom),n=l(this.Gn.left+(s.x+i.left-i.right)/2,this.Gn.bottom+(s.y+i.bottom-i.top)/2);if(this.Sf){const t=this.Sf;this.xk.forEach(e=>{this.Vk(e,new fs({color:t.getColors(e.getAnimatedValue(),void 0)}))})}for(let t=0;t<this.xk.length;t+=1){const e=Math.abs(this.xk[t].getAnimatedValue())>0;this.xk[t].iC.setVisible(e),this.xk[t].zh.setVisible(e)}this.xk=this.xk.sort(this.Sk);const o=this.xk.filter(t=>Math.abs(t.getAnimatedValue())>0);let a=0;for(let t=0;t<o.length;t+=1)a+=Math.abs(o[t].getAnimatedValue());const h=[];for(let t=0;t<o.length;t+=1)h.push((c=Math.abs(o[t].getAnimatedValue()))>0?c/a:0);var c;for(let t=0;t<o.length;t+=1){const e=o[t];e.zh.tn(this.zk(e,h[t])).Nh()}this.jm.ir(!1,this.xk,(t,e,i)=>{const s=h[o.indexOf(t)]||0,r=this.pi.il(e);return{cursorPosition:{pointMarker:{x:r.engineX,y:r.engineY},pointMarkerScale:this.pi.ai,resultTable:{x:r.engineX,y:r.engineY},resultTableScale:this.pi.ai},slice:t,category:t.getName(),value:t.getValue(),relativeValue:s}}),this.Os.forEach(t=>t.ir(e,this.Gn)),this.Nk(o,h,n,r)}Vk(t,e=this.Dk(t.index,t)){t.setStyle(e,this.Ek,this.Ok,this.Rk,this.Mk)}Ik(){this.xk=this.xk.sort(this.Sk),this.pi.Bs()}bg(){return this.xk}dispose(){return super.dispose(),this.xk.slice().forEach(t=>t.dispose()),this.jm.G(),this.Bk.G(),this.Pk.G(),this}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const og=(t,e,i)=>[[{component:e.slice,rowFillStyle:t.getTheme().cursorResultTableHeaderBackgroundFillStyle}],[{text:e.value.toString(),font:{weight:"bold"}}]];class ag extends ng{constructor(t,e,i,s,r,n,o){super(t,e,i,s,r,n,o),this.zk=Qu.NamePlusValue,this.Hk=[],this.BP=40,this.DP=5,this.EP=10,this.Wk=this.bi.pieChartConnectorStrokeStyle}setLabelConnectorStyle(t){this.Wk=t;for(let t=0;t<this.Hk.length;t+=1)this.Hk[t].cr(this.Wk);return this.pi.Bs(),this}getLabelConnectorStyle(){return this.Wk}setLabelSliceOffset(t){return this.BP=t,this.pi.Bs(),this}getLabelSliceOffset(){return this.BP}setLabelConnectorGapStart(t){return this.DP=t,this.pi.Bs(),this}getLabelConnectorGapStart(){return this.DP}setLabelConnectorEndLength(t){return this.EP=t,this.pi.Bs(),this}getLabelConnectorEndLength(){return this.EP}Nk(t,e,i,s){const r=this.Rk.getSize(),n=this.BP,o=this.EP,a=this.DP,h=Math.min(this.PP,n-a);let c=0;if(1===t.length)c=t[0].zh.bc().x;else for(let e=0;e<t.length;e+=1)c=Math.max(c,t[e].zh.bc().x);const u=Math.max(.5*(Math.min(s.x-2*c-2*o,s.y-2*r)-2*n),0);if(u<50){const n=Math.max(.5*Math.min(s.x,s.y-2*r),0);rg(t,e,i,n,this.zu,h),t.forEach(t=>t.zh.setVisible(!1)),this.Hk.forEach(t=>t.setVisible(!1))}else{rg(t,e,i,u,this.zu,h);let s=90;const r=t.map((t,r)=>{const a=360*e[r],h=s-a,l=Yi(Ui(.5*(s+h))),c=l.x>=0?-1:1,d=Li(Li(i,Ri(l,u+n)),{x:c*-o,y:0});s=h;const f={x:c,y:0};t.zh.sr(d).Zl(f),t.zh.Nh();const g=t.zh.mc();return{position:d,alignment:f,shape:t.zh,boundaries:g,sliceAngleVec:l,slice:t}}),c=[];for(let t=0;t<r.length;t+=1){const e=r[t],i=c[c.length-1];i&&!1!==fi([i.boundaries,e.boundaries])?e.shape.setVisible(!1):(c.push(e),e.shape.setVisible(!0))}for(let t=0;t<this.Hk.length;t+=1)this.Hk[t].setVisible(!1);c.forEach((t,e)=>{const s=t.slice.iC,r=sg(s,i,u+a+h*t.slice.getAnimatedExplosion()),n=((t,e,i)=>{const s=(i.y-e.y)/(i.x-e.x),r=e.x+(t-e.y)/s;return l(r,t)})(t.position.y,r,i),o=t.position;this.Xk([r,n,o])})}}getMinimumSize(){return l(500,300)}Xk(t){let e;for(let t=0;t<this.Hk.length;t+=1)if(!this.Hk[t].getVisible()){e=this.Hk[t].setVisible(!0);break}void 0===e&&(e=this.Bk.Np(this.eA,void 0,[Wh.InternalUI]).cr(this.Wk).setPointerEvents(!1),this.Hk.push(e)),e.Vi().bu(t)}}class hg extends ng{constructor(){super(...arguments),this.zk=Qu.Name,this.RP=.5}Nk(t,e,i,s){const r=this.PP,n=Math.max(0,.5*Math.min(s.x,s.y)-r);rg(t,e,i,n,this.zu,r);for(let e=0;e<t.length;e+=1){const s=t[e],o=s.iC,a=s.zh,h=this.zu/100,l=((1-h)*this.RP+h)*n+s.getAnimatedExplosion()*r,c=sg(o,i,l);a.sr(c).Yl(0).Wl(0)}}getMinimumSize(){return l(200,200)}setLabelPosition(t){return this.RP=t,this.pi.Bs(),this}getLabelPosition(){return this.RP}}const lg={LabelsOnSides:ag,LabelsInsideSlices:hg},cg=510001,ug=(t,e)=>{const i=Math.floor(99999/e),s=Math.floor(99999/e),r=Math.floor(99998/e),n=Math.floor(99998/e),o=Math.floor(99999/(e+1)),a=Math.floor(89999/(e+1)),h=cg+e*a;let l=0;return{OP:()=>{const e=t.zP("dashboard ui",h+l);return l+=1,e},VP:()=>t.zP("dashboard legend",51e4),NP:e=>{const h=1+e*i,l=100001+e*s,c=200002+e*r,u=300002+e*n,d=400001+e*o,f=cg+e*a;let g=0;return{pi:t,Hg:(e,i)=>{const s=h+i;return t.zP(e,s)},Rm:(e,i)=>{const s=l+i;return t.zP(e,s)},u_:(e,i)=>{const s=c+i;return t.zP(e,s)},Om:(e,i)=>{const s=u+i;return t.zP(e,s)},Em:(e,i,s)=>{const r=u+i;return t.GP(e,r,s)},Jg:(e,i)=>{const s=d+i;return t.zP(e,s)},Rg:e=>{const i=f+g,s=t.zP(e,i);return g+=1,s},zg:()=>t.zP("panel legend",500002+e),Ym:()=>t.zP("panel cursor",600001+e)}}}};class dg extends Error{constructor(t,e){super(`ChartError: ${t} ${e?`in ${e.constructor.name}`:""}`),Object.setPrototypeOf(this,dg.prototype)}}class fg extends Error{constructor(t,e,i=!1){const s=`EngineError: ${t} ${e?`in ${e.constructor.name}`:""}`;super(s),i&&Ut.alert(s),Object.setPrototypeOf(this,fg.prototype)}}class gg extends fg{constructor(t){super(t),Object.setPrototypeOf(this,gg.prototype)}}class pg{constructor(t){this.D=new vt,this.M=t}C(t){return this.M=t,this.D.R("change",{value:t}),this}T(){return this.M}O(t,e,i){this.D.addEventListener(t,e,i)}N(t,e){this.D.removeEventListener(t,e)}}const mg=(t,e)=>e?t.x:t.y,yg=(t,e,i,s)=>1===e&&s===(i?t.columnIndex:t.rowIndex)||-1===e&&s===(i?t.columnIndex+t.columnSpan:t.rowIndex+t.rowSpan),xg=(t,e,i,s,r,n)=>{const o=e.length,a=Math.sign(s),h=[],l=e.reduce((t,e)=>t+e);for(let t=1;t<=o-1;t+=1)h.push(mg(r,n)*e.slice(0,t).reduce((t,e)=>t+e,0)/l);const c=h.map(t=>0);let u=h[i-1]+s;for(let e=i;e>0&&e<o;e+=a){const s=t.filter(t=>yg(t,a,n,e)).reduce((t,e)=>Math.max(t,mg(e.panel.getMinimumSize()||{x:0,y:0},n)),20),o=h[e-1];if(1===a&&u>mg(r,n)-s||-1===a&&u<0+s){c.fill(0);break}if(e!==i&&(1===a?o>u:o<u))break;c[e-1]=u-o,u+=s*a}const d=c.map((t,e)=>h[e]+t),f=d.map((t,e)=>(t-(e>0?d[e-1]:0))/mg(r,n));return f.push(1-f.reduce((t,e)=>t+e,0)),f};class vg{constructor(t,e,i,s,r,n){this.coordsRelative="relative",this.coordsClient="client",this.ci=!1,this.tT=new Array,this.$P=[],this.UP=void 0,this.YP=!0,this.jP=!0,this.HP=!0,this.Cg=!1,this.WP=!0,this.XP=()=>{this.WP=!0,this.pi.Bs()},this.ZP=[],this.JP=t=>{for(let e=0;e<this.tT.length;e+=1)if(this.tT[e].panel===t){this.tT.splice(e,1),this.YP=!0,this.pi.Bs();break}},this.QP=t=>{const e=this.$P.indexOf(t);e>=0&&this.$P.splice(e,1)},this.KP=(t,e,i,s,r)=>{if(this.qP(e,i,s,r)){const n={panel:t,columnIndex:e,rowIndex:i,columnSpan:s,rowSpan:r};return this.tT.push(n),this.tB(n),this.YP=!0,t}throw new dg("Out of dashboard range.")},this.D=new vt,this.iB=e.numberOfRows,this.sB=e.numberOfColumns,this.Pg=t,this.eB=e,this.rB=s;const o=this.sB*this.iB;this.hB={x:new pg(new Array(this.sB).fill(1)),y:new pg(new Array(this.iB).fill(1))},this.bi=i.bi,this.nB=this.bi.dashboardSplitterStyle,this.Er=!1!==(null==e?void 0:e.animationsEnabled),this.oB=ug(i,o),this.aB=i.zP("dashboard splitters",500001),this.lB=()=>this.oB.OP(),this.Og=this.oB.VP(),this.vs=i.vs.ys(this,{uB:{}}),this.vs.uB.Ps(this.bi.effectsDashboardSplitters);const a=i.kt();this.uiScale=J.d2({scaleXYConstructor:q}).ii(0,100).si(0,100).Z(a),this.eA=J.d2({scaleXYConstructor:q}).ii(0,this.uiScale.x.getCellSize()).si(0,this.uiScale.y.getCellSize()).Z(a),this.cB=i.dB.bind(i),this.fB=i.AB.bind(i),this.gB=i.pB.bind(i),this.vB=i.yB.bind(i),this.ja=i.ja.bind(i),this.Wa=i.Wa.bind(i),this.engine=i.Dg,this.pi=i.Mc,i.O("resize",this.XP),i.Bs();const h=t=>{this.Cg=t.isInView,this.D.R("inviewchange",{isInView:this.Cg})};i.O("inviewchanged",h),this.$g=()=>{i.N("inviewchanged",h)},this.mB(),this.setAnimationsEnabled(this.Er),this.createChartXY=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new Cu(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,e,this),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createSpiderChart=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new Vd(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,e,this),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createPolarChart=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new Wu(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,e,this),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createPieChart=t=>{const e=Ag(t,this.eB,this.Er),i=e&&e.type?e.type:ag;return this.KP(new i(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createGaugeChart=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new Uf(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createFunnelChart=t=>{const e=Ag(t,this.eB,this.Er),i=e&&e.type?e.type:ad;return this.KP(new i(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createPyramidChart=t=>{const e=Ag(t,this.eB,this.Er),i=t&&t.type?t.type:bd;return this.KP(new i(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createUIPanel=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new Nh(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createLegendPanel=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new qf(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,t.legend),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createZoomBandChart=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new Pu(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,e,this),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createMapChart=t=>{const e=Ag(t,this.eB,this.Er);return this.KP(new hc(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,e,this),e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createChart3D=t=>{const e=Ag(t,this.eB,this.Er),i=new Rl(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e);return this.KP(i,e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createDataGrid=t=>{const e=Ag(t,this.eB,this.Er),i=new vf(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this);return this.KP(i,e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createBarChart=t=>{const e=Ag(t,this.eB,this.Er),i=new Cf(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e);return this.KP(i,e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)},this.createParallelCoordinateChart=t=>{const e=Ag(t,this.eB,this.Er),i=new $f(this.Pg,this.oB.NP(this.xB(t.columnIndex,t.rowIndex)),this.SB(e,this.hB),this.JP,n,this,e);return this.KP(i,e.columnIndex,e.rowIndex,e.columnSpan,e.rowSpan)}}xB(t,e){return t+e*this.sB}SB(t,e){return{d1:i=>new i.scale1DConstructor("x"===i.dimension?t.columnIndex:t.rowIndex,"x"===i.dimension?t.columnSpan:t.rowSpan,"x"===i.dimension?this.sB:this.iB,"x"===i.dimension?e.x:e.y),d2:i=>(new i.scaleXYConstructor).hi({x:t.columnIndex,y:t.rowIndex},{x:t.columnSpan,y:t.rowSpan},{x:this.sB,y:this.iB},e),d3:()=>new Y({x:t.columnIndex,y:t.rowIndex},{x:t.columnSpan,y:t.rowSpan},{x:this.sB,y:this.iB},e)}}setWidth(t){return t instanceof Array||(t=[t,t]),this.cB(t[0]),this.fB(t[1]),this}setHeight(t){return t instanceof Array||(t=[t,t]),this.gB(t[0]),this.vB(t[1]),this}getWidth(){return this.ja()}getHeight(){return this.Wa()}setBackgroundFillStyle(t){return this.engine.setBackgroundFillStyle(t),this.aB.Bs(),this}getBackgroundFillStyle(){return this.engine.getBackgroundFillStyle()}setBackgroundStrokeStyle(t){return this.engine.setBackgroundStrokeStyle(t),this.aB.Bs(),this}getBackgroundStrokeStyle(){return this.engine.getBackgroundStrokeStyle()}getTheme(){return this.bi}setSplitterStyle(t){const e=this.nB;return this.nB="function"==typeof t?t(this.nB):t,this.bB(e),this}getSplitterStyle(){return this.nB}setSplitterEffect(t){return this.vs.uB.Ps(t),this.pi.Bs(),this}getSplitterEffect(){return this.vs.uB.Ds()}setAnimationHighlight(t){return this.HP=t,this.ZP.forEach(e=>this.pi.Ms.Ns(e.line,t)),this}getAnimationHighlight(){return this.HP}bB(t){for(const t of this.ZP)t.line.cr(this.nB);this.mB()}setColumnWidth(t,e){const i=this.hB.x.T();return t>=0&&t<i.length&&(i[t]=e,this.hB.x.C(i)),this.XP(),this}getColumnWidth(t){const e=this.hB.x.T();if(t>=e.length)throw new dg("Column index is out of dashboard range.");return e[t]}setRowHeight(t,e){const i=this.hB.y.T();return t>=0&&t<i.length&&(i[Math.abs(i.length-1-t)]=e,this.hB.y.C(i)),this.XP(),this}getRowHeight(t){const e=this.hB.y.T();if(t>=e.length)throw new dg("Row index is out of dashboard range.");return e[Math.abs(e.length-1-t)]}getSizePixels(){return this.eA.getInnerIntervalPixels()}MB(t,e,i){if(i&&Math.abs(t.x)>0)this.wB(e,t.x);else{if(i||!(Math.abs(t.y)>0))return;this._B(e,t.y)}for(const t of this.tT)t.panel.H();this.XP()}_B(t,e){const i=xg(this.tT,this.hB.y.T(),t,e,this.eA.kt(),!1);this.hB.y.C(i),this.XP()}wB(t,e){const i=xg(this.tT,this.hB.x.T(),t,e,this.eA.kt(),!0);this.hB.x.C(i),this.XP()}kB(){this.ZP.forEach(t=>t.line.dispose()),this.ZP.length=0;for(let t=1;t<=this.sB-1;t+=1)for(let i=0;i<=this.iB-1;i+=1)if(void 0!==this.tT.find(e=>mi(i,e.rowIndex,e.rowIndex+e.rowSpan-1)&&(t===e.columnIndex||t===e.columnIndex+e.columnSpan))){const s=this.aB.dr(this.eA).cr(this.nB);s.addEventListener("pointerenter",i=>{this.ZP.forEach(e=>{"vertical"===e.alignment&&e.column===t&&(this.pi.Ms.Vs(e.line,1),this.aB.CB(e.line))}),this.UP=this.engine.setMouseStyle(e.MouseStyles.ResizeColumn,this.UP),this.pi.Bs()}),s.addEventListener("pointerleave",e=>{this.ZP.forEach(e=>{"vertical"===e.alignment&&e.column===t&&this.pi.Ms.Vs(e.line,0)}),this.UP=this.engine.restoreMouseStyle(this.UP),this.pi.Bs()}),s.addEventListener("pointerdown",i=>{fe(i);let s=i;const r=i=>{fe(i),this.UP=this.engine.setMouseStyle(e.MouseStyles.ResizeColumn,this.UP),this.ZP.forEach(e=>{"vertical"===e.alignment&&e.column===t&&(this.pi.Ms.Vs(e.line,1),this.aB.CB(e.line))});const r={x:i.clientX-s.clientX,y:i.clientY-s.clientY};s=i,this.MB(r,t,!0)},n=e=>{e.pointerId===i.pointerId&&(this.ZP.forEach(e=>{"vertical"===e.alignment&&e.column===t&&this.pi.Ms.Vs(e.line,0)}),this.UP=this.engine.restoreMouseStyle(this.UP),Ut.removeEventListener("pointermove",r),Ut.removeEventListener("pointerup",n))};Ut.addEventListener("pointermove",r),Ut.addEventListener("pointerup",n)}),this.pi.Ms.bs(s,t=>s.Ii(t),{animationEnabled:this.HP}),this.ZP.push({row:i,column:t,line:s,alignment:"vertical"})}for(let t=1;t<=this.iB-1;t+=1)for(let i=0;i<=this.sB-1;i+=1)if(void 0!==this.tT.find(e=>mi(i,e.columnIndex,e.columnIndex+e.columnSpan-1)&&(t===e.rowIndex||t===e.rowIndex+e.rowSpan))){const s=this.aB.dr(this.eA).cr(this.nB);s.addEventListener("pointerenter",i=>{this.ZP.forEach(e=>{"horizontal"===e.alignment&&e.row===t&&(this.pi.Ms.Vs(e.line,1),this.aB.CB(e.line))}),this.UP=this.engine.setMouseStyle(e.MouseStyles.ResizeRow,this.UP),this.pi.Bs()}),s.addEventListener("pointerleave",e=>{this.ZP.forEach(e=>{"horizontal"===e.alignment&&e.row===t&&this.pi.Ms.Vs(e.line,0)}),this.UP=this.engine.restoreMouseStyle(this.UP),this.pi.Bs()}),s.addEventListener("pointerdown",i=>{fe(i);let s=i;const r=i=>{fe(i),this.UP=this.engine.setMouseStyle(e.MouseStyles.ResizeRow,this.UP),this.ZP.forEach(e=>{"horizontal"===e.alignment&&e.row===t&&(this.pi.Ms.Vs(e.line,1),this.aB.CB(e.line))});const r={x:i.clientX-s.clientX,y:-(i.clientY-s.clientY)};s=i,this.MB(r,t,!1)},n=e=>{e.pointerId===i.pointerId&&(this.ZP.forEach(e=>{"horizontal"===e.alignment&&e.row===t&&this.pi.Ms.Vs(e.line,0)}),this.UP=this.engine.restoreMouseStyle(this.UP),Ut.removeEventListener("pointermove",r),Ut.removeEventListener("pointerup",n))};Ut.addEventListener("pointermove",r),Ut.addEventListener("pointerup",n)}),this.pi.Ms.bs(s,t=>s.Ii(t),{animationEnabled:this.HP}),this.ZP.push({row:t,column:i,line:s,alignment:"horizontal"})}this.vs.uB.ks(this.ZP.map(t=>t.line))}TB(){const t=this.eA.kt(),e=this.hB.x.T(),i=e.reduce((t,e)=>t+e),s=this.hB.y.T(),r=s.reduce((t,e)=>t+e);this.ZP.forEach(n=>{if("vertical"===n.alignment){const o=l(t.x*e.slice(0,n.column).reduce((t,e)=>t+e,0)/i,t.y*s.slice(0,n.row).reduce((t,e)=>t+e,0)/r),a=l(o.x,t.y*s.slice(0,n.row+1).reduce((t,e)=>t+e,0)/r);n.line.gr(o).Ar(a)}else{const o=l(t.x*e.slice(0,n.column).reduce((t,e)=>t+e,0)/i,t.y*s.slice(0,n.row).reduce((t,e)=>t+e,0)/r),a=l(t.x*e.slice(0,n.column+1).reduce((t,e)=>t+e,0)/i,o.y);n.line.gr(o).Ar(a)}})}setAnimationsEnabled(t){return this.Er=t,this.getCells().filter(t=>t.panel instanceof Oh).forEach(e=>e.panel.setAnimationsEnabled(t)),this.setAnimationHighlight(this.Er),this}getAnimationsEnabled(){return this.Er}getCells(){return this.tT.slice()}dispose(){return this.ci||(this.$g&&this.$g(),this.tT.slice().forEach(t=>t.panel.dispose()),this.$P.slice().forEach(t=>t.dispose()),this.ci=!0,this.rB(),this.D.R("dispose",{})),this}isDisposed(){return this.ci}getIsInView(){return this.Cg}saveToFile(t,e,i,s){return bh(this.engine,t,e,i,s),this}wc(t){if(this.WP){const t=this.pi.ai.kt(),e=t.x,i=t.y;this.uiScale.Z(e,i),this.eA.Z(e,i);const s=this.uiScale.getInnerIntervalPixels();this.eA.ii(0,s.x).si(0,s.y),this.D.R("resize",{width:s.x,height:s.y,engineWidth:e,engineHeight:i}),this.jP=!0}this.YP&&(this.kB(),this.YP=!1,this.jP=!0),this.jP&&(this.TB(),this.jP=!1);for(const e of this.tT)e.panel.ir(t);return this.$P.forEach(t=>t.Nh()),this.$P.forEach(t=>t.ir()),this.WP=!1,this}j(){for(const t of this.tT)t.panel.j();return this.eA.x.j(),this.eA.y.j(),this.uiScale.x.j(),this.uiScale.y.j(),this}H(){for(const t of this.tT)t.panel.H();return this.eA.x.H(),this.eA.y.H(),this.uiScale.x.H(),this.uiScale.y.H(),this}translateCoordinate(t,e,i){return kh(t,e,i,this.eA,this.pi)}addUIElement(t=ya,e=this.uiScale){e=Eh(e,this.eA);const i=Mh(t,this.lB(),this.uiScale,e,this.QP,this.bi);return this.$P.push(i),i}qP(t,e,i,s){return e>=0&&t>=0&&e+s<=this.iB&&t+i<=this.sB}tB(t){const e=this.nB,i=e===Bt?0:e.getThickness()/2,s={left:t.columnIndex>0?i:0,top:t.rowIndex<this.iB-1?i:0,right:t.columnIndex<this.sB-1?i:0,bottom:t.rowIndex>0?i:0};t.panel.Mn(s)}mB(){this.uiScale.x.St([0,0]),this.uiScale.y.St([0,0]),this.eA.x.St([0,0]),this.eA.y.St([0,0]);for(const t of this.tT)this.tB(t);this.pi.Bs()}addEventListener(t,e,i){this.D.addEventListener(t,e,i)}removeEventListener(t,e){this.D.removeEventListener(t,e)}}const Ag=(t,e,i)=>{const s={...t,columnSpan:t.columnSpan||1,rowSpan:t.rowSpan||1,animationsEnabled:void 0!==t.animationsEnabled?t.animationsEnabled:i};var r,n;return s.rowIndex=(r=s.rowIndex,n=s.rowSpan,e.numberOfRows-(r+n)),s},Sg=(t,i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAgCAYAAADwkoGKAAAsa2NhQlgAACxranVtYgAAAB5qdW1kYzJwYQARABCAAACqADibcQNjMnBhAAAALEVqdW1iAAAAR2p1bWRjMm1hABEAEIAAAKoAOJtxA3Vybjp1dWlkOjlmZDBkZjkzLTVmMDMtNDczYi1hZThhLTFhNDM4NmMzNmJhYQAAAAGzanVtYgAAAClqdW1kYzJhcwARABCAAACqADibcQNjMnBhLmFzc2VydGlvbnMAAAAA12p1bWIAAAAmanVtZGNib3IAEQAQgAAAqgA4m3EDYzJwYS5hY3Rpb25zAAAAAKljYm9yoWdhY3Rpb25zgaNmYWN0aW9ua2MycGEuZWRpdGVkbXNvZnR3YXJlQWdlbnRtQWRvYmUgRmlyZWZseXFkaWdpdGFsU291cmNlVHlwZXhTaHR0cDovL2N2LmlwdGMub3JnL25ld3Njb2Rlcy9kaWdpdGFsc291cmNldHlwZS9jb21wb3NpdGVXaXRoVHJhaW5lZEFsZ29yaXRobWljTWVkaWEAAACranVtYgAAAChqdW1kY2JvcgARABCAAACqADibcQNjMnBhLmhhc2guZGF0YQAAAAB7Y2JvcqVqZXhjbHVzaW9uc4GiZXN0YXJ0GCFmbGVuZ3RoGSx3ZG5hbWVuanVtYmYgbWFuaWZlc3RjYWxnZnNoYTI1NmRoYXNoWCBvErgv+J0u7bVCYViyMUgw5yMb8idAv1erA3/DALx9NWNwYWRIAAAAAAAAAAAAAAIDanVtYgAAACRqdW1kYzJjbAARABCAAACqADibcQNjMnBhLmNsYWltAAAAAddjYm9yqGhkYzp0aXRsZW9HZW5lcmF0ZWQgaW1hZ2VpZGM6Zm9ybWF0aWltYWdlL3BuZ2ppbnN0YW5jZUlEeCh4bXAuaWlkOjI3NEMxQjdDN0E0MDExRUVBQkZFQUNFQjJDOTA0NzVCb2NsYWltX2dlbmVyYXRvcng2QWRvYmVfUGhvdG9zaG9wLzI1LjIuMCBhZG9iZV9jMnBhLzAuNy42IGMycGEtcnMvMC4yNS4ydGNsYWltX2dlbmVyYXRvcl9pbmZvgb9kbmFtZW9BZG9iZSBQaG90b3Nob3BndmVyc2lvbmYyNS4yLjD/aXNpZ25hdHVyZXgZc2VsZiNqdW1iZj1jMnBhLnNpZ25hdHVyZWphc3NlcnRpb25zgqJjdXJseCdzZWxmI2p1bWJmPWMycGEuYXNzZXJ0aW9ucy9jMnBhLmFjdGlvbnNkaGFzaFggSmnBvf+o3kEweL4k7cz4MTrB0WSVNFZxoA1rBrM31K+iY3VybHgpc2VsZiNqdW1iZj1jMnBhLmFzc2VydGlvbnMvYzJwYS5oYXNoLmRhdGFkaGFzaFggL2g6Dghd536quyA5vPlS/9NGA5WvLRkkKJmqn0VxCoFjYWxnZnNoYTI1NgAAKEBqdW1iAAAAKGp1bWRjMmNzABEAEIAAAKoAOJtxA2MycGEuc2lnbmF0dXJlAAAAKBBjYm9y0oREoQE4JKNmc2lnVHN0oWl0c3RUb2tlbnOBoWN2YWxZDjYwgg4yMAMCAQAwgg4pBgkqhkiG9w0BBwKggg4aMIIOFgIBAzEPMA0GCWCGSAFlAwQCAQUAMIGCBgsqhkiG9w0BCRABBKBzBHEwbwIBAQYJYIZIAYb9bAcBMDEwDQYJYIZIAWUDBAIBBQAEIHj4VpJDPzaO0x4hOPnj/w1GTHuwXU0IpBf4VVocIQzoAhB3SsxvHza2JR1fKj3Mjr0yGA8yMDIzMTEwMzExNTcyNloCCQCyOL6wAOGCbaCCC70wggUHMIIC76ADAgECAhAFHp6R1x6RCrvkPVzt0N3ZMA0GCSqGSIb3DQEBCwUAMGMxCzAJBgNVBAYTAlVTMRcwFQYDVQQKEw5EaWdpQ2VydCwgSW5jLjE7MDkGA1UEAxMyRGlnaUNlcnQgVHJ1c3RlZCBHNCBSU0E0MDk2IFNIQTI1NiBUaW1lU3RhbXBpbmcgQ0EwHhcNMjMwOTA4MDAwMDAwWhcNMzQxMjA3MjM1OTU5WjBYMQswCQYDVQQGEwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xMDAuBgNVBAMTJ0RpZ2lDZXJ0IEFkb2JlIEFBVEwgVGltZXN0YW1wIFJlc3BvbmRlcjBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABE0srlH5A/+15/MFl1asNh8Q8TubOsEVfu0qlJrF0smjtwL1IeHZ/AB7J59u1Trpho1BDN85lfTY30rNBsfT+myjggGLMIIBhzAOBgNVHQ8BAf8EBAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDAgBgNVHSAEGTAXMAgGBmeBDAEEAjALBglghkgBhv1sBwEwHwYDVR0jBBgwFoAUuhbZbU2FL3MpdpovdYxqII+eyG8wHQYDVR0OBBYEFLA1qlbDIamLztO4vIsWJVed7zThMFoGA1UdHwRTMFEwT6BNoEuGSWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRydXN0ZWRHNFJTQTQwOTZTSEEyNTZUaW1lU3RhbXBpbmdDQS5jcmwwgZAGCCsGAQUFBwEBBIGDMIGAMCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wWAYIKwYBBQUHMAKGTGh0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRydXN0ZWRHNFJTQTQwOTZTSEEyNTZUaW1lU3RhbXBpbmdDQS5jcnQwDQYJKoZIhvcNAQELBQADggIBAHgrjELHhBCEWJSCyRX7lsL0C9LJgbX1ryVYySNRxHkMR2LqC7PQZRJgDNR+kJop8P5v2Bzp/jMrzw4U4pY6rYv3I8HpFlJa4uBwUTIUgHWpi8Xxd1JEEX94POODi7HySekX60A055BozFb7GGVaxb0LreQTRXnkr6ggPNUPX9Gh+2ScOxlTdQQLgZbkdYvxo3Ap6cy9riZijRxOZqiOyWSxMUhgKxeKzwrFW6Xbe0awNhOUXZzIxc4ixpKzWSItpPJ30ZiBQn49U3ADYTnshbN9ZkTA1pHf/Nov2ZUvvddkZ8UYvwo9vBvLTDvnmABnRMBKaXYAs3ZCvw9CkDPOWTeUJMFRAtmUx52ohaA3nD8bCJ6UfpQ2pFfOdShwpb6GKv0g+BgcdIG2LHPJ0Ufmr+XmpgZgq/HIge0hjcCADpjDgq2z4B0L4xtAA1M8MrUx02hxb7104nFKqMuv5zJTQl3sgwqXUyP+9zHQP9y/Z5Fx/AQWrOXCW56dV7P4cFBJl8zHqinlhkOStZ1m22+9Hlq+eC0hJ2lkF1LuzRdJJb/51LXoPKRnopFDng6XpoD7eG6w4YpAx9+P00JuUoBsYSrdsuFiyWyQQGBAnjI69ggbSLcW+hJytuinaxawVlItJkS2eV5Z4XsxPg7f82uRkdtN0hTHeI93CN3OWeRebnK7MIIGrjCCBJagAwIBAgIQBzY3tyRUfNhHrP0oZipeWzANBgkqhkiG9w0BAQsFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBUcnVzdGVkIFJvb3QgRzQwHhcNMjIwMzIzMDAwMDAwWhcNMzcwMzIyMjM1OTU5WjBjMQswCQYDVQQGEwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xOzA5BgNVBAMTMkRpZ2lDZXJ0IFRydXN0ZWQgRzQgUlNBNDA5NiBTSEEyNTYgVGltZVN0YW1waW5nIENBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAxoY1BkmzwT1ySVFVxyUDxPKRN6mXUaHW0oPRnkyibaCwzIP5WvYRoUQVQl+kiPNo+n3znIkLf50fng8zH1ATCyZzlm34V6gCff1DtITaEfFzsbPuK4CEiiIY3+vaPcQXf6sZKz5C3GeO6lE98NZW1OcoLevTsbV15x8GZY2UKdPZ7Gnf2ZCHRgB720RBidx8ald68Dd5n12sy+iEZLRS8nZH92GDGd1ftFQLIWhuNyG7QKxfst5Kfc71ORJn7w6lY2zkpsUdzTYNXNXmG6jBZHRAp8ByxbpOH7G1WE15/tePc5OsLDnipUjW8LAxE6lXKZYnLvWHpo9OdhVVJnCYJn+gGkcgQ+NDY4B7dW4nJZCYOjgRs/b2nuY7W+yB3iIU2YIqx5K/oN7jPqJz+ucfWmyU8lKVEStYdEAoq3NDzt9KoRxrOMUp88qqlnNCaJ+2RrOdOqPVA+C/8KI8ykLcGEh/FDTP0kyr75s9/g64ZCr6dSgkQe1CvwWcZklSUPRR8zZJTYsg0ixXNXkrqPNFYLwjjVj33GHek/45wPmyMKVM1+mYSlg+0wOI/rOP015LdhJRk8mMDDtbiiKowSYI+RQQEgN9XyO7ZONj4KbhPvbCdLI/Hgl27KtdRnXiYKNYCQEoAA6EVO7O6V3IXjASvUaetdN2udIOa5kM0jO0zbECAwEAAaOCAV0wggFZMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFLoW2W1NhS9zKXaaL3WMaiCPnshvMB8GA1UdIwQYMBaAFOzX44LScV1kTN8uZz/nupiuHA9PMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAKBggrBgEFBQcDCDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0VHJ1c3RlZFJvb3RHNC5jcnQwQwYDVR0fBDwwOjA4oDagNIYyaHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0VHJ1c3RlZFJvb3RHNC5jcmwwIAYDVR0gBBkwFzAIBgZngQwBBAIwCwYJYIZIAYb9bAcBMA0GCSqGSIb3DQEBCwUAA4ICAQB9WY7Ak7ZvmKlEIgF+ZtbYIULhsBguEE0TzzBTzr8Y+8dQXeJLKftwig2qKWn8acHPHQfpPmDI2AvlXFvXbYf6hCAlNDFnzbYSlm/EUExiHQwIgqgWvalWzxVzjQEiJc6VaT9Hd/tydBTX/6tPiix6q4XNQ1/tYLaqT5Fmniye4Iqs5f2MvGQmh2ySvZ180HAKfO+ovHVPulr3qRCyXen/KFSJ8NWKcXZl2szwcqMj+sAngkSumScbqyQeJsG33irr9p6xeZmBo1aGqwpFyd/EjaDnmPv7pp1yr8THwcFqcdnGE4AJxLafzYeHJLtPo0m5d2aR8XKc6UsCUqc3fpNTrDsdCEkPlM05et3/JWOZJyw9P2un8WbDQc1PtkCbISFA0LcTJM3cHXg65J6t5TRxktcma+Q4c6umAU+9Pzt4rUyt+8SVe+0KXzM5h0F4ejjpnOHdI/0dKNPH+ejxmF/7K9h+8kaddSweJywm228Vex4Ziza4k9Tm8heZWcpw8De/mADfIBZPJ/tgZxahZrrdVcA6KYawmKAr7ZVBtzrVFZgxtGIJDwq9gdkT/r+k0fNX2bwE+oLeMt8EifAAzV3C+dAjfwAL5HYCJtnwZXZCpimHCUcr5n8apIUP/JiW9lVUKx+A+sDyDivl1vupL0QVSucTDh3bNzgaoSv27dZ8/DGCAbgwggG0AgEBMHcwYzELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDkRpZ2lDZXJ0LCBJbmMuMTswOQYDVQQDEzJEaWdpQ2VydCBUcnVzdGVkIEc0IFJTQTQwOTYgU0hBMjU2IFRpbWVTdGFtcGluZyBDQQIQBR6ekdcekQq75D1c7dDd2TANBglghkgBZQMEAgEFAKCB0TAaBgkqhkiG9w0BCQMxDQYLKoZIhvcNAQkQAQQwHAYJKoZIhvcNAQkFMQ8XDTIzMTEwMzExNTcyNlowKwYLKoZIhvcNAQkQAgwxHDAaMBgwFgQU2Rq5M/4XremCHqYT9aQ6cU4+fn0wLwYJKoZIhvcNAQkEMSIEIGmY+GsCefCDmP0PFcYjdxBUfi0EgKYuEZb9pUMyLNuVMDcGCyqGSIb3DQEJEAIvMSgwJjAkMCIEIILa8ZSVezaEAkWP1ScAaf5ixxRW+p4Lhqv4J+hTICfZMAoGCCqGSM49BAMCBEcwRQIgcxxuf7QHV9Fkpj1VhPrFqhNFh8dZzl8qUU/2N3Sr4eoCIQDKu0KGYL++CSsDAXjJciMDbr5ImTy3jw0yQU5GYYeLimd4NWNoYWluglkGMzCCBi8wggQXoAMCAQICEBtbCzvasORd8vMNnlTR2tIwDQYJKoZIhvcNAQELBQAwdTELMAkGA1UEBhMCVVMxIzAhBgNVBAoTGkFkb2JlIFN5c3RlbXMgSW5jb3Jwb3JhdGVkMR0wGwYDVQQLExRBZG9iZSBUcnVzdCBTZXJ2aWNlczEiMCAGA1UEAxMZQWRvYmUgUHJvZHVjdCBTZXJ2aWNlcyBHMzAeFw0yMzAyMDEwMDAwMDBaFw0yNDAyMDEyMzU5NTlaMIGhMREwDwYDVQQDDAhjYWktcHJvZDEcMBoGA1UECwwTQ29udGVudCBDcmVkZW50aWFsczETMBEGA1UECgwKQWRvYmUgSW5jLjERMA8GA1UEBwwIU2FuIEpvc2UxEzARBgNVBAgMCkNhbGlmb3JuaWExCzAJBgNVBAYTAlVTMSQwIgYJKoZIhvcNAQkBFhVncnAtY2FpLW9wc0BhZG9iZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDv0wCnfYY9lkHDsykrTG7FYlnYHBcyualuD5u9ULjzv+FsTWOLg8Nhrz9RTxI9EeBbu3Wm7f4vqPsQYfxkEp0wIa6DVmEOZhbAeRfbhybWQ/D4Wvvck4mEZR+QZmTpIn7HX61gbtMFHlJUxkYBctIoAt9TBAFbz9d5Ig2WG0bsH39b6/8USXnIIk4FB6dtBRT1xeEwSDtwOd1YBpXXNBJmRWHXNJZZ85of2tBTesg/kMvTrOJJxYDZ97U416wcvbVomlees+NXUY3/ZB4xH+NsZils7m1bL2v2hSnHiLoqZeUKklbHUmT4ZpjrZCdtuIsWm5j2PPXKr7HKUuCbZSXBAgMBAAWjggGMMIIBiDAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIHgDAeBgNVHSUEFzAVBgkqhkiG9y8BAQwGCCsGAQUFBwMEMIGOBgNVHSAEgYYwgYMwgYAGCSqGSIb3LwECAzBzMHEGCCsGAQUFBwICMGUMY1lvdSBhcmUgbm90IHBlcm1pdHRlZCB0byB1c2UgdGhpcyBMaWNlbnNlIENlcnRpZmljYXRlIGV4Y2VwdCBhcyBwZXJtaXR0ZWQgYnkgdGhlIGxpY2Vuc2UgYWdyZWVtZW50LjBdBgNVHR8EVjBUMFKgUKBOhkxodHRwOi8vcGtpLWNybC5zeW1hdXRoLmNvbS9jYV83YTVjM2EwYzczMTE3NDA2YWRkMTkzMTJiYzFiYzIzZi9MYXRlc3RDUkwuY3JsMDcGCCsGAQUFBwEBBCswKTAnBggrBgEFBQcwAYYbaHR0cDovL3BraS1vY3NwLnN5bWF1dGguY29tMB8GA1UdIwQYMBaAFFcpejJNzP7kNU7AHyRzznNTq99qMA0GCSqGSIb3DQEBCwUAA4ICAQBXjlGa3yAK/Gijn6n/JNU9FZm72MP6vc5czrWe9y0T+EawuRvhpD5Edi1TnXkrpe8sMkgSjTGdbY+yGhq8zlCWQeXN1/aWo3L9Xr1uNxY/oVpLn0uWWfnfJ7yR9gKl/yoMfhjydT4t1fXHi/MhfhrWSVRHqX2U31UFGz/e298P2kv+vqhzpIUo1bj+jibtoPLMMQcCOTtKiJOTh4o3VSZpwQDERCzo91NkF+LnZjwYl6fE5USIkg/oCoomXxSPpowybDrcRJ9ilbtJcER48/LGgwzv/c7OYdron4PnEXm1FkOaVj+QRf7OwiNTizonhIzLR5Vfp0QHOWv/bPzvCjPQd+Xr0Q4032WlSxQwostNTAPtoVAU4OCwVH3Ech38emJ00/6fkDCdr7MN8/4n2LSNrMUvaBEZdmLqDCBnO02dbFrmpg3pTc0FqRQ4GL/88pjRNSMy5tU9SoQnSCGYqIsjfL8AzgPEGiXXRgABYc1uXecf4/eayb3K2MPs7hnWTbUKpHHJIwxpdN3vTGdZNWpz9Oxfuo3eELQlkTvACHgqkaXi/FAanHe5PChn6fr1/4cNF8goD0buPApgS3zzwqjRhxrH8ISwPfJn8JqzurMaLDMnnc18tHzUiMtX73jf6oXh7voCxX/T4D3nFPlxU3om2cpcLQ1Wd4026x18rlSGR1kGpTCCBqEwggSJoAMCAQICEAyotlR7iebSBol1zYubieIwDQYJKoZIhvcNAQELBQAwbDELMAkGA1UEBhMCVVMxIzAhBgNVBAoTGkFkb2JlIFN5c3RlbXMgSW5jb3Jwb3JhdGVkMR0wGwYDVQQLExRBZG9iZSBUcnVzdCBTZXJ2aWNlczEZMBcGA1UEAxMQQWRvYmUgUm9vdCBDQSBHMjAeFw0xNjExMjkwMDAwMDBaFw00MTExMjgyMzU5NTlaMHUxCzAJBgNVBAYTAlVTMSMwIQYDVQQKExpBZG9iZSBTeXN0ZW1zIEluY29ycG9yYXRlZDEdMBsGA1UECxMUQWRvYmUgVHJ1c3QgU2VydmljZXMxIjAgBgNVBAMTGUFkb2JlIFByb2R1Y3QgU2VydmljZXMgRzMwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQC3Hy69vQmzXEhs/gyDrmwB6lF4JaSAPomnsbKIZNr2iXaB+fkd85X8eJiNmI7P5O4cVT4Nc1p3zrESqBV4ZUyW8gcZ78QdwoHG8QNd2VNcHnMgSR+XT9Iafsnq9Nfww3Jt9KL3l5ANQ5n1+MJqr48EWNLll942bOL/JH4ywDSMoqhZqtJEIUUUGlQVBZ8CAvJc7LE6ddA5C52PE2Ppa7RfQgHXf4gfXVZwpxYRZcziPiOHqEvLb0J3cShUbejFxV6cwX8QyAPa1ePHg1RtM0HX+D34xHo3DkyGnmT+Ddq00TEDGG26AL5PdINKFIQl+zaq6KJFQe1fdGE5wrWzU4mBPmzaz3EbLn+7FWlwAhorYqIMldbfHE3ydc+aTU1JW7+bG19qmvhO9IluGtTtQDeqFBj2fg6faxsfVfVPD7stN6TwoIDlkOCE4RE+Iin8m3z3eqi/VsTmsmRqBxWDRaqOHz02EJoEDxXJG3ei+UbIIp01XZQvdufm90WxOTuqqan2ZqTPX9K5VdjEh/ovr7xFc5q1dZo+Sa5y4sTVM854/tLU3klOgUKzzSXYPYS3GhBcYJHjwr9xNRHnNX99D6F0g7OijScWfvtjxh13aTv/H0ETvymah4yfDpVdh9cK5YSCPqnuOlsujFAyhYwJXOWDvZZU2EkWVLDhoPx9zp7N4QIDAQABo4IBNDCCATAwEgYDVR0TAQH/BAgwBgEB/wIBADA1BgNVHR8ELjAsMCqgKKAmhiRodHRwOi8vY3JsLmFkb2JlLmNvbS9hZG9iZXJvb3RnMi5jcmwwDgYDVR0PAQH/BAQDAgEGMBQGA1UdJQQNMAsGCSqGSIb3LwEBBzBXBgNVHSAEUDBOMEwGCSqGSIb3LwECAzA/MD0GCCsGAQUFBwIBFjFodHRwczovL3d3dy5hZG9iZS5jb20vbWlzYy9wa2kvcHJvZF9zdmNlX2Nwcy5odG1sMCQGA1UdEQQdMBukGTAXMRUwEwYDVQQDEwxTWU1DLTQwOTYtMzMwHQYDVR0OBBYEFFcpejJNzP7kNU7AHyRzznNTq99qMB8GA1UdIwQYMBaAFKYc4W1UJEyoj0hyv26pjNXk7DHUMA0GCSqGSIb3DQEBCwUAA4ICAQBxzuUHjKbcLdzI4DtlXgCSgZXrlSAkr59pOF3JfPG42qVNAGU7JcEYXJ6+WbfcGwY7WYMl+jO7IvJPb7shXFYW9bnJgxX7lLU14KExchmcLNY1ee6IhBJ2Y8PzZMRUKSd5CkURPg0PBLGjz/KR/DofHx+G4rPTCOGORYxeYrd01lci5hVxvKccvIk7MD69ZTewfZPSM+0WnsU3f0Zmd7hgbRpUyWceG0eHFpdUKK/ZFWhHjDVC28odCnN885tHncKXviItK0ZUUo/AIthFKlhEXsnq9VL9fFbgvO83ZvpUQo5y8mY3cuGnEVGXdhjNb53CfC1u4dbpYmWaN99subUzEsUaUb3loLPfVfzDOpg2y9v37kBdy/wuXr20teY7U62xj/fAgs1QSnhUtlMTfCqbefyEycKVmKIrJkJLsvgTSYKVvH4FFIwfd5WjqOC97jX98rcVAzhAI0iSkazsWOMvL6m0L4nLJapx+85GsVX8Y6AHmEP4bmCElwil6KAP+UewJFiw5rmwV2pESHAhYuZJa03B8tl0nd2QJzvJGmbeBqXqpF9ORinFM3HErK8puRokOjFH2+1asLeI2tB31W/ELdNe27Ogduq6Z6qBwCp59YX27qydDhD0WRfN64kCs25K88iGAGNW2CAfTDS+b+WYJBiIL9jXYZ4LF+BiUvfdu2NwYWRZC70AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPZZAQBKX2Q2ihN2fLDLReHISpfOF0xIqNpOZXbBwZ0XanWG98erbIBdawl7r9nVma/uZjYH457wp00TVpKYUTJHMnzJMKskvM2Df4K6t5pUKGtJqEvMXLUy3g9kJq53aYDwikcUE+8wv+CYtu/+vii4XYSXQIxT4NN+JKoTDXmrNH1G46Nmpfq6SKk0g9GQ2brbkW3fzGR0xDxY3BXRy71guSBxN9TAbQGqUjMnkIyBcwV9wUQ2oCW9oIMNKASjW0CRkcFEzzmrQ+y+zHYpNvUaG7QehHcyhvOec3plzlyP6DZeQWp3PHA5bmonI8t5j6Qj15X1KnQiXuJ0rW+xoMA89aIVmpx4VgAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAOSaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA5LjEtYzAwMSA3OS4xNDYyODk5Nzc3LCAyMDIzLzA2LzI1LTIzOjU3OjE0ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjYyYTdmYWExLWJmZTMtMjE0Ny04MjAwLWMxM2NlMGU4ZTc1NCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNzRDMUI3RDdBNDAxMUVFQUJGRUFDRUIyQzkwNDc1QiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNzRDMUI3QzdBNDAxMUVFQUJGRUFDRUIyQzkwNDc1QiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoMjAyMzEwMjQubS4yMzc0IDRhYjk0MzkpICAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDphYjQzZjNjYy1hNTY4LTRkNGQtOTdiZC1iYjk0YjBlZjhjYmQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NjJhN2ZhYTEtYmZlMy0yMTQ3LTgyMDAtYzEzY2UwZThlNzU0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+HNvo5wAADZFJREFUeNrsXFtPVUkW3gc4yP0qDigKON517FFbHRGn1TamjaOJvvhsjIkvPplgfEKe1AefNDE+GP+AmWTszPTYcbpn2piJzc1GWwlOekRBEBFQ7jeZ9ZVrnVkUtfc5CGp3h5VU9qUuu3bVV9+67DonND4+7omEQiHPJaWlpYlxcXGLKX8epTCdB5aXNnHU6c2bN5POcaREp+O9dHxSX1/f5s3KL1ImYCkasMrKyvIISJspD+AyZSTpOrodDSaIBpQCkwtgSM8oVd2/f39M2quoqAijmcrKyjG/l7L77vde+v6sfCRgbdu2LY3AtJNSgg0qDa5oTOViKQtM9nXTgQMHaqmpPEoLKXUQqJpcYIqPj/cSEhLMUZgUbYyNjZkjRPpu50n+VEUvKtditMEb7Xom5OrVqzvpkOXIukFps5XXTunO4cOHR7heKp1/ye1gEX9BCcdv6H4330cbCyh9iXrRgJUQ1FmarFWUIqDS4ApiCT9AobxMpj24uI/209LSvMLCwiLKz6fyQModAlW73TeAac6cOV5SUpIBlasv9qKRvgBYIyMj3tDQkDmPdaLRPzwrHA6bhGsNWr9xsMfEZnC7XDSg+tzv4lRCCRPfjJtHjhzpu3LlCkDVx4BKZICsx9gy4PT4rmFQQbIpdfM5ynX7gWrS/Phl7NixI0SDWCCD52Is14vqAXIByoluAkl+fr43f/58Lyvr7cIaHh4OJSYmfkug6rXZApOamprqUb6vned3X4CBujj29/cbkEl/7EUj74o+og4S2gh6xkypk6mUPXnyZN25c+fCDKzm8vLyOuQzqCAtJ06cuH/+/PkwAytMLCR57VjQFy5cmKeAiXJZGOeLFy/iPBVt4Nqeb60dogKLBm9O/FvxXIwVxBAaUBpgixYt8np7e7329vYJZUtKSkwSefHihVdTU9N2586dXrtfmNj09HQz0dMRvAsYD0dhLryrvG8s7/w+ZCrPcJSdx8duAb+6l0WgWqeu/8uMZMoDWCTr+BpMVoZ8jLUq18XXgdohEFg0cXF6kF2s5Uf9NqBwxL0FCxaYSXz58qWZSNzr6+vzioqKIm01NTV5ZLgbT9HuExgGAzBdUOmJEeb6EKD5AJKt1KJ9TwAFNrpz6tSpljNnzgiQuuh8DbNSNx9HlF0mx26/cbTHLy6AsSKGcVCyjWepJwnS2trqbdiwwZyDJaDyUBbslZmZGTG6Hz9+7D18+NDdUSqTkpIyY6B6V5b4mYsBAIGm27rXR/f+DFXGKm5Ega6P7a5lqvw6sbMIcFkKlCUAI6esQI0QBCwBjxirNqCkDACSkZFhQKLVCSassbHR27Jli6kvsnDhQnN8/vy5t3Hjxsj95ubmSQ6CVoEA5a8IBO+LsSKgoskPKxaC1DKo1mmDXF1/AwAyCO+rNoX1FrANVqLA6V6sfuGGgwcPphBovrCBIuwCgRp7+vSpAUd2dra5bmtrM6pvdHTUu3fvnrGdNHhEbt265XV1dXn79+9/y8V0XltbGwkDkKpsqqqqqhG2AmgBrFn5+Qo0Uyw21gRm0kwCLwqAAgC2b99u2AQCVYWyACtUGkRUoC2bNm0yYBIBe/l5ncKaWmg1hrj/47TCRu32ebUam4LyAweEymK1QG+PUdk3PmXCrGZicrej9e99CD0znvs4NsPtRh2fmMMNLmBBYHgDmTC4ly1bNslWAbhu375tyh06dGgCw2kB+yDEAIEh39HR4RsjE+/NkgJKf0DwlNJ3jkndi2Yo/QXOZ5RxWElpOaUqSk99QLWPErzUr2OcD+j7T+GPUKqZocldyu2mWWbMv1mt4T3q2OObSVnNz46MD49xMfelE85ArOGGiA2FSR0cHDRggVe3fv16Lzc317cXCBeUlZUZu8sVBLUF7YrnaDMWygsjWpLJx1eOvCS8LKX+GFeYdPS1T356wLOC7NcOK/g4HSbaSmku2zZtlo0D6l8U5R2mIxmO91/F79iP8aY+lmhAR2Us09PXr439hAles2ZNoK2Tl5dnwgorV66clHfz5k1v165dk8CFuJYfWwm4/Twgn4FMZqO0U00OPg/lsgck0k3Ae6JACq8HamsAJgPl9fOAzef8VLpey1HtVGXUQoZ45b7QawzgojqpauJNZIYnpEXUFpWZw8ZxMqsdEdgUixlUqPMt1RlygE8mv4jO5/M7tFHZXs4HI+uJG4YFQvldnF+sAPRGjd8SSjl8fzGVG6I6Dxk76GcKl8uOlbESh4eHDVOBpWCcQ/1F88qQv2fPnknlnjx5YsIJOBYXF/9/NqhtANcV8ZbYlc8zswJYJJ8H5Eem7A3WxEYmjdVcigycyltBeV/RsVANbDKDrJnL5jom+Dsa+A5e0WDOn7g/Kx3PR/06qpPDjBS28gG6e6pfDT6gimeV5LF6iqh4focxHo84Ne8hzv8ng2sJA6tfjUedROkZbPkqRhbie8JauTEBi7y6ePncAQaaO3fulKLaWgDQgYEBoxrh+WlgiW3l9znFNtp5IBN5kv0YS6vJYgYVVlU120mfUPot58sqbeaBxJh8zqs7TIN+i573R2aMfykGQD2w21dcfx2DMI3yXjOosLqH6Fr6U8VqDHGhzVw2ns8T2BaTWNMefrc09a7PA1R1iNuuYibZwfXmUB8Qq/qrZa9tZjs1i65fcRswHf5O1zuYgZ7yeG1jdq3SbM9gauFF8yimOBYABaN66dKlUwKVS0TVQT2+evVqgjcIYAWxXxQ12O/jcWUq0MlqvwtQsIeo8zOUWoQHOcCTNMbqQsqPcTARE5PCk/+a64woB6HPYf/JMzq57KgqW8AAaKa8Jn4fbfOlKe92wGeoMq13GFQqdwD95aDmZ5Q+Z9AJwwwoYL5Wn3vqHH2JCOU9pkMjg7jWMgH8GYtspVx8cIwW6QYDrV271rccgATGAkhgm8GTfPDggbd161YTWIUqdLGVnPt4lQKsQQebJTCVj7CNlO4YmAwFlCUaBAo0XVR/nK6T+RqTNh5g7GuwLrTyMxlMfY760r/eKI4J+hJSffA1rlm9o989DK5SLtOmnpOm+pCr6zNoojpJVK6HnxFbuKGiomI5u5hRQVVdXW0+0UjowGa97u6Jn5ewewExMIAN3mA0lepjX8nLgsYXMy2P8SAmWJM6zGoJhnkrr7BEBRwbJLYHJJ/zQ5gwZhx7IkMMkEFWfZF8BcxOFU9zAes33L9+yzERMKLP66nMM8V4HjNFpgPI0r9kft4AmwLjzE4wD0Z58S0OMCvk/RMDgB1zHGtZtIoIgopKe/TokRNYnZ2dzroAIsAFo93Vrq0OAxgLdPZ7TZBsLOtBAl2vZbvqE1VWT4JWM/YkDfJk4P4+GtxqR5l07otrYjMdk6Ydj24ebxjwO23CZ6A+YGegiJOn+vY3xcC9jncY5TwA7E92+zGEW/r5+CnbUjdijbXYbJXs8E6ck11aWmp2G+B7oC1Qc2AsP+AAVHqT3RR3Vd5nQ9dO93hw6ik95hX9H7jonF/PIQBjj7ARC9f5rhUTQrlWrt/L9e/y/XbOq1ce0ihfy0A85useZop6K2gJ8P8A0FACo/7De7tV5Qd4sgIa8QDp2IBoDTNOvU7Mlo1sQ44rwNSzwS3t19l14WWq/tb4qLW76rn3Yp2gSd8KCVjwWMqC1JP6nmei8Ddu3DBRdgmI4jshDHbkByVpQ5+rY9P3339fk5OT46m9RVMNLGLQf2cxdCGff62M3I8m1EcY73nqVg4nhBYe/FK+EwJH+E4cpAozgxoQlhEQwGNctWqVUW2rV6+OGOx++96jbcm193bJBrx3lBQV3NRu8o+xgCrWvervsoddWD8pKamQ40Py9QEM00htNrzrnvxY3yeW/kUTIRlbO7kYa4OlxyMsZG87loQ8Yhdv9+7dJkIPYGk28mOrFStWGOMeux+wdx0foq9fvx7Z3QDGgmeK9D63y8j74D2QpI+unZHTAZdsgJzKxE33vfQzowEuluC3q57eyx/EWBn2DQQ3MdDa9bd/xrV8+fLIpx8beH4/HigoKHgbKi4u9s6ePeuVl5cbYOkOIxwB0M30Bj+0DRDhy4LE7KSfszJ9SbAMd0+5vxEjG6EB+SWMRq3eepycnGwMdq0mfX7aNWHbsrAhovvXrl2bpCKRB2DDSZjuKpd2AVa0qX9EMSszK3GOmEWCjopLgBMJE4GEyZajVh8OA9zJXBpUOL98+bJ37Ngxr6WlRbPbuIABrILPS+8KAtRD/3t6ekzsTBbLLKg+HLC0GrxLkzCmAaWTDSptm0QDGf92cMKvdy5duuQdPXpU6+sB7TAAWFCzOI8VTCiLOoinIeaGNqbyO8JZmXlg3a2srPyJANQqQHIBTIPLBlYQc8GTxM5SAdHevXvNr3NgSylGe2Z7owAG2AZHcSbshHJgOJQDoCSeNgumj2hjMbAMqHBBE/IAv0imiU6AjSUGvN9Pv1z2lAtc2AiILTg4r6mpMfGP48ePew0NDdJGU21t7SuXaysAt3e26l85z7LSx5cJ4YbTp0/PJVBN2G6wb9++PJrAzdif5fpBhTaK/f70I1qygPeMrqvq6upi0nmuPyWZlY8XJPWNY7mEVJX5GyNK8yiFg34J7fM3RYEgIyCN09H8jVF1dfXs3xj9CoD1PwEGAKorJqR4atjIAAAAAElFTkSuQmCC",s)=>{let r,n=0,o=0;const a=[],h=t=>{const i=new Ut.Image;i.src=t,i.onload=()=>{a.forEach(t=>{var s;const r=new Tt({source:i,fitMode:e.ImageFitMode.Stretch});null===(s=t.xd)||void 0===s||s.qe(r),n=i.width,o=i.height,u(t)})}};h(i);const l=t=>{h(t.logoDataURI)};let c;if(t.Pa.addEventListener("logochange",l),new Ut.Image instanceof Ut.HTMLImageElement){const t=new Ut.Image;t.src=i,c=new Tt({source:t,fitMode:e.ImageFitMode.Stretch})}else if(Ut.lcjs_setup){const t=new Ut.Image;t.src=i;const s=Ut.lcjs_setup(t.naturalWidth,t.naturalHeight);s.getContext("2d").drawImage(t,0,0),c=new Tt({source:s,fitMode:e.ImageFitMode.Stretch})}else c=new fs({color:E("#f00")});const u=t=>{if(t.xd){const e=t.ai.Qt({x:t.ai.x.getInnerEnd(),y:t.ai.y.getInnerStart()},{x:-(3+n),y:3}),i=t.ai.Qt({x:t.ai.x.getInnerEnd(),y:t.ai.y.getInnerStart()},{x:-3,y:3+o}),s={x:i.x-e.x,y:i.y-e.y};t.xd.sr(e).Z(s)}r&&r.Bs()};return r=t.zP("logo",Number.MAX_SAFE_INTEGER),i=>{const n={ai:i};return(i=>{const n=s&&"cGx1Z2lu"in s&&"cHl0aG9u"===s.cGx1Z2lu?Mg:bg;if(i.xd&&i.xd.dispose(),r){let s;i.xd=r.tr(i.ai).qe(c).setPointerEvents(!0).Ke(Bt),i.xd.addEventListener("pointerenter",()=>{s=t.Rn(e.MouseStyles.Point)}),i.xd.addEventListener("pointerleave",()=>{s=t.On(s)}),i.xd.addEventListener("click",n),u(i)}})(n),a.push(n),{Nh:()=>u(n),G:()=>(e=>{e.xd&&(e.xd.dispose(),e.xd=void 0);const i=a.indexOf(e);i>=0&&a.splice(i,1),a.length<=0&&t.Pa.removeEventListener("logochange",l)})(n)}}},bg=()=>Ut.open("https://lightningchart.com/lightningchart-js/"),Mg=()=>Ut.open("https://lightningchart.com/python-charts/");class Eg{constructor(){this.FB=this.IB.bind(this),Ut.addEventListener("scroll",this.FB,{passive:!0})}G(){this.FB&&Ut.removeEventListener("scroll",this.FB),this.FB=void 0}}class kg{constructor(t,e){this.Cl=t,this.Y=e,this.LB=!0,this.PB=null,this.BB=null}}class Tg{constructor(t){this.DB=!1,this.EB=1,this.RB=t,this.OB={Cl:l(0,0),Y:l(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),LB:!0,PB:null,BB:null},this.zB=l(64,64),this.VB=new Uint8ClampedArray(this.zB.x*this.zB.y*this.EB)}NB(t,e){if(!t.LB)return null;if(t.PB&&t.BB){const i=this.NB(t.PB,e);return null!==i?i:this.NB(t.BB,e)}const i=c(t.Y.x,t.Y.y);if(t.Cl.x+t.Y.x>=Number.MAX_SAFE_INTEGER&&(i.x=this.zB.x-t.Cl.x-1),t.Cl.y+t.Y.y>=Number.MAX_SAFE_INTEGER&&(i.y=this.zB.y-t.Cl.y-1),t.Y.x===e.x&&t.Y.y===e.y)return t.LB=!1,t;if(i.x<e.x||i.y<e.y)return null;let s,r;const n=i.x-e.x,o=i.y-e.y;let a=n<o;return 0===n&&0===o&&(a=!(t.Y.x>t.Y.y)),a?(s=new kg(Li(t.Cl,{x:0,y:1}),l(t.Y.x,e.y)),r=new kg(Li(t.Cl,{x:0,y:e.y+1}),l(t.Y.x,t.Y.y-1-e.y))):(s=new kg(Li(t.Cl,{x:1,y:0}),l(e.x,t.Y.y)),r=new kg(Li(t.Cl,{x:e.x+1,y:0}),l(t.Y.x-1-e.x,t.Y.y))),t.PB=s,t.BB=r,this.NB(t.PB,e)}GB(t,e){const i={$B:!1,Cl:null};let s=this.NB(this.OB,e);if(null===s)for(;null===s&&this.zB.x<this.RB&&this.zB.y<this.RB;){if(!this.UB(l(2*this.zB.x,2*this.zB.y)))return this.DB=!0,null;i.$B=!0,s=this.NB(this.OB,e)}if(null===s)return this.DB=!0,null;for(let i=0;i<e.y;i+=1)for(let r=0;r<e.x;r+=1){const n=s.Cl.y+i,o=s.Cl.x+r;this.VB[n*this.EB*this.zB.x+o*this.EB+0]=t[i*this.EB*e.x+r*this.EB+0]}return i.Cl=s.Cl,i}UB(t){if(t.x>this.RB||t.y>this.RB)return!1;const e=new Uint8ClampedArray(t.x*t.y*this.EB);for(let i=0;i<this.zB.y;i+=1)for(let s=0;s<this.zB.x;s+=1)e[i*t.x*this.EB+s*this.EB+0]=this.VB[i*this.zB.x*this.EB+s*this.EB+0];return this.zB=t,this.VB=e,!0}}class wg{constructor(t){this.YB=new Map,this.RB=t,this.YB.set(this.YB.size,new Tg(this.RB))}jB(t){return this.YB.get(t)}GB(t,e){let i=-1;const s=Array.from(this.YB.values());for(let t=0;t<s.length;t+=1){const e=s[t];if(!e)break;if(!e.DB){i=t;break}}-1===i&&(i=this.YB.size,this.YB.set(this.YB.size,new Tg(this.RB)));const r=this.YB.get(i);if(!r)return null;let n=r.GB(t,e);if(!n&&r.DB){const s=this.YB.size,r=new Tg(this.RB);this.YB.set(s,r),i=s,n=r.GB(t,e)}return n?{HB:i,...n}:null}}var Cg;!function(t){t[t.Fail=0]="Fail",t[t.Success=1]="Success",t[t.Resize=2]="Resize"}(Cg||(Cg={}));const Bg=Le("font-texture");class Fg{constructor(t){this.WB=new Map,this.XB=new Map,this.xi=Bg(),this.ZB=t,this.JB=new wg(this.ZB.QB||4096)}_c(){return this.XB.forEach(t=>{this.ZB.KB(t)}),this.XB.clear(),this}qB(t,e){const i=this.WB.get(e);if(i)return i.get(t)}tD(t,e,i){let s=this.WB.get(e);if(s||(s=new Map,this.WB.set(e,s)),s.has(t.glyph))return Cg.Success;const r=this.JB.GB(i,t.size);if(!r||!r.Cl)return Cg.Fail;r.$B&&this.iD();const n=this.JB.jB(r.HB);if(!n)return Cg.Fail;let o=this.XB.get(r.HB);if(!o){const t=this.ZB.gl.createTexture();if(!t)throw new fg("Failed to create texture for font!");o=t,this.XB.set(r.HB,t)}const a=r.Cl,h=n.zB.x,l=n.zB.y,c=-t.offsetX,u=t.baseline-t.size.y,d=-t.offsetX+t.size.x,f=t.baseline,g=a.x/h,p=(a.y+t.size.y)/l,m=(a.x+t.size.x)/h,y=a.y/l,x=[g,p,m,p,g,y,g,y,m,p,m,y],v=[c,u,d,u,c,f,c,f,d,u,d,f],A={origin:a,size:t.size,advanceX:t.advance,baseline:t.baseline,vertices:v,texCoords:x,packerId:r.HB,texture:o};s.set(t.glyph,A);const S=this.ZB.gl;return S.pixelStorei(S.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),S.bindTexture(S.TEXTURE_2D,o),S.texImage2D(S.TEXTURE_2D,0,S.LUMINANCE,n.zB.x,n.zB.y,0,S.LUMINANCE,S.UNSIGNED_BYTE,this.ZB.sD?n.VB:new Uint8Array(n.VB)),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.bindTexture(S.TEXTURE_2D,null),r.$B?Cg.Resize:Cg.Success}iD(){this.WB.forEach(t=>{t.forEach((e,i)=>{const s=this.JB.jB(e.packerId);if(!s)return;const r=e.origin,n=s.zB.x,o=s.zB.y,a=r.x/n,h=(r.y+e.size.y)/o,l=(r.x+e.size.x)/n,c=r.y/o,u=[a,h,l,h,a,c,a,c,l,h,l,c];e.texCoords=u,t.set(i,e)})})}}const Dg=t=>(e,i)=>i%2?e:e+t;class Ig{constructor(t){this.eD=new Map,this.rD=Le("font"),this.hD=new Map,this.nD=new Set,this.ZB=t}_c(t=!1){return(t||0===this.nD.size)&&(this.eD.forEach((t,e)=>{t._c(),this.eD.delete(e)}),this.nD.clear()),this}Kc(t){this.nD.add(t)}oD(t){this.nD.delete(t)}aD(t,e,i,s){const r=Ut.devicePixelRatio,n=`${s?"dark":"light"} - ${ro(e,r).id}`,o=this.hD.get(n),a=this.eD.get(o);let h=0,l=0,c=0;const u=t.split(""),d=e.size,f=.45*e.size*r,g=Math.round(1*e.size*r);let p=!1;for(let t=0;t<u.length;t+=1){const e=u[t],i=a&&a.qB(e,d);if(i)""!==e.trim()&&(l=Math.max(l,i.baseline),h=Math.min(h,i.baseline-(i.size.y-1))),c+=i.advanceX;else{if(""!==e.trim()){const t=0;l=Math.max(l,t),h=Math.min(h,t-(g-1))}c+=f,p=!0}}const m=br(c/r,(l-h+1)/r,i);return{x:m.x,y:m.y,isEstimate:p}}lD(t,e,i){const s=`${i?"dark":"light"} - ${e.id}`;let r=this.hD.get(s);r||(r=this.rD(),this.eD.set(r,new Fg(this.ZB)),this.hD.set(s,r));const n=this.eD.get(r);if(!n)throw new fg("Failed to get font texture!");let o=0,a=0,h=0;const c=t.split(""),u=new Map;let d=0;const f=e.properties.size;for(let t=0;t<c.length;t+=1){const s=c[t],r=Math.ceil(d);let h=n.qB(s,f);if(!h){const r=this.ZB.uD(s,e.properties,e.dpr,i);if(!r)continue;const l=n.tD(r[1],f,r[0]);if(l===Cg.Resize){this.nD.forEach(t=>{t.ml.u=!0}),t=-1,d=0,a=0,o=0,u.clear(),this.ZB.pi.Bs(!0);continue}if(l===Cg.Fail)throw new fg("Failed to create glyph");if(h=n.qB(s,f),!h)throw new fg("Failed to get glyph after creation")}if(""!==s.trim()){let t=u.get(h.texture);t||(t={vertices:[],texCoords:[]},u.set(h.texture,t)),t.vertices.push(...h.vertices.map(Dg(r))),t.texCoords.push(...h.texCoords),a=Math.max(a,h.baseline),o=Math.min(o,h.baseline-(h.size.y-1))}d+=h.advanceX}h=d;const p=g(l(0,o),l(h,a)),m=[];return u.forEach((t,e)=>{m.push({texCoords:new Float32Array(t.texCoords),vertices:new Float32Array(t.vertices),texture:e})}),[m,p]}}const Rg={roundUnsigned:{cD:"roundUnsigned",dD:"float roundUnsigned(float number) {\n  return floor(number + 0.5);\n}"},linearStep:{cD:"linearStep",dD:"float linearStep(float step0, float step1, float step) {\n  return clamp((step - step0) / (step1 - step0), 0.0, 1.0);\n}"},dither:{cD:"dither",dD:"\nconst mat4x4 bayerMatrix4x4 = mat4x4(\n    0.0,  8.0,  2.0, 10.0,\n    12.0, 4.0,  14.0, 6.0,\n    3.0,  11.0, 1.0, 9.0,\n    15.0, 7.0,  13.0, 5.0\n) / 16.0;\n\nvec4 dither(vec2 pos, vec4 c0, vec4 c1, float s0, float s1, float mixVal)\n{\n    float step = linearStep(s0, s1, mixVal);\n    int x = int(pos.x) % 4;\n    int y = int(pos.y) % 4;\n    float threshold = bayerMatrix4x4[y][x];\n    vec4 color = mix(c0, c1, step * 0.95 + threshold * 0.05);\n    return color;\n}"},decodeUbyteRGBAEncodedFloat:{cD:"decodeUbyteRGBAEncodedFloat",dD:"\n      // Denormalize 8-bit color channels to integers in the range 0 to 255.\n      ivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n        ivec4 bytes = ivec4(inputFloats * 255.0);\n        return (\n          littleEndian\n          ? bytes.abgr\n          : bytes\n        );\n      }\n      \n      // Break the four bytes down into an array of 32 bits.\n      void bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n        for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n          float acc = float(bytes[channelIndex]);\n          for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n            float powerOfTwo = exp2(float(indexInByte));\n            bool bit = acc >= powerOfTwo;\n            bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n            acc = mod(acc, powerOfTwo);\n          }\n        }\n      }\n      \n      // Compute the exponent of the 32-bit float.\n      float getExponent(bool bits[32]) {\n        const int startIndex = 1;\n        const int bitStringLength = 8;\n        const int endBeforeIndex = startIndex + bitStringLength;\n        float acc = 0.0;\n        int pow2 = bitStringLength - 1;\n        for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n          acc += float(bits[bitIndex]) * exp2(float(pow2--));\n        }\n        return acc;\n      }\n      \n      // Compute the mantissa of the 32-bit float.\n      float getMantissa(bool bits[32], bool subnormal) {\n        const int startIndex = 9;\n        const int bitStringLength = 23;\n        const int endBeforeIndex = startIndex + bitStringLength;\n        // Leading/implicit/hidden bit convention:\n        // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n        float acc = float(!subnormal) * exp2(float(bitStringLength));\n        int pow2 = bitStringLength - 1;\n        for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n          acc += float(bits[bitIndex]) * exp2(float(pow2--));\n        }\n        return acc;\n      }\n      \n      // Parse the float from its 32 bits.\n      float bitsToFloat(bool bits[32]) {\n        float signBit = float(bits[0]) * -2.0 + 1.0;\n        float exponent = getExponent(bits);\n        bool subnormal = abs(exponent - 0.0) < 0.01;\n        float mantissa = getMantissa(bits, subnormal);\n        float exponentBias = 127.0;\n        return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n      }\n      \n      // Decode a 32-bit float from the RGBA color channels of a texel.\n      float decodeUbyteRGBAEncodedFloat(vec4 rgba, bool littleEndian) {\n        ivec4 rgbaBytes = floatsToBytes(rgba, littleEndian);\n        bool bits[32];\n        bytesToBits(rgbaBytes, bits);\n        return bitsToFloat(bits);\n      }\n      "},texelFetchWithFallback:{webgl2:{cD:"texelFetchWithFallback",dD:"vec4 texelFetchWithFallback(sampler2D textureSampler, ivec2 iTexel, vec2 textureSize) {\n  return texelFetch(textureSampler, iTexel, 0);\n}"},webgl1:{cD:"texelFetchWithFallback",dD:"vec4 texelFetchWithFallback(sampler2D textureSampler, ivec2 iTexel, vec2 textureSize) {\n  vec2 halfTexel = 0.5 / textureSize;\n  return texture2D(textureSampler, (vec2(iTexel) * 2.0 + 1.0) * halfTexel);\n}"}},texelFetchUnsignedWithFallback:{webgl2:{cD:"texelFetchUnsignedWithFallback",dD:"uvec4 texelFetchUnsignedWithFallback(usampler2D textureSampler, ivec2 iTexel, vec2 textureSize) {\n  return texelFetch(textureSampler, iTexel, 0);\n}"},webgl1:{cD:"texelFetchUnsignedWithFallback",dD:"uvec4 texelFetchUnsignedWithFallback(usampler2D textureSampler, ivec2 iTexel, vec2 textureSize) {\n  vec2 halfTexel = 0.5 / textureSize;\n  return texture2D(textureSampler, (vec2(iTexel) * 2.0 + 1.0) * halfTexel);\n}"}},modulus:{cD:"modulus",dD:"int modulus(int a, int b) {\n  return (a)-((a)/(b))*(b);\n}"},computeScreenSpaceWireframe:{cD:"computeScreenSpaceWireframe",dD:"#extension GL_OES_standard_derivatives : enable\nfloat computeScreenSpaceWireframe (vec3 barycentric, float lineWidth) {\n  vec3 dist = fwidth(barycentric);\n  vec3 smoothed = smoothstep(dist * ((lineWidth * 0.5) - 0.5), dist * ((lineWidth * 0.5) + 0.5), barycentric);\n  return 1.0 - min(min(smoothed.x, smoothed.y), smoothed.z);\n}"}},Lg="posAxis",Pg="posWorld",zg="normal",_g="colorFragment",Vg="antiAliasFactor",Ng="mousePickingIdOffset",Og="uRatioPxClip",Ug="uRatioNwuWu",Gg="uColorTexture",Yg="uSizePixels",Zg="uOffsetAlignment",Wg="uMaskTexture",jg="aNormal",Hg="Rot";class $g{constructor(t){this.modifiers=[],this.modifiers=t}build(t){const e=this.modifiers.filter(t=>Xg(t));for(const i of e)t=i(t);return`${Oe(this.modifiers.filter(t=>Kg(t))).map(t=>t.dD).join("\n")}\n${t}`}}const Xg=t=>"function"==typeof t,qg={cD:"ratioPxClip",dD:`uniform vec2 ${Og};`},Kg=t=>t&&"object"==typeof t&&"cD"in t,Jg=(...t)=>e=>{t=t.reverse();for(let i of t)"string"==typeof i&&(i=i.includes("{")||i.endsWith(";")?i:`${i};`,i=i.trim(),e=e.replace("void main(void)",`${i}\nvoid main(void)`));return e},Qg=t=>e=>(t=t.endsWith(";")?t:`${t};`,e.replace(t,"")),tp=(...t)=>e=>{const i=t.filter(t=>t);for(let t=0;t<i.length;t+=1)i[t]=i[t].endsWith(";")?i[t]:`${i[t]};`,i[t]=i[t].startsWith("\t")?i[t]:`\t${i[t]}`;const s=i.join("\n");return e.replace("void main(void) {\n",`void main(void) {\n${s}\n`)},ep=(t,...e)=>i=>{for(let t=0;t<e.length;t+=1)e[t]=e[t].endsWith(";")?e[t]:`${e[t]};`,e[t]=e[t].startsWith("\t")?e[t]:`\t${e[t]}`;const s=e.join("\n"),r=new RegExp(`(.*${t}.*)`),n=i.replace(r,`${s}\n$1`);return e.forEach(e=>{if(!n.includes(e))throw new Error(`ShaderBefore misusage (not found: \n${e}\nmatch: \n${t}\nresult: \n${n}\n)`)}),n},ip=(t,...e)=>i=>{const s=e.filter(t=>"string"==typeof t);for(let t=0;t<s.length;t+=1)s[t]=s[t].endsWith(";")?s[t]:`${s[t]};`,s[t]=s[t].startsWith("\t")?s[t]:`\t${s[t]}`;const r=s.join("\n"),n=i.lastIndexOf(t),o=i.substring(n),a=o.indexOf("\n"),h=o.substring(a),l=`${i.substring(0,n+a)}\n${r}${h}`;return s.forEach(e=>{if(!l.includes(e))throw new Error(`ShaderAfter misusage (not found: "${e}", match: "${t}", result: "${l}")`)}),l},sp=(...t)=>e=>{for(let i of t)if("string"==typeof i){i=i.endsWith(";")?i:`${i};`,i=i.trim(),i=i.startsWith("\t")?i:`\t${i}`;const t=e.lastIndexOf("}");e=`${e.substring(0,t-1)}\n${i}\n}`}return e},rp=(t,e)=>i=>{let s,r;if(t.includes("uniform")||t.includes("attribute")){const e=t.endsWith(";")?t:`${t};`;i=Jg(e)(i),s=t.split(" ")[2].replace(";","")}else s=t;if(e.includes(" ")){const t=e.endsWith(";")?e:`${e};`;i=Jg(t)(i),r=e.split(" ")[2].replace(";","")}else r=e;return sp(`\t${r} = ${s};`)(i)},np=(...t)=>e=>{t=t.reverse();for(const i of t)e=i+e;return e},op=(t,e)=>{const i=e.steps,s=i.length-1,r=[Jg("uniform vec4 uFallbackColor")],n=[],o=[];for(let t=0;t<e.steps.length;t+=1)n.push(`uniform float uLUTValue${t}`),o.push(`uniform vec4 uLUTColor${t}`);return r.push(Jg(...n,...o),e.percentageValues&&Jg("uniform float uMinValue","uniform float uMaxValue")),e.interpolate?r.push(ip(`${_g} =`,"vec4 colorLookup = uLUTColor0","float value = "+(e.percentageValues?`clamp((${t} - uMinValue) / (uMaxValue  - uMinValue), 0.0, 1.0);`:`${t}`),`if (value <= ${It}) {\n                    colorLookup = uFallbackColor;\n                }`,`if (value >= uLUTValue${s}) {\n                    colorLookup = uLUTColor${s};\n                }`,...i.slice(0,-1).map((t,e)=>`if (value >= uLUTValue${e} && value <= uLUTValue${e+1}) {\ncolorLookup = uLUTColor${e} + vec4(uLUTColor${e+1}.r -  uLUTColor${e}.r, uLUTColor${e+1}.g -  uLUTColor${e}.g, uLUTColor${e+1}.b -  uLUTColor${e}.b, uLUTColor${e+1}.a -  uLUTColor${e}.a) * (value - uLUTValue${e})/(uLUTValue${e+1} - uLUTValue${e});} `),`${_g} = colorLookup`)):r.push(ip(`${_g} =`,"vec4 colorLookup = vec4(uLUTValue0)","float value = "+(e.percentageValues?`clamp((${t} - uMinValue) / (uMaxValue  - uMinValue), 0.0, 1.0);`:`${t}`),`if (${t} <= ${It}) {\n                    colorLookup = uFallbackColor;\n                } else if (${t} < uLUTValue0) { colorLookup = uLUTColor0;} ${i.slice().reverse().map(t=>{const e=i.indexOf(t);return`else if (value >= uLUTValue${e}) { colorLookup = uLUTColor${e};} `}).join("")}`,`${_g} = colorLookup`)),r},ap=[Jg(`uniform sampler2D ${Wg}`),Jg("varying vec2 vMaskTextureCoord"),ip(`${Vg} =`,`vec4 maskTextureSample = texture2D(${Wg}, vMaskTextureCoord)`,`${Vg} = maskTextureSample.r`)],hp=[Jg(`uniform sampler2D ${Wg}`),Jg("varying vec2 vMaskTextureCoord"),ip(`${Vg} =`,`vec4 maskTextureSample = texture2D(${Wg}, vMaskTextureCoord)`,`${Vg} = maskTextureSample.a`)],lp=[Jg("varying vec3 vPosWorld;","varying vec3 vNormal;","uniform vec3 uCameraLoc;","uniform vec3 uLightLoc;","uniform vec4 uLightColor;","uniform vec4 uAmbientColor;","uniform float uShininess;","uniform float uAmbientReflection;","uniform float uDiffuseReflection;","uniform float uSpecularReflection;"),ip(`${_g} =`,"float ambientReflection = uAmbientReflection","float diffuseReflection = uDiffuseReflection","float specularReflection = uSpecularReflection","vec3 ambientColor = uAmbientColor.rgb",`vec3 diffuseColor = ${_g}.rgb`,"vec3 specularColor = uLightColor.rgb","vec3 vNormalNormalized = normalize(vNormal)","vNormalNormalized = (float(gl_FrontFacing) * 2.0 - 1.0) * vNormalNormalized","vec3 lightDir = normalize( uLightLoc - vPosWorld )","float lambertian = abs(dot(vNormalNormalized, lightDir))","float specular = 0.0","vec3 R =  reflect(-lightDir, vNormalNormalized)","vec3 V = normalize(uCameraLoc - vPosWorld)","float specAngle = max(dot(R,V),0.0)","specular = pow(specAngle, uShininess)",`${_g} = vec4(ambientReflection * ambientColor + diffuseReflection * lambertian * diffuseColor + specularReflection * specular * specularColor, ${_g}.a)`)],cp=(t,...e)=>{var i,s;if("linear-highPrecision"!==t||0===e.length)return{vertexShaderModifiers:[],fragmentShaderModifiers:[]};const r=e[0];return{vertexShaderModifiers:[Jg("varying vec4 d"),sp(`d = vec4(${e[0]}.x, ${e[0]}.y, ${null!==(i=e[1])&&void 0!==i?i:r}.x, ${null!==(s=e[1])&&void 0!==s?s:r}.y)`)],idFragment:"hpfix",fragmentShaderModifiers:[Jg("varying vec4 d"),sp("if (d.z == -100.0 + d.z / 10.0) { gl_FragColor = d; }")]}};class up extends Error{constructor(t,e,i){super(`Dynamic shader generation error\n(id: ${e})\n ${i?`when applying feature: ${i.idVertex?`vert: ${i.idVertex}`:""} ${i.idFragment?`frag: ${i.idFragment}`:""}`:""} | ${t}`)}}const dp=(...t)=>{let e="";for(const i of t){if("object"!=typeof i){e+=`${String(i)},`;continue}const t=[{prefix:"",obj:i}];for(;t.length>0;){const{prefix:i,obj:s}=t.shift();e+=`${i}:`;const r=Object.keys(s).sort();for(const i of r){const r=s[i];"object"==typeof r&&r.__proto__===Object.prototype||Array.isArray(r)?t.push({prefix:i,obj:r}):e+=`${i}=${String(r)},`}}}return e},fp=t=>void 0!==t.find(t=>{var e;return null===(e=t.fD)||void 0===e?void 0:e.AD}),gp=t=>void 0!==t.find(t=>{var e;return null===(e=t.fD)||void 0===e?void 0:e.gD}),pp=(t,e,...i)=>{const s=[],r=e?"vec3":"vec2",{axisWorldTranslation:n,scaling:o,translation:a,flipXY:h,flipXZ:l,offsets:c,splitPosAttribute:u,normalSource:d}=t,f=[];"attribute"===d&&s.push(Jg(`attribute vec3 ${jg}`),tp(`vec3 ${zg} = ${jg}`)),"linear-highPrecision"!==n?i.forEach(t=>{void 0!==t.attributeNameAxisCoord&&void 0!==t.variableNameAxisCoord&&(!0!==u?f.push(`${r} ${t.variableNameAxisCoord} = ${t.attributeNameAxisCoord}`):f.push(`${r} ${t.variableNameAxisCoord} = ${e?`vec3(${t.attributeNameAxisCoord}X, ${t.attributeNameAxisCoord}Y, ${t.attributeNameAxisCoord}Z)`:`vec2(${t.attributeNameAxisCoord}X, ${t.attributeNameAxisCoord}Y)`}`))}):i.forEach(e=>{!0!==t.splitPosAttribute?f.push(`${r} ${e.variableNameAxisCoord}_highpart = ${e.attributeNameAxisCoord}_highpart`,`${r} ${e.variableNameAxisCoord}_lowpart = ${e.attributeNameAxisCoord}_lowpart`):f.push(`${r} ${e.variableNameAxisCoord}_highpart = vec2(${e.attributeNameAxisCoord}_highpartX, ${e.attributeNameAxisCoord}_highpartY)`,`${r} ${e.variableNameAxisCoord}_lowpart = vec2(${e.attributeNameAxisCoord}_lowpartX, ${e.attributeNameAxisCoord}_lowpartY)`)});const g=(t=>{if(t)for(const i of t){const t=(null==(e=i)?void 0:e.rotation)&&e.rotation.dataType;if(void 0!==t&&!1!==t)return t}var e})(c);if("attribute-deg"===g&&s.push(Jg("attribute float aRotDeg"),Jg("uniform float uBaseRotDeg")),"attribute"===g&&s.push(Jg("attribute vec2 aRot")),"uniform"===g&&s.push(Jg("uniform vec2 uRot")),null==c||c.forEach(t=>{if(t&&t.rotation){const e=t.rotation.dataType,i="uniform"===e?"u":"a";if("attribute-deg"===e){const e=t.directionVar,i=`c${Hg}`;s.push(tp(`vec2 ${t.directionVar}Rot = vec2(${e}.x * ${i}.y + ${e}.y * ${i}.x, ${e}.y * ${i}.y - ${e}.x * ${i}.x)`))}else{const e=`${i}${Hg}`,r=t.directionVar;s.push(tp(`vec2 ${t.directionVar}Rot = vec2(${r}.x * ${e}.y + ${r}.y * ${e}.x, ${r}.y * ${e}.y - ${r}.x * ${e}.x)`))}}}),null==c?void 0:c.find(t=>(null==t?void 0:t.rotation)&&"attribute-deg"===t.rotation.dataType)){const t=`c${Hg}`;s.push(tp(`vec2 ${t} = vec2(sin((aRotDeg + uBaseRotDeg) * 0.01745329252), cos((aRotDeg + uBaseRotDeg) * 0.01745329252))`))}if(c&&c.forEach(t=>{t&&!0!==t.skipAddDefinition&&s.push(Jg(`attribute ${r} ${t.directionVar}`))}),!0===h){if("linear-highPrecision"===n)throw new Error("Unimplemented vertex location feature combination: linear-highPrecision + flipXY");i.forEach(t=>{f.push(`${t.variableNameAxisCoord} = ${e?`vec3(${t.variableNameAxisCoord}.y, ${t.variableNameAxisCoord}.x, ${t.variableNameAxisCoord}.z)`:`vec2(${t.variableNameAxisCoord}.y, ${t.variableNameAxisCoord}.x)`}`)})}if(!0===l){if("linear-highPrecision"===n)throw new Error("Unimplemented vertex location feature combination: linear-highPrecision + flipXZ");i.forEach(t=>{f.push(`${t.variableNameAxisCoord} = vec3(${t.variableNameAxisCoord}.z, ${t.variableNameAxisCoord}.y, ${t.variableNameAxisCoord}.x)`)})}if(o){if("linear-highPrecision"===n)throw new Error("Unimplemented vertex location feature combination: linear-highPrecision + scaling");const t=("attribute"===o.dataType?"a":"u")+"Scaling",r=e?"vec3":"vec2";s.push(Jg(`${o.dataType} ${r} ${t}`)),i.forEach(e=>{f.push(`${e.variableNameAxisCoord} = ${e.variableNameAxisCoord} * ${t}`)})}if(a&&"axis"===a.sizeUnit){if("linear-highPrecision"===n)throw new Error("Unimplemented vertex location feature combination: linear-highPrecision + translation (axis)");const t=("attribute"===a.dataType?"a":"u")+"TranslationAxis",r=e?"vec3":"vec2";s.push(Jg(`${a.dataType} ${r} ${t}`)),i.forEach(e=>{f.push(`${e.variableNameAxisCoord} = ${e.variableNameAxisCoord} + ${t}`)})}if(null==c||c.forEach(t=>{if(t&&"axis"===t.sizeUnit){if("linear-highPrecision"===n)throw new Error("Unimplemented vertex location feature combination: linear-highPrecision + offset (axis)");const o=("attribute"===t.dataType?"a":"u")+"OffsetAxis",a=!0===t.symmetric?"float":r;s.push(Jg(`${t.dataType} ${a} ${o}`));const h=t.halved?" * 0.5":"",l=t.rotation?`${t.directionVar}Rot`:t.directionVar,c="offsetGeometry";f.push(`${r} ${c} = ${o} * ${l}${h} * sign(uScale)`),e&&"gpu-calculate"===d&&f.push(`${r} ${zg} = ${l}`),i.forEach(t=>{f.push(`${t.variableNameAxisCoord} = ${t.variableNameAxisCoord} + ${c}`)})}}),void 0===n||"linear"===n)s.push(Jg(`uniform ${r} uDisp`,`uniform ${r} uScale`)),i.forEach(t=>{f.push(`${r} ${t.variableNameWorldCoord} = (${t.variableNameAxisCoord} - uDisp) / uScale`)});else if("linear-highPrecision"===n)s.push(Jg(`uniform ${r} uDisp`,`uniform ${r} uScale`,`uniform ${r} uScaleStart_highpart`,`uniform ${r} uScaleStart_lowpart`)),i.forEach(t=>{f.push(`${r} ${t.variableNameAxisCoord}_hprecision = (${t.variableNameAxisCoord}_highpart - uScaleStart_highpart) + (${t.variableNameAxisCoord}_lowpart - uScaleStart_lowpart)`,`${r} ${t.variableNameWorldCoord} = (${t.variableNameAxisCoord}_hprecision - uDisp) / uScale`,`${r} ${t.variableNameAxisCoord} = ${t.variableNameAxisCoord}_highpart + ${t.variableNameAxisCoord}_lowpart`)});else if("matrix"===n)s.push(Jg("uniform mat3 uMatrix")),i.forEach(t=>{f.push(`vec2 ${t.variableNameWorldCoord} = (uMatrix * vec3(${t.variableNameAxisCoord}, 1.0)).xy`)});else if("matrix4"===n)s.push(Jg("uniform mat4 uMatrix")),i.forEach(t=>{f.push(`vec4 ${t.variableNameWorldCoord} = uMatrix * ${t.attributeNameAxisCoord}`)});else if("logarithmic"===n[0]){s.push(Jg(`uniform ${r} uScaleStart`,`uniform ${r} uScaleStartLog`,`uniform ${r} uScaleInterval`,`uniform ${r} uScaleIntervalLog`,`uniform ${r} uViewportStart`,`uniform ${r} uViewportSize`));const t=e?["x","y","z"]:["x","y"],o=[];t.forEach(t=>{const e=n[1][t];if(void 0!==e){const t=e.base;if("e"===t)return;const i=`float cLog${t} = 1.0 / log(${$i(t).toFixed(1)})`;o.includes(i)||o.push(i)}}),s.push(Jg(...o)),i.forEach((e,i)=>{const s=`${i}`,o=[];t.forEach(t=>{const i=t.toUpperCase(),r=n[1][t];if(void 0===r)f.push(`float posPercent${i}${s} = (${e.variableNameAxisCoord}.${t} - uScaleStart.${t}) / uScaleInterval.${t}`);else{const n=r.base,o="e"===n;f.push(`float posLog${i}${s} = log(${e.variableNameAxisCoord}.${t})${o?"":` * cLog${n}`}`,`float posPercent${i}${s} = (posLog${i}${s} - uScaleStartLog.${t}) / uScaleIntervalLog.${t}`)}o.push(`posPercent${i}${s}`)}),f.push(`${r} ${e.variableNameWorldCoord} = uViewportStart + ${r}(${o.join(", ")}) * uViewportSize`)})}return null==c||c.forEach(t=>{if(t&&"px"===t.sizeUnit){s.push(qg);let e="vec2(0.0, 0.0)";if(t.useAlignment&&(s.push(Jg(`uniform vec2 ${Zg}`)),e=Zg),i.find(t=>t.overrideOffsetPixels))i.forEach(t=>{f.push(`${t.variableNameWorldCoord} = ${t.variableNameWorldCoord} + ${t.overrideOffsetPixels} * ${Og}`)});else{const n=`${t.directionVar}Amount`,o=!0===t.symmetric?"float":r;s.push(Jg(`${t.dataType} ${o} ${n}`));const a=t.halved?" * 0.5":"";let h;if(!1!==t.useGeometry){const i=t.rotation?`${t.directionVar}Rot`:t.directionVar;h=`(${i} + ${e}) * ${n}${a} * ${Og}`}else h=`${n}${a} * ${Og}`;i.forEach(t=>{f.push(`${t.variableNameWorldCoord} = ${t.variableNameWorldCoord} + ${h}`)})}}if(t&&"scale"===t.sizeUnit){s.push(qg),s.push(Jg(`uniform vec2 ${Yg}`));let e="vec2(0.0, 0.0)";t.useAlignment&&(s.push(Jg(`uniform vec2 ${Zg}`)),e=Zg);const r=("uniform"===t.dataType?"u":"a")+"OffsetScale";s.push(Jg(`${t.dataType} float ${r}`));const n=`(${t.rotation?`${t.directionVar}Rot`:t.directionVar} + ${e}) * ${r} * ${Yg} * ${Og}`;i.forEach(t=>{f.push(`${t.variableNameWorldCoord} = ${t.variableNameWorldCoord} + ${n}`)})}if(t&&"wu"===t.sizeUnit){const n=("attribute"===t.dataType?"a":"u")+"OffsetWU",o=!0===t.symmetric?"float":r;s.push(Jg(`${t.dataType} ${o} ${n}`));const a=t.halved?" * 0.5":"",h=t.rotation?`${t.directionVar}Rot`:t.directionVar,l="offsetGeometry";f.push(`${r} ${l} = ${n} * ${h}${a}`),e&&"gpu-calculate"===d&&f.push(`${r} ${zg} = normalize(${l})`),i.forEach(t=>{f.push(`${t.variableNameWorldCoord} = ${t.variableNameWorldCoord} + ${l}`)})}if(t&&"nwu"===t.sizeUnit){s.push(Jg(`uniform float ${Ug}`));const n=("attribute"===t.dataType?"a":"u")+"OffsetNWU",o=!0===t.symmetric?"float":r;s.push(Jg(`${t.dataType} ${o} ${n}`));const a=t.halved?" * 0.5":"",h=t.rotation?`${t.directionVar}Rot`:t.directionVar,l="offsetGeometry";f.push(`${r} ${l} = ${n} * ${h}${a}`),e&&"gpu-calculate"===d&&f.push(`${r} ${zg} = normalize(${l})`),i.forEach(t=>{f.push(`${t.variableNameWorldCoord} = ${t.variableNameWorldCoord} + ${l} * ${Ug}`)})}}),t.snapToNearestPixel&&(s.push(Jg("uniform vec2 uViewportSizePx")),i.forEach(t=>{f.push(`${t.variableNameWorldCoord} = 2.0 * floor(((${t.variableNameWorldCoord} + 1.0) * 0.5) * uViewportSizePx + 0.5) / uViewportSizePx - 1.0`)})),s.push(ep("gl_Position =",...f)),s},mp=(t,e,i,s)=>{const r=[],n=t.axisWorldTranslation,o=e?"vec3":"vec2";if("linear"===n)r.push(ip(i,`${o} ${s} = ${i} * uScale + uDisp`));else if("linear-highPrecision"===n)r.push(ip(i,`${o} ${s} = ${i} * uScale + uDisp + uScaleStart_highpart + uScaleStart_lowpart`));else{if("matrix"===n)throw new Error("transformWorldCoordBackToAxis | unimplemented vertex location type");if("matrix4"===n)throw new Error("transformWorldCoordBackToAxis | unimplemented vertex location type");if("logarithmic"!==n[0])throw new Error("transformWorldCoordBackToAxis | unimplemented vertex location type");{const t=[`${o} ${i}_percent = (${i} - uViewportStart) / uViewportSize`];(e?["x","y","z"]:["x","y"]).forEach(e=>{const s=e.toUpperCase(),r=n[1][e];if(void 0===r)t.push(`float pos${s}Back = ${i}_percent.${e} * uScaleInterval.${e} + uScaleStart.${e}`);else{const n=r.base,o="e"===n?"1.0":`cLog${n}`;t.push(`float pos${s}Back = pow(2.71828, (${i}_percent.${e} * uScaleIntervalLog.${e} + uScaleStartLog.${e}) / ${o})`)}}),t.push(`${o} ${s} = ${o}(posXBack, posYBack${e?", posZBack":""})`),r.push(ip(i,...t))}}return r},yp=t=>(t=>void 0!==t.find(t=>{var e;return null===(e=t.fD)||void 0===e?void 0:e.pD}))(t)?[Qg("attribute vec4 aColor"),Qg("vColor = aColor"),Jg("attribute vec4 aColorA"),Jg("attribute vec4 aColorB"),sp("vColor = mix(aColorA, aColorB, aSegmentSide)")]:[],xp=t=>(t=>void 0!==t.find(t=>{var e;return null===(e=t.fD)||void 0===e?void 0:e.vD}))(t)?[Qg("attribute float aLookupValue"),Qg("vLookupValue = aLookupValue"),Jg("attribute float aLookupValueA"),Jg("attribute float aLookupValueB"),sp("vLookupValue = mix(aLookupValueA, aLookupValueB, aSegmentSide)")]:[],vp={"2D":{idFeature:"2D",apply:t=>({idVertex:"2D",idFragment:"2D",defaultVertexShader:"2D",defaultFragmentShader:"FragmentShader"})},"2DCompose":{idFeature:"2DCompose",apply:t=>({idVertex:"2DCompose",idFragment:"2DCompose",defaultVertexShader:"2DMatrix",defaultFragmentShader:"Empty"})},"3D":{idFeature:"3D",fD:{AD:!0},apply:t=>({idVertex:"3D",idFragment:"3D",defaultVertexShader:"3D",defaultFragmentShader:"FragmentShader"})},PointSize:t=>({idFeature:"PointSize",apply:e=>{const i="uniform"===t?"u":"a";return{idVertex:`SizePrimitive:${dp(t)}`,idFragment:void 0,vertexShaderModifiers:[Jg(`${t} float ${i}PointSize`,"uniform float uDevicePixelRatio"),sp(`gl_PointSize = ${i}PointSize * uDevicePixelRatio`)]}}}),Color:t=>{const i=t&&t.dataType,s=t&&t.maskTextureText,r=t&&t.maskTexture,n=t&&t.overrideOpacity;return{idFeature:"Color",fD:{gD:!(!Array.isArray(t.dataType)||"value"===t.dataType[1])||void 0,vD:!(!Array.isArray(t.dataType)||"value"!==t.dataType[1])||void 0,pD:"attribute"===t.dataType||void 0},apply:(o,a)=>{let h,l=`Color:${dp(t)}`;const c=[];let u="FragmentShader";const d=[];if("uniform"===i)d.push(Jg("uniform vec4 uColor"),ip(`${_g} =`,`${_g} = uColor`),...s?ap:[],...r?hp:[]);else if("attribute"===i)h="colorAttribute",c.push(rp("attribute vec4 aColor","varying vec4 vColor")),d.push(Jg("varying vec4 vColor"),ip(`${_g} =`,`${_g} = vColor`),...s?ap:[],...r?hp:[]);else if("texture"===i)h="colorTexCoord",c.push(rp("attribute vec2 aTextureCoord","varying vec2 vTextureCoord")),d.push(Jg("varying vec2 vTextureCoord"),Jg(`uniform sampler2D ${Gg}`),Jg("uniform vec4 uColor"),ip(`${_g} =`,`${_g} = texture2D(${Gg}, vTextureCoord)`,`if(vTextureCoord.x < 0. || vTextureCoord.x > 1. || vTextureCoord.y < 0. || vTextureCoord.y > 1.) {\n                        ${_g} = uColor;\n                    }`),...s?ap:[],...r?hp:[]);else if("texture-coord-calc-gpu"===i)h="colorTexCoord",u="Empty",c.push(Jg("attribute vec2 aTextureCoord"),Jg("varying vec2 vTextureCoord"),sp("vTextureCoord = gl_Position.xy * 0.5 + 0.5")),d.push(Jg("varying vec2 vTextureCoord"),Jg(`uniform sampler2D ${Gg}`),tp(`vec4 ${_g} = texture2D(${Gg}, vTextureCoord)`,`gl_FragColor = ${_g};`));else if(Array.isArray(i)&&"image"===i[0])h="colorTexCoord",c.push(rp("attribute vec2 aTextureCoord","varying vec2 vTextureCoord")),i[1].fitMode===e.ImageFitMode.Tile?d.push(Jg(`uniform sampler2D ${Gg}`),Jg("varying vec2 vTextureCoord"),ip(`${_g} =`,`${_g} = texture2D(${Gg}, vTextureCoord);`)):d.push(Jg(`uniform sampler2D ${Gg}`),Jg("varying vec2 vTextureCoord"),Jg("uniform vec4 uColor"),ip(`${_g} =`,`${_g} = texture2D(${Gg}, vTextureCoord);`,`if(vTextureCoord.x < 0. || vTextureCoord.x > 1. || vTextureCoord.y < 0. || vTextureCoord.y > 1.){\n                                ${_g} = uColor;\n                            }`));else if(Array.isArray(i)&&"lookup"===i[0]){const t=i[1];if("value"===t)h="lookup:value",c.push(rp("attribute float aLookupValue","varying float vLookupValue"));else{const e=`${Lg}.${t}`;h=`lookup:${t}`,c.push(rp(e,"varying float vLookupValue"))}d.push(Jg("varying float vLookupValue"),...op("vLookupValue",i[2]),...s?ap:[],...r?hp:[])}else if(Array.isArray(i)&&"gradient"===i[0]){const t=i[1],e=t.getColorStops();if(N(t)){const i="webgl2"===a&&!!((f=t)&&"object"==typeof f&&"type"in f&&"fillstyle"===f.type&&"fillType"in f&&"radial-gradient"===f.fillType&&!0===f.ditheringEnabled);l=`rgradient${e.length},${r},${s},${i}`,d.push(Jg("uniform vec4 uBounds","uniform vec2 uCenter","uniform vec2 uDistance","uniform float uAspect"),Jg(...Xt(e.map((t,e)=>[`uniform vec4 color_${e}`,`uniform float stop_${e}`]))),Rg.linearStep,i?Rg.dither:void 0,ip(`${_g} =`,"vec2 uv = vec2((((gl_FragCoord.x)-uBounds.x)/(uBounds.z))*uAspect,((gl_FragCoord.y)-uBounds.y)/(uBounds.w))","float mixVal = distance(uv/uDistance, uCenter/uDistance)",i?"vec4 color = dither(gl_FragCoord.xy, color_0, color_1, stop_0, stop_1, mixVal)":"vec4 color = mix(color_0, color_1, linearStep(stop_0, stop_1, mixVal))",...e.map((t,e)=>e<2?"":i?`color = dither(gl_FragCoord.xy, color, color_${e}, stop_${e-1}, stop_${e}, mixVal);`:`color = mix(color, color_${e}, linearStep(stop_${e-1}, stop_${e}, mixVal));`),`${_g} = color`),...s?ap:[],...r?hp:[])}else G(t)&&(l=`lgradient${e.length},${r},${s}`,d.push(Jg("uniform vec4 uBounds","uniform vec2 uStartPoint","uniform vec2 uEndPoint"),Jg(...Xt(e.map((t,e)=>[`uniform vec4 color_${e}`,`uniform float stop_${e}`]))),Rg.linearStep,ip(`${_g} =`,"vec2 uv = gl_FragCoord.xy - uBounds.xy","float magnitude = ((uv.x-uStartPoint.x) * (uEndPoint.x-uStartPoint.x) + (uv.y-uStartPoint.y) * (uEndPoint.y-uStartPoint.y)) / (pow(uEndPoint.x - uStartPoint.x, 2.0) + pow(uEndPoint.y-uStartPoint.y,2.0))","vec4 color = mix(color_0, color_1, linearStep(stop_0, stop_1, magnitude))",...e.map((t,e)=>e<2?"":`color = mix(color, color_${e}, linearStep(stop_${e-1}, stop_${e}, magnitude))`),`${_g} = color`),...s?ap:[],...r?hp:[]))}var f;if(s||r){const t="maskTexture";h=h?`${h} ${t}`:`Color:${t}`,c.push(rp("attribute vec2 aMaskTextureCoord","varying vec2 vMaskTextureCoord"))}return n&&d.push(Jg("uniform float uOpacity"),ip(`${_g} =`,`${_g}.a *= uOpacity`)),{vertexShaderModifiers:c,fragmentShader:u,fragmentShaderModifiers:d,idVertex:h,idFragment:l}}}},ColorShaded3D:t=>{const{dataType:e,shadingStyle:i,wireframe:s}=t;let r=i;const n=`ColorShaded3D:${dp(t)}`;return{idFeature:"ColorShaded3D",fD:{gD:!(!Array.isArray(t.dataType)||"value"===t.dataType[1])||void 0,vD:!(!Array.isArray(t.dataType)||"value"!==t.dataType[1])||void 0},apply:(t,o)=>{const a=[],h=[];if(a.push("phong"===i&&rp(zg,"varying vec3 vNormal"),rp(Pg,"varying vec3 vPosWorld")),"uniform"===e)h.push(Jg("uniform vec4 uColorDiffuse"),ip(`${_g} =`,`${_g} = uColorDiffuse`));else if("attribute"===e)r+=",per-vertex-color",a.push(rp("attribute vec4 aColor","varying vec4 vColor")),h.push(Jg("varying vec4 vColor"),ip(`${_g} =`,`${_g} = vColor`));else if(Array.isArray(e)){const t=e[1];if("value"===t)r+=",lookup:value",a.push(rp("attribute float aLookupValue","varying float vLookupValue"));else{const e=`${Lg}.${t}`;r+=`,lookup:${t}`,a.push(rp(e,"varying float vLookupValue"))}h.push(Jg("varying float vLookupValue"),...op("vLookupValue",e[2]))}return s&&(r+=",wireframe",a.push(rp("attribute vec3 aTriangleBary","varying vec3 vTriangleBary")),h.push(Jg("varying vec3 vTriangleBary"),Jg("uniform vec4 uWireframeColor","uniform float uWireframeThickness"),Rg.computeScreenSpaceWireframe,ip(`${_g} =`,"float edge = computeScreenSpaceWireframe(vTriangleBary, uWireframeThickness)",`${_g} = mix(${_g}, uWireframeColor, edge)`))),"phong"===i&&h.push(...lp),{idVertex:r,idFragment:n,vertexShaderModifiers:a,fragmentShader:"FragmentShader",fragmentShaderModifiers:h}}}},VertexLocation:t=>({idFeature:"VertexLocation",apply:e=>{const i=cp(t.axisWorldTranslation,"posAxis_hprecision"),s=[],r=fp(e),n=t.coordType?t.coordType:r?"vec3":"vec2";return t.isInstanceRectangleRendering?s.push(Jg("attribute vec2 aRectCorner","attribute vec2 aMemberStart","attribute vec2 aMemberEnd"),tp("vec2 aPos = mix(aMemberStart, aMemberEnd, aRectCorner)")):"linear-highPrecision"!==t.axisWorldTranslation?!0!==t.splitPosAttribute?s.push(Jg(`attribute ${n} aPos`)):s.push(Jg("attribute float aPosX"),Jg("attribute float aPosY"),r&&Jg("attribute float aPosZ")):!0===t.splitPosAttribute?s.push(Jg("attribute float aPos_highpartX"),Jg("attribute float aPos_lowpartX"),Jg("attribute float aPos_highpartY"),Jg("attribute float aPos_lowpartY")):s.push(Jg(`attribute ${n} aPos_highpart`),Jg(`attribute ${n} aPos_lowpart`)),s.push(...pp(t,r,{attributeNameAxisCoord:"aPos",variableNameAxisCoord:"vec4"===t.coordType?void 0:Lg,variableNameWorldCoord:Pg})),s.push(...i.vertexShaderModifiers),{idVertex:`VertexLocation:${dp(t)}`,idFragment:i.idFragment,vertexShaderModifiers:s,fragmentShaderModifiers:i.fragmentShaderModifiers}}}),Model3D:t=>({idFeature:"Model3D",apply:e=>{const i=[];return i.push(Jg("attribute vec3 aGeoPos"),Jg("uniform mat4 uModelRotation"),Jg("uniform mat4 uModelRotationNormals"),Jg("uniform vec3 uLocationAxis"),Jg("uniform vec3 uModelAlignment"),Jg("uniform vec3 uModelScale"),Jg("uniform vec3 uModelSize"),...pp({axisWorldTranslation:"linear",normalSource:t.normalSource},!0,{attributeNameAxisCoord:"uLocationAxis",variableNameAxisCoord:"locationAxis",variableNameWorldCoord:"locationWorld"}),ep("gl_Position =","vec3 posWorld = locationWorld + ((uModelRotation * vec4(aGeoPos, 1.0)).xyz  - (uModelAlignment + 1.0) * uModelSize/2.0) * uModelScale;"),"attribute"===t.normalSource&&ip(`vec3 ${zg} =`,` ${zg} = (uModelRotationNormals * vec4(${zg}, 1.0)).xyz;`),...gp(e)?mp({axisWorldTranslation:"linear",normalSource:t.normalSource},!0,Pg,Lg):[]),{vertexShaderModifiers:i,idVertex:`Model3D:${dp(t)}`,idFragment:void 0}}}),LineInstanced2D:t=>{const e=cp(t.axisWorldTranslation,"locationA_hprecision","locationB_hprecision"),i=t.offsets&&t.offsets[0];return{idFeature:"LineInstanced2D",apply:s=>({idVertex:`LineInstanced2D:${dp(t)}`,idFragment:e.idFragment,vertexShaderModifiers:[Jg("uniform float uThicknessPixels"),qg,..."linear-highPrecision"!==t.axisWorldTranslation&&!0!==t.splitPosAttribute?[Jg("attribute vec2 aLocationA"),Jg("attribute vec2 aLocationB")]:"linear-highPrecision"===t.axisWorldTranslation&&!0!==t.splitPosAttribute?[Jg("attribute vec2 aLocationA_highpart"),Jg("attribute vec2 aLocationB_highpart"),Jg("attribute vec2 aLocationA_lowpart"),Jg("attribute vec2 aLocationB_lowpart")]:"linear-highPrecision"!==t.axisWorldTranslation&&!0===t.splitPosAttribute?[Jg("attribute float aLocationAX"),Jg("attribute float aLocationAY"),Jg("attribute float aLocationBX"),Jg("attribute float aLocationBY")]:"linear-highPrecision"===t.axisWorldTranslation&&!0===t.splitPosAttribute?[Jg("attribute float aLocationA_highpartX"),Jg("attribute float aLocationA_highpartY"),Jg("attribute float aLocationB_highpartX"),Jg("attribute float aLocationB_highpartY"),Jg("attribute float aLocationA_lowpartX"),Jg("attribute float aLocationA_lowpartY"),Jg("attribute float aLocationB_lowpartX"),Jg("attribute float aLocationB_lowpartY")]:[],Jg("attribute vec2 aSegmentPosition"),Jg("attribute float aSegmentSide"),i&&Jg(`attribute vec2 ${i.directionVar}A`,`attribute vec2 ${i.directionVar}B`),...pp({...t,offsets:i?[{...i,skipAddDefinition:!0}]:[]},!1,{attributeNameAxisCoord:"aLocationA",variableNameAxisCoord:"locationA",variableNameWorldCoord:"worldA",overrideOffsetPixels:i?`${i.directionVar}A`:void 0},{attributeNameAxisCoord:"aLocationB",variableNameAxisCoord:"locationB",variableNameWorldCoord:"worldB",overrideOffsetPixels:i?`${i.directionVar}B`:void 0}),t.ensureMinimumSegmentLength&&Jg("uniform vec2 uMinSegmentPixelVector"),ip("worldB = ",t.ensureMinimumSegmentLength&&"float segmentLengthPixels = sqrt(pow(worldB.x - worldA.x, 2.0) + pow(worldB.y - worldA.y, 2.0)) / length(uRatioPxClip)",t.ensureMinimumSegmentLength&&"if (segmentLengthPixels == 0.0 || segmentLengthPixels < length(uMinSegmentPixelVector)) {\n                            worldB = worldA + uMinSegmentPixelVector * uRatioPxClip;\n                        }","vec2 directionBasis = worldB - worldA","vec2 directionBasisNorm = normalize(directionBasis)","vec2 perpendBasisNorm = vec2(-directionBasisNorm.y, directionBasisNorm.x)","vec2 offset = mix(worldA, worldB, aSegmentSide)","vec2 thicknessDirection = aSegmentPosition.x * directionBasisNorm + aSegmentPosition.y * perpendBasisNorm",`vec2 ${Pg} = offset + thicknessDirection * uThicknessPixels * ${Og}`),...xp(s),...yp(s),...gp(s)?mp({...t,offsets:i?[{...i,skipAddDefinition:!0}]:[]},!1,Pg,Lg):[],...e.vertexShaderModifiers],fragmentShaderModifiers:e.fragmentShaderModifiers})}},Area2D:t=>({idFeature:"Area2D",apply:e=>{const i=cp(t.axisWorldTranslation,"locationA_hprecision","locationB_hprecision");return{idVertex:`Area2D:${dp(t)}`,idFragment:i.idFragment,vertexShaderModifiers:[..."linear-highPrecision"!==t.axisWorldTranslation&&!0!==t.splitPosAttribute?[Jg("attribute vec2 aLocationA"),Jg("attribute vec2 aLocationB")]:"linear-highPrecision"===t.axisWorldTranslation&&!0!==t.splitPosAttribute?[Jg("attribute vec2 aLocationA_highpart"),Jg("attribute vec2 aLocationB_highpart"),Jg("attribute vec2 aLocationA_lowpart"),Jg("attribute vec2 aLocationB_lowpart")]:"linear-highPrecision"!==t.axisWorldTranslation&&!0===t.splitPosAttribute?[Jg("attribute float aLocationAX"),Jg("attribute float aLocationAY"),Jg("attribute float aLocationBX"),Jg("attribute float aLocationBY")]:"linear-highPrecision"===t.axisWorldTranslation&&!0===t.splitPosAttribute?[Jg("attribute float aLocationA_highpartX"),Jg("attribute float aLocationA_highpartY"),Jg("attribute float aLocationB_highpartX"),Jg("attribute float aLocationB_highpartY"),Jg("attribute float aLocationA_lowpartX"),Jg("attribute float aLocationA_lowpartY"),Jg("attribute float aLocationB_lowpartX"),Jg("attribute float aLocationB_lowpartY")]:[],Jg("attribute float aCurveOrBaseline"),Jg("attribute float aSegmentSide"),...pp(t,!1,{attributeNameAxisCoord:"aLocationA",variableNameAxisCoord:"locationA",variableNameWorldCoord:"worldA"},{attributeNameAxisCoord:"aLocationB",variableNameAxisCoord:"locationB",variableNameWorldCoord:"worldB"}),ip("worldB = ","vec2 posCoord = mix(worldA, worldB, aSegmentSide)","bottom"===t.fill?"float baseline = min(posCoord.y, -1.0)":"top"===t.fill?"float baseline = max(posCoord.y, 1.0)":"left"===t.fill?"float baseline = min(posCoord.x, -1.0)":"float baseline = max(posCoord.x, 1.0)",`vec2 ${Pg} = ${"bottom"===t.fill||"top"===t.fill?"vec2(posCoord.x, mix(posCoord.y, baseline, aCurveOrBaseline))":"vec2(mix(posCoord.x, baseline, aCurveOrBaseline), posCoord.y)"}`),...xp(e),...yp(e),...gp(e)?mp(t,!1,Pg,Lg):[],...i.vertexShaderModifiers],fragmentShaderModifiers:i.fragmentShaderModifiers}}}),LineInstanced3D:t=>({idFeature:"LineInstanced3D",apply:e=>({idVertex:`LineInstanced3D:${dp(t)}`,idFragment:void 0,defaultFragmentShader:"FragmentShader",vertexShaderModifiers:[Jg("uniform float uOffsetWU"),Jg("attribute vec3 aLocationA"),Jg("attribute vec3 aLocationB"),Jg("attribute float aSegmentPosition"),Jg("attribute float aPerpendHorizontal"),Jg("attribute float aPerpendVertical"),...pp({axisWorldTranslation:t.axisWorldTranslation,normalSource:"custom"},fp(e),{attributeNameAxisCoord:"aLocationA",variableNameAxisCoord:"locationA",variableNameWorldCoord:"worldA"},{attributeNameAxisCoord:"aLocationB",variableNameAxisCoord:"locationB",variableNameWorldCoord:"worldB"}),ip("worldB = ","vec3 directionBasis = worldB - worldA","vec3 directionBasisNorm = normalize(directionBasis)","vec3 notParallel = normalize(mix( vec3( 0.0, 1.0, 0.0 ), vec3( 0.2, 0.8, 0.0 ), step( abs(directionBasis.y), 0.9 ) ))","vec3 horizontalBasis = normalize( cross( notParallel, directionBasisNorm ) )","vec3 verticalBasis = normalize( cross( horizontalBasis, directionBasisNorm ) )",`vec3 ${zg} = aPerpendHorizontal * horizontalBasis + aPerpendVertical * verticalBasis`,`vec3 ${Pg} = worldA + aSegmentPosition * directionBasis + ${zg} * uOffsetWU * 0.5`),...gp(e)?mp({axisWorldTranslation:t.axisWorldTranslation,normalSource:"custom"},!0,Pg,Lg):[]]})}),RoundedEdges3D:{idFeature:"RoundedEdges3D",apply:t=>({idVertex:"RoundedEdges3D",idFragment:void 0,vertexShaderModifiers:[Jg("attribute vec3 aEdge"),Jg("uniform float uEdgeRoundness"),ip(`${Pg} =`,"vec3 boxSizeWorld = abs( aOffsetAxis / uScale )","float boxMinDimensionWorldXZ = min( boxSizeWorld.x, boxSizeWorld.z )","vec3 edgeRoundAmount = uEdgeRoundness * vec3( boxMinDimensionWorldXZ, min( boxMinDimensionWorldXZ, boxSizeWorld.y ), boxMinDimensionWorldXZ )",`${Pg} = ${Pg} + aEdge * edgeRoundAmount`)]})},ColorGrid2D:t=>{const e=t.flipXY,i=t.intensityTextureType,s=t.littleEndian,r=t.aggregation;return{idFeature:"ColorGrid2D",apply:(n,o)=>({idVertex:void 0,idFragment:`ColorGrid2D:${dp(t)}`,fragmentShader:"FragmentShader",fragmentShaderModifiers:[Jg("uniform vec4 uTileBounds","uniform vec2 uTileDimensions","uniform sampler2D uTileIntensityValues",r&&"uniform vec2 uAggregationWindowSize"),"ubyte"===i&&Rg.decodeUbyteRGBAEncodedFloat,"bilinear"===t.interpolation?tp("vec2 cellSizePx = uTileBounds.zw / (uTileDimensions - 1.0)","vec2 cellIndex = (gl_FragCoord.xy - uTileBounds.xy) / cellSizePx","vec2 cellStart = floor(cellIndex)","vec2 cellEnd = ceil(cellIndex)","vec2 cellStartNormalized = cellStart / (uTileDimensions - 1.0)","vec2 cellEndNormalized = cellEnd / (uTileDimensions - 1.0)",`vec4 sample00 = texture2D(uTileIntensityValues, ${e?"cellStartNormalized":"vec2(cellStartNormalized.y, cellStartNormalized.x)"})`,`vec4 sample01 = texture2D(uTileIntensityValues, ${e?"vec2(cellStartNormalized.x, cellEndNormalized.y)":"vec2(cellStartNormalized.y, cellEndNormalized.x)"})`,`vec4 sample10 = texture2D(uTileIntensityValues, ${e?"vec2(cellEndNormalized.x, cellStartNormalized.y)":"vec2(cellEndNormalized.y, cellStartNormalized.x)"})`,`vec4 sample11 = texture2D(uTileIntensityValues, ${e?"cellEndNormalized":"vec2(cellEndNormalized.y, cellEndNormalized.x)"})`,"float intensity00 = "+("float"===i?"sample00.x":`decodeUbyteRGBAEncodedFloat(sample00, ${s})`),"float intensity01 = "+("float"===i?"sample01.x":`decodeUbyteRGBAEncodedFloat(sample01, ${s})`),"float intensity10 = "+("float"===i?"sample10.x":`decodeUbyteRGBAEncodedFloat(sample10, ${s})`),"float intensity11 = "+("float"===i?"sample11.x":`decodeUbyteRGBAEncodedFloat(sample11, ${s})`),"vec2 lerpFactors = cellIndex - cellStart",`float intensityR1 = mix(intensity00, intensity10, ${e?"lerpFactors.x":"lerpFactors.y"})`,`float intensityR2 = mix(intensity01, intensity11, ${e?"lerpFactors.x":"lerpFactors.y"})`,`float intensityP = mix(intensityR1, intensityR2,  ${e?"lerpFactors.y":"lerpFactors.x"})`):tp("vec2 cellSizePx = uTileBounds.zw / (uTileDimensions)","vec2 cellIndex = (gl_FragCoord.xy - uTileBounds.xy) / cellSizePx","vec2 cellIndexNormalized = cellIndex / uTileDimensions",...r?[`float intensityP = ${"max"===r?"-":""}340282346638528859811704183484516925440.0`,`for (float dy = -uAggregationWindowSize.y; dy <= uAggregationWindowSize.y; dy++) {\n                                            for (float dx = -uAggregationWindowSize.x; dx <= uAggregationWindowSize.x; dx++) {\n                                                vec2 offset = vec2(dx, dy) / uTileDimensions;\n                                                vec2 coord = ${e?"offset":"vec2(offset.y, offset.x)"} + ${e?"cellIndexNormalized":"vec2(cellIndexNormalized.y, cellIndexNormalized.x)"};\n                                                vec4 sample0 = texture2D(uTileIntensityValues, coord);\n                                                float intensity0 = ${"float"===i?"sample0.x;":`decodeUbyteRGBAEncodedFloat(sample0, ${s};`}\n                                                intensityP = ${"max"===r?"max":"min"}(intensityP, intensity0);\n                                            }\n                                        }`]:[`vec4 sample0 = texture2D(uTileIntensityValues, ${e?"cellIndexNormalized":"vec2(cellIndexNormalized.y, cellIndexNormalized.x)"})`,"float intensityP = "+("float"===i?"sample0.x":`decodeUbyteRGBAEncodedFloat(sample0, ${s})`)]),...op("intensityP",t.lut)]})}},DrawToNormalTexture:t=>{const e=t.flipXZ,i=t.vertexIdSource,s=t.normalTextureType,r=t.heightmapTextureType,n=t.littleEndian;return{idFeature:"DrawToNormalTexture",apply:(o,a)=>{const h=[],l=[];return h.push(Jg("uniform ivec2 uTileDimensions","uniform vec2 uTileDimensionsXZ","uniform vec2 uTileStartLocationAxisXZ","uniform vec2 uTileSizeAxisXZ","uniform sampler2D uHeightmapTexture","uint"===s?"flat varying uvec3 vNormalRGB":"varying vec3 vNormalRGB","attribute"===i&&"attribute float aVertexID"),void 0!==i&&Rg.roundUnsigned,Rg.modulus,Rg.texelFetchWithFallback[a],"ubyte"===r&&Rg.decodeUbyteRGBAEncodedFloat,tp(void 0===i?"int iVertex = gl_VertexID":"int iVertex = int(roundUnsigned(aVertexID))","int iSecondary = modulus(iVertex, (uTileDimensions.y - 1))","int iPrimary = iVertex / (uTileDimensions.y - 1)","vec2 iCell = vec2(float(iPrimary), float(iSecondary))","vec2 uTileDimensionsMinus1 = vec2(uTileDimensions) - 1.0","vec2 halfTexelWorld = 2.0 / (uTileDimensionsMinus1 * 2.0)","vec2 posWorld = vec2(-1.0 + halfTexelWorld.y + iCell.y * 2.0 * halfTexelWorld.y, -1.0 + halfTexelWorld.x + iCell.x * 2.0 * halfTexelWorld.x)","vec2 cellSizeAxis = uTileSizeAxisXZ / (uTileDimensionsXZ - 1.0)",`vec3 posAxis0 = vec3(\n                            uTileStartLocationAxisXZ.x + iCell.${e?"y":"x"} * cellSizeAxis.x,\n                            ${"float"===r?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${n})`} ,\n                            uTileStartLocationAxisXZ.y + iCell.${e?"x":"y"} * cellSizeAxis.y\n                        )`,"vec2 iCell1 = iCell + vec2(1.0, 0.0)",`vec3 posAxis1 = vec3(\n                            uTileStartLocationAxisXZ.x + iCell1.${e?"y":"x"} * cellSizeAxis.x,\n                            ${"float"===r?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell1.y, iCell1.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell1.y, iCell1.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${n})`},\n                            uTileStartLocationAxisXZ.y + iCell1.${e?"x":"y"} * cellSizeAxis.y\n                        )`,"vec2 iCell2 = iCell + vec2(0.0, 1.0)",`vec3 posAxis2 = vec3(\n                            uTileStartLocationAxisXZ.x + iCell2.${e?"y":"x"} * cellSizeAxis.x,\n                            ${"float"===r?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell2.y, iCell2.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell2.y, iCell2.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${n})`},\n                            uTileStartLocationAxisXZ.y + iCell2.${e?"x":"y"} * cellSizeAxis.y\n                        )`,"vec2 iCell3 = iCell + vec2(1.0, 1.0)",`vec3 posAxis3 = vec3(\n                            uTileStartLocationAxisXZ.x + iCell3.${e?"y":"x"} * cellSizeAxis.x,\n                            ${"float"===r?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell3.y, iCell3.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell3.y, iCell3.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${n})`},\n                            uTileStartLocationAxisXZ.y + iCell3.${e?"x":"y"} * cellSizeAxis.y\n                        )`,"vec3 normal = normalize(cross(posAxis2 - posAxis0, posAxis1 - posAxis0) + cross(posAxis1 - posAxis3, posAxis2 - posAxis3))","uint"===s?"vNormalRGB = uvec3(((normal / 2.0) + 0.5) * float(-1u))":"vNormalRGB = (normal / 2.0) + 0.5","gl_PointSize = 1.0")),l.push(Jg("uint"===s?"flat varying uvec3 vNormalRGB":"varying vec3 vNormalRGB"),tp("uint"===s?"gl_FragColor = uvec4(vNormalRGB, -1u)":"gl_FragColor = vec4(vNormalRGB, 1.0)")),{idVertex:`DrawToNormalTexture:${dp(t)}`,idFragment:`DrawToNormalTexture:${dp(t)}`,vertexShaderModifiers:h,fragmentShaderModifiers:l,fragmentShader:"Empty",hints:["uint"===s&&{type:"fragOutput",fragOutput:"uvec4"}]}}}},SurfaceGrid:t=>{const e=t.fillColor,i=t.interpolation,s=t.flipXZ,r=t.shadingStyle,n=t.wireframe,o=t.normalTextureType,a=t.heightmapTextureType,h=t.intensityTextureType,l=t.littleEndian;return{idFeature:"SurfaceGrid",fD:{yD:!0},apply:(c,u)=>{const d=[],f=[];return d.push(Jg("attribute vec2 aGeoCellOffset","uniform int uBaseInstance","uniform ivec2 uTileDimensions","uniform vec2 uTileDimensionsXZ","uniform vec2 uTileStartLocationAxisXZ","uniform vec2 uTileSizeAxisXZ","uniform sampler2D uHeightmapTexture"),Rg.modulus,Rg.texelFetchWithFallback[u],"ubyte"===a&&Rg.decodeUbyteRGBAEncodedFloat,tp("int iSecondary = modulus(iInstance + uBaseInstance, (uTileDimensions.y - 1))","int iPrimary = (iInstance + uBaseInstance) / (uTileDimensions.y - 1)","vec2 iCell = vec2(float(iPrimary), float(iSecondary))","vec2 iCellVertex = iCell + aGeoCellOffset","vec2 uTileDimensionsMinus1 = vec2(float(uTileDimensions.x), float(uTileDimensions.y)) - 1.0","vec2 ySampleCoordinate = vec2(iCellVertex.y, iCellVertex.x) / vec2(uTileDimensionsMinus1.y, uTileDimensionsMinus1.x)","float y = "+("float"===a?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCellVertex.y, iCellVertex.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCellVertex.y, iCellVertex.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${l})`),"vec2 cellSizeAxis = uTileSizeAxisXZ / (uTileDimensionsXZ - 1.0)","vec2 posAxisXZ = uTileStartLocationAxisXZ + cellSizeAxis * "+(s?"vec2(iCellVertex.y, iCellVertex.x)":"iCellVertex"),"vec3 posAxis = vec3(posAxisXZ.x, y, posAxisXZ.y)")),d.push(...pp({axisWorldTranslation:t.axisWorldTranslation,normalSource:"custom"},!0,{attributeNameAxisCoord:void 0,variableNameAxisCoord:Lg,variableNameWorldCoord:Pg})),"phong"===r&&d.push(rp(Pg,"varying vec3 vPosWorld"),..."uint"===o?[Rg.texelFetchUnsignedWithFallback[u],sp("vec4 normalAxisRGB = vec4(texelFetchUnsignedWithFallback(uNormalmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensionsMinus1.y, uTileDimensionsMinus1.x))) / float(-1u)")]:[sp("vec4 normalAxisRGB = texelFetchWithFallback(uNormalmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensionsMinus1.y, uTileDimensionsMinus1.x))")],sp("vec3 normalAxis = (normalAxisRGB.rgb * 2.0) - 1.0","vNormal = normalize(normalAxis * uScale)"),Jg("varying vec3 vNormal",..."uint"===o?["uniform usampler2D uNormalmapTexture"]:["uniform sampler2D uNormalmapTexture"])),f.push(Jg("varying vec3 vTriangleBary")),"uniform"===e?f.push(Jg("uniform vec4 uColorDiffuse"),ip(`${_g} =`,`${_g} = uColorDiffuse`)):Array.isArray(e)&&"lookup"===e[0]&&("value"===e[1]?(d.push(rp(`${Lg}.xz`,"varying vec2 vVertexLocationAxisXZ")),f.push(Jg("uniform vec4 uTileBoundsAxisXZ","uniform vec2 uTileDimensionsXZ","varying vec2 vVertexLocationAxisXZ","uniform sampler2D uTileIntensityValues","uniform mat4 uViewProjectionMatrix","uniform vec3 uScale","uniform vec3 uDisp"),"ubyte"===h&&Rg.decodeUbyteRGBAEncodedFloat,"bilinear"===i?tp("vec2 cellSizeAxisXZ = uTileBoundsAxisXZ.zw / (uTileDimensionsXZ - 1.0)","vec2 cellIndex = (vVertexLocationAxisXZ - uTileBoundsAxisXZ.xy) / cellSizeAxisXZ","vec2 cellStart = floor(cellIndex)","vec2 cellEnd = ceil(cellIndex)","vec2 cellStartNormalized = cellStart / (uTileDimensionsXZ - 1.0)","vec2 cellEndNormalized = cellEnd / (uTileDimensionsXZ - 1.0)",`vec4 sample00 = texture2D(uTileIntensityValues, ${s?"cellStartNormalized":"vec2(cellStartNormalized.y, cellStartNormalized.x)"})`,`vec4 sample01 = texture2D(uTileIntensityValues, ${s?"vec2(cellStartNormalized.x, cellEndNormalized.y)":"vec2(cellStartNormalized.y, cellEndNormalized.x)"})`,`vec4 sample10 = texture2D(uTileIntensityValues, ${s?"vec2(cellEndNormalized.x, cellStartNormalized.y)":"vec2(cellEndNormalized.y, cellStartNormalized.x)"})`,`vec4 sample11 = texture2D(uTileIntensityValues, ${s?"cellEndNormalized":"vec2(cellEndNormalized.y, cellEndNormalized.x)"})`,"float intensity00 = "+("float"===h?"sample00.x":`decodeUbyteRGBAEncodedFloat(sample00, ${l})`),"float intensity01 = "+("float"===h?"sample01.x":`decodeUbyteRGBAEncodedFloat(sample01, ${l})`),"float intensity10 = "+("float"===h?"sample10.x":`decodeUbyteRGBAEncodedFloat(sample10, ${l})`),"float intensity11 = "+("float"===h?"sample11.x":`decodeUbyteRGBAEncodedFloat(sample11, ${l})`),"vec2 lerpFactors = cellIndex - cellStart",`float intensityR1 = mix(intensity00, intensity10, ${s?"lerpFactors.x":"lerpFactors.y"})`,`float intensityR2 = mix(intensity01, intensity11, ${s?"lerpFactors.x":"lerpFactors.y"})`,`float intensityP = mix(intensityR1, intensityR2,  ${s?"lerpFactors.y":"lerpFactors.x"})`):tp("vec2 cellSizeAxisXZ = uTileBoundsAxisXZ.zw / (uTileDimensionsXZ - 1.0)","vec2 cellIndex = floor((vVertexLocationAxisXZ - uTileBoundsAxisXZ.xy) / cellSizeAxisXZ)","vec2 cellIndexNormalized = cellIndex / (uTileDimensionsXZ - 1.0)",`vec4 sample0 = texture2D(uTileIntensityValues, ${s?"cellIndexNormalized":"vec2(cellIndexNormalized.y, cellIndexNormalized.x)"})`,"float intensityP = sample0.x"),...op("intensityP",e[2]))):(d.push(rp(`${Lg}.${e[1]}`,"varying float vLookupValue")),f.push(Jg("varying float vLookupValue"),...op("vLookupValue",e[2])))),"phong"===r&&f.push(...lp),n&&(d.push(Jg("attribute vec3 aTriangleBary"),rp("aTriangleBary","varying vec3 vTriangleBary")),f.push(Jg("uniform vec4 uWireframeColor","uniform float uWireframeThickness"),Rg.computeScreenSpaceWireframe,ip(`${_g} =`,"float edge = computeScreenSpaceWireframe(vTriangleBary, uWireframeThickness)",e?`if (edge > 0.0) {\n                                    ${_g} = vec4(mix(${_g}.rgb, uWireframeColor.rgb, edge * uWireframeColor.a), max(${_g}.a, uWireframeColor.a));\n                                }`:`if (edge > 0.0) {\n                                    ${_g} = uWireframeColor;\n                                  } else {\n                                      discard;\n                                  }`))),{idVertex:`SurfaceGrid:${dp(t)}`,idFragment:`SurfaceGrid:${dp(t)}`,vertexShaderModifiers:d,fragmentShader:"FragmentShader",fragmentShaderModifiers:f}}}},DebugSurfaceGridNormals:t=>({idFeature:"DebugSurfaceGridNormals",apply:(e,i)=>({idVertex:`DebugSurfaceGridNormals:${dp(t)}`,idFragment:`DebugSurfaceGridNormals:${dp(t)}`,vertexShaderModifiers:[Jg("attribute float aNormalArrow","uniform int uBaseInstance","uniform ivec2 uTileDimensions","uniform vec2 uTileDimensionsXZ","uniform vec2 uTileStartLocationAxisXZ","uniform vec2 uTileSizeAxisXZ","uniform sampler2D uHeightmapTexture","attribute"===t.instanceIdSource&&"attribute float aInstanceID",..."uint"===t.normalTextureType?["uniform usampler2D uNormalmapTexture"]:["uniform sampler2D uNormalmapTexture"]),Rg.roundUnsigned,Rg.modulus,Rg.texelFetchWithFallback[i],"ubyte"===t.heightmapTextureType&&Rg.decodeUbyteRGBAEncodedFloat,tp(void 0===t.instanceIdSource?"int iInstance = gl_InstanceID":"int iInstance = int(roundUnsigned(aInstanceID))","iInstance = iInstance + uBaseInstance","int iSecondary = modulus(iInstance, (uTileDimensions.y - 1))","int iPrimary = iInstance / (uTileDimensions.y - 1)","vec2 iCell = vec2(float(iPrimary), float(iSecondary))","vec2 uTileDimensionsMinus1 = vec2(float(uTileDimensions.x), float(uTileDimensions.y)) - 1.0","float y00 = "+("float"===t.heightmapTextureType?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${t.littleEndian})`),"float y01 = "+("float"===t.heightmapTextureType?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y + 1.0, iCell.x), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y + 1.0, iCell.x), vec2(uTileDimensions.y, uTileDimensions.x)), ${t.littleEndian})`),"float y10 = "+("float"===t.heightmapTextureType?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y, iCell.x + 1.0), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y, iCell.x + 1.0), vec2(uTileDimensions.y, uTileDimensions.x)), ${t.littleEndian})`),"float y11 = "+("float"===t.heightmapTextureType?"texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y + 1.0, iCell.x + 1.0), vec2(uTileDimensions.y, uTileDimensions.x)).x":`decodeUbyteRGBAEncodedFloat(texelFetchWithFallback(uHeightmapTexture, ivec2(iCell.y + 1.0, iCell.x + 1.0), vec2(uTileDimensions.y, uTileDimensions.x)), ${t.littleEndian})`),"float y = (y00 + y01 + y10 + y11) / 4.0","vec2 cellSizeAxis = uTileSizeAxisXZ / (uTileDimensionsXZ - 1.0)",`vec2 posAxisXZ = uTileStartLocationAxisXZ + cellSizeAxis * (0.5 + ${t.flipXZ?"vec2(iCell.y, iCell.x)":"iCell"})`,"vec3 posAxis = vec3(posAxisXZ.x, y, posAxisXZ.y)",..."uint"===t.normalTextureType?["vec4 normalAxisRGB = vec4(texelFetchUnsignedWithFallback(uNormalmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensionsMinus1.y, uTileDimensionsMinus1.x))) / float(-1u)"]:["vec4 normalAxisRGB = texelFetchWithFallback(uNormalmapTexture, ivec2(iCell.y, iCell.x), vec2(uTileDimensionsMinus1.y, uTileDimensionsMinus1.x))"],"vec3 normalAxis = (normalAxisRGB.rgb * 2.0) - 1.0","vec3 normalWorld = normalize(normalAxis * uScale)"),..."uint"===t.normalTextureType?[Rg.texelFetchUnsignedWithFallback[i]]:[],...pp({axisWorldTranslation:t.axisWorldTranslation,normalSource:"custom"},!0,{attributeNameAxisCoord:void 0,variableNameAxisCoord:Lg,variableNameWorldCoord:Pg}),ip("posWorld =","vec3 dirArrow = normalWorld","vec3 posArrowStart = posWorld","vec3 posArrowEnd = posWorld + dirArrow * 0.010","vec3 notParallel = normalize(mix( vec3( 0.0, 1.0, 0.0 ), vec3( 0.2, 0.8, 0.0 ), step( abs(dirArrow.y), 0.9 ) ))","vec3 dirArrowLeft = normalize(-dirArrow + 0.50 * normalize(cross(dirArrow, notParallel)))","vec3 dirArrowRight = normalize(-dirArrow + 0.50 * normalize(cross(notParallel, dirArrow)))","vec3 posArrowLeft = posArrowEnd + dirArrowLeft * 0.0025","vec3 posArrowRight = posArrowEnd + dirArrowRight * 0.0025","if (aNormalArrow == 0.0) {\n                        posWorld = posArrowStart;\n                    } else if (aNormalArrow == 1.0) {\n                        posWorld = posArrowEnd;\n                    } else if (aNormalArrow == 2.0) {\n                        posWorld = posArrowLeft;\n                    } else if (aNormalArrow == 3.0) {\n                        posWorld = posArrowRight;\n                    }")],fragmentShader:"FragmentShader",fragmentShaderModifiers:[sp("gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0)")]})}),OffsetTowardsCamera:()=>({idFeature:"OffsetTowardsCamera",apply:t=>({idVertex:"OffsetTowardsCamera",idFragment:void 0,vertexShaderModifiers:[Jg("uniform vec3 uCameraLoc"),ip("posWorld =","posWorld = posWorld + normalize(uCameraLoc) * 0.0025")]})}),AliasedEdge:{idFeature:"AliasedEdge",apply:t=>({idVertex:"AliasedEdge",idFragment:"AliasedEdge",vertexShaderModifiers:[Jg("attribute float aSegmentInside"),Jg("varying float vSegmentInside"),Jg("varying float vSegmentSide"),ip("gl_Position = ","\n                vSegmentInside = aSegmentInside;\n                vSegmentSide = aSegmentSide;\n                ")],fragmentShaderModifiers:[np("#extension GL_OES_standard_derivatives : enable"),Jg("uniform float uAALimit"),Jg("varying float vSegmentInside"),Jg("varying float vSegmentSide"),ip(`${Vg} = `,`\n                float dist = (uAALimit - vSegmentInside);\n                vec2 ddist = vec2(dFdx(dist), dFdy(dist));\n                float pixelDist = dist / length(ddist);\n                // additional blurring\n                pixelDist *= 0.5;\n\n                float aa = clamp(0.5 - pixelDist, 0.0, 1.0);\n                if((vSegmentSide <= 0.0 || vSegmentSide >= 1.0) && aa <=0.99){\n                    aa *= 0.5;\n                }\n                ${Vg} = aa;\n                `)]})},Glow1D:t=>({idFeature:"Glow1D",apply:()=>{const e=Math.round(t.spreadPx),i=Math.round(t.blurPx),s=e+i,r=t.firstPass,n=[];for(let t=-s;t<=s;t+=1){const e=Math.abs(t);n.push(r?{x:t.toFixed(1),y:"0.0",distPx:e.toFixed(1)}:{x:"0.0",y:t.toFixed(1),distPx:e.toFixed(1)})}return{idVertex:`Glow1D:${dp(t)}`,idFragment:`Glow1D:${dp(t)}`,vertexShaderModifiers:[rp("attribute vec2 aTextureCoord","varying vec2 vTextureCoord")],fragmentShader:"FragmentShader",fragmentShaderModifiers:[Jg("uniform sampler2D uTexture"),Jg("varying vec2 vTextureCoord"),Jg("uniform vec2 uTextureSize"),r&&Jg("uniform vec2 uOffsetPx"),!r&&Jg("uniform sampler2D uTextureFirstGlowPass"),!r&&Jg("uniform vec4 uGlowColor"),ip(`${Vg} =`,"vec2 oneTexel = vec2(1.0, 1.0) / uTextureSize","vec2 vTexCoordPixelCenter = vTextureCoord + vec2(0.5, 0.5) / uTextureSize",...r?[]:["float inverseIntensity =\n                                    0.25 * texture2D(uTexture, vTexCoordPixelCenter).a +\n                                    0.125 * texture2D(uTexture, vTexCoordPixelCenter + vec2(-oneTexel.x, 0.0)).a +\n                                    0.125 * texture2D(uTexture, vTexCoordPixelCenter + vec2(oneTexel.x, 0.0)).a +\n                                    0.125 * texture2D(uTexture, vTexCoordPixelCenter + vec2(0.0, -oneTexel.y)).a +\n                                    0.125 * texture2D(uTexture, vTexCoordPixelCenter + vec2(0.0, oneTexel.y)).a +\n                                    0.0625 * texture2D(uTexture, vTexCoordPixelCenter + vec2(-oneTexel.x, -oneTexel.y)).a +\n                                    0.0625 * texture2D(uTexture, vTexCoordPixelCenter + vec2(oneTexel.x, -oneTexel.y)).a +\n                                    0.0625 * texture2D(uTexture, vTexCoordPixelCenter + vec2(-oneTexel.x, oneTexel.y)).a +\n                                    0.0625 * texture2D(uTexture, vTexCoordPixelCenter + vec2(oneTexel.x, oneTexel.y)).a",`${Vg} *= 1.0 - (inverseIntensity * inverseIntensity)`,`if (${Vg} <= 0.0) { discard; }`],"float distancePx = 255.0","vec2 sample_tx = vec2(0.0)",...r?["vec2 texCoordOffset = vTexCoordPixelCenter - uOffsetPx * oneTexel",...n.map((t,e)=>[`sample_tx = texCoordOffset + oneTexel * vec2(${t.x}, ${t.y})`,`if (distancePx > ${t.distPx} && sample_tx.x <= 1.0 && sample_tx.y <= 1.0 && sample_tx.x >= 0.0 && sample_tx.y >= 0.0 && texture2D(uTexture, sample_tx).a > 0.0) { distancePx = ${t.distPx}; }`]).flat(),`${_g} = vec4(distancePx / 255.0, 0.0, 0.0, 1.0)`]:["vec4 sample_horizontal = vec4(0.0)","float horizontal_dist = 255.0","float min_horizontal_dist = 255.0",...n.map((t,e)=>[`sample_tx = vTexCoordPixelCenter + oneTexel * vec2(${t.x}, ${t.y})`,"if (sample_tx.x <= 1.0 && sample_tx.y <= 1.0 && sample_tx.x >= 0.0 && sample_tx.y >= 0.0) {\n                                                sample_horizontal = texture2D(uTextureFirstGlowPass, sample_tx);\n                                                horizontal_dist = sample_horizontal.r * 255.0;\n                                            }","if (sample_horizontal.a < 0.9) { horizontal_dist = 255.0; }","min_horizontal_dist = min(min_horizontal_dist, horizontal_dist)",`distancePx = min(distancePx, pow(horizontal_dist * horizontal_dist + ${t.y} * ${t.y}, 0.5))`]).flat(),`if (distancePx > ${s.toFixed(1)}) { discard; }`,"vec4 pixelGlowColor = vec4(0.0, 0.0, 0.0, 0.0)",`if (distancePx > ${e.toFixed(1)}) {\n                                        float lerpAmount = (distancePx - ${e.toFixed(1)}) / ${(i+1).toFixed(1)};\n                                        pixelGlowColor = mix(uGlowColor, vec4(uGlowColor.rgb, 0.0), 1.0 - (1.0 - lerpAmount) * (1.0 - lerpAmount));\n                                    } else {\n                                        pixelGlowColor = uGlowColor;\n                                    }`,`${_g} = pixelGlowColor`])]}}}),MousePicking:t=>{const e=!!(null==t?void 0:t.customMousePickingIdInput),i=!e&&!!(null==t?void 0:t.useVertexId),s=!e&&!!(null==t?void 0:t.useAttribute),r=!e&&!i&&!s;return{idFeature:"MousePicking",fD:{yD:r,mD:i},apply:(n,o)=>{const a="webgl2"===o?"flat":"",h="webgl2"===o?"int":"float";return{idVertex:`MousePicking:${dp(t)}`,idFragment:`MousePicking:${dp(t)}`,vertexShaderModifiers:[...r?[Jg(`${a} varying ${h} vPickingIdOffset`),sp(`vPickingIdOffset = ${h}(iInstance)`)]:[],...i?[Jg(`${a} varying ${h} vPickingIdOffset`),sp(`vPickingIdOffset = ${h}(iVertex)`)]:[],...s?[Jg("attribute float aPickingIdOffset",`${a} varying ${h} vPickingIdOffset`),sp(`vPickingIdOffset = ${h}(aPickingIdOffset)`)]:[]],fragmentShaderModifiers:[Jg("uniform int uFirstId"),...e?[]:[Jg(`${a} varying ${h} vPickingIdOffset`),tp(`int ${Ng} = ${"int"===h?"vPickingIdOffset":"int(floor(vPickingIdOffset + 0.5))"}`)],ip(`${_g} =`,`int remainder = ${Ng} + uFirstId`,"int r = remainder / 16777216","remainder -= r * 16777216","int g = remainder / 65536","remainder -= g * 65536","int b = remainder / 256","remainder -= b * 256","int a = remainder",`${_g} = vec4(float(r) / 255.0, float(g) / 255.0, float(b) / 255.0, float(a) / 255.0)`),t=>t.replace(`gl_FragColor = vec4(fragColorEnd.rgb, fragColorEnd.a * ${Vg})`,`if (${Vg} <= 0.0) { discard; }\ngl_FragColor = fragColorEnd`).replace("if (fragColorEnd.a <= 0.0) { discard; }","")]}}}},AttributeHighlight:{idFeature:"AttributeHighlight",apply:t=>({idVertex:"AttributeHighlight",idFragment:"AttributeHighlight",vertexShaderModifiers:[rp("attribute float aIsHighlighted","varying float vIsHighlighted")],fragmentShaderModifiers:[t=>t.replace("uniform float uIsHighlighted","varying float vIsHighlighted").replace("uIsHighlighted","vIsHighlighted")]})},StippleTexture:{idFeature:"StippleTexture",apply:(t,e)=>({idVertex:"StippleTexture",idFragment:"StippleTexture",vertexShaderModifiers:[Jg("attribute vec2 aLengthSoFar"),Jg("varying float vLengthSoFar"),Jg("uniform vec2 uStippleCount"),sp("\n                vec2 len = (((aLengthSoFar) / uScale) / 2.0) * uStippleCount;\n                vLengthSoFar = len.x + len.y;\n                ")],fragmentShaderModifiers:[Jg("uniform sampler2D uStippleTexture"),Jg("uniform float uStippleScale"),Jg("varying float vLengthSoFar"),"webgl1"===e&&Jg("uniform float uStippleTextureWidthLimiter"),ip(`${Vg} = `,`\n                    float stippleSampleY = texture2D(\n                        uStippleTexture, \n                        ${"webgl1"===e?"vec2(mod((vLengthSoFar / uStippleScale) , uStippleTextureWidthLimiter), 0)":"vec2((vLengthSoFar / uStippleScale), 0)"}\n                    ).r;\n                    float stippleAA = (stippleSampleY - 0.5) * 2.0;\n                    ${Vg} *= stippleAA;\n                    if (${Vg} <= 0.0) { discard; }`)]})},StippleTextureInstanced:{idFeature:"StippleTextureInstanced",apply:(t,e)=>({idVertex:"StippleTextureInstanced",idFragment:"StippleTextureInstanced",vertexShaderModifiers:[Jg("attribute vec2 aLengthSoFarA"),Jg("attribute vec2 aLengthSoFarB"),Jg("varying float vLengthSoFar"),Jg("uniform vec2 uStippleCount"),sp("\n                vec2 aLengthSoFar = mix(aLengthSoFarA, aLengthSoFarB, aSegmentSide);\n                vec2 len = (((aLengthSoFar) / uScale) / 2.0) * uStippleCount;\n                vLengthSoFar = len.x + len.y;\n                ")],fragmentShaderModifiers:[Jg("uniform sampler2D uStippleTexture"),Jg("uniform float uStippleScale"),Jg("varying float vLengthSoFar"),"webgl1"===e&&Jg("uniform float uStippleTextureWidthLimiter"),ip(`${Vg} = `,`\n                    float stippleSampleY = texture2D(\n                        uStippleTexture, \n                        ${"webgl1"===e?"vec2(mod((vLengthSoFar / uStippleScale) , uStippleTextureWidthLimiter), 0)":"vec2((vLengthSoFar / uStippleScale), 0)"}\n                    ).r;\n                    float stippleAA = (stippleSampleY - 0.5) * 2.0;\n                    ${Vg} *= stippleAA;\n                    if (${Vg} <= 0.0) { discard; }`)]})},PolarHeatmap:t=>({idFeature:"PolarHeatmap",apply:(e,i)=>{const s="dataType"in t,r="interpolation"in t?t:void 0,n=r?r.flipXY:void 0,o="bilinear"===(null==r?void 0:r.interpolation),a=null==r?void 0:r.intensityTextureType,h=null==r?void 0:r.littleEndian;return{idVertex:void 0,idFragment:`PolarHeatmap:${dp(t)}`,vertexShaderModifiers:[],fragmentShaderModifiers:[Jg("uniform vec2 uViewportSize","uniform vec2 uScale","uniform vec2 uDisp","uniform float uSectors","uniform float uAnnuli","uniform float uAmplitudeStart","uniform float uAmplitudeStep","uniform float uAmplitudeAxisStart","uniform float uAmplitudeAxisEnd","uniform float uAngleOffset","uniform float uAngleDirection",r&&"uniform sampler2D uTileIntensityValues",s&&"uniform vec4 uColor"),Rg.texelFetchWithFallback[i],"ubyte"===a&&Rg.decodeUbyteRGBAEncodedFloat,tp("vec2 posWorld = (2.0 * gl_FragCoord.xy / uViewportSize) - 1.0","vec2 posAxis = posWorld * uScale + uDisp","float amplitudeAxisInterval = uAmplitudeAxisEnd - uAmplitudeAxisStart","float amplitude = uAmplitudeAxisStart + sign(amplitudeAxisInterval) * sqrt(posAxis.x * posAxis.x + posAxis.y * posAxis.y)","float iAnnulus = (amplitude - uAmplitudeStart) / uAmplitudeStep"),r&&ip("iAnnulus","float angRad = atan(posAxis.y, posAxis.x) * uAngleDirection + uAngleOffset","if (angRad < 0.0) { angRad = angRad + 2.0 * 3.1415926538; }","if (angRad > 2.0 * 3.1415926538) { angRad = angRad - 2.0 * 3.1415926538; }","float iSector = uSectors * angRad / (2.0 * 3.1415926538)","vec2 cellIndex = vec2(iSector, iAnnulus)","ivec2 cellStart = ivec2(floor(cellIndex))","ivec2 cellEnd = cellStart + ivec2(1)","if (cellEnd.x >= int(uSectors)) { cellEnd = ivec2(0, cellEnd.y); }",n&&"cellIndex = vec2(cellIndex.y, cellIndex.x)",n&&"cellStart = ivec2(cellStart.y, cellStart.x)",n&&"cellEnd = ivec2(cellEnd.y, cellEnd.x)"),s&&ip(`${_g} =`,`${_g} = uColor`),r&&ip("cellEnd","vec2 tileDimensions = "+(n?"vec2(uAnnuli, uSectors)":"vec2(uSectors, uAnnuli)"),o&&"vec4 sample00 = texelFetchWithFallback(uTileIntensityValues, cellStart, tileDimensions)",o&&"vec4 sample01 = texelFetchWithFallback(uTileIntensityValues, ivec2(cellStart.x, cellEnd.y), tileDimensions)",o&&"vec4 sample10 = texelFetchWithFallback(uTileIntensityValues, ivec2(cellEnd.x, cellStart.y), tileDimensions)",o&&"vec4 sample11 = texelFetchWithFallback(uTileIntensityValues, cellEnd, tileDimensions)",o&&"float intensity00 = "+("float"===a?"sample00.x":`decodeUbyteRGBAEncodedFloat(sample00, ${h})`),o&&"float intensity01 = "+("float"===a?"sample01.x":`decodeUbyteRGBAEncodedFloat(sample01, ${h})`),o&&"float intensity10 = "+("float"===a?"sample10.x":`decodeUbyteRGBAEncodedFloat(sample10, ${h})`),o&&"float intensity11 = "+("float"===a?"sample11.x":`decodeUbyteRGBAEncodedFloat(sample11, ${h})`),o&&"vec2 lerpFactors = cellIndex - vec2(cellStart)",o&&"float intensityR1 = mix(intensity00, intensity10, lerpFactors.x)",o&&"float intensityR2 = mix(intensity01, intensity11, lerpFactors.x)",o&&"float intensityP = mix(intensityR1, intensityR2,  lerpFactors.y)",!o&&"vec4 sample0 = texelFetchWithFallback(uTileIntensityValues, cellStart, tileDimensions)",!o&&"float intensityP = "+("float"===a?"sample0.x":`decodeUbyteRGBAEncodedFloat(sample0, ${h})`)),...r?op("intensityP",r.lut):[]]}}})},Ap={"2D":"\nvoid main(void) {\n    gl_Position = vec4(posWorld, 0.0, 1.0 );\n}\n","2DMatrix":"\nvoid main(void) {\n    gl_Position = posWorld;\n}\n","3D":"\nuniform mat4 uViewProjectionMatrix;\nvoid main(void) {\n    gl_Position = uViewProjectionMatrix * vec4(posWorld, 1.0);\n}\n"},Sp={FragmentShader:`\nuniform float uIsHighlighted;\nuniform vec4 uHighlightColorOffset;\nuniform float uRenderEffectMask;\nvoid main(void) {\n    vec4 ${_g} = vec4(0.0, 0.0, 0.0, 0.0);\n    float ${Vg} = 1.0;\n    vec4 fragColorEnd = ${_g};\n    if (fragColorEnd.a <= 0.0) { discard; }\n    fragColorEnd = clamp(fragColorEnd + uIsHighlighted * uHighlightColorOffset, vec4(0.0), vec4(1.0));\n    fragColorEnd = mix(fragColorEnd, vec4(1.0), uRenderEffectMask * fragColorEnd.a * 1000.0);\n    gl_FragColor = vec4(fragColorEnd.rgb, fragColorEnd.a * ${Vg});\n}\n`,Empty:"\nvoid main(void) {\n}\n"};class bp{constructor(t,e,i,s,r){if(this.id=t,this.shader=i,this.gl=s,this.info=r,!e||!i)throw new gg(`Could not find ${this.xD()} ${this.SD()} shader source code.`);this.gl.shaderSource(i,e),this.gl.compileShader(i)}get src(){return""}xD(){return this.id.toString()}SD(){return this.gl.getShaderParameter(this.shader,this.gl.SHADER_TYPE)===this.gl.FRAGMENT_SHADER?"fragment":"vertex"}}class Mp extends bp{constructor(t,e,i,s){super(t,e,i.createShader(i.VERTEX_SHADER),i,s)}}class Ep extends bp{constructor(t,e,i,s){super(t,e,i.createShader(i.FRAGMENT_SHADER),i,s)}}class kp{constructor(t,e,i,s){this.bD=new Map,this.MD=new Map,this.wD=i,this._D=i.createProgram(),this.kD=`${t.xD()} vertex`,this.CD=`${e.xD()} fragment`,i.attachShader(this._D,t.shader),i.attachShader(this._D,e.shader),i.bindAttribLocation(this._D,0,"aPos"),i.linkProgram(this._D),i.deleteShader(t.shader),i.deleteShader(e.shader),this.allAttributeNames=t.info.allAttributeNames,this.allUniformNames=Array.from(new Set(t.info.allUniformNames.concat(e.info.allUniformNames)).values()),this.vertexSharedRemovedVariables=t.info.removedVariableNames,this.fragmentSharedRemovedVariables=e.info.removedVariableNames}get vertexShaderSrc(){return""}get fragmentShaderSrc(){return""}TD(t){return _e(0,()=>Ve())}FD(t){const e=this.ID(t);if(void 0===e)throw this.TD(`Could not get ${t} uniform from ${this.kD} and ${this.CD} shaders.`);return e}ID(t){const e=this.bD.get(t);if(e)return e;const i=this.wD.getUniformLocation(this._D,t);return i?(this.bD.set(t,i),i):void 0}LD(t){const e=this.PD(t);if(void 0===e)throw this.TD(`Could not get ${t} attribute from ${this.kD} and ${this.CD} shaders.`);return e}PD(t){const e=this.MD.get(t);if(e||0===e)return e;const i=this.wD.getAttribLocation(this._D,t);return i>=0?(this.MD.set(t,i),i):void 0}G(){this.wD.deleteProgram(this._D)}}const Tp=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/,wp=t=>{let e;try{e=Ut.getComputedStyle(t)}catch(t){return null}return e};function Cp(t){const e=wp(t);return!!e&&("fixed"===e.position||!!("auto"!==e.zIndex&&"static"!==e.position||function(t){const e=wp(Ip(t)),i=e?e.display:"auto";return"flex"===i||"inline-flex"===i}(t))||+e.opacity<1||"transform"in e&&"none"!==e.transform||"webkitTransform"in e&&"none"!==e.webkitTransform||"mixBlendMode"in e&&"normal"!==e.mixBlendMode||"filter"in e&&"none"!==e.filter||"webkitFilter"in e&&"none"!==e.webkitFilter||"isolation"in e&&"isolate"===e.isolation||!!Tp.test(e.willChange)||"touch"===e.webkitOverflowScrolling)}function Bp(t){let e=t.length;for(;e--;)if(Cp(t[e]))return t[e];return null}function Fp(t){var e;return t&&Number((null===(e=wp(t))||void 0===e?void 0:e.zIndex)||0)||0}function Dp(t){const e=[];for(;t;)e.push(t),t=Ip(t);return e}function Ip(t){var e;return(null===(e=t.parentNode)||void 0===e?void 0:e.host)||t.parentNode}const Rp=t=>t&&"resize"in t;class Lp extends Eg{constructor(t){if(super(),this.BD=new Map,this.DD=new Map,this.ED=new Map,this.RD=!0,this.OD=null,this.zD=null,this.VD=null,this.ND=null,this.GD=0,this.$D=0,this.UD=0,this.YD=!1,this.jD=!0,this.ci=!1,this.HD=Le(`chart-engine-${(new Date).getTime()}${Math.trunc(1e6*Math.random()).toString()}`),this.Y={x:100,y:100},this.WD=()=>{this.XD&&clearTimeout(this.XD),this.XD=setTimeout(()=>this.ia(),12)},this.ZD=t=>{const e=t.intersectionRatio>0,i=t.target.getAttribute("data-lcjs-engine-id");if(i){const t=this.BD.get(i);if(t){const s=t.JD();t.QD(e),e?this.DD.set(i,t):this.DD.delete(i),s!==e&&t.Bs()}}},this.KD=(t,e,i,s,r)=>{const n=r[0],o=this.gl;if(o.bindFramebuffer(null==o?void 0:o.FRAMEBUFFER,null),o.useProgram(this.zD._D),o.clear(o.COLOR_BUFFER_BIT),n.zn.getBoundingClientRect()){const t=n.qD();o.viewport(0,0,t.x,t.y),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n.tE),o.uniform1i(this.GD,0),o.uniformMatrix4fv(this.$D,!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),o.bindBuffer(o.ARRAY_BUFFER,this.VD),o.enableVertexAttribArray(0),o.vertexAttribPointer(this.UD,2,o.FLOAT,!1,0,0),o.drawArrays(o.TRIANGLES,0,6),o.bindFramebuffer(o.FRAMEBUFFER,null),n.iE&&(n.iE.clearRect(0,0,n.iE.canvas.width,n.iE.canvas.height),n.iE.drawImage(this.sE,0,this.sE.height-t.y,t.x,t.y,0,0,n.iE.canvas.width,n.iE.canvas.height))}},this.eE=(t,e,i,s,r)=>{const n=this.gl;n.bindFramebuffer(null==n?void 0:n.FRAMEBUFFER,null),n.useProgram(this.zD._D),n.clear(n.COLOR_BUFFER_BIT),r.forEach(i=>{const r=i.zn.getBoundingClientRect();if(r){const i=r.right-r.left,o=r.bottom-r.top,a=r.left,h=s-r.bottom;n.viewport(a*this.rE-t*this.rE,h*this.rE+e*this.rE,i*this.rE,o*this.rE)}n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i.tE),n.uniform1i(this.GD,0),n.uniformMatrix4fv(this.$D,!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n.bindBuffer(n.ARRAY_BUFFER,this.VD),n.enableVertexAttribArray(0),n.vertexAttribPointer(this.UD,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLES,0,6)}),n.bindFramebuffer(n.FRAMEBUFFER,null)},this.hE=(t,e,i,s,r)=>{const n=r[0],o=this.gl2.ctx;o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.clear(o.COLOR_BUFFER_BIT);const a=n.qD();o.bindFramebuffer(o.READ_FRAMEBUFFER,n.nE[1]),o.blitFramebuffer(0,0,a.x,a.y,0,this.sE.height-a.y,a.x,this.sE.height,o.COLOR_BUFFER_BIT,o.LINEAR),n.iE&&(n.iE.clearRect(0,0,n.iE.canvas.width,n.iE.canvas.height),n.iE.drawImage(this.sE,0,0)),o.bindFramebuffer(o.FRAMEBUFFER,null)},this.oE=(t,e,i,s,r)=>{const n=this.gl2.ctx;n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.clear(n.COLOR_BUFFER_BIT),r.forEach(i=>{const r=i.zn.getBoundingClientRect();if(r){const o=r.right-r.left,a=r.bottom-r.top,h=r.left,l=s-r.bottom,c=i.qD();n.bindFramebuffer(n.READ_FRAMEBUFFER,i.nE[1]),n.blitFramebuffer(0,0,c.x,c.y,h*this.rE-t*this.rE,l*this.rE+e*this.rE,(h-t+o)*this.rE,(l+e+a)*this.rE,n.COLOR_BUFFER_BIT,n.LINEAR)}}),n.bindFramebuffer(n.FRAMEBUFFER,null)},this.XD=void 0,this.Da=t,!Ut.requestAnimationFrame||!Ut.cancelAnimationFrame)throw new Error("LightningChart JS depends on requestAnimationFrame. Make sure to load a polyfill in older browsers.");let e=1;if(t&&t.aE)e=!0===t.aE?Ut.devicePixelRatio||1:t.aE||1;else{const t=Ut.document.head.querySelector('meta[name="viewport"]');t&&t.content.includes("width=device-width")&&(e=Ut.devicePixelRatio||1)}this.rE=e,t.Ea=!0===t.Ea,this.jD=!1!==t.lE,this.uE=!1!==t.cE,this.dE=t.dE||!1;let i=!1;if(t.sE)if("string"==typeof t.sE){const e=Ut.document.getElementById(t.sE);if(!e)throw new Error(`Canvas "${t.sE}" doesn't exist.`);this.sE=e,i=!0}else this.sE=t.sE,i=!0;else this.sE=Ut.document.createElement("canvas");const s={preserveDrawingBuffer:!0,alpha:!0,antialias:!1};if(2!==t.fE&&t.fE){const e=this.sE.getContext("webgl",{...s,antialias:!!t.lE})||this.sE.getContext("experimental-webgl",{...s,antialias:!!t.lE});this.gl=e,this.AE=!1}else{const t=this.sE.getContext("webgl2",s);this.gl2={ctx:t},this.gl=t,this.AE=!0}if(!this.gl)throw new fg("No WebGL context available."+((null==t?void 0:t.fE)?`\nSelected explicit target: WebGL ${t.fE}`:""));const r=[];if(this.gE={WEBGL_lose_context:this.gl.getExtension("WEBGL_lose_context")},Object.keys(this.gE).forEach(t=>{null===this.gE[t]&&r.push(t)}),this.AE)this.pE=!0;else{const t={ANGLE_instanced_arrays:this.gl.getExtension("ANGLE_instanced_arrays"),EXT_blend_minmax:this.gl.getExtension("EXT_blend_minmax"),OES_element_index_uint:this.gl.getExtension("OES_element_index_uint"),OES_standard_derivatives:this.gl.getExtension("OES_standard_derivatives"),OES_vertex_array_object:this.gl.getExtension("OES_vertex_array_object")};t.OES_standard_derivatives||(this.RD=!1),Object.keys(t).forEach(e=>{null===t[e]&&r.push(e)});const e={OES_texture_float:this.gl.getExtension("OES_texture_float")};this.pE=!!e.OES_texture_float,this.gl1={ctx:this.gl,gE:t,optional:e}}const n=r;if(n.length>0&&!1!==t.Ea){const t=Ut.document.createElement("div");t.innerText="LightningChart JS: Some features might not work properly, due to missing WebGL features.",t.style.cssText="position:absolute;top:0;background:red;width:100%;padding:10px;text-align:center;color:white;z-index:1;";const e=Ut.document.createElement("button");e.innerText="X",e.addEventListener("click",()=>{t.parentElement&&t.parentElement.removeChild(t)}),Ut.document.body.appendChild(t),t.appendChild(e),Ut.console.warn("LightningChart JS - Following WebGL extensions could not be loaded:",n.join(", "))}if(this.vE=this.dE?this.yE(this.AE?this.hE.bind(this):this.KD.bind(this)).bind(this):this.mE(this.AE?this.oE.bind(this):this.eE.bind(this)).bind(this),Ut.ResizeObserver){const t=t=>{for(const e of t)e.target===this.sE&&this.xE()};this.Va=new Ut.ResizeObserver(t.bind(this)),this.Va.observe(this.sE)}if(this.SE=((t,e)=>{const i=t,s=new Map,r=new Map,n=new Map,o={totalMs:0,vertexShaders:0,fragmentShaders:0,programs:0},a=(t,i,s=[])=>{const r=[],n=[],o={allAttributeNames:Array.from(t.matchAll(/attribute\s[^\s]*\s(.*);/g)).map(t=>t[1]),allUniformNames:Array.from(t.matchAll(/uniform\s[^\s]*\s(.*);/g)).map(t=>t[1]),allVaryingNames:Array.from(t.matchAll(/varying\s[^\s]*\s(.*);/g)).map(t=>t[1]),removedVariableNames:[]};if(e){const e=t.match(/#extension.*/g);e&&n.push(...e),t=t.replace(/#extension.*/g,"")}else if(r.push("#version 300 es"),(t=(t=(t=t.replace(/#extension.*/g,"")).replace(/attribute/g,"in")).replace(/texture2D/g,"texture")).includes("usampler2D")&&r.push("precision highp usampler2D;"),"vertex"===i)t=t.replace(/varying/g,"out");else{t=t.replace(/varying/g,"in");const e=s.find(t=>"fragOutput"===t.type);t=(t=e?`out ${e.fragOutput} fragOutput;\n${t}`:`out vec4 fragOutput;\n${t}`).replace(/gl_FragColor/g,"fragOutput")}return n&&r.push(...n),r.push("precision highp float;"),r.push("precision highp int;"),{source:t=`${r.join("\n")}\n${t}`,info:o}};return(...t)=>{const h=e?"webgl1":"webgl2";let l,c,u,d,f,g,p,m,y;try{const e=Ut.performance.now();l=t.filter(t=>!1!==t&&void 0!==t),c=((t,e)=>{const i=t.map(i=>i.apply(t,e)),s=i.map(t=>t.idVertex).filter(t=>void 0!==t).sort().join(" "),r=i.map(t=>t.idFragment).filter(t=>void 0!==t).sort().join(" "),n=`vert: ${s} frag: ${r}`;let o,a=!1,h=!1;const l=[];let c;const u=[],d=[];if(i.forEach(t=>{if(t.defaultVertexShader&&(a||(o=t.defaultVertexShader)),t.vertexShader){if(o&&a&&o!==t.vertexShader)throw new up(`Conflicting vertex shader templates ${o} vs ${t.vertexShader}`,n,t);o=t.vertexShader,a=!0}if(t.vertexShaderModifiers)for(const e of t.vertexShaderModifiers)void 0!==e&&!1!==e&&l.push(e);if(t.defaultFragmentShader&&(h||(c=t.defaultFragmentShader)),t.fragmentShader){if(c&&h&&c!==t.fragmentShader)throw new up(`Conflicting fragment shader templates ${c} vs ${t.fragmentShader}`,n,t);c=t.fragmentShader,h=!0}if(t.fragmentShaderModifiers)for(const e of t.fragmentShaderModifiers)void 0!==e&&!1!==e&&u.push(e);t.hints&&t.hints.forEach(t=>{t&&d.push(t)})}),!!t.find(t=>{var e;return null===(e=t.fD)||void 0===e?void 0:e.yD})&&("webgl1"===e?l.push(Jg("attribute float aInstanceID"),tp("int iInstance = int(aInstanceID)")):l.push(tp("int iInstance = gl_InstanceID"))),!!t.find(t=>{var e;return null===(e=t.fD)||void 0===e?void 0:e.mD})&&("webgl1"===e?l.push(Jg("attribute float aVertexID"),tp("int iVertex = int(aVertexID)")):l.push(tp("int iVertex = gl_VertexID"))),!o)throw new up("No vertex shader template defined",n);if(!c)throw new up("Fragment shader not defined",n);return{id:n,vertexShader:{id:s,template:o,modifiers:l},fragmentShader:{id:r,template:c,modifiers:u},hints:d}})(l,h);const x=n.get(c.id);if(u="new",x)return u="existing",g=x.vertexShaderSrc,p=x.fragmentShaderSrc,x;const v=c.vertexShader.id;let A=s.get(v);if(A)g=A.src,d="existing";else{d="new";const t=new $g(c.vertexShader.modifiers).build(Ap[c.vertexShader.template]),{source:e,info:r}=a(t,"vertex");g=e,m=r,A=new Mp(v,e,i,r),s.set(v,A),o.vertexShaders+=1}const S=c.fragmentShader;let b;const M=S.id;if(b=r.get(M),b)p=b.src,f="existing";else{f="new";const t=Sp[S.template],e=new $g([...S.modifiers]).build(t),{source:s,info:n}=a(e,"fragment",c.hints);p=s,y=n,b=new Ep(M,s,i,n),r.set(M,b),o.fragmentShaders+=1}const E=new kp(A,b,i,c);return n.set(c.id,E),o.programs+=1,o.totalMs+=Ut.performance.now()-e,E}catch(t){throw _e(0,()=>{const t="Unexpected LightningChart JS rendering error.\nThis can mean a bug in the library, or that it is simply used in unsupported manner (passing wrong type to method, using disposed component, etc).";return Ut.alert(t),new Error(t)})}}})(this.gl,!this.AE),this.uD=(()=>{const t=Ut.document.createElement("canvas"),e=t.getContext("2d",{willReadFrequently:!0});if(!e)throw new fg("Failed to get Text canvas rendering context");return e.fillStyle="#fff",(i,s,r,n)=>{const o=`${s.style} ${s.weight} ${s.size*r}px ${s.family}`;e.font=o,e.textBaseline="alphabetic",e.textAlign="left";const a=e.measureText(i);if(0===a.width)return;const h=void 0!==a.actualBoundingBoxLeft&&void 0!==a.actualBoundingBoxRight?Math.ceil(a.actualBoundingBoxLeft+a.actualBoundingBoxRight):Math.ceil(a.width),c=a.width,u=Math.round(s.size*r),d=void 0!==a.actualBoundingBoxLeft?a.actualBoundingBoxLeft:0;t.width=h>0?h:c,t.height=2*u,e.font=o,e.textBaseline="alphabetic",e.textAlign="left",n?(e.clearRect(0,0,t.width,t.height),e.fillStyle="#fff"):(e.fillStyle="rgba(255,255,255,0)",e.fillRect(0,0,t.width,t.height),e.fillStyle="#000"),e.fillText(i,d,u);const f=e.getImageData(0,0,t.width,t.height);let g=0,p=0;const m=f.width;for(let t=0;t<f.height;t+=1){for(let e=0;e<m;e+=1)if(0!==f.data[t*m*4+4*e+3]){g=t;break}if(0!==g)break}for(let t=f.height-1;t>=0;t-=1){for(let e=0;e<m;e+=1)if(0!==f.data[t*m*4+4*e+3]){p=t;break}if(0!==p)break}const y=e.canvas.height/2-g,x=p-g+1,v=m,A=new Uint8ClampedArray(v*x*1);for(let t=0;t<x;t+=1)for(let e=0;e<v;e+=1)A[1*t*v+1*e+0]=f.data[(t+g)*v*4+4*e+3];return[A,{advance:c,offsetX:d,baseline:y,glyph:i,size:l(v,x)}]}})(),t.bE||(this.dE?this.sE.style.display="none":(this.sE.style.position="absolute",this.sE.style.top="0",this.sE.style.left="0",this.sE.style.right="0",this.sE.style.bottom="0",this.sE.style.width="100%",this.sE.style.height="100%",this.sE.style.boxSizing="content-box",this.sE.style.display="block",this.sE.style.pointerEvents="none")),this.sE.classList.add("lcjs-canvas"),t.ME&&this.sE.setAttribute("data-lcjs-id",t.ME),i||Ut.document.body.appendChild(this.sE),Ut.IntersectionObserver&&(this.wE=new Ut.IntersectionObserver(t=>{for(let e=0;e<t.length;e+=1){const i=t[e];this.ZD(i)}},{threshold:Array.from(Array(100)).map((t,e)=>e/100)})),Ut.addEventListener("resize",this.WD,{passive:!0}),!this.AE){if(this.zD=this.SE(vp["2DCompose"],vp.Color({dataType:"texture-coord-calc-gpu"}),vp.VertexLocation({axisWorldTranslation:"matrix4",normalSource:void 0,coordType:"vec4"})),!this.zD._D)throw new fg("Unable to setup composition shader!");const t=this.gl,e=t.getUniformLocation(this.zD._D,"uColorTexture");if(!e)throw new fg("Unable to setup composition shader! Failed to find uColorTexture");const i=t.getUniformLocation(this.zD._D,"uMatrix");if(!i)throw new fg("Unable to setup composition shader! Failed to find uMatrix");this.GD=e,this.$D=i,this.UD=t.getAttribLocation(this.zD._D,"aPos"),this.VD=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.VD),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.ND=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.ND),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null)}}yE(t){return e=>{this.OD=null;const i=this.gl.canvas,s=Array.from(this.DD.values());this.YD=!1,s.forEach(s=>{const r=s.qD();(this.Y.x<r.x||this.Y.y<r.y)&&(this.Y.x=Math.max(this.Y.x,r.x),this.Y.y=Math.max(this.Y.y,r.y),i instanceof HTMLCanvasElement&&(i.width=this.Y.x,i.height=this.Y.y)),s.oa&&s._E(e),t(0,0,0,0,[s])}),this.YD&&this.xE()}}mE(t){return e=>{this.OD=null,"style"in this.gl.canvas&&!this.Da.kE&&(this.gl.canvas.style.transform=`translateX(${window.scrollX}px) translateY(${window.scrollY}px)`);const i=this.gl.canvas,s=this.sE.clientHeight,r=this.sE.clientWidth;let n=0,o=0;if(i instanceof HTMLCanvasElement){i.width===r*this.rE&&i.height===s*this.rE||(i.width=r*this.rE,i.height=s*this.rE);const t=i.getBoundingClientRect();n=t.x,o=t.y}const a=Array.from(this.DD.values());this.YD=!1,a.sort((t,e)=>t.CE()-e.CE()).forEach(t=>{t.oa&&t._E(e)}),t(n,o,r,s,a),this.YD&&this.xE()}}xE(t){return Rp(this.gl)||(!this.YD&&t&&(this.YD=!0),this.OD||this.ci||(this.OD=Ut.requestAnimationFrame(this.vE))),this}TE(t){const e=this.HD();return t.zn.setAttribute("data-lcjs-engine-id",e),this.BD.set(e,t),t.FE(this.BD.size-1),t.QD(!0),this.DD.set(e,t),this.wE&&this.wE.observe(t.zn),this.XD&&clearTimeout(this.XD),this.XD=setTimeout(()=>this.ia(),0),this}IE(t){const e=t.zn.getAttribute("data-lcjs-engine-id");return e?(this.BD.delete(e),this.DD.delete(e),this.wE&&this.wE.unobserve(t.zn),t.zn.removeAttribute("data-lcjs-engine-id"),this):this}ia(){if(this.wE){const t=this.wE.takeRecords();for(let e=0;e<t.length;e+=1){const i=t[e];this.ZD(i)}}return!this.dE&&this.uE&&Array.from(this.BD.values()).sort((t,e)=>function(t,e){if(t===e)return 0;const i={a:Dp(t),b:Dp(e)};let s;for(;i.a[i.a.length-1]===i.b[i.b.length-1];)t=i.a.pop(),e=i.b.pop(),s=t;const r=Fp(Bp(i.a)),n=Fp(Bp(i.b));if(r===n&&s){const t=s.childNodes,e={a:i.a[i.a.length-1],b:i.b[i.b.length-1]};let r=t.length;for(;r--;){const i=t[r];if(i===e.a)return 1;if(i===e.b)return-1}}return Math.sign(r-n)}(t.zn,e.zn)).forEach((t,e)=>t.FE(e)),this.xE(!0),this}IB(){return this.xE(),this}LE(){this.ci||this.BD.forEach(t=>t.Dg.layout())}G(){var t;if(this.ci)return;this.ci=!0,super.G(),this.OD&&(Ut.cancelAnimationFrame(this.OD),this.OD=null),this.YD=!1,this.Va&&(this.Va.disconnect(),this.Va=void 0),this.wE&&(this.wE.disconnect(),this.wE=void 0),Ut.removeEventListener("resize",this.WD),this.WD=void 0,this.BD.forEach(t=>{t.G()}),this.BD.clear(),Array.from(this.ED.values()).forEach(t=>{t._c(!0)}),this.ED.clear();const e=this.gl;e.deleteBuffer(this.VD),e.deleteBuffer(this.ND),this.sE&&!this.Da.sE?(this.sE.width=1,this.sE.height=1,null===(t=this.sE.parentElement)||void 0===t||t.removeChild(this.sE),this.sE=void 0):this.sE=void 0,this.SE=void 0,this.uD=void 0,this.vE=()=>{},this.gE.WEBGL_lose_context&&this.gE.WEBGL_lose_context.loseContext()}}const Pp=(t,e,i,s)=>r=>{const n={theme:xf,...i,...r},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new vg(o.Da,r,o,o.G.bind(o),n,a);return o.Ka(t=>h.wc(t)).Qa(()=>h.j()).Bs(),h},zp=(t,e)=>{t.Ka(t=>{e.ir(t)}).Qa(()=>e.j()).Bs()},_p=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Nh(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,null==r?void 0:r.legend);return zp(o,h),h},Vp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Cu(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,r);return zp(o,h),h},Np=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Vd(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,r);return zp(o,h),h},Op=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Wu(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,r);return zp(o,h),h},Up=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new(r&&r.type?r.type:ag)(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Gp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Uf(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Yp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new(r&&r.type?r.type:ad)(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Zp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new(r&&r.type?r.type:bd)(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Wp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new hc(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,r,void 0);return zp(o,h),h},jp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Rl(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Hp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new vf(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0);return zp(o,h),h},$p=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Cf(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Xp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Pu(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,r);return zp(o,h),h},qp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e||s?Sg(o,s,null==i?void 0:i.licenseInformation):void 0,h=new Nf(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,r);return zp(o,h),h},Kp=(t,e,i,s)=>r=>{const n={...i,...r,theme:(null==r?void 0:r.theme)||xf},o=t(n),a=e?Sg(o,s):void 0,h=new $f(o.Da,ug(o,1).NP(0),J,o.G.bind(o),a,void 0,r);return zp(o,h),h},Jp={translation:(t,e,i)=>[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1],xRotation(t){const e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},yRotation(t){const e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},zRotation(t){const e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},scaling:(t,e,i)=>[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1],translate:(t,e,i,s)=>Jp.multiply(t,Jp.translation(e,i,s)),xRotate:(t,e)=>Jp.multiply(t,Jp.xRotation(e)),yRotate:(t,e)=>Jp.multiply(t,Jp.yRotation(e)),zRotate:(t,e)=>Jp.multiply(t,Jp.zRotation(e)),rotateXYZ(t,e){let i=Jp.xRotate(t,e.x);return i=Jp.yRotate(i,e.y),i=Jp.zRotate(i,e.z),i},scale:(t,e,i,s)=>Jp.multiply(t,Jp.scaling(e,i,s)),multiply(t,e){const i=e[0],s=e[1],r=e[2],n=e[3],o=e[4],a=e[5],h=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11],g=e[12],p=e[13],m=e[14],y=e[15],x=t[0],v=t[1],A=t[2],S=t[3],b=t[4],M=t[5],E=t[6],k=t[7],T=t[8],w=t[9],C=t[10],B=t[11],F=t[12],D=t[13],I=t[14],R=t[15],L=[];return L[0]=i*x+s*b+r*T+n*F,L[1]=i*v+s*M+r*w+n*D,L[2]=i*A+s*E+r*C+n*I,L[3]=i*S+s*k+r*B+n*R,L[4]=o*x+a*b+h*T+l*F,L[5]=o*v+a*M+h*w+l*D,L[6]=o*A+a*E+h*C+l*I,L[7]=o*S+a*k+h*B+l*R,L[8]=c*x+u*b+d*T+f*F,L[9]=c*v+u*M+d*w+f*D,L[10]=c*A+u*E+d*C+f*I,L[11]=c*S+u*k+d*B+f*R,L[12]=g*x+p*b+m*T+y*F,L[13]=g*v+p*M+m*w+y*D,L[14]=g*A+p*E+m*C+y*I,L[15]=g*S+p*k+m*B+y*R,L},inverse(t){const e=[],i=t[0],s=t[1],r=t[2],n=t[3],o=t[4],a=t[5],h=t[6],l=t[7],c=t[8],u=t[9],d=t[10],f=t[11],g=t[12],p=t[13],m=t[14],y=t[15],x=d*y,v=m*f,A=h*y,S=m*l,b=h*f,M=d*l,E=r*y,k=m*n,T=r*f,w=d*n,C=r*l,B=h*n,F=c*p,D=g*u,I=o*p,R=g*a,L=o*u,P=c*a,z=i*p,_=g*s,V=i*u,N=c*s,O=i*a,U=o*s,G=x*a+S*u+b*p-(v*a+A*u+M*p),Y=v*s+E*u+w*p-(x*s+k*u+T*p),Z=A*s+k*a+C*p-(S*s+E*a+B*p),W=M*s+T*a+B*u-(b*s+w*a+C*u),j=1/(i*G+o*Y+c*Z+g*W);return e[0]=j*G,e[1]=j*Y,e[2]=j*Z,e[3]=j*W,e[4]=j*(v*o+A*c+M*g-(x*o+S*c+b*g)),e[5]=j*(x*i+k*c+T*g-(v*i+E*c+w*g)),e[6]=j*(S*i+E*o+B*g-(A*i+k*o+C*g)),e[7]=j*(b*i+w*o+C*c-(M*i+T*o+B*c)),e[8]=j*(F*l+R*f+L*y-(D*l+I*f+P*y)),e[9]=j*(D*n+z*f+N*y-(F*n+_*f+V*y)),e[10]=j*(I*n+_*l+O*y-(R*n+z*l+U*y)),e[11]=j*(P*n+V*l+U*f-(L*n+N*l+O*f)),e[12]=j*(I*d+P*m+D*h-(L*m+F*h+R*d)),e[13]=j*(V*m+F*r+_*d-(z*d+N*m+D*r)),e[14]=j*(z*h+U*m+R*r-(O*m+I*r+_*h)),e[15]=j*(O*d+L*r+N*h-(V*h+U*d+P*r)),e},projectionPerspective(t,e,i,s){const r=1/Math.tan(t*Math.PI/180/2),n=1/(i-s);return[r/e,0,0,0,0,r,0,0,0,0,(i+s)*n,-1,0,0,i*s*n*2,0]},projectionOrthographic:(t,e,i,s,r,n)=>[2/(e-t),0,0,0,0,2/(s-i),0,0,0,0,2/(r-n),0,(t+e)/(t-e),(i+s)/(i-s),(r+n)/(r-n),1],quaternionToRotationMatrix(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]),i=[t[0]/e,t[1]/e,t[2]/e,t[3]/e],s=i[0]+i[0],r=i[1]+i[1],n=i[2]+i[2],o=i[0]*s,a=i[0]*r,h=i[0]*n,l=i[1]*r,c=i[1]*n,u=i[2]*n,d=i[3]*s,f=i[3]*r,g=i[3]*n;return[1-(l+u),a-g,h+f,0,a+g,1-(o+u),c-d,0,h-f,c+d,1-(o+l),0,0,0,0,1]}};function Qp(t,i,s,r,n,o){let a=i.x.Dt(t.max.x),h=i.x.Dt(t.min.x),l=i.y.Dt(t.max.y),c=i.y.Dt(t.min.y),u=a-h,d=l-c;if(u<1){const t=(h+a)/2;h=t-.5,a=t+.5,u=1}if(d<1){const t=(c+l)/2;c=t-.5,l=t+.5,d=1}const f=u/d,g=u*s.x,p=d*s.y,m=u-g,y=d-p,x=g>m?[m,g]:[g,m],v=p>y?[y,p]:[p,y];let A,S,b=1,M=1;switch(r){default:case e.GradientExtent.closestSide:if(A=x[0]/u,S=v[0]/d,n===e.GradientShape.circle){const t=Math.min(A*f,S);b=t,M=t}else b=A*f,M=S;break;case e.GradientExtent.farthestSide:if(A=x[1]/u,S=v[1]/d,n===e.GradientShape.circle){const t=Math.max(A*f,S);b=t,M=t}else b=A*f,M=S;break;case e.GradientExtent.closestCorner:if(S=v[0]/d,n===e.GradientShape.circle){A=x[0]/u*f;const t=Math.sqrt(A*A+S*S);b=t,M=t}else{A=x[0]/u;const t=Math.sqrt(A*A+S*S);b=t*f,M=t}break;case e.GradientExtent.farthestCorner:if(S=v[1]/d,n===e.GradientShape.circle){A=x[1]/u*f;const t=Math.sqrt(A*A+S*S);b=t,M=t}else{A=x[1]/u;const t=Math.sqrt(A*A+S*S);b=t*f,M=t}}return{bounds:[h*o,c*o,u*o,d*o],center:[s.x*f,s.y],distance:[Math.max(b,1e-4),Math.max(M,1e-4)],aspectRatio:f}}function tm(t,e,i,s){const r=e.x.Dt(t.max.x),n=e.x.Dt(t.min.x),o=e.y.Dt(t.max.y),a=e.y.Dt(t.min.y),h=r-n,c=o-a,u=Math.abs(h*Math.sin(i))+Math.abs(c*Math.cos(i)),d=l(h/2-Math.sin(i)*(u/2),c/2-Math.cos(i)*(u/2)),f=l(h/2+Math.sin(i)*(u/2),c/2+Math.cos(i)*(u/2));return{bounds:[n*s,a*s,h*s,c*s],startPoint:[d.x*s,d.y*s],endPoint:[f.x*s,f.y*s]}}class em{constructor(t){this.ZB=t}}class im{constructor(){this.PE=new Array,this.BE=t=>(this.PE.push(t),t),this.DE=this.BE(new Map),this.EE=this.BE(new Map),this.RE=this.BE(new Map),this.OE=this.BE(new Map),this.zE=this.BE(new Map),this.VE=this.BE(new Map),this.NE=this.BE(new Map),this.GE=this.BE(new Map)}$E(){this.PE.forEach(t=>{t.forEach(t=>t.$E()),t.clear()})}}const sm=(t,e,i=void 0)=>()=>{t.UE=e,i&&i()},rm=(t,i,s,r,n)=>{const o=Math.min(s/t,r/i),a=t*o,h=i*o,l=s/a,c=r/h,u=a/s,d=h/r;let f=0,g=1,p=0,m=1;switch(n){case e.ImageFitMode.Fill:c<l?(f=0,g=1,p=.5+-u/2,m=.5+u/2):(p=0,m=1,f=.5+-d/2,g=.5+d/2);break;case e.ImageFitMode.Fit:c<l?(p=0,m=1,f=.5+-l/2,g=.5+l/2):(f=0,g=1,p=.5+-c/2,m=.5+c/2);break;case e.ImageFitMode.Center:{const e=s/t,n=r/i;f=.5+-e/2,g=.5+e/2,p=.5+-n/2,m=.5+n/2}break;case e.ImageFitMode.Tile:f=0,g=s/t,p=0,m=r/i;break;case e.ImageFitMode.Stretch:default:f=0,g=1,p=0,m=1}return new Float32Array([f,m,g,m,g,p,f,p])};class nm{constructor(t,e){if(this.YE=0,this.jE=0,this.HE=!1,this.UE=!1,this.WE=!1,this.XE=!1,this.ZE=!1,this.JE=new Set,this.QE=new Set,this.Js=e,this.wD=t,this.KE=null,this.HE=e instanceof Ut.HTMLVideoElement,this.Js instanceof Ut.HTMLImageElement)this.Js.addEventListener("load",()=>{this.XE=!0,this.qE()}),this.Js.addEventListener("error",()=>{this.ZE=!0}),this.Js.complete&&(this.XE=!0,this.qE());else if(this.Js instanceof Ut.HTMLVideoElement){const t=this;this.Js.addEventListener("canplay",function(){t.jE=this.videoHeight,t.YE=this.videoWidth,t.XE=!0,t.qE()},!0),this.Js.addEventListener("play",sm(this,!0,()=>this.qE())),this.Js.addEventListener("playing",sm(this,!0,()=>this.qE())),this.Js.addEventListener("pause",sm(this,!1)),this.Js.addEventListener("ended",sm(this,!1)),this.Js.readyState>=1&&(this.YE=this.Js.videoWidth,this.jE=this.Js.videoHeight,this.UE=!this.Js.paused,this.XE=!0,this.qE())}else this.XE=!0,this.qE()}Kc(t){0===this.QE.size&&this.XE&&this.qE(),this.QE.add(t)}oD(t){this.QE.delete(t),0===this.QE.size&&this.unbindResources()}tR(t){this.JE.add(t),this.WE&&(t(),this.iR(t))}iR(t){this.JE.delete(t)}qE(){if(this.ZE||this.WE||!this.XE)return;const t=this.wD.gl;if(!this.KE&&this.Js&&t){this.KE=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.KE),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);const e=0,i=t.RGBA,s=t.RGBA,r=t.UNSIGNED_BYTE,n=this.Js,o=this.YE>0?this.YE:n.width,a=this.jE>0?this.jE:n.height;t.texImage2D(t.TEXTURE_2D,e,i,s,r,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.YE=o,this.jE=a,t.bindTexture(t.TEXTURE_2D,null)}this.WE=!0,this.JE&&this.JE.forEach(t=>{t(),this.iR(t)})}Nh(){const t=this.wD.gl;if(!this.ZE&&this.WE&&this.KE){const e=0,i=t.RGBA,s=t.RGBA,r=t.UNSIGNED_BYTE,n=this.Js;n&&(t.bindTexture(t.TEXTURE_2D,this.KE),t.texImage2D(t.TEXTURE_2D,e,i,s,r,n))}}sR(){return this.KE}unbindResources(){return this.WE&&(this.KE&&(this.wD.KB(this.KE),this.KE=null),this.WE=!1),this}}class om extends mt{constructor(t,e,i){super(t.pi,e,i),this.hp=!0,this.sp=m(Xs),this.Ws=t,this.ai=t.ai}eR(){var t;return this.sp.u&&this.sp.T().type!==(null===(t=this.rR)||void 0===t?void 0:t.type)}up(t){return this.hp=t,this}}class am{constructor(t){this.DR=[],this.ZB=t}ER(t,e){((t,e,i,s)=>{const r=t.hR(),n=Math.round(Math.min(i.spread,10)*r),o=Math.round(Math.min(i.blur,10)*r),a=Math.round(i.offset.x*r),h=Math.round(i.offset.y*r),l=t.nR(),c=t.oR(),u=t.aR(),d=t.lR(),f=t.uR();t.cR("disabled"),t.up(!1),t.dR(!1);const g=t.pi.sa.AE,p=e.fR(),m=n+o/2,y=((t,e,i,s)=>{const r=t.gl,n=t.hR(),o=t.AR();t.gR(r.FRAMEBUFFER,s.frameBuffer),r.bindRenderbuffer(r.RENDERBUFFER,s.depthBuffer),r.bindTexture(r.TEXTURE_2D,s.texture),r.clearDepth(1),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);const a=s.sizeDpr;t.pR(0,0,a.x,a.y);const h=[],l=t.pi.sa.AE;return e.forEach(e=>{let s;if(e instanceof fo){s=e.us||e.Ws.qg();let t=!1;if(!s){const i=e.Ws.vR(e);i&&i.max.x-i.min.x>0&&i.max.y-i.min.y>0&&(s={x:i.min.x,y:i.min.y,width:i.max.x-i.min.x,height:i.max.y-i.min.y},t=!0)}s&&(s.width>0&&s.height>0?(t&&(s.x-=i.left/n,s.y-=i.top/n,s.width+=(i.left+i.right)/n,s.height+=(i.top+i.bottom)/n),h.push({x:s.x,y:s.y,width:s.width,height:s.height})):s=void 0)}else e instanceof om&&(s=e.Ws.Cm());if(s){const e=s.x+(l?0:i.left),r=s.y+(l?0:i.bottom),o=Math.max(s.width-(l?0:i.left+i.right),0),a=Math.max(s.height-(l?0:i.bottom+i.top),0);t.yR(e*n,r*n,o*n,a*n)}else t.dR(!1);e.wc(2,0)}),t.gR(r.FRAMEBUFFER,o),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindTexture(r.TEXTURE_2D,null),t.dR(!1),h})(t,s,{left:m+(a<0?-a:0),top:m+(h>0?h:0),right:m+(a>0?a:0),bottom:m+(h<0?-h:0)},p),x=p,v=n+o+5,A=((t,e,i,s)=>{const r=(t=>{const e=[];for(let i=0;i<t.length;i+=1){let s,r=t[i];do{const t=e.findIndex(t=>ci(r,t));s=t>=0?e[t]:void 0,s&&(e.splice(t,1),r=Ei(r,s))}while(s);e.push(r)}return e})(e.map(t=>{const e=t instanceof fo||t instanceof om?t.Ws.vR(t):ai;if(Ne(e))return ai;const r={min:{x:Math.max(e.min.x-i.left,0),y:Math.max(e.min.y-i.bottom,0)},max:{x:Math.min(e.max.x+i.right,s.x),y:Math.min(e.max.y+i.top,s.y)}};return r.max.x<=r.min.x||r.max.y<=r.min.y?ai:r}).filter(t=>!Ne(t))),n=6*r.length,o=new Float32Array(4*n);let a=0;return r.forEach(t=>{const e=_i(t.min,s),i=_i(t.max,s),r=e,n=i;o[a+0]=e.x,o[a+1]=e.y,o[a+2]=r.x,o[a+3]=r.y,o[a+4]=i.x,o[a+5]=e.y,o[a+6]=n.x,o[a+7]=r.y,o[a+8]=i.x,o[a+9]=i.y,o[a+10]=n.x,o[a+11]=n.y,o[a+12]=i.x,o[a+13]=i.y,o[a+14]=n.x,o[a+15]=n.y,o[a+16]=e.x,o[a+17]=i.y,o[a+18]=r.x,o[a+19]=n.y,o[a+20]=e.x,o[a+21]=e.y,o[a+22]=r.x,o[a+23]=r.y,a+=24}),{vertexBuffer:t.mR(o),vertexCount:n}})(t,s,{left:v+(a<0?-a:0),top:v+(h>0?h:0),right:v+(a>0?a:0),bottom:v+(h<0?-h:0)},e.xR()),S=e.fR(x),b=t.SE(vp["2D"],vp.Glow1D({spreadPx:n,blurPx:o,firstPass:!0}),vp.VertexLocation({scaling:{dataType:"uniform"},translation:{dataType:"uniform",sizeUnit:"axis"},axisWorldTranslation:"linear",normalSource:void 0}));((t,e,i,s,r,n)=>{const o=t.gl,a=t.AR();t.gR(o.FRAMEBUFFER,i.frameBuffer),o.bindRenderbuffer(o.RENDERBUFFER,i.depthBuffer),o.bindTexture(o.TEXTURE_2D,i.texture),o.clearDepth(1),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),t.pR(0,0,i.sizeDpr.x,i.sizeDpr.y),t.SR(s,(a,h,l,c)=>(t.Kc(s),n&&n(a),t._R(a("uIsHighlighted"),0).UI(a("uHighlightColorOffset"),C)._R(a("uRenderEffectMask"),0).wR(a("uTexture"),e.texture,0).MR(c("uTextureSize"),[e.sizeDpr.x,e.sizeDpr.y]).MR(a("uScale"),i.uniforms.kR()).MR(a("uDisp"),i.uniforms.CR()).MR(a("uScaling"),[i.size.x,i.size.y]).MR(a("uTranslationAxis"),[0,0]).bR(r.vertexBuffer,void 0,{location:h("aPos"),size:2},{location:h("aTextureCoord"),size:2}).Nk(o.TRIANGLES,r.vertexCount,0),!0)),t.gR(o.FRAMEBUFFER,a),o.bindRenderbuffer(o.RENDERBUFFER,null),o.bindTexture(o.TEXTURE_2D,null)})(t,x,S,b,A,(e,i,s,r)=>(t.MR(e("uOffsetPx"),[a+1,h+1]),!0)),t.dR(c),t.TR(f),g&&(((t,e)=>{if(void 0===e||e.length<1)return;const i=t.gl,s=6*e.length*2,r=[s];let n=0;for(let t=0;t<e.length;t+=1){const i=e[t];r[n+0]=i.x,r[n+1]=i.y,r[n+2]=i.x+i.width,r[n+3]=i.y,r[n+4]=i.x,r[n+5]=i.y+i.height,r[n+6]=i.x+i.width,r[n+7]=i.y,r[n+8]=i.x+i.width,r[n+9]=i.y+i.height,r[n+10]=i.x,r[n+11]=i.y+i.height,n+=12}const o=t.mR(r,!0),a={x:t.pi.kt().x,y:t.pi.kt().y},h=J.d2({scaleXYConstructor:q}).Z(a).ii(0,a.x).si(0,a.y),l=new cm;l.FR(h);const c=t.SE(vp["2D"],vp.VertexLocation({scaling:{dataType:"uniform"},translation:void 0,axisWorldTranslation:"linear",normalSource:void 0}),vp.Color({dataType:"uniform"}));t.IR(!0),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.stencilFunc(i.ALWAYS,1,255),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.stencilMask(255),i.colorMask(!1,!1,!1,!1),t.Kc(c).PR(c.LD("aPos"),o).MR(c.FD("uDisp"),l.CR()).MR(c.FD("uScaling"),[1,1]).MR(c.FD("uScale"),l.kR()).LR(c.FD("uColor"),[1,1,1,1]).Nk(i.TRIANGLES,s/2),t.BR(o),i.colorMask(!0,!0,!0,!0)})(t,y),t.gl.stencilFunc(t.gl.EQUAL,1,255),t.gl.stencilOp(t.gl.KEEP,t.gl.KEEP,t.gl.KEEP),t.IR(!0));const M=t.SE(vp["2D"],vp.Glow1D({spreadPx:n,blurPx:o,firstPass:!1}),vp.VertexLocation({scaling:{dataType:"uniform"},translation:{dataType:"uniform",sizeUnit:"axis"},axisWorldTranslation:"linear",normalSource:void 0}));((t,e,i,s,r)=>{const n=t.gl,o={x:t.pi.kt().x,y:t.pi.kt().y};t.pR(0,0,o.x*t.hR(),o.y*t.hR());const a=J.d2({scaleXYConstructor:q}).Z(o).ii(0,o.x).si(0,o.y),h=new cm;h.FR(a),t.SR(i,(a,l,c,u)=>(t.Kc(i),r&&r(a),t._R(a("uIsHighlighted"),0).UI(a("uHighlightColorOffset"),C)._R(a("uRenderEffectMask"),0).wR(a("uTexture"),e.texture,0).MR(u("uTextureSize"),[e.sizeDpr.x,e.sizeDpr.y]).MR(a("uScale"),h.kR()).MR(a("uDisp"),h.CR()).MR(a("uScaling"),[o.x,o.y]).MR(a("uTranslationAxis"),[0,0]).bR(s.vertexBuffer,void 0,{location:l("aPos"),size:2},{location:l("aTextureCoord"),size:2}).Nk(n.TRIANGLES,s.vertexCount,0),!0))})(t,p,M,A,(e,s,r,n)=>(t.wR(e("uTextureFirstGlowPass"),S.texture,1).UI(e("uGlowColor"),i.color),!0)),t.pR(l.x,l.y,l.width,l.height),t.cR(u),t.up(d),t.BR(A.vertexBuffer),g&&t.IR(!1)})(this.ZB,this,e,t)}xR(){const t=this.ZB.pi.kt();return{x:Math.ceil(t.x),y:Math.ceil(t.y)}}fR(...t){const e=this.DR,i=this.xR(),s={x:Math.ceil(i.x*this.ZB.hR()),y:Math.ceil(i.y*this.ZB.hR())},r=this.ZB.gl,n=e.find(e=>!t.includes(e));if(n)return n.sizeDpr.x===s.x&&n.sizeDpr.y===s.y||(n.size=i,n.sizeDpr=s,r.bindTexture(r.TEXTURE_2D,n.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,s.x,s.y,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindRenderbuffer(r.RENDERBUFFER,n.depthBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,s.x,s.y),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),n.scale.Z(i).ii(0,i.x).si(0,i.y),n.uniforms.FR(n.scale)),n;const o=r.createTexture(),a=this.ZB.RR(),h=this.ZB.OR();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,s.x,s.y,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);const l=this.ZB.AR();this.ZB.gR(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0),r.bindRenderbuffer(r.RENDERBUFFER,h),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,s.x,s.y),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,h),r.bindTexture(r.TEXTURE_2D,null),this.ZB.gR(r.FRAMEBUFFER,l),r.bindRenderbuffer(r.RENDERBUFFER,null);const c=J.d2({scaleXYConstructor:q}).Z(i).ii(0,i.x).si(0,i.y),u=new cm;u.FR(c);const d={size:i,sizeDpr:s,texture:o,frameBuffer:a,depthBuffer:h,scale:c,uniforms:u};return e.push(d),d}G(){[this.DR].forEach(t=>{t.forEach(t=>{this.ZB.zR(t.depthBuffer),this.ZB.VR(t.frameBuffer),this.ZB.KB(t.texture)}),t.length=0})}}class hm{constructor(t,i,s,r,n=!0){this.NR=new im,this.GR=new Map,this.$R=new Map,this.UR=[],this.aE=1,this.IS_MACHINE_LITTLE_ENDIAN=(()=>{const t=new Uint32Array([287454020]),e=new Uint8Array(t.buffer);return 68===e[0]||17!==e[0]&&(Ut.console.error("Unidentified machine endianness. Some features might behave unexpectedly."),!0)})(),this.hp=!1,this.YR=!1,this.MR=(t,[e,i])=>(void 0===t||this.gl.uniform2f(t,e,i),this),this.jR=(t,[e,i])=>(void 0===t||this.gl.uniform2i(t,e,i),this),this.LR=(t,[e,i,s,r])=>(void 0===t||this.gl.uniform4f(t,e,i,s,r),this),this.HR=(t,[e,i,s])=>(void 0===t||this.gl.uniform3f(t,e,i,s),this),this.WR=(t,e)=>(void 0===t||this.gl.uniformMatrix3fv(t,!1,e),this),this.XR=(t,e)=>(void 0===t||this.gl.uniformMatrix4fv(t,!1,e),this),this.UI=(t,e)=>(void 0===t||this.gl.uniform4f(t,e.r,e.g,e.b,e.a),this),this._R=(t,e)=>(void 0===t||this.gl.uniform1f(t,e),this),this.ZR=(t,e)=>(this.gl.uniform1i(t,e),this),this.wR=(t,e,i)=>{if(void 0===t)return this;if(e){const s=this.gl.TEXTURE0+i;return this.gl.activeTexture(s),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(t,i),this}throw new fg("Could not bind a texture.")},this.JR=t=>(((t,i)=>{i===e.ImageFitMode.Tile?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))})(this.gl,t),this),this.mR=(t,e=!1,i,s=Float32Array)=>{const r=t.length,n=this.QR(r,i);if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,t instanceof s?t:new s(t),e?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),n)return n;throw new fg("Could not create vertex buffer")},this.KR=(t,e,i,s=Float32Array)=>{const r=i||this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),e&&e.length===t?this.gl.bufferData(this.gl.ARRAY_BUFFER,e instanceof s?e:new s(e),this.gl.STATIC_DRAW):(this.gl.bufferData(this.gl.ARRAY_BUFFER,t*s.BYTES_PER_ELEMENT,this.gl.STATIC_DRAW),e&&this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,e instanceof s?e:new s(e))),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),r)return r;throw new fg("Could not create vertex buffer")},this.qR=(t,e,i,s=Float32Array)=>{this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,e*s.BYTES_PER_ELEMENT,i instanceof s?i:new s(i)),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},this.tO=(t,e,i,s,r)=>{if(s&&t&&(t.usedSize=0),!t){const t=e.length+i,s=new r(t);return s.set(e),{buffer:this.KR(t,s,void 0,r),dataCache:s,preallocSize:t,usedSize:e.length}}if(t.usedSize+e.length>t.preallocSize){const s=t.usedSize+e.length+i,n=new r(s);return n.set(t.dataCache),n.set(e,t.usedSize),{buffer:this.KR(s,n,t.buffer,r),dataCache:n,preallocSize:s,usedSize:t.usedSize+e.length}}return t.dataCache.set(e,t.usedSize),this.qR(t.buffer,t.usedSize,e,r),t.usedSize+=e.length,t},this.iO=(t,e,i=!1)=>{this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,i?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},this.sO=(t,e)=>{const i=t.length,s=this.QR(i,e);if(this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,s),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),s)return s;throw new fg("Could not create index buffer")},this.eO=t=>{const e=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t instanceof Float32Array?t:new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),e)return e;throw new fg("Could not create float buffer")},this.PR=(t,e)=>(void 0===t||(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,0,0)),this),this.rO=(t,e)=>(void 0===t||(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.vertexAttribPointer(t,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(t)),this),this.bR=(t,e,...i)=>{var s;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t);const r=i.length;let n=0;for(let t=0;t<r;t+=1)n+=i[t].size;for(let t=0;t<r;t+=1){const e=i[t].location;void 0!==e&&e>-1&&this.gl.enableVertexAttribArray(e)}let o=0;for(let t=0;t<r;t+=1){const e=i[t];void 0!==e.location&&e.location>-1&&this.gl.vertexAttribPointer(e.location,e.size,this.gl.FLOAT,!1,n*Float32Array.BYTES_PER_ELEMENT,o*Float32Array.BYTES_PER_ELEMENT+(null!==(s=e.extraOffset)&&void 0!==s?s:0)),o+=e.size}if(void 0!==e)for(let t=0;t<r;t+=1){const s=i[t].location;void 0!==s&&s>-1&&this.hO(s,e)}return this},this.nO=(...t)=>{const e=t.length;for(let i=0;i<e;i+=1){const e=t[i];0!==e&&e>-1&&this.gl.disableVertexAttribArray(e)}return this},this.oO=(t,e)=>(void 0===t||(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,4,this.gl.FLOAT,!1,0,0)),this),this.aO=(t,e,i,s=0)=>(void 0===t||(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.vertexAttribPointer(t,1,this.gl.FLOAT,!1,0,s),this.gl.enableVertexAttribArray(t),void 0!==i&&this.hO(t,i)),this),this.lO=t=>(this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t),this),this.uO=null,this.Nk=(t,e,i=0)=>(e>0&&this.gl.drawArrays(t,i,e),this),this.cO=(t,e=this.gl.TRIANGLES,i=0,s=this.gl.UNSIGNED_SHORT)=>(t>0&&this.gl.drawElements(e,t,s,i),this),this.dO=(t,e,i,s)=>{if(s>0&&(this.gl2&&this.gl2.ctx.drawArraysInstanced(t,e,i,s),this.gl1)){if(!this.gl1.gE.ANGLE_instanced_arrays)return Ut.console.warn("The browser does not support REQUIRED WebGL 1 extension: ANGLE_instanced_arrays.\nThis application will NOT work properly!"),this;this.gl1.gE.ANGLE_instanced_arrays.drawArraysInstancedANGLE(t,e,i,s)}return this},this.fO=(t,e,i,s,r=this.gl.UNSIGNED_SHORT)=>{if(s>0&&(this.gl2&&this.gl2.ctx.drawElementsInstanced(t,e,r,i,s),this.gl1)){if(!this.gl1.gE.ANGLE_instanced_arrays)return Ut.console.warn("The browser does not support REQUIRED WebGL 1 extension: ANGLE_instanced_arrays.\nThis application will NOT work properly!"),this;this.gl1.gE.ANGLE_instanced_arrays.drawElementsInstancedANGLE(t,e,r,i,s)}return this},this.hO=(t,e)=>{if(t>-1&&(this.gl2&&this.gl2.ctx.vertexAttribDivisor(t,e),this.gl1)){if(!this.gl1.gE.ANGLE_instanced_arrays)return Ut.console.warn("The browser does not support REQUIRED WebGL 1 extension: ANGLE_instanced_arrays.\nThis application will NOT work properly!"),this;this.gl1.gE.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(t,e)}return this},this.AO=(t,e,i,s=0)=>{const r=this.gl.TEXTURE0+s;this.gl.activeTexture(r);const n=this.AR();this.gR(this.gl.FRAMEBUFFER,e),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,i,0);const o=this.oR();o&&this.dR(!1),t(),o&&this.dR(!0),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gR(this.gl.FRAMEBUFFER,n)},this.Vi=()=>(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this),this.gO=t=>(this.gl.clearColor(t.r,t.g,t.b,t.a),this),this.Kc=t=>(this.gl.useProgram(t._D),this),this.pO=!1,this.vO=[],this.pi=t,this.Pg=i,this.pi=t,this.gl=s.ctx,this.yO=s.antialias,this.mO=!!this.pi.sa.RD&&s.lineAntialias,this.pE=this.pi.sa.pE,this.xO=new Map,this.gl1=this.pi.sa.gl1,this.gl2=this.pi.sa.gl2,n&&(this.TR(!0),this.SO()),this.gE=this.pi.sa.gE,this.QB=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.sD=this.bO(),this.SE=this.pi.sa.SE,this.MO=new dm(this),this.uD=this.pi.sa.uD,this.wO=new am(this),this.ED=this.pi.sa.ED,this._O=this.mR([0,0,1,0,1,1,0,1]),this.kO=this.mR([0,0,1,0,0,1,0,1,1,0,1,1])}cR(t){return t!==this.CO&&(this.CO=t,"disabled"===t?this.gl.disable(this.gl.CULL_FACE):"cull-back"===t?(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK)):"cull-front"===t&&(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT))),this}aR(){return this.CO||"disabled"}up(t){return t!==this.hp&&(this.hp=t,t?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)),this}IR(t){return t!==this.YR&&(this.YR=t,t?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST)),this}lR(){return this.hp}TO(t){return this.aE=t,this}hR(){return this.aE}QR(t,e){let i;if(e){const s=this.xO.get(e);s&&s.size>=t&&s.size-t<1e6?i=e:this.BR(e)}return i||(i=this.gl.createBuffer(),this.xO.set(i,{size:t})),i}ub(t,e=this.gl.RGBA,i=!1,s,r,n=!1,o=this.gl.UNSIGNED_BYTE,a=e){const h=this.gl.createTexture();if(!h)throw new fg("Couldn't reserve Texture.");return this.gl.bindTexture(this.gl.TEXTURE_2D,h),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),t&&null===r?this.gl.texImage2D(this.gl.TEXTURE_2D,0,a,e,o,t):r&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,a,r.x,r.y,0,e,o,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,s?this.gl.NEAREST:this.gl.LINEAR),i?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.generateMipmap(this.gl.TEXTURE_2D)):this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,s?this.gl.NEAREST:this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),h}KB(t){this.gl.deleteTexture(t)}RR(){const t=this.gl.createFramebuffer();if(!t)throw new fg("Couldn't reserve Framebuffer.");return t}gR(t,e){this.uO=e,this.gl.bindFramebuffer(t,e)}AR(){return this.uO}VR(t){this.gl.deleteFramebuffer(t)}OR(){const t=this.gl.createRenderbuffer();if(!t)throw new fg("Couldn't reserve Render buffer.");return t}zR(t){this.gl.deleteRenderbuffer(t)}FO(){const t=this.gl;switch(t.checkFramebufferStatus(t.FRAMEBUFFER)){default:case t.FRAMEBUFFER_COMPLETE:Ut.console.log("FRAMEBUFFER_COMPLETE");break;case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:Ut.console.log("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:Ut.console.log("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:Ut.console.log("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_UNSUPPORTED:Ut.console.log("FRAMEBUFFER_UNSUPPORTED")}}pR(t,e,i,s){return this.gl.viewport(t,e,i,s),this.IO&&t===this.IO.x&&e===this.IO.y&&i===this.IO.width&&s===this.IO.height||(this.IO={x:t,y:e,width:i,height:s}),this}nR(){return this.IO||{x:0,y:0,width:0,height:0}}yR(t,e,i,s){return this.dR(!0),this.gl.scissor(Math.max(t,0),Math.max(e,0),Math.max(i,0),Math.max(s,0)),this}dR(t){return t===this.LO||(t?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this.LO=t),this}TR(t){return t!==this.pO&&(this.pO=t,t&&this.gl.enable(this.gl.BLEND),t||this.gl.disable(this.gl.BLEND)),this}uR(){return this.pO}SO(t,e,i,s){return t?(void 0!==t&&void 0!==e&&(void 0!==i&&void 0!==s?this.gl.blendFuncSeparate(t,e,i,s):this.gl.blendFunc(t,e)),this):(this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this)}oR(){return void 0!==this.LO&&this.LO}SR(t,e){const i=new fm(this,t),s=e(i.uniform,i.attribute,i,i.uniformOptional);i.finish(s)}BR(t){t&&(this.gl.deleteBuffer(t),this.xO.delete(t))}PO(t,e,i){this.MR(t.uniform("uCenter"),e.center).MR(t.uniform("uDistance"),e.distance).LR(t.uniform("uBounds"),e.bounds)._R(t.uniform("uAspect"),e.aspectRatio);const s=i.getColorStops();if(s.length<2)throw new Error("Minimum two color stops required");for(let e=0;e<s.length;e+=1)this.UI(t.uniform(`color_${e}`),s[e].color)._R(t.uniform(`stop_${e}`),s[e].offset);return this}BO(t,e,i){this.MR(t.uniform("uStartPoint"),e.startPoint).MR(t.uniform("uEndPoint"),e.endPoint).LR(t.uniform("uBounds"),e.bounds);const s=i.getColorStops();if(s.length<2)throw new Error("Minimum two color stops required");for(let e=0;e<s.length;e+=1)this.UI(t.uniform(`color_${e}`),s[e].color)._R(t.uniform(`stop_${e}`),s[e].offset);return this}kh(t){const e=this.ED.get(t);if(!e){const e=new Ig(this);return this.ED.set(t,e),e}return e}DO(t){const e=this.GR.get(t);if(!e){const e=new nm(this,t);return this.EO(t,e),e}return e}EO(t,e){this.GR.set(t,e)}bO(){const t=this.gl,e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,1,1,0,t.ALPHA,t.UNSIGNED_BYTE,new Uint8ClampedArray([0]));const i=0===t.getError();return i||!1!==this.Pg.Ea&&Ut.console.info("LightningChart JS - Uint8ClampedArray is not supported as texture data. The above WebGL error/warning is from the feature detection. There is nothing to worry about."),t.deleteTexture(e),i}RO(t,e,i,s){if(i)this.bR(e,s,{location:t.attribute("aPos_highpart"),size:2},{location:t.attribute("aPos_lowpart"),size:2});else{const i=t.attribute("aPos");this.PR(i,e),void 0!==s&&this.hO(i,s)}return this}OO(){this.gE.WEBGL_lose_context&&this.gE.WEBGL_lose_context.loseContext()}zO(t){if(this.VO&&this.VO.bufferIdsCount>=t)return this.VO.buffer;this.VO&&(this.BR(this.VO.buffer),this.VO=void 0);const e=t,i=new Float32Array(e);for(let t=0;t<e;t+=1)i[t]=t;const s=this.mR(i);return this.VO={buffer:s,bufferIdsCount:e},s}NO(){return this.gl2?void 0:"attribute"}GO(t,e){if("attribute"===this.NO()){const i=this.zO(e);this.bR(i,void 0,{location:t.attribute("aVertexID"),size:1})}return this}$O(){return this.gl2?void 0:"attribute"}UO(t,e){if("attribute"===this.$O()){const i=this.zO(e);this.bR(i,1,{location:t.attribute("aInstanceID"),size:1})}return this}YO(t,e,i,s,r,n,o,a,h){const l=t.createBuffer();return this.vO.push(l),t.bindFramebuffer(t.FRAMEBUFFER,e),t.bindBuffer(t.PIXEL_PACK_BUFFER,l),t.bufferData(t.PIXEL_PACK_BUFFER,h.byteLength,t.STREAM_READ),t.readPixels(i,s,r,n,o,a,0),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),lm(t,()=>this.pi.ci,t.PIXEL_PACK_BUFFER,l,0,h).then(()=>h).catch(t=>{throw t}).finally(()=>{t.deleteBuffer(l),this.vO.splice(this.vO.indexOf(l),1)})}jO(t,e,i,s,r,n,o,a){const h=this.gl,l=this.AR();this.gR(h.FRAMEBUFFER,t),h.readPixels(e,i,s,r,n,o,a),this.gR(this.gl.FRAMEBUFFER,l)}HO(t){const e=this.$R.get(t);if(!e){const e=this.gl.createTexture();if(!e)throw new fg("Couldn't reserve Texture.");this.gl.bindTexture(this.gl.TEXTURE_2D,e);const s=[];let r=255;for(let e=0;e<t.length;e+=1){for(let i=0;i<t[e];i+=1)s.push(r);r=255===r?0:255}const n=s.length;if(!this.gl2&&(i=s.length)&i-1){const t=(t=>{t-=1;for(let e=1;e<32;e<<=1)t|=t>>1;return t+1})(s.length);for(let e=s.length;e<t;e+=1)s[e]=0}this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.pixelStorei(this.gl.PACK_ALIGNMENT,1),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,s.length,1,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,new Uint8Array(s)),this.gl.bindTexture(this.gl.TEXTURE_2D,null);const o={WO:e,XO:n,ZO:s.length};return this.$R.set(t,o),o}var i;return e}JO(t,e,i){const{uniform:s}=t;this.UI(s("uFallbackColor"),e.getFallbackColor());for(let t=0;t<e.steps.length;t+=1)this._R(s(`uLUTValue${t}`),e.steps[t].value),this.UI(s(`uLUTColor${t}`),e.steps[t].color);if(e.percentageValues){if(!i)return _e(0,()=>{}),this;this._R(s("uMinValue"),i.min),this._R(s("uMaxValue"),i.max)}return this}QO(t,i,s,r,n,o){const a=s&&s.getSource()||r&&r.Js,h=s?s.getFitMode():e.ImageFitMode.Stretch,l=t=>{t.texCoordsBuffer=this.mR(o(t.texture.YE,t.texture.jE,h),!1,t.texCoordsBuffer)};if(a){let e=i;if((!i||a!==i.source)&&a){i&&(i.texture.oD(t),this.BR(i.texCoordsBuffer));const r=this.DO(a);r.Kc(t);const n=s?s.getSourceMissingColor():en.color;e={texture:r,source:a,texCoordsBuffer:this.mR([]),sourceMissingTexture:this.ub(new Uint8Array([n.getR(),n.getG(),n.getB(),n.getA()]),this.gl.RGBA,!1,!0,{x:1,y:1},!1),textureReadyCallback:()=>{e&&a&&(l(e),this.pi.Bs())}},r.tR(e.textureReadyCallback),l(e)}return e&&e.texture.WE&&e.texture.HE&&e.texture.UE&&(e.texture.Nh(),this.pi.Bs()),n&&e&&e.texture.WE&&l(e),e}i&&this.KO(t,i)}KO(t,e){e&&(e.texture.oD(t),e.texture.iR(e.textureReadyCallback),this.KB(e.sourceMissingTexture),this.BR(e.texCoordsBuffer))}qO(t,e,i,s){var r,n,o,a;const{uniform:h,uniformOptional:l,attribute:c}=t,u=i.ai,d=this.hR();if(this.UI(h("uHighlightColorOffset"),1===e||2===e?B:i.Si)._R(h("uRenderEffectMask"),2===e?1:0).MR(l("uRatioPxClip"),[2/this.pi.kt().x,2/this.pi.kt().y])._R(l("uDevicePixelRatio"),d),void 0===s.highlightBuffer)this._R(h("uIsHighlighted"),1===e||2===e?0:i.gi);else{if(!s.highlightBuffer)throw new Error("Highlight buffer not supplied for attribute highlighting");this.bR(s.highlightBuffer,null!==(r=s.highlightAttribDivisor)&&void 0!==r?r:void 0,{location:c("aIsHighlighted"),size:1})}u instanceof q||u instanceof Ar?this.MR(h("uScale"),s.uniforms.kR()).MR(h("uDisp"),s.uniforms.CR()).MR(l("uScaleStart_highpart"),s.uniforms.tz()).MR(l("uScaleStart_lowpart"),s.uniforms.iz()):u instanceof K&&this.MR(l("uScaleStart"),s.uniforms.MixedScaleXY.uScaleStart).MR(l("uScaleStartLog"),s.uniforms.MixedScaleXY.uScaleStartLog).MR(l("uScaleInterval"),s.uniforms.MixedScaleXY.uScaleInterval).MR(l("uScaleIntervalLog"),s.uniforms.MixedScaleXY.uScaleIntervalLog).MR(h("uViewportStart"),s.uniforms.MixedScaleXY.uViewportStart).MR(h("uViewportSize"),s.uniforms.MixedScaleXY.uViewportSize);const f=!0===s.coordsHighPrecision;if(s.coordsX)if(f){const t=c("aPos_highpartX"),e=c("aPos_lowpartX");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.coordsX),this.gl.vertexAttribPointer(t,1,this.gl.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(e,1,this.gl.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,1*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(e)}else this.aO(c("aPosX"),s.coordsX);if(s.coordsY)if(f){const t=c("aPos_highpartY"),e=c("aPos_lowpartY");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.coordsY),this.gl.vertexAttribPointer(t,1,this.gl.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(e,1,this.gl.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,1*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(e)}else this.aO(c("aPosY"),s.coordsY);if(1===e){if(this.ZR(h("uFirstId"),s.idFirst),void 0!==s.mousePickingOffsetBuffer){if(!s.mousePickingOffsetBuffer)throw new Error("No mouse picking offset buffer for attribute mouse picking");this.aO(c("aPickingIdOffset"),s.mousePickingOffsetBuffer,null!==(n=s.mousePickingOffsetAttribDivisor)&&void 0!==n?n:void 0)}}else{if(s.fillStyleSolid&&this.UI(h("uColor"),s.fillStyleSolid.getColor()),s.fillStylePaletted){if("value"===s.fillStylePaletted.getLookUpProperty()&&null!==s.lookupValueBuffer){if(!s.lookupValueBuffer)return!1;const t=c("aLookupValue");this.aO(t,s.lookupValueBuffer,s.lookupValueAttribDivisor,null!==(o=s.lookupValueBufferByteOffset)&&void 0!==o?o:0)}this.JO(t,s.fillStylePaletted.lut,s.lookupValueRange)}if(s.fillStyleLinearGradient){if(!s.linearGradientInfo)return!1;this.BO(t,s.linearGradientInfo,s.fillStyleLinearGradient)}if(s.fillStyleRadialGradient){if(!s.radialGradientInfo)return!1;this.PO(t,s.radialGradientInfo,s.fillStyleRadialGradient)}if(s.fillStyleIndividual&&null!==s.colorBuffer){if(!s.colorBuffer)return!1;const t=c("aColor");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.colorBuffer),this.gl.vertexAttribPointer(t,4,this.gl.UNSIGNED_BYTE,!0,0,null!==(a=s.colorBufferByteOffset)&&void 0!==a?a:0),this.gl.enableVertexAttribArray(t),void 0!==s.colorAttribDivisor&&this.hO(t,s.colorAttribDivisor)}if(s.fillStyleImage){if(!s.texturedFillGLInfo)return!1;const t=s.texturedFillGLInfo&&s.texturedFillGLInfo.texture.sR();this.UI(l("uColor"),s.fillStyleImage.getSurroundingColor()).wR(h(Gg),t||s.texturedFillGLInfo.sourceMissingTexture,0).bR(s.texturedFillGLInfo.texCoordsBuffer,s.texCoordAttribDivisor,{location:c("aTextureCoord"),size:2}).JR(s.fillStyleImage.fitMode)}if(s.maskTexture){const t=s.maskTexture&&s.maskTexture.texture.sR();this.wR(h(Wg),t||s.maskTexture.sourceMissingTexture,0).bR(s.maskTexture.texCoordsBuffer,s.maskTextureCoordsAttribDivisor,{location:c("aMaskTextureCoord"),size:2})}}return void 0!==s.useInstanceID&&this.UO(t,s.useInstanceID),void 0!==s.useVertexID&&this.GO(t,s.useVertexID),!0}sz(t,e,i){if(t)return tm(i||e.Fi(),e.ai,t.getAngle(!0),this.hR())}ez(t,e,i){if(t)return Qp(i||e.Fi(),e.ai,t.getPosition(),t.getExtent(),t.getShape(),this.hR())}}const lm=async(t,e,i,s,r,n,o,a)=>{const h=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0);return t.flush(),((t,e,i,s)=>{const r=void 0!==s.flags?s.flags:0,n=void 0!==s.retryTimeout?s.retryTimeout:10;return new Promise((s,o)=>{const a=()=>{if(i())return s(void 0);const h=t.clientWaitSync(e,r,0);return h===t.WAIT_FAILED?o(new Error(`WebGL Sync WAIT_FAILED ${t.getError()}`)):h!==t.TIMEOUT_EXPIRED?s(void 0):void Ut.setTimeout(a,n)};Ut.setTimeout(a,0)})})(t,h,e,{retryTimeout:10}).then(()=>{if(!e())return t.deleteSync(h),t.bindBuffer(i,s),t.getBufferSubData(i,r,n,o,a),t.bindBuffer(i,null),n}).catch(t=>{throw t})};class cm{FR(t){if(t instanceof q||t instanceof Ar){const e=t.Ht();this.rz=e.x.scaling,this.hz=-e.x.displacement,this.nz=e.y.scaling,this.oz=-e.y.displacement;const i=Math.fround(e.x.highPrecisionOffset),s=Math.fround(e.y.highPrecisionOffset);this.az=i,this.lz=e.x.highPrecisionOffset-i,this.uz=s,this.cz=e.y.highPrecisionOffset-s}else t instanceof K&&(this.MixedScaleXY=t.Ht());return this}CR(){return[this.hz,this.oz]}kR(){return[this.rz,this.nz]}tz(){return[this.az,this.uz]}iz(){return[this.lz,this.cz]}}class um{constructor(){this.rz=0,this.nz=0,this.dz=0,this.hz=0,this.oz=0,this.fz=0}Az(t){return this.rz=t.tt(),this.hz=t.getInnerStart()+.5*this.rz*t.it(),this}gz(t){return this.nz=t.tt(),this.oz=t.getInnerStart()+.5*this.nz*t.it(),this}pz(t){return this.dz=t.tt(),this.fz=t.getInnerStart()+.5*this.dz*t.it(),this}kR(){return[this.rz,this.nz,this.dz]}CR(){return[this.hz,this.oz,this.fz]}vz(t,e,i,s,r){const n=l(2*(t-i.x)/(i.width-i.x)-1,2*(e-i.y)/(i.height-i.y)-1),o=Jp.multiply(s,[n.x,n.y,r,1]);return d(o[0],o[1],o[2])}}class dm{constructor(t){this.ZB=t}wc(t,e,i,s,r,n=0){const o=this.ZB,a=void 0===s;if(!(s=s||o.RR()))throw new fg("Could not bind a framebuffer.");const h=o.nR(),l=o.uR();o.TR(!1),o.AO(()=>{o.pR(0,0,i.x,i.y),t()},s,e,n),a&&o.VR(s),this.ZB.gO(r),this.ZB.pR(h.x,h.y,h.width,h.height),o.TR(l)}}class fm{constructor(t,e){this.yz=[],this.mz=[],this.uniform=t=>{const e=this.shader.FD(t);return this.mz.push({name:t,optional:!1}),e},this.uniformOptional=t=>{const e=this.shader.ID(t);return this.mz.push({name:t,optional:!0}),e},this.attribute=t=>{const e=this.shader.LD(t);return this.yz.push({name:t,location:e}),e},this.glUtils=t,this.shader=e}finish(t){for(const t of this.yz)this.glUtils.nO(t.location),this.glUtils.hO(t.location,0)}}class gm extends fo{constructor(t,e,i,s,r){super(t,e,i,s),this.xz=new Map,this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.wz=r,this.bz=e}_c(){return this}wc(t,e){if(!this.wz||0!==t||0===this.xz.size)return{};let i=Array.from(this.xz.values()).map(t=>t._z.filter(t=>t.kz).map(t=>t.gs).flat().filter(t=>void 0!==t).filter(t=>t.getVisible())).flat();if(this.pi.xc&&(i=i.filter(t=>!(t instanceof So))),0===i.length)return{};const s=this.wz;return this.ZB.wO.ER(i,s),{}}kc(t,e,i,s,r){return{}}Nh(){return this}Wi(){return 0}Hi(){return 0}Zi(){return 0}Xi(){return 0}uu(){return 0}cu(){return 0}ys(t,e){const i={_z:[]},s=(t,e)=>{const s={gs:t||[],kz:void 0===e||e};i._z.push(s);const r={ks:t=>(s.gs=t,r),Ps:t=>(s.kz=t,r),Ds:()=>s.kz};return r},r={};Object.keys(e).forEach(t=>{const i=e[t],n=i.shapes||[],o=void 0===i.themeEffectEnabled||i.themeEffectEnabled,a=s(n,o);r[t]=a});const n={aA:s,...r};this.xz.set(t,i);const o=()=>{this.xz.delete(t),t.removeEventListener("dispose",o)};return Ut.requestAnimationFrame(()=>{t.addEventListener("dispose",o)}),n}}function pm(t,e,i,s,r,n=Math.floor(Math.sqrt(s>r?25*s:25*r))){const o=Array(n+2),a=Math.PI;let h=0,c=0;const u=e*a/180,d=(i*a/180-u)/n;for(o[h]=l(t.x,t.y),h+=1;h<=n+1;)o[h]=l(t.x+s*Math.cos(u+c*d),t.y+r*Math.sin(u+c*d)),h+=1,c+=1;return[o,n]}const mm=(t,e,i)=>((t,e,i)=>{const s=[];let r=0;const n=Ri(e,i/2);let o,a,h,c,u=t[t.length-1],d=0;for(let i=0;i<t.length;i+=1){o=t[i],a=i===t.length-1?t[0]:t[i+1],i>0&&(u=t[i-1]),Gt(o,u)&&(u=Li(o,Fi(Ri(Pi(a,o),-1)))),Gt(o,a)&&(a=Li(o,Fi(Ri(Pi(u,o),-1))));const f=_i(u,e),g=_i(o,e),p=_i(a,e),m=Fi(Pi(g,f)),y=Fi(Pi(p,g)),x=Li(m,y),v=l(-x.y,x.x),A=l(-m.y,m.x),S=1/Ni(v,A),b=Ii(v),M=Fi(Pi(m,y)),E=Math.sign(Ni(v,M))||1,k=zi(v,Ri(n,S)),T=zi(v,Ri(n,-S));if(b<1||S===1/0){let t={x:0,y:0},e={x:0,y:0},i={x:0,y:0},h={x:0,y:0};const c=l(-y.y,y.x),f=Math.sign(Ni(m,v))||E,g=zi(A,Ri(n,f)),p=zi(c,Ri(n,f));1===E?(t=g,e=T,i=p,h=T):(t=k,e=g,i=k,h=p);const x=4*yi(u,o),b=4*yi(o,a);(S>x||S>b)&&(1===E?(t=g,e=p,i=p,h=g):(t=p,e=g,i=g,h=p));const M=Li(o,t),w=Li(o,e),C=Li(o,i),B=Li(o,h);s[r]=M,r+=1,s[r]=w,r+=1,s[r]=C,r+=1,s[r]=B,r+=1,d=4}else{const t=Li(o,k),e=Li(o,T);s[r]=t,r+=1,s[r]=e,r+=1,d=2}c=h,h=t[i]}return s[r]=s[0],r+=1,s[r]=s[1],r+=1,[s,d,[c,h]]})(t,e,i)[0];class ym extends ko{constructor(t,e,i,s,r){super(t,e,i,s,r),this.bD=new cm,this.Cz=ai,this.Tz=ai,this.Fz=Mr({arcStyleSolid:()=>gs(this.Ze)&&this.Ze,arcStyleRadialGradient:()=>N(this.Ze)&&this.Ze,arcStyleLinearGradient:()=>G(this.Ze)&&this.Ze}),this.Sz=t,this.bz=e,this.ZB=t.Mz()}Iz(t,e){let i=0,s=Array(0),r=0;if(void 0!==e){const r=t.length,n=Array(r+e.length);let o=0,a=0;for(;o<r;)n[a]=t[o],n[a+1]=e[o],a+=2,o+=1;s=n,i=this.ZB.gl.TRIANGLE_STRIP}else s=t,i=this.ZB.gl.TRIANGLE_FAN;const n=pe(s,this.ai.zt());return r=s.length,[s,this.ZB.mR(n),r,i]}Lz(t,e,i,s){let r=Array(0);if(void 0===e)r=t;else{let i=0,s=0;const n=t.length;for(i=0,s=n,r=Array(n+e.length-2),e.reverse();i<n;)r[i]=t[i],r[s]=e[i],s+=1,i+=1}if(1===i||-1===i)return[pe(r,this.ai.zt()),r.length];const n=mm(r,s,i);return[pe(n,this.ai.zt()),n.length]}Nh(){const t=this.cl(),e=this.ui.T();if(this.dl()){const i=Math.abs(this.Ut.T()-this.Eu.T());this.bD.FR(this.ai);const s=this.ai.ei()||t,r=this.ai.ni(),n=this.Ru.T(),o=this.Ou.T(),[a,h]=pm(this.Ln.T(),this.Eu.T(),this.Ut.T(),this.Ru.T(),this.Ou.T(),this.Vu.T()),c=this.zu.T(),u=c>0?pm(this.Ln.T(),this.Eu.T(),this.Ut.T(),this.Ru.T()*c/100,this.Ou.T()*c/100,h)[0]:[this.Ln.T()],d=a.length-1;if(2===d){const t=(a[d-1].x+a[1].x)/2,e=(a[d-1].y+a[1].y)/2;this.Nu=l(t,e)}else{const t=Math.floor(d/2);this.Nu=l(a[t].x,a[t].y)}this.Gu=a[1];const f=a.length-1;this.$u=a[f],this.zu.T()&&(a.shift(),u.shift());let p=!1;(this.Ln.u||this.Eu.u||this.Ut.u||this.Ru.u||this.Ou.u||this.zu.u||this.Vu.u||s)&&(this.Tz=g(l(this.Vl().x-n,this.Vl().y-o),l(this.Vl().x+n,this.Vl().y+o)),p=!0,this.Ln.u=!1,this.Eu.u=!1,this.Ut.u=!1,this.Ru.u=!1,this.Ou.u=!1,this.zu.u=!1,this.Vu.u=!1);const m=this.ll();(p||m)&&this.Ze!==ls&&(this.zu.T()?(this.Pz&&this.ZB.BR(this.Pz),[this.Bz,this.Pz,this.Dz,this.Ez]=this.Iz(a,u)):(this.Pz&&this.ZB.BR(this.Pz),[this.Bz,this.Pz,this.Dz,this.Ez]=this.Iz(a,void 0)),N(this.Ze)?this.Rz=Qp(this.Tz,this.ai,this.Ze.getPosition(),this.Ze.getExtent(),this.Ze.getShape(),this.ZB.hR()):G(this.Ze)?this.Oz=tm(this.Tz,this.ai,this.Ze.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0));const y=this.Fz.arcStyleSolid(m),x=this.Fz.arcStyleLinearGradient(m),v=this.Fz.arcStyleRadialGradient(m),A=y||x||v;m&&(this.zz=A?this.ZB.SE(vp["2D"],vp.Color({dataType:N(this.Ze)||G(this.Ze)?["gradient",this.Ze]:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.fl(this.Ze));const S=this.Je;if(cr(S)&&(p||this.vl(S.getThickness())||s)){this.zu.T()?360===i?(a.pop(),u.pop(),[this.Vz,this.Nz]=this.Lz(a,void 0,S.getThickness(),r),this.Gz&&this.Vz?this.ZB.iO(this.Gz,this.Vz,!0):!this.Gz&&this.Vz?this.Gz=this.ZB.mR(this.Vz,!0):this.Gz&&!this.Vz&&(this.ZB.BR(this.Gz),this.Gz=void 0),[this.$z,this.Uz]=this.Lz(u,void 0,S.getThickness(),r),this.Yz&&this.$z?this.ZB.iO(this.Yz,this.$z,!0):!this.Yz&&this.$z?this.Yz=this.ZB.mR(this.$z,!0):this.Yz&&!this.$z&&(this.ZB.BR(this.Yz),this.Yz=void 0)):([this.Vz,this.Nz]=this.Lz(a,u,S.getThickness(),r),this.Gz&&this.Vz?this.ZB.iO(this.Gz,this.Vz,!0):!this.Gz&&this.Vz?this.Gz=this.ZB.mR(this.Vz,!0):this.Gz&&!this.Vz&&(this.ZB.BR(this.Gz),this.Gz=void 0),this.$z&&(this.Yz&&this.ZB.BR(this.Yz),this.Yz=void 0,this.Uz=0)):(360===i&&(a.shift(),a.pop()),[this.Vz,this.Nz]=this.Lz(a,void 0,S.getThickness(),r),this.Gz&&this.Vz?this.ZB.iO(this.Gz,this.Vz,!0):!this.Gz&&this.Vz?this.Gz=this.ZB.mR(this.Vz,!0):this.Gz&&!this.Vz&&(this.ZB.BR(this.Gz),this.Gz=void 0));const t=S.getFillStyle();N(t)?this.jz=Qp(this.Tz,this.ai,t.getPosition(),t.getExtent(),t.getShape(),this.ZB.hR()):G(t)?this.Wz=tm(this.Tz,this.ai,t.getAngle(!0),this.ZB.hR()):(this.jz=void 0,this.Wz=void 0),this.Xz=t===ls?void 0:this.ZB.SE(vp["2D"],vp.Color({dataType:N(t)||G(t)?["gradient",t]:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})),this.yl(S)}if(p){let t=1,e=1;cr(S)&&(t=S.getThickness()*r.x,e=S.getThickness()*r.y),this.Cz=g(l(this.Tz.min.x-t,this.Tz.min.y-e),l(this.Tz.max.x+t,this.Tz.max.y+e))}this.Zz=e&&A?this.Zz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.Jz=e&&this.Je!==Bt?this.Jz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0}return this}wc(t,e){if(this.dl()){const i=1===t?this.Zz:this.zz,s=this.Ze,r=this.Pz;i&&r&&this.ZB.Kc(i).SR(i,(i,n,o,a)=>{if(this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(a("uScaleStart_highpart"),this.bD.tz()).MR(a("uScaleStart_lowpart"),this.bD.iz()).RO(o,r,this.ai.zt(),void 0)._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),1===t)this.ZB.ZR(i("uFirstId"),e).UO(o,1);else if(gs(s))this.ZB.UI(i("uColor"),s.getColor());else if(N(s)){if(!this.Rz)return!1;this.ZB.PO(o,this.Rz,s)}else if(G(s)){if(!this.Oz)return!1;this.ZB.BO(o,this.Oz,s)}return this.ZB.Nk(this.Ez,this.Dz),!0});const n=this.Je;cr(n)&&(void 0!==this.Gz&&this.Qz(t,this.Gz,this.Nz,n,e),void 0!==this.Yz&&this.Qz(t,this.Yz,this.Uz,n,e))}return{idCount:1}}kc(t,e,i,s,r){return{}}Qz(t,e,i,s,r){const n=1===t?this.Jz:this.Xz,o=s.getFillStyle();n&&this.ZB.Kc(n).SR(n,(n,a,h,l)=>{if(this.ZB.MR(n("uScale"),this.bD.kR()).MR(n("uDisp"),this.bD.CR()).RO(h,e,this.ai.zt(),void 0)._R(n("uIsHighlighted"),1===t||2===t?0:this.gi).UI(n("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(n("uRenderEffectMask"),2===t?1:0),1===t)this.ZB.ZR(n("uFirstId"),r).UO(h,1);else if(gs(o))this.ZB.UI(n("uColor"),o.getColor());else if(N(o)){if(!this.jz)return!1;this.ZB.PO(h,this.jz,o)}else if(G(o)){if(!this.Wz)return!1;this.ZB.BO(h,this.Wz,o)}const c=s.getThickness(),u=-1===c||1===c;return this.ZB.Nk(u?this.ZB.gl.LINE_LOOP:this.ZB.gl.TRIANGLE_STRIP,i),!0})}_c(){return this.Kz&&(this.ZB.BR(this.Kz),this.Kz=void 0),this.qz&&(this.ZB.BR(this.qz),this.qz=void 0),this.Pz&&(this.ZB.BR(this.Pz),this.Pz=void 0),this.Gz&&(this.ZB.BR(this.Gz),this.Gz=void 0),this.Yz&&(this.ZB.BR(this.Yz),this.Yz=void 0),this.zz=void 0,this.Xz=void 0,this.Zz=void 0,this.Jz=void 0,this}Wi(){return this.Tz.max.x}Hi(){return this.Tz.min.x}Zi(){return this.Tz.max.y}Xi(){return this.Tz.min.y}uu(){return We(this.Je)}cu(){return We(this.Je)}}class xm{constructor(){this.first=0,this.second=1,this.third=2,this.fourth=3,this.fifth=4,this.sixth=5}tV(t){return this.first=t,this.second=t+1,this.third=t+2,this.fourth=t+3,this.fifth=t+4,this.sixth=t+5,t+=6,this}iV(){return this.first=this.second,this.second=this.third,this.third=this.fourth,this.fourth=this.fifth,this.fifth=this.sixth,this.sixth+=1,this}sV(){return this.first=this.third,this.second=this.fourth,this.third=this.fifth,this.fourth=this.sixth,this.fifth=this.fourth+1,this.sixth=this.fifth+1,this}eV(t){const e=t.buffer;let{position:i}=t;return e[i]=this.first,e[i+1]=this.second,e[i+2]=this.third,i+=3,t.position=i,t.next&&this.iV(),this}rV(t){const e=t.buffer;let{position:i}=t;return e[i]=this.first,e[i+1]=this.third,e[i+2]=this.second,e[i+3]=this.third,e[i+4]=this.fourth,e[i+5]=this.second,i+=6,t.position=i,t.next&&this.sV(),this}hV(t,e){e.next=!0,6*t>=e.buffer.length&&(e.buffer=Array(6*t));for(let i=0;i<t;i+=1)this.rV(e);return this}nV(){return[this.first,this.second,this.third,this.fourth,this.fifth,this.sixth]}}const vm=((t=0)=>(new xm).tV(t))(),Am=(t,e,i,s,r,n,o,a,h,l)=>(void 0===a&&void 0===o||vm.iV(),n.push(t,e),r.push(vm.first,vm.second,vm.third),a=void 0,o=void 0,r.push(vm.third,vm.fourth,vm.second),h=vm.third,vm.sV(),l&&n.push(i,s),[o,a,h]),Sm=(t,e,i,s,r,n,o,a,h,l,c)=>{void 0===h&&void 0===a||vm.iV(),o.push(t,e),r.push(vm.first,vm.second,vm.third);const u=Zi(t,i,e,s);return h=void 0,void 0!==u&&(void 0===h&&(h=u),o.push(h),n.push(vm.third,vm.fourth,vm.fifth),l=vm.fourth),vm.sV(),c&&o.push(i,s),[a,h,l]},bm=(t,e,i,s,r,n,o,a,h,l)=>(void 0===o&&void 0===n||vm.iV(),r.push(t,e),s.push(vm.first,vm.second,vm.third),n=i,o=void 0,a=vm.third,l?r.push(i):h=!0,[n,o,a,h]),Mm=(t,e,i,s,r,n,o,a,h,l,c)=>(0!==n.length?(void 0===a&&void 0===o||vm.iV(),vm.iV()):h>0&&(vm.iV(),c>0&&(c-=1)),n.push(t),r.push(vm.first,vm.second,vm.third),h=vm.second,o=t,a=void 0,l&&n.push(i,s),[o,a,h,c]),Em=(t,e=0)=>{vm.tV(e);const[i,s]=t,r=i.length,n=[],o=[],a=[];let h,l,c=e,u=0,d=i[u],f=s[u],g=i[u],p=s[u],m=!1,y=c>0?g.y!==p.y?2:1:0;if(r>1)for(;u<r-1;){g=d,p=f,u+=1,d=i[u],f=s[u];const t=u===r-1;g.y>p.y?d.y>f.y?[h,l,c]=Am(g,p,d,f,n,a,h,l,c,t):d.y<f.y?[h,l,c]=Sm(g,p,d,f,n,o,a,h,l,c,t):[h,l,c,m]=bm(g,p,d,n,a,h,l,c,m,t):g.y<p.y?d.y<f.y?[h,l,c]=Am(g,p,d,f,o,a,h,l,c,t):d.y>f.y?[h,l,c]=Sm(g,p,d,f,o,n,a,h,l,c,t):[h,l,c,m]=bm(g,p,d,o,a,h,l,c,m,t):d.y===f.y?(h=g,m&&(a.push(g),m=!1,vm.iV()),0===a.length&&c>0&&y>0&&(y-=1)):d.y>f.y?[h,l,c,y]=Mm(g,0,d,f,n,a,h,l,c,t,y):[h,l,c,y]=Mm(g,0,d,f,o,a,h,l,c,t,y)}return[a,new Uint16Array(n),new Uint16Array(o),c,y]};class km extends Eo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.bD=new cm,this.oV=0,this.hu=Array(),this.aV=0,this.lV=new Uint16Array(0),this.uV=new Uint16Array(0),this.Fz=Mr({hightFillSolid:()=>gs(this.Ze)&&this.Ze,hightFillRadialGradient:()=>N(this.Ze)&&this.Ze,hightFillLinearGradient:()=>G(this.Ze)&&this.Ze,hightFillPaletted:()=>vs(this.Ze)&&this.Ze,lowFillSolid:()=>gs(this.yu)&&this.yu,lowFillRadialGradient:()=>N(this.yu)&&this.yu,lowFillLinearGradient:()=>G(this.yu)&&this.yu,lowFillPaletted:()=>vs(this.yu)&&this.yu}),this.Sz=t,this.bz=e,this.ZB=t.Mz()}Nh(){const t=this.cl(),e=this.ui.T(),i=this.mu;if(this.dl()){this.bD.FR(this.ai);const s=i;if(s&&(this.oV=0,this.lV=new Uint16Array(0),this.uV=new Uint16Array(0),this.hu.length=0,this.aV=0,this.Au>1)){const[t,e,i,s]=Em([this.du,this.fu]);this.oV=s,this.lV=e,this.uV=i,this.hu=t,this.aV=t.length}if(this.vu&&this.pu[0].length>1){const[t,e]=this.pu,i=t.length,[s,r,n,o,a]=Em([t,e],this.oV);this.oV=o;const h=s.length;for(let t=a;t<h;t+=1)this.hu[this.aV]=s[t],this.aV+=1;this.lV=Wi(this.lV,r),this.uV=Wi(this.uV,n);for(let s=a>0||this.Au>0?1:a;s<i;s+=1)this.du[this.Au]=t[s],this.fu[this.Au]=e[s],this.Au+=1;this.gu=!0,this.vu=!1,this.pu=[]}const r=this.Ze,n=this.ul!==r,o=this.Fz.hightFillSolid(n),a=this.Fz.hightFillRadialGradient(n),h=this.Fz.hightFillLinearGradient(n),l=this.Fz.hightFillPaletted(n),c=o||a||h||l&&["x","y"].includes(l.getLookUpProperty())&&l,u=this.yu,d=this.Bu!==u,f=this.Fz.lowFillSolid(d),g=this.Fz.lowFillRadialGradient(d),p=this.Fz.lowFillLinearGradient(d),m=this.Fz.lowFillPaletted(d),y=f||g||p||m&&["x","y"].includes(m.getLookUpProperty())&&m;if((n||t)&&(this.cV=c?this.ZB.SE(vp["2D"],vp.Color({dataType:h?["gradient",h]:a?["gradient",a]:l?["lookup",l.getLookUpProperty(),l.lut]:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0),a?this.Rz=Qp(this.Ai||this.nu,this.ai,a.getPosition(),a.getExtent(),a.getShape(),this.ZB.hR()):h?this.Oz=tm(this.Ai||this.nu,this.ai,h.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0),(d||t)&&(this.dV=y?this.ZB.SE(vp["2D"],vp.Color({dataType:p?["gradient",p]:g?["gradient",g]:m?["lookup",m.getLookUpProperty(),m.lut]:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0),g?this.fV=Qp(this.Ai||this.nu,this.ai,g.getPosition(),g.getExtent(),g.getShape(),this.ZB.hR()):p?this.AV=tm(this.Ai||this.nu,this.ai,p.getAngle(!0),this.ZB.hR()):(this.fV=void 0,this.AV=void 0),(t||this.gu||s)&&this.gu||s){const t=this.hu,e=pe(t,this.ai.zt());this.gV=this.ZB.mR(e,!1,this.gV),c&&(this.pV=this.ZB.sO(this.lV,this.pV),this.vV=this.lV.length),y&&(this.yV=this.ZB.sO(this.uV,this.yV),this.mV=this.uV.length),this.gu=!1}this.Zz=e&&(y||c)?this.Zz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.fl(this.Ze),this.Du(this.yu),this.mu=!1}return this}wc(t,e){const i=this.Ze,s=this.yu,r=1===t?this.Zz:this.dV;if(r&&this.gV&&this.yV){const i=this.gV,n=this.yV;this.ZB.Kc(r).SR(r,(r,o,a,h)=>{if(this.ZB.RO(a,i,this.ai.zt(),void 0).lO(n)._R(r("uIsHighlighted"),1===t||2===t?0:this.gi).UI(r("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(r("uRenderEffectMask"),2===t?1:0),this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(r("uScale"),this.bD.kR()).MR(r("uDisp"),this.bD.CR()).MR(h("uScaleStart_highpart"),this.bD.tz()).MR(h("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(h("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(h("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(h("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(h("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(r("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(r("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),1===t)this.ZB.ZR(r("uFirstId"),e).UO(a,1);else if(gs(s))this.ZB.UI(r("uColor"),s.getColor());else if(N(s)){if(!this.fV)return!1;this.ZB.PO(a,this.fV,s)}else if(G(s)){if(!this.AV)return!1;this.ZB.BO(a,this.AV,s)}else if(vs(s)){const t=Er(s,this,void 0);if(!t&&s.lut.percentageValues)return!1;this.ZB.JO(a,s.lut,t)}return this.ZB.cO(this.mV),!0})}const n=1===t?this.Zz:this.cV;if(n&&this.gV&&this.pV){const s=this.gV,r=this.pV;this.ZB.Kc(n).SR(n,(n,o,a,h)=>{if(this.ZB.RO(a,s,this.ai.zt(),void 0).lO(r)._R(n("uIsHighlighted"),1===t||2===t?0:this.gi).UI(n("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(n("uRenderEffectMask"),2===t?1:0),this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(n("uScale"),this.bD.kR()).MR(n("uDisp"),this.bD.CR()).MR(h("uScaleStart_highpart"),this.bD.tz()).MR(h("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(h("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(h("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(h("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(h("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(n("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(n("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),1===t)this.ZB.ZR(n("uFirstId"),e).UO(a,1);else if(gs(i))this.ZB.UI(n("uColor"),i.getColor());else if(N(i)){if(!this.Rz)return!1;this.ZB.PO(a,this.Rz,i)}else if(G(i)){if(!this.Oz)return!1;this.ZB.BO(a,this.Oz,i)}else if(vs(i)){const t=Er(i,this,void 0);if(!t&&i.lut.percentageValues)return!1;this.ZB.JO(a,i.lut,t)}return this.ZB.cO(this.vV),!0})}return{idCount:1}}kc(t,e,i,s,r){return{}}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return 0}cu(){return 0}gS(t){this.Tu()>0&&this.Nh();const[e,i]=this.Mu(),s=e.length>2&&e[1].x<e[0].x,r=lt(e,t,ht.NearestX,this.xu,this.Su,this.ai,this.pi.ai,this.nu,"x",s);if(void 0===r)return;const n=[e[r],i[r]];return Number.isNaN(n[0].y)||Number.isNaN(n[1].y)?void 0:n}Eb(t){this.Tu()>0&&this.Nh();const[e,i]=this.Mu(),s=e.length;if(0===s)return;const r=this.xu?1:0,n=s-(this.Su?2:1),o=e.length>2&&e[1].x<e[0].x,a=gt(e,tt(t,this.pi.ai,this.ai),"x",o,r,n);if(!a)return;const h=[Ai(e[a.a],e[a.b],a.lerpAmount),Ai(i[a.a],i[a.b],a.lerpAmount)];return Number.isNaN(h[0].y)||Number.isNaN(h[1].y)?void 0:h}dispose(){return super.dispose(),this.yV&&(this.ZB.BR(this.yV),this.yV=void 0),this.pV&&(this.ZB.BR(this.pV),this.pV=void 0),this.gV&&(this.ZB.BR(this.gV),this.gV=void 0),this}_c(){return this.dispose(),this}}class Tm extends em{constructor(t,e){super(t),this.xV=e;const{vertices:i,indices:s,indicesCount:r,drawMode:n}=this.SV();this.bV=t.mR(i),this.MV=t.sO(s),this.wV=r,this._V=n}Kc(t,e){return this.ZB.bR(this.bV,0,{location:t.attribute("aSegmentPosition"),size:2},{location:t.attribute("aSegmentSide"),size:1},{location:e?t.attribute("aSegmentInside"):void 0,size:1}),this.ZB.lO(this.MV),this}Nk(t,e){return this.ZB.fO(void 0!==e?e:this._V,this.wV,0,t,this.ZB.gl.UNSIGNED_BYTE),this}SV(){const t=[];[1,0].forEach(e=>{const i=1===e?.5*Math.PI:1.5*Math.PI;for(let s=0;s<=this.xV;s+=1){const r=i-s*Math.PI/this.xV;t.push(.5*Math.cos(r),.5*Math.sin(r),e,0)}}),t.push(0,0,1,1),t.push(0,0,0,1);const e=t.length/4,i=[];for(let t=0;t<this.xV;t+=1)i.push(t,t+1,e-2),i.push(t+e/2-1,t+e/2,e-1);return i.push(0,e-2,e-1),i.push(e-1,e-2,e/2-1),i.push(0,e-3,e-1),i.push(e/2-2,e-2,e/2-1),{vertices:new Float32Array(t),indices:new Uint8Array(i),indicesCount:i.length,verticesCount:e,drawMode:this.ZB.gl.TRIANGLES}}$E(){this.ZB.BR(this.bV),this.ZB.BR(this.MV)}}const wm=(t,e,i=!0)=>((t,e)=>{let i=t.NR.OE.get(e);return i||(i=new Tm(t,e),t.NR.OE.set(e,i),i)})(t,i?e>=50?8:e>=20?6:e>=7?4:e>=4?3:1===e?1:2:1),Cm={kV:(t,e,i,s,r,n,o=1)=>{const{attribute:a}=s,h=e.gl;if(h.bindBuffer(h.ARRAY_BUFFER,i),t){const t=a("aLocationA_highpart"),i=a("aLocationA_lowpart"),s=a("aLocationB_highpart"),l=a("aLocationB_lowpart");h.vertexAttribPointer(t,2,h.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),e.hO(t,o),h.enableVertexAttribArray(t),h.vertexAttribPointer(i,2,h.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,(n+2)*Float32Array.BYTES_PER_ELEMENT),e.hO(i,o),h.enableVertexAttribArray(i),h.vertexAttribPointer(s,2,h.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,(n+r)*Float32Array.BYTES_PER_ELEMENT),e.hO(s,o),h.enableVertexAttribArray(s),h.vertexAttribPointer(l,2,h.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,(n+r+2)*Float32Array.BYTES_PER_ELEMENT),e.hO(l,o),h.enableVertexAttribArray(l)}else{const t=a("aLocationA"),i=a("aLocationB");h.vertexAttribPointer(t,2,h.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),e.hO(t,o),h.enableVertexAttribArray(t),h.vertexAttribPointer(i,2,h.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,(n+r)*Float32Array.BYTES_PER_ELEMENT),e.hO(i,o),h.enableVertexAttribArray(i)}},CV:(t,e,i,s,r,n,o,a)=>{const h=t.gl;h.bindBuffer(h.ARRAY_BUFFER,i),h.vertexAttribPointer(s,n,h.FLOAT,!1,o*Float32Array.BYTES_PER_ELEMENT,a*Float32Array.BYTES_PER_ELEMENT),t.hO(s,1),h.enableVertexAttribArray(s),h.vertexAttribPointer(r,n,h.FLOAT,!1,o*Float32Array.BYTES_PER_ELEMENT,(a+o)*Float32Array.BYTES_PER_ELEMENT),t.hO(r,1),h.enableVertexAttribArray(r)},TV:(t,e,i,s,r,n)=>{const{attribute:o}=s,a=e.gl;if(a.bindBuffer(a.ARRAY_BUFFER,i),t){const t=o("aLocationA_highpart"),i=o("aLocationA_lowpart"),s=o("aLocationB_highpart"),h=o("aLocationB_lowpart");a.vertexAttribPointer(t,2,a.FLOAT,!1,2*r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),e.hO(t,1),a.enableVertexAttribArray(t),a.vertexAttribPointer(i,2,a.FLOAT,!1,2*r*Float32Array.BYTES_PER_ELEMENT,(n+2)*Float32Array.BYTES_PER_ELEMENT),e.hO(i,1),a.enableVertexAttribArray(i),a.vertexAttribPointer(s,2,a.FLOAT,!1,2*r*Float32Array.BYTES_PER_ELEMENT,(n+r)*Float32Array.BYTES_PER_ELEMENT),e.hO(s,1),a.enableVertexAttribArray(s),a.vertexAttribPointer(h,2,a.FLOAT,!1,2*r*Float32Array.BYTES_PER_ELEMENT,(n+r+2)*Float32Array.BYTES_PER_ELEMENT),e.hO(h,1),a.enableVertexAttribArray(h)}else{const t=o("aLocationA"),i=o("aLocationB");a.vertexAttribPointer(t,2,a.FLOAT,!1,2*r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),e.hO(t,1),a.enableVertexAttribArray(t),a.vertexAttribPointer(i,2,a.FLOAT,!1,2*r*Float32Array.BYTES_PER_ELEMENT,(n+r)*Float32Array.BYTES_PER_ELEMENT),e.hO(i,1),a.enableVertexAttribArray(i)}},FV:(t,e,i,s,r,n,o,a,h,l)=>{const c=t.gl;c.bindBuffer(c.ARRAY_BUFFER,i),c.vertexAttribPointer(s,n,h,a,2*n*l,o*l),t.hO(s,1),c.enableVertexAttribArray(s),c.vertexAttribPointer(r,n,h,a,2*n*l,(o+n)*l),t.hO(r,1),c.enableVertexAttribArray(r)},wc:(t,e,i,s,r,n,o)=>{const a=t.Mz(),{uniform:h,uniformOptional:l}=i,c=1/t.Da.Ra,u=(r?Math.max(n,c):Math.max(n,0))+1;a._R(h("uThicknessPixels"),u)._R(l("uAALimit"),1-(u-1)/u).MR(h("uRatioPxClip"),[2/t.kt().x,2/t.kt().y]),e.Kc(i,s).Nk(o)}},Bm={kV:(t,e,i,s,r,n)=>{const{attribute:o}=s,a=e.gl;if(a.bindBuffer(a.ARRAY_BUFFER,i),t){const t=o("aPos_highpart");a.vertexAttribPointer(t,2,a.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),a.enableVertexAttribArray(t);const e=o("aPos_lowpart");a.vertexAttribPointer(e,2,a.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,(n+2)*Float32Array.BYTES_PER_ELEMENT),a.enableVertexAttribArray(e)}else{const t=o("aPos");a.vertexAttribPointer(t,2,a.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),a.enableVertexAttribArray(t)}},CV:(t,e,i,s,r,n)=>{const o=t.gl;o.bindBuffer(o.ARRAY_BUFFER,i),o.vertexAttribPointer(s,r,o.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),o.enableVertexAttribArray(s)},TV:(t,e,i,s,r,n)=>{const{attribute:o}=s,a=e.gl;if(a.bindBuffer(a.ARRAY_BUFFER,i),t){const t=o("aPos_highpart"),e=o("aPos_lowpart");a.vertexAttribPointer(t,2,a.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),a.enableVertexAttribArray(t),a.vertexAttribPointer(e,2,a.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,(n+2)*Float32Array.BYTES_PER_ELEMENT),a.enableVertexAttribArray(e)}else{const t=o("aPos");a.vertexAttribPointer(t,2,a.FLOAT,!1,r*Float32Array.BYTES_PER_ELEMENT,n*Float32Array.BYTES_PER_ELEMENT),a.enableVertexAttribArray(t)}},IV:(t,e)=>{const i=t.Mz();i.Nk(i.gl.LINE_STRIP,e,0)},LV:(t,e)=>{const i=t.Mz();i.Nk(i.gl.LINES,2*e,0)}},Fm=(t,e,i,s,r,n,o,a,h,l,c=o,u=0)=>{const d=t.gl;if(i){const i=e.attribute(`${r}A_highpart${n}`),f=e.attribute(`${r}A_lowpart${n}`),g=e.attribute(`${r}B_highpart${n}`),p=e.attribute(`${r}B_lowpart${n}`);d.bindBuffer(d.ARRAY_BUFFER,s),d.vertexAttribPointer(i,o,h,a,2*c*l,2*u*l),d.vertexAttribPointer(f,o,h,a,2*c*l,(c+2*u)*l),t.hO(i,1),t.hO(f,1),d.enableVertexAttribArray(i),d.enableVertexAttribArray(f),d.vertexAttribPointer(g,o,h,a,2*c*l,(2*c+2*u)*l),d.vertexAttribPointer(p,o,h,a,2*c*l,(3*c+2*u)*l),t.hO(g,1),t.hO(p,1),d.enableVertexAttribArray(g),d.enableVertexAttribArray(p),d.bindBuffer(d.ARRAY_BUFFER,null)}else{const i=e.attribute(`${r}A${n}`),f=e.attribute(`${r}B${n}`);d.bindBuffer(d.ARRAY_BUFFER,s),d.vertexAttribPointer(i,o,h,a,c*l,(0+u)*l),d.vertexAttribPointer(f,o,h,a,c*l,(c+u)*l),t.hO(i,1),t.hO(f,1),d.enableVertexAttribArray(i),d.enableVertexAttribArray(f),d.bindBuffer(d.ARRAY_BUFFER,null)}};class Dm extends Co{constructor(t,e,i,s,r){super(t,e,i,s,r),this.bD=new cm,this.nu=ai,this.Fz=Mr({lineStyleSolid:()=>cr(this.hc)&&this.hc,lineStyleDashed:()=>gr(this.hc)&&this.hc,strokeFillSolid:()=>{const t=this.hc.getFillStyle();return gs(t)&&t},strokeFillLinearGradient:()=>{const t=this.hc.getFillStyle();return G(t)&&t},strokeFillRadialGradient:()=>{const t=this.hc.getFillStyle();return N(t)&&t},strokeFillPaletted:()=>{const t=this.hc.getFillStyle();return vs(t)&&t}}),this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.PV=this.ZB.mO}Nh(){const t=this.Al(),e=this.hc,i=this.Fz.lineStyleSolid(t),s=this.Fz.lineStyleDashed(t),r=i||s,n=this.Fz.strokeFillSolid(t),o=this.Fz.strokeFillLinearGradient(t),a=this.Fz.strokeFillRadialGradient(t),h=this.Fz.strokeFillPaletted(t),c=n||o||a||h&&["x","y"].includes(h.getLookUpProperty())&&h,u=this.Yt(),d=this.$t(),f=this.ui.T(),p=this.ui.u,m=e.ji();if(s&&this.ai instanceof K)return Ut.console.error("LightningChart JS DashedLine is not supported on logarithmic axis"),this;if(this.bD.FR(this.ai),this.uc&&(this.BV=this.ZB.mR(pe([u,d],this.ai.zt()),!1,this.BV),this.nu=g(l(u.x,u.y),l(d.x,d.y))),t||p){const t=this.dl()&&r&&c&&m>0,e=o?["gradient",o]:a?["gradient",a]:h?["lookup",h.getLookUpProperty(),h.lut]:"uniform";this.DV=t?{type:"triangulated",shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),this.PV?vp.AliasedEdge:void 0,s&&vp.StippleTextureInstanced),mousePickingShader:f?this.ZB.SE(vp["2D"],vp.MousePicking(),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),s&&vp.StippleTextureInstanced):void 0,geometry:wm(this.ZB,m),thickness:m,lineStyleSolid:i,lineStyleDashed:s,fillStyleSolid:n,fillStyleLinearGradient:o,fillStyleRadialGradient:a,fillStylePaletted:h}:void 0}if(a?this.jz=Qp(po(this.nu,{x:this.uu(),y:this.cu()},this.ai),this.ai,a.getPosition(),a.getExtent(),a.getShape(),this.ZB.hR()):o?this.Wz=tm(po(this.nu,{x:this.uu(),y:this.cu()},this.ai),this.ai,o.getAngle(!0),this.ZB.hR()):(this.jz=void 0,this.Wz=void 0),s){if(t||this.uc){const t=[0,0,Math.abs(d.x-u.x),Math.abs(d.y-u.y)];this.EV=this.ZB.mR(t,!1,this.EV)}this.RV=this.ZB.HO(s.getPattern())}else this.EV&&(this.ZB.BR(this.EV),this.EV=void 0),this.RV=void 0;return this.lc(e),this.uc=!1,this.ui.u=!1,this}wc(t,e){var i,s;const r=this.BV;if(!r)return{};const n=this.DV;if(!n)return{};const{fillStyleSolid:o,fillStyleLinearGradient:a,fillStyleRadialGradient:h,fillStylePaletted:l,lineStyleDashed:c,thickness:u}=n,d=1===t?null===(i=this.DV)||void 0===i?void 0:i.mousePickingShader:null===(s=this.DV)||void 0===s?void 0:s.shader;return d?(this.ZB.Kc(d).SR(d,(i,s,d,f)=>{if(this.ZB._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(f("uScaleStart_highpart"),this.bD.tz()).MR(f("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(f("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(f("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(f("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(f("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(i("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(i("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),1===t)this.ZB.ZR(i("uFirstId"),e).UO(d,1);else if(o)this.ZB.UI(i("uColor"),o.getColor());else if(h){if(!this.jz)return!1;this.ZB.PO(d,this.jz,h)}else if(a){if(!this.Wz)return!1;this.ZB.BO(d,this.Wz,a)}else if(l){const t=Er(l,this,void 0);if(!t&&l.lut.percentageValues)return!1;this.ZB.JO(d,l.lut,t)}if(c){if(!this.EV||!this.RV)return!1;Cm.CV(this.ZB,d,this.EV,s("aLengthSoFarA"),s("aLengthSoFarB"),2,2,0),this.ZB.MR(i("uStippleCount"),[this.pi.kt().x/this.RV.ZO,this.pi.kt().y/this.RV.ZO])._R(f("uStippleTextureWidthLimiter"),this.RV.XO/this.RV.ZO)._R(i("uStippleScale"),c.getPatternScale()).wR(i("uStippleTexture"),this.RV.WO,1)}return Cm.kV(this.ai.zt(),this.ZB,r,d,this.ai.zt()?4:2,0),Cm.wc(this.Sz,n.geometry,d,this.PV&&1!==t,1===t,u,1),!0}),{idCount:1}):{}}kc(t,e,i,s,r){return{}}dispose(){return super.dispose(),this.DV=void 0,this.BV&&(this.ZB.BR(this.BV),this.BV=void 0),this.EV&&(this.ZB.BR(this.EV),this.EV=void 0),this.RV=void 0,this}_c(){return this}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return We(this.hc)}cu(){return We(this.hc)}}class Im extends Bo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.OV=[],this.zV=!1,this.VV=!1,this.NV=!1,this.GV=!1,this.$V=!1,this.bD=new cm,this.nu=ai,this.Fz=Mr({lineStyleSolid:()=>cr(this.hc)&&this.hc,lineStyleDashed:()=>gr(this.hc)&&this.hc,lineFillSolid:()=>{const t=this.hc.getFillStyle();return gs(t)&&t},lineFillRadialGradient:()=>{const t=this.hc.getFillStyle();return N(t)&&t},lineFillLinearGradient:()=>{const t=this.hc.getFillStyle();return G(t)&&t},lineIndividualPointFill:()=>{const t=this.hc.getFillStyle();return ms(t)&&t}}),this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.PV=this.ZB.mO,this.UV=t.Da.za}Ho(){const t={Fs:e=>this.YV(t,e),Ii:e=>this.jV(t,e),wA:(e,i)=>this.HV(t,e,i),UI:e=>this.WV(t,e),jt:{x:0,y:0},Ut:{x:0,y:0},gi:0,iP:void 0,XV:this.OV.length,HA:!0,ZV:!0};return this.VV=!0,this.OV.push(t),t}Vi(){return this.OV.length=0,this.zV=!0,this.pi.Ci(this),this}JV(){return this.OV.length}T(t){const e=this.OV[t];return[e.jt,e.Ut]}Bp(){return this.OV}Zd(t){const e=this.OV.indexOf(t);e>=0&&(this.OV.splice(e,1),t.ZV||(this.zV=!0),this.pi.Ci(this))}YV(t,e){if(e&&!t.HA)t.XV=this.OV.length,this.OV.push(t);else if(!e){const e=this.OV.indexOf(t);this.OV.splice(e,1)}return t.HA=e,t.ZV||(this.GV=!0),t}jV(t,e){return t.gi=e,t.ZV||(this.NV=!0),t}HV(t,e,i){return t.jt=e,t.Ut=i,t.ZV||(this.zV=!0),t}WV(t,e){return t.iP=e,t.ZV||(this.$V=!0),t}Nh(){const t=this.ui.T(),e=this.ui.u,i=this.Al(),s=this.hc,r=this.OV,n=this.NV,o=this.zV,a=this.GV,h=this.$V,l=this.VV,c=this.Fz.lineStyleSolid(i),u=this.Fz.lineStyleDashed(i),d=c||u,f=this.Fz.lineFillSolid(i),g=this.Fz.lineIndividualPointFill(i),p=this.Fz.lineFillRadialGradient(i),m=this.Fz.lineFillLinearGradient(i),y=f||g||m||p,x=s.ji(),v=u?"triangulated":s.getThickness()<0?"primitive":"triangulated";if(u&&this.ai instanceof K)return Ut.console.error("LightningChart JS DashedLine is not supported on logarithmic axis"),this;this.bD.FR(this.ai);const A=this.dc,S=o||a,b=!S&&l;if(S||b){const t=S?r:r.filter(t=>t.ZV),e=[],i=t.length;let s=ni,n=ni,o=oi,a=oi;for(let r=0;r<i;r+=1){const i=t[r];e.push(i.jt),e.push(i.Ut),s=Math.min(s,i.jt.x,i.Ut.x),n=Math.min(n,i.jt.y,i.Ut.y),o=Math.max(o,i.jt.x,i.Ut.x),a=Math.max(a,i.jt.y,i.Ut.y)}this.BV=this.ZB.tO(this.BV,pe(e,this.ai.zt()),A*(this.ai.zt()?8:4),S,Float32Array),this.nu=b?Ei(this.nu,{min:{x:s,y:n},max:{x:o,y:a}}):{min:{x:s,y:n},max:{x:o,y:a}}}if(i||e){const e=f?"uniform":g?"attribute":m?["gradient",m]:p?["gradient",p]:void 0,i=d&&y&&x>0&&e;this.DV=i?"triangulated"===v?{type:"triangulated",shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,snapToNearestPixel:this.UV,ensureMinimumSegmentLength:void 0!==this.cc}),this.PV?vp.AliasedEdge:void 0,u&&vp.StippleTextureInstanced,vp.AttributeHighlight),mousePicking:t?{shader:this.ZB.SE(vp["2D"],vp.MousePicking({useAttribute:!0}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,snapToNearestPixel:this.UV,ensureMinimumSegmentLength:void 0!==this.cc}),u&&vp.StippleTextureInstanced,vp.AttributeHighlight)}:void 0,geometry:wm(this.ZB,x,!1),thickness:x,lineStyleSolid:c,lineStyleDashed:u,fillStyleSolid:f,fillStyleIndividual:g,fillStyleLinearGradient:m,fillStyleRadialGradient:p}:{type:"primitive",shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0,snapToNearestPixel:this.UV}),vp.AttributeHighlight),mousePicking:t?{shader:this.ZB.SE(vp["2D"],vp.MousePicking({useAttribute:!0}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0,snapToNearestPixel:this.UV}),vp.AttributeHighlight)}:void 0,lineStyleSolid:c,lineStyleDashed:u,fillStyleSolid:f,fillStyleIndividual:g,fillStyleLinearGradient:m,fillStyleRadialGradient:p}:void 0}if(u){if(i||S||b){const t=S||i?r:r.filter(t=>t.ZV),e=new Float32Array(4*t.length);let s=0;for(let i=0;i<t.length;i+=1){const r=t[i].jt,n=t[i].Ut;e[s]=0,e[s+1]=0,e[s+2]=Math.abs(n.x-r.x),e[s+3]=Math.abs(n.y-r.y),s+=4}this.EV=this.ZB.tO(this.EV,e,4*A,S||i,Float32Array)}this.RV=this.ZB.HO(u.getPattern())}else this.EV&&(this.ZB.BR(this.EV.buffer),this.EV=void 0),this.RV=void 0;if(n||S||b){const t="triangulated"===v?1:2,e=S||n?r:r.filter(t=>t.ZV),i=new Float32Array(e.length*t);let s=0;e.forEach(e=>{for(let r=0;r<t;r+=1)i[s+r]=e.gi;s+=t}),this.QV=this.ZB.tO(this.QV,i,A*t,S||n,Float32Array)}if((h||S||b||i)&&g){const t=S||h||i?r:r.filter(t=>t.ZV),e=new Uint32Array(2*t.length);let s=0;t.forEach(t=>{const i=(t.iP||g.color).toUint32();for(let t=s;t<s+2;t+=1)e[t]=i;s+=2}),this.KV=this.ZB.tO(this.KV,e,2*A,S||h,Uint32Array)}if(t){if(S||b||e){const t="triangulated"===v?1:2,i=S||e?r:r.filter(t=>t.ZV),s=new Float32Array(i.length*t);let n=0;i.forEach(e=>{for(let i=0;i<t;i+=1)s[n+i]=e.XV||0;n+=t}),this.qV=this.ZB.tO(this.qV,s,A*t,S,Float32Array)}}else this.qV&&(this.ZB.BR(this.qV.buffer),this.qV=void 0);p?this.Rz=Qp(this.Ai||this.nu,this.ai,p.getPosition(),p.getExtent(),p.getShape(),this.ZB.hR()):m?this.Oz=tm(this.Ai||this.nu,this.ai,m.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0),this.lc(s),this.NV=!1,this.GV=!1,this.zV=!1,this.$V=!1,this.ui.u=!1,this.VV=!1;for(const t of r)t.ZV=!1;return this}wc(t,e){var i;const s=this.BV,r=this.QV,n=this.qV;if(!s||!r)return{};const o=this.DV;if(!o)return{};const{type:a,fillStyleSolid:h,fillStyleIndividual:l,fillStyleLinearGradient:c,fillStyleRadialGradient:u,lineStyleDashed:d}=o,f=1===t?null===(i=o.mousePicking)||void 0===i?void 0:i.shader:o.shader;return f?(this.ZB.Kc(f).SR(f,(i,f,g,p)=>{if(this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(p("uScaleStart_highpart"),this.bD.tz()).MR(p("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(p("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(p("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(p("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(p("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(i("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(i("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),this.UV&&this.ZB.MR(p("uViewportSizePx"),[this.pi.kt().x*this.ZB.hR(),this.pi.kt().y*this.ZB.hR()]),void 0!==this.cc&&this.ZB.MR(i("uMinSegmentPixelVector"),[this.cc.x,this.cc.y]),this.ZB.UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),1===t){if(this.ZB.ZR(i("uFirstId"),e),!n)return!1;"triangulated"===a?this.ZB.bR(n.buffer,1,{location:f("aPickingIdOffset"),size:1}):this.ZB.aO(f("aPickingIdOffset"),n.buffer)}else if(h)this.ZB.UI(i("uColor"),h.getColor());else if(l){if(!this.KV)return!1;if("triangulated"===a)Cm.FV(this.ZB,g,this.KV.buffer,f("aColorA"),f("aColorB"),4,0,!0,this.ZB.gl.UNSIGNED_BYTE,1);else{const t=f("aColor");this.ZB.gl.bindBuffer(this.ZB.gl.ARRAY_BUFFER,this.KV.buffer),this.ZB.gl.vertexAttribPointer(t,4,this.ZB.gl.UNSIGNED_BYTE,!0,0,0),this.ZB.gl.enableVertexAttribArray(t)}}else if(u){if(!this.Rz)return!1;this.ZB.PO(g,this.Rz,u)}else if(c){if(!this.Oz)return!1;this.ZB.BO(g,this.Oz,c)}if(d){if(!this.EV||!this.RV)return!1;Cm.FV(this.ZB,g,this.EV.buffer,f("aLengthSoFarA"),f("aLengthSoFarB"),2,0,!1,this.ZB.gl.FLOAT,Float32Array.BYTES_PER_ELEMENT),this.ZB.MR(i("uStippleCount"),[this.pi.kt().x/this.RV.ZO,this.pi.kt().y/this.RV.ZO])._R(p("uStippleTextureWidthLimiter"),this.RV.XO/this.RV.ZO)._R(i("uStippleScale"),d.getPatternScale()).wR(i("uStippleTexture"),this.RV.WO,0)}if("triangulated"===a){const{geometry:e,thickness:i}=o;Cm.TV(this.ai.zt(),this.ZB,s.buffer,g,this.ai.zt()?4:2,0),this.ZB.bR(r.buffer,1,{location:f("aIsHighlighted"),size:1}),Cm.wc(this.Sz,e,g,this.PV&&1!==t,1===t,i,this.OV.length)}else Bm.TV(this.ai.zt(),this.ZB,s.buffer,g,this.ai.zt()?4:2,0),this.ZB.aO(f("aIsHighlighted"),r.buffer),Bm.LV(this.Sz,this.OV.length);return!0}),{idCount:this.OV.length}):{}}dispose(){return super.dispose(),this.DV=void 0,this.BV&&(this.ZB.BR(this.BV.buffer),this.BV=void 0),this.EV&&(this.ZB.BR(this.EV.buffer),this.EV=void 0),this.QV&&(this.ZB.BR(this.QV.buffer),this.QV=void 0),this.qV&&(this.ZB.BR(this.qV.buffer),this.qV=void 0),this.KV&&(this.ZB.BR(this.KV.buffer),this.KV=void 0),this.RV=void 0,this}kc(t,e,i,s,r){return{collectionMember:this.OV.find(i=>e+i.XV===t)}}_c(){return this}Ii(t){super.Ii(t);for(const e of this.OV)e.Ii(t);return this}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return We(this.hc)}cu(){return We(this.hc)}}class Rm{constructor(t,e){this.tN=!1,this.iN=!1,this.ai=t,this.sN=e,this.sN.wi("DataPattern",t=>{"ProgressiveX"!==t.pattern&&"RegressiveX"!==t.pattern||(this.tN="x"),"ProgressiveY"!==t.pattern&&"RegressiveY"!==t.pattern||(this.tN="y"),"RegressiveX"!==t.pattern&&"RegressiveY"!==t.pattern||(this.iN=!0)})}calculateUserDataPointsProgressiveRange(t){if(0===t.length)throw new Error("calculateUserDataPointsProgressiveRange called with 0 data points");return{start:"x"===this.tN?t[0].x:t[0].y,end:"x"===this.tN?t[t.length-1].x:t[t.length-1].y}}calculateUserDataPointsBoundaries(t){return this.tN?"x"===this.tN?function(t){const e=t.length;if(e>0){const i=Math.max(t[e-1].x,t[0].x),s=Math.min(t[e-1].x,t[0].x);let r=t[0].y,n=t[0].y;for(let i=0;i<e;i+=1){const e=t[i];e.y>r&&(r=e.y),e.y<n&&(n=e.y)}return g(l(s,n),l(i,r))}return ai}(t):function(t){const e=t.length;if(e>0){const i=Math.max(t[e-1].y,t[0].y),s=Math.min(t[e-1].y,t[0].y);let r=t[0].x,n=t[0].x;for(let i=0;i<e;i+=1){const e=t[i];e.x>r&&(r=e.x),e.x<n&&(n=e.x)}return g(l(n,s),l(r,i))}return ai}(t):bi(t)}calculateAvgStepBetweenDataPoints(t,e,i){return Math.abs(t-e)/(i-1)}}const Lm=Math.min(1,1.5);class Pm extends Rm{constructor(t,e,i){super(t,e),this.eN=!1,this.rN={enabled:!1,totalDataPointsAtTime:0},this.hN=[],this.Bs=i,this.nN=t instanceof q?{type:"linear",scale:t}:t instanceof K?{type:"mixed",scale:t}:{type:"unknown"},this.sN.wi("DataPattern",t=>{!1===t.allowDataGrouping&&(this.eN=!0)})}oN(t,e=!1){if(this.eN||!this.tN||"linear"!==this.nN.type)return!1;!1===e&&this.aN&&(clearTimeout(this.aN),this.aN=void 0);const i="x"===this.tN?this.nN.scale.x.Jf:this.nN.scale.y.Jf;if(!i)throw new Error("CP helper has no information about Axis state.");const s=t.length;if(s<2)return!1;const r=t[0],n=t[s-1],o=this.calculateAvgStepBetweenDataPoints("x"===this.tN?r.x:r.y,"x"===this.tN?n.x:n.y,s),a=this.nN.scale,h=Math.abs("x"===this.tN?a.ni().x:a.ni().y),l=h/o,c=Math.floor(l*Lm),u=c*o,d=Ut.performance.now(),f=!(d-i.$r<500)&&(i.Rr?d-i.Gr<1e3:d-i.Or<2e3||i.Vr),g=s>2*this.rN.totalDataPointsAtTime;if(f&&!g)return this.aN=setTimeout(()=>this.lN(t),1e3),!1;const p=c>=10,m=this.rN.enabled?this.rN.columnWidthAxis/h<1.5:void 0,y=this.rN.enabled&&c>this.rN.dataPointsPerColumn?c/this.rN.dataPointsPerColumn>=2:void 0;let x;!0===this.rN.enabled?m?y&&(x={enabled:!0,columnWidthAxis:u,dataPointsPerColumn:c,totalDataPointsAtTime:s}):x=p?{enabled:!0,columnWidthAxis:u,dataPointsPerColumn:c,totalDataPointsAtTime:s}:{enabled:!1,totalDataPointsAtTime:s}:p&&(x={enabled:!0,columnWidthAxis:u,dataPointsPerColumn:c,totalDataPointsAtTime:s});const v=!1===e;return x?(v&&(this.rN=x),!0):(v&&(this.rN={...this.rN,totalDataPointsAtTime:s}),!1)}uN(){this.cN=void 0,this.hN.length=0,this.aN&&(clearTimeout(this.aN),this.aN=void 0)}dN(t){if(0===t.length)return t;if(this.eN||!this.tN||"linear"!==this.nN.type||!this.rN.enabled)return t;let e;e=this.hN.length>0?Be(this.hN,t,{canReturnB:!0}):t;const i=e.length,s=[];let r,n,o=void 0===this.cN,a=-1,h=-1,l=0,c=0;if("x"!==this.tN||this.iN)if("x"===this.tN&&this.iN){const t=this.rN.columnWidthAxis;let u=this.cN?this.cN.x:e[0].x,d=u-t;for(let f=0;f<i;f+=1){const i=e[f];i.x>=d?((!r||i.y>r.y)&&(r=i,a=f),(!n||i.y<n.y)&&(n=i,h=f),c=f):(r&&n&&(o&&s.push(e[0]),a<h?s.push(r,n):s.push(n,r)),o=!1,u=i.x,d=u-t,r=i,a=f,n=i,h=f,l=f,c=f)}}else if("y"!==this.tN||this.iN){if("y"===this.tN&&this.iN){const t=this.rN.columnWidthAxis;let u=this.cN?this.cN.y:e[0].y,d=u-t;for(let f=0;f<i;f+=1){const i=e[f];i.y>=d?((!r||i.x>r.x)&&(r=i,a=f),(!n||i.x<n.x)&&(n=i,h=f),c=f):(n&&r&&(o&&s.push(e[0]),a<h?s.push(r,n):s.push(n,r)),o=!1,u=i.y,d=u-t,r=i,a=f,n=i,h=f,l=f,c=f)}}}else{const t=this.rN.columnWidthAxis;let u=this.cN?this.cN.y:e[0].y,d=u+t;for(let f=0;f<i;f+=1){const i=e[f];i.y<=d?((!r||i.x>r.x)&&(r=i,a=f),(!n||i.x<n.x)&&(n=i,h=f),c=f):(n&&r&&(o&&s.push(e[0]),a<h?s.push(r,n):s.push(n,r)),o=!1,u=i.y,d=u+t,r=i,a=f,n=i,h=f,l=f,c=f)}}else{const t=this.rN.columnWidthAxis;let u=this.cN?this.cN.x:e[0].x,d=u+t;for(let f=0;f<i;f+=1){const i=e[f];i.x<=d?((!r||i.y>r.y)&&(r=i,a=f),(!n||i.y<n.y)&&(n=i,h=f),c=f):(r&&n&&(o&&s.push(e[0]),a<h?s.push(r,n):s.push(n,r)),o=!1,u=i.x,d=u+t,r=i,a=f,n=i,h=f,l=f,c=f)}}if(r||n){const t=e.slice(l,c+1);this.hN=t}else this.hN.length=0;const u=s.length;return u>0&&(this.cN=s[u-1]),s}fN(t){var e,i;if(this.tN&&"linear"===this.nN.type){const s="x"===this.tN?this.nN.scale.x.Jf:this.nN.scale.y.Jf;if(!s)throw new Error("CP helper has no information about Axis state.");if((null===(e=s.Rh)||void 0===e?void 0:e.id)===pn||(null===(i=s.Rh)||void 0===i?void 0:i.id)===mn){const e=Math.abs("x"===this.tN?this.nN.scale.x.getInnerInterval():this.nN.scale.y.getInnerInterval());if(this.rN.enabled)return 2*e/this.rN.columnWidthAxis;const i=t.length,s=t[0],r=t[i-1];return e/this.calculateAvgStepBetweenDataPoints("x"===this.tN?s.x:s.y,"x"===this.tN?r.x:r.y,i)}}}AN(t,e,i){if(!this.tN)return e;const s=i.length;let r=ft(i,t.min,this.tN,this.iN,0,s-1);void 0===r&&(r=this.iN?s-1:0);let n=ft(i,t.max,this.tN,this.iN,0,s-1);return void 0===n&&(n=this.iN?0:s-1),1+Math.abs(n-r)}gN(){this.aN&&(clearTimeout(this.aN),this.aN=void 0)}lN(t){this.oN(t,!0)&&this.Bs()}}class zm extends Rm{renderVisibleOnly(t,e,i=!1){const s=this.ai.x.getInnerStart(),r=this.ai.x.getInnerEnd(),n=Math.min(s,r),o=Math.max(s,r),a=this.ai.y.getInnerStart(),h=this.ai.y.getInnerEnd(),l=Math.min(a,h),c=Math.max(a,h);t.forEach((t,s)=>{t.existingCoordinatesCount<=1||!1===i&&(t.boundaries.max.x<n||t.boundaries.min.x>o||t.boundaries.max.y<l||t.boundaries.min.y>c)||e(t)})}}class _m{constructor(t,e,i){this.pN=e,this.vN=i,this.yN=t,this.mN=[]}xN(t,e,i,s){const r=t.length;if(0===r)return;let n=t,o=r,a=this.yN[this.yN.length-1];do{const t=this.yN.length;let r;a||(a=this.SN(e,o)),a&&0==a.allocatedCoordinatesCount-a.existingCoordinatesCount&&(a=void 0);let h=0;if(this.vN&&t>0&&(void 0===a||0===a.existingCoordinatesCount)){const e=this.yN[t-1].lastDataPoint;e?(n.splice(0,0,e),h=1,o+=1):console.error("SegmentationHelper _connectSegments = true, but segment has no lastDataPoint information!")}if(a)r=Math.min(o,a.allocatedCoordinatesCount-a.existingCoordinatesCount),s(a,n.slice(0,r),r,h);else{const t=Math.ceil(e)+h;r=Math.min(t,o);const s={...i(t,n.slice(0,r),r,h),isDropped:!1};this.yN.push(s)}r>0&&(o>r?(n=n.slice(r),o=n.length):(n=[],o=0))}while(o>0);this.bN()}MN(t){const e=t,i=this.yN.indexOf(e);i>=0&&this.yN.splice(i,1),e.droppedTimestamp=Ut.performance.now(),this.mN.push(e)}wN(){this.yN.slice().forEach(t=>this.MN(t))}_N(){this.yN.forEach(t=>this.pN(t)),this.mN.forEach(t=>this.pN(t)),this.yN.length=0,this.mN.length=0}SN(t,e){const i=2*t/3,s=4*t/3,r=this.mN.findIndex(t=>t.allocatedCoordinatesCount>=i&&t.allocatedCoordinatesCount<=s);if(r>=0){const t=this.mN[r];return this.mN.splice(r,1),this.yN.push(t),t}}bN(){if(this.mN.length>5){const t=Ut.performance.now();for(let e=0;e<this.mN.length-5;e+=1){const i=this.mN[e];(void 0===i.droppedTimestamp||t-i.droppedTimestamp>=1e4)&&(this.pN(i),this.mN.splice(e,1),e-=1)}}}}class Vm extends Rm{kN(t,e){if(!e||"object"!=typeof e)return 0;const i=this.ai.x.getInnerStart(),s=this.ai.x.getInnerEnd(),r=Math.min(i,s),n=Math.max(i,s),o=this.ai.y.getInnerStart(),a=this.ai.y.getInnerEnd(),h=Math.min(o,a),l=Math.max(o,a);if("maxDataPointCount"in e)return this.CN(t,e.maxDataPointCount,r,n,h,l);if("minDataPointCount"in e)return this.TN(t,e.minDataPointCount,r,n,h,l);if("progressiveDataCleaningThreshold"in e)return this.FN(t,e.progressiveDataCleaningThreshold,r,n,h,l);throw new Error(`Unimplemented data cleaning configuration: ${JSON.stringify(e)}`)}CN(t,e,i,s,r,n){if(void 0===e||e<=0)return 0;const o=t.reduce((t,e)=>t+e.existingDataPointsCount,0);if(o<=e)return 0;let a=0,h=o;for(let i=0;i<t.length;i+=1){const s=t[i];h>e&&(a+=1,h-=s.existingDataPointsCount)}return a}FN(t,e,i,s,r,n){if(void 0===e||!this.tN)return 0;let o=0;for(let a=0;a<t.length;a+=1){const h=t[a],l=this.iN?"x"===this.tN?h.boundaries.min.x>s:h.boundaries.min.y>n:"x"===this.tN?h.boundaries.max.x<i:h.boundaries.max.y<r;if(!((this.iN?"x"===this.tN?h.boundaries.min.x>e:h.boundaries.min.y>e:"x"===this.tN?h.boundaries.max.x<e:h.boundaries.max.y<e)&&l&&h.existingCoordinatesCount>2))break;o+=1}return o}TN(t,e,i,s,r,n){if(void 0===e||0===e)return 0;let o=0,a=0;for(let h=t.length-1;h>=0;h-=1){const l=t[h];if(a>e)if(this.tN){if(this.iN?"x"===this.tN?l.boundaries.min.x>s:l.boundaries.min.y>n:"x"===this.tN?l.boundaries.max.x<i:l.boundaries.max.y<r){o=1+h;break}}else l.boundaries.max.x<i||l.boundaries.min.x>s||l.boundaries.max.y<r||l.boundaries.min.y>n?o+=1:o=0;a+=l.existingDataPointsCount}return o}IN(t,e){const i=t.reduce((t,e)=>Ei(t,e.boundaries),ai);if(e&&"progressiveDataCleaningThreshold"in e&&e.progressiveDataCleaningThreshold){const t=e.progressiveDataCleaningThreshold;"x"!==this.tN||this.iN?"x"===this.tN&&this.iN?i.max.x=Math.min(i.max.x,t):"y"!==this.tN||this.iN?"y"===this.tN&&this.iN&&(i.max.y=Math.min(i.max.y,t)):i.min.y=Math.max(i.min.y,t):i.min.x=Math.max(i.min.x,t)}return i}}class Nm extends Fo{constructor(t,e,i,s,r,n){super(t,e,i,s,r),this.bD=new cm,this._b=[],this.LN=new zm(this.ai,this),this.PN=new Pm(this.ai,this,()=>this.pi.Bs()),this.DN=new _m(this._b,t=>{t.coordsBuffer&&this.ZB.BR(t.coordsBuffer),t.EV&&this.ZB.BR(t.EV)},!0),this.EN=new Vm(this.ai,this),this.RN=0,this.ON=0,this.zN=!1,this.Fz=Mr({lineStyleSolid:()=>cr(this.hc)&&this.hc,lineStyleDashed:()=>gr(this.hc)&&this.hc,strokeFillSolid:()=>{const t=this.hc.getFillStyle();return gs(t)&&t},strokeFillLinearGradient:()=>{const t=this.hc.getFillStyle();return G(t)&&t},strokeFillRadialGradient:()=>{const t=this.hc.getFillStyle();return N(t)&&t},strokeFillPaletted:()=>{const t=this.hc.getFillStyle();return vs(t)&&t}}),this.bz=e,this.Da=n,this.DV={type:"none"},this.ZB=t.Mz(),this.Sz=t,this.PV=this.ZB.mO;const o=this.ai.zt(),a=!0===(null==n?void 0:n.individualLookupValuesEnabled);let h,l,c,u=0;o||(h=u,u+=2),o&&(l=u,u+=4),a&&(c=u,u+=1);const d=((t,e)=>e?(e,i)=>((t,e)=>{if(!e){const e=t.length,i=new Float32Array(3*e);for(let s=0,r=0;s<e;s+=1){const e=t[s];i[r+0]=e.x,i[r+1]=e.y,i[r+2]=void 0!==e.value?e.value:0,r+=3}return i}const i=t.length,s=new Float32Array(5*i);let r=0;for(let e=0;e<i;e+=1){const i=t[e],n=Math.fround(i.x),o=Math.fround(i.y);s[r+0]=n,s[r+1]=o,s[r+2]=i.x-n,s[r+3]=i.y-o,s[r+4]=void 0!==i.value?i.value:0,r+=5}return s})(e,t):(e,i)=>pe(e,t,Float32Array))(o,a);this.VN={individualLookupValuesEnabled:a,attributesPerVertex:u,attributeOffsetCoordinateLowPrecision:h,attributeOffsetCoordinateHighPrecision:l,attributeOffsetLookUpValue:c,prepareRenderData:(t,e)=>d(t,this.hc.getFillStyle())}}NN(t,e,i){const s=new Float32Array(2*e);let r=0,n=i||t[0];for(let i=0;i<e;i+=1){const e=t[i];this.RN+=Math.abs(n.x-e.x),this.ON+=Math.abs(n.y-e.y),s[r]=this.RN,s[r+1]=this.ON,r+=2,n=e}return s}Nh(){const t=this.mu,e=this.hc,i=this.Al(),s=this.pu,r=s.length,n=r>0,o=this.ui.T(),a=this.ui.u,h=this.Fz.lineStyleSolid(i),l=this.Fz.lineStyleDashed(i),c=h||l,u=c&&c.getThickness(),d=this.Fz.strokeFillSolid(i),f=this.Fz.strokeFillLinearGradient(i),g=this.Fz.strokeFillRadialGradient(i),p=this.Fz.strokeFillPaletted(i),m=d||f||g||p,y=this.VN.individualLookupValuesEnabled;if(l&&this.ai instanceof K)return Ut.console.error("LightningChart JS DashedLine is not supported on logarithmic axis"),this;n&&(this.fc=Be(this.fc,s,{canReturnB:!0}),this.Ac+=r);let x=this.gc.u;const v=this.EN.kN(this._b,this.gc.T());if(v>0){let t=0;for(let e=0;e<v;e+=1){const e=this._b[0];t+=e.existingDataPointsCount,e.existingDataPointsCount=0,e.existingCoordinatesCount=0,e.jointPointsCount=0,e.boundaries=ai,e.lastDataPoint=void 0,this.DN.MN(e)}this.fc=this.fc.slice(t),this.Ac=this.fc.length,x=!0}let A=s,S=!1;(this.PN.oN(this.fc)||t)&&(S=!0),l&&!this.zN?(S=!0,this.zN=!0,this.DN._N()):!l&&this.zN&&(this._b.forEach(t=>{t.EV&&(this.ZB.BR(t.EV),t.EV=void 0)}),this.zN=!1),S&&(this.PN.uN(),this._b.forEach(t=>{t.existingDataPointsCount=0,t.existingCoordinatesCount=0,t.jointPointsCount=0,t.boundaries=ai,t.lastDataPoint=void 0}),this.DN.wN(),A=this.fc,this.RN=0,this.ON=0);const b=this.PN.dN(A),M=b.length;if(M>0){let t=this.PN.fN(this.fc)||(this.wi("ApplicationType",t=>"InternalUI"===t.type)?this.Ac:1e5);M/t>10&&(t=M/10),this.DN.xN(b,t,(t,e,i,s)=>{const r=this.LN.calculateUserDataPointsBoundaries(e),n=this.PN.AN(r,i,this.fc)-s;return this.GN=e[i-1],{allocatedCoordinatesCount:t,existingDataPointsCount:n,existingCoordinatesCount:i,jointPointsCount:s,boundaries:r,coordsBuffer:this.ZB.KR(t*this.VN.attributesPerVertex,this.VN.prepareRenderData(e,i)),lastDataPoint:e[i-1],EV:this.zN?this.ZB.KR(2*t,this.NN(e,i,this.GN)):void 0}},(t,e,i,s)=>{const r=Ei(t.boundaries,this.LN.calculateUserDataPointsBoundaries(e)),n=this.PN.AN(r,t.existingCoordinatesCount+i,this.fc)-(t.jointPointsCount+s);this.ZB.qR(t.coordsBuffer,t.existingCoordinatesCount*this.VN.attributesPerVertex,this.VN.prepareRenderData(e,i)),this.zN&&t.EV&&this.ZB.qR(t.EV,2*t.existingCoordinatesCount,this.NN(e,i,this.GN)),this.GN=e[i-1],t.jointPointsCount+=s,t.lastDataPoint=e[i-1],t.existingDataPointsCount=n,t.existingCoordinatesCount+=i,t.boundaries=r})}if(x&&(this.nu=this.EN.IN(this._b,this.gc.T())),this.bD.FR(this.ai),g?this.jz=Qp(this.Ai||this.nu,this.ai,g.getPosition(),g.getExtent(),g.getShape(),this.ZB.hR()):f?this.Wz=tm(this.Ai||this.nu,this.ai,f.getAngle(!0),this.ZB.hR()):(this.jz=void 0,this.Wz=void 0),i||a){if(p&&"value"===p.getLookUpProperty()&&!y){const t='LCJS misusage error: Series individualLookupValuesEnabled flag must be set if using PalettedFill with lookUpProperty="value" !';throw Ut.alert(t),new Error(t)}if(m&&c&&!1!==u){const t=-1===u?"primitive":"triangulated",e=f?["gradient",f]:g?["gradient",g]:p?["lookup",p.getLookUpProperty(),p.lut]:"uniform";this.DV="primitive"===t?{type:t,shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),l&&vp.StippleTexture),mousePickingShader:o?this.ZB.SE(vp["2D"],vp.MousePicking({useVertexId:!0}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),l&&vp.StippleTexture):void 0,lineStyleSolid:h,lineStyleDashed:l,fillStyleSolid:d,fillStyleLinearGradient:f,fillStyleRadialGradient:g,fillStylePaletted:p}:"triangulated"===t?{type:t,shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),this.PV?vp.AliasedEdge:void 0,l&&vp.StippleTextureInstanced),mousePickingShader:o?this.ZB.SE(vp["2D"],vp.MousePicking(),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),l&&vp.StippleTextureInstanced):void 0,geometry:wm(this.ZB,u),thickness:u,lineStyleSolid:h,lineStyleDashed:l,fillStyleSolid:d,fillStyleLinearGradient:f,fillStyleRadialGradient:g,fillStylePaletted:p}:{type:"none"}}else this.DV={type:"none"}}return this.RV=l?this.ZB.HO(l.getPattern()):void 0,this.lc(e),this.mu=!1,this.pu=[],this.ui.u=!1,this}wc(t,e){const i=this.ZB.gl,s=this.DV;if(!s||"none"===s.type)return{};const r=1===t?s.mousePickingShader:s.shader;if(!r)return{};const{lineStyleDashed:n,fillStyleSolid:o,fillStyleLinearGradient:a,fillStyleRadialGradient:h,fillStylePaletted:l}=s;return this.ZB.Kc(r).SR(r,(r,c,u,d)=>{let f=!1;if(this.ZB._R(r("uIsHighlighted"),1===t||2===t?0:this.gi).UI(r("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(r("uRenderEffectMask"),2===t?1:0),this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(r("uScale"),this.bD.kR()).MR(r("uDisp"),this.bD.CR()).MR(d("uScaleStart_highpart"),this.bD.tz()).MR(d("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(d("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(d("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(d("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(d("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(r("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(r("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),1===t);else if(o)this.ZB.UI(r("uColor"),o.getColor());else if(h){if(!this.jz)return!1;this.ZB.PO(u,this.jz,h)}else if(a){if(!this.Wz)return!1;this.ZB.BO(u,this.Wz,a)}else if(l){const t=Er(l,this,void 0);if(!t&&l.lut.percentageValues)return!1;this.ZB.JO(u,l.lut,t)}const g=ti(e);return this.LN.renderVisibleOnly(this._b,e=>{const{coordsBuffer:o}=e;if(!o)return;if(1===t){const[t,i]=g.ss(e.existingDataPointsCount);this.ZB.ZR(r("uFirstId"),t),"triangulated"===s.type?this.ZB.UO(u,i):this.ZB.GO(u,i)}i.bindBuffer(i.ARRAY_BUFFER,o);const a="triangulated"===s.type?Cm.kV:Bm.kV;if(this.ai.zt()||void 0===this.VN.attributeOffsetCoordinateLowPrecision?this.ai.zt()&&void 0!==this.VN.attributeOffsetCoordinateHighPrecision&&a(!0,this.ZB,o,u,this.VN.attributesPerVertex,this.VN.attributeOffsetCoordinateHighPrecision):a(!1,this.ZB,o,u,this.VN.attributesPerVertex,this.VN.attributeOffsetCoordinateLowPrecision),n){if(!e.EV||!this.RV)return;"triangulated"===s.type?Cm.CV(this.ZB,u,e.EV,c("aLengthSoFarA"),c("aLengthSoFarB"),2,2,0):Bm.CV(this.ZB,u,e.EV,c("aLengthSoFar"),2,0),this.ZB.MR(r("uStippleCount"),[this.pi.kt().x/this.RV.ZO,this.pi.kt().y/this.RV.ZO])._R(d("uStippleTextureWidthLimiter"),this.RV.XO/this.RV.ZO)._R(r("uStippleScale"),n.getPatternScale()).wR(r("uStippleTexture"),this.RV.WO,1)}if(l&&"value"===l.lookUpProperty&&void 0!==this.VN.attributeOffsetLookUpValue&&1!==t)if("triangulated"===s.type){const t=c("aLookupValueA");i.vertexAttribPointer(t,1,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetLookUpValue*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(t,1),i.enableVertexAttribArray(t);const e=c("aLookupValueB");i.vertexAttribPointer(e,1,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,(this.VN.attributeOffsetLookUpValue+this.VN.attributesPerVertex)*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(e,1),i.enableVertexAttribArray(e)}else{const t=c("aLookupValue");i.vertexAttribPointer(t,1,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetLookUpValue*Float32Array.BYTES_PER_ELEMENT),i.enableVertexAttribArray(t)}if("triangulated"===s.type){const{thickness:i}=s;Cm.wc(this.Sz,s.geometry,u,this.PV&&1!==t,1===t,i,e.existingCoordinatesCount-1)}else Bm.IV(this.Sz,e.existingCoordinatesCount);f=!0},void 0===this.us),i.bindBuffer(i.ARRAY_BUFFER,null),f}),{idCount:this.Ac}}kc(t,e,i,s,r){return{}}bu(t,e){return Array.isArray(t)||(t=[t]),this.pu=Be(this.pu,t,{canReturnB:!0}),this.nu=Ei(this.nu,e||e||this.LN.calculateUserDataPointsBoundaries(t)),this}Vi(){return super.Vi(),this.RN=0,this.ON=0,this.GN=void 0,this}dispose(){return super.dispose(),this.DN._N(),this.PN.gN(),this.DV={type:"none"},this.RV=void 0,this}_c(){return this}gS(t){this.Tu()>0&&this.Nh();const e=this.Mu(),i=lt(e,t,this.Mi(),this.xu,this.Su,this.ai,this.engine.ai,this.nu,this.LN.tN,this.LN.iN);return void 0!==i?e[i]:void 0}Eb(t){this.Tu()>0&&this.Nh();const e=this.Mu(),i=e.length;if(0===i)return;const s=this.xu?1:0,r=i-(this.Su?2:1),n=this.Mi();if(n===ht.Nearest){let s,r,n=ni;for(let o=0;o<i;o+=1){const i=tt(e[o],this.ai,this.pi.ai);if(void 0!==r){const e=pi(r,i,t),o=(e.x-t.x)**2+(e.y-t.y)**2;o<n&&(n=o,s=e)}r=i}return void 0!==s?tt(s,this.pi.ai,this.ai):void 0}if("x"===this.LN.tN&&n===ht.NearestX||"y"===this.LN.tN&&n===ht.NearestY){const i=gt(e,tt(t,this.pi.ai,this.ai),this.LN.tN,this.LN.iN,s,r);return i?Ai(e[i.a],e[i.b],i.lerpAmount):void 0}return this.gS(t)}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return We(this.hc)}cu(){return We(this.hc)}}class Om extends Ao{constructor(t,e,i,s,r){super(t,e,i,s,r),this.DV={fill:void 0,border:void 0},this.bD=new cm,this.nu=ai,this.$N=!1,this.UN=!1,this.YN=!1,this.jN=!1,this.HN=!1,this.Wd=[],this.Fz=Mr({polygonStyleSolid:()=>gs(this.Ze)&&this.Ze,polygonStyleImage:()=>wt(this.Ze)&&this.Ze,polygonStyleRadialGradient:()=>N(this.Ze)&&this.Ze,polygonStyleLinearGradient:()=>G(this.Ze)&&this.Ze,polygonStylePaletted:()=>vs(this.Ze)&&this.Ze,polygonStyleIndividual:()=>ms(this.Ze)&&this.Ze,lineStyleSolid:()=>cr(this.Je)&&this.Je,lineStyleDashed:()=>gr(this.Je)&&this.Je,lineStyleFilled:()=>{const t=this.Je&&this.Je.getFillStyle();return gs(t)&&t}}),this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.PV=this.ZB.mO}Ho(){const t={Fs:e=>this.YV(t,e),Ii:e=>this.jV(t,e),au:e=>this.WN(t,e),Bx:e=>this.XN(t,e),UI:e=>this.WV(t,e),hu:[],M:void 0,ZN:void 0,gi:0,HA:!0,JN:this.Wd.length};return this.Wd.push(t),t}Vi(){return this.Wd.length=0,this.$N=!0,this.pi.Ci(this),this}Bp(){return this.Wd}Zd(t){const e=this.Wd.indexOf(t);e>=0&&(this.Wd.splice(e,1),this.HN=!0,this.pi.Ci(this,t))}YV(t,e){return t.HA=e,this.HN=!0,t.HA||this.pi.Ci(this,t),t}jV(t,e){return t.gi=e,this.jN=!0,t}WN(t,e){return t.hu=e,this.$N=!0,t}XN(t,e){return t.M=e,this.UN=!0,t}WV(t,e){return t.ZN=null==e?void 0:e.toUint32(),this.YN=!0,t}Nh(){const t=this.ui.T(),e=this.ui.u,i=this.ll(),s=this.jN,r=this.$N,n=this.UN,a=this.YN,h=this.HN,l=this.Je,c=this.Al(),u=this.Wd.filter(t=>t.HA&&t.hu.length>0);if(this.bD.FR(this.ai),(r||h)&&(this.nu=Ei(...u.map(t=>bi(t.hu)))),r||h){const t=u.map(t=>[...t.hu,t.hu[0],{x:Number.NaN,y:Number.NaN}]).flat(),e=pe(t,!1,Float64Array),i=this.ai.zt()?pe(t,!0):e;this.BV=this.ZB.mR(i,!1,this.BV);let s=[];u.reduce((t,i)=>{const r=t,n=2*(i.hu.length+1),a=new Float64Array(e.buffer,r,n),h=o.default(a,void 0,2),l=t/(2*Float64Array.BYTES_PER_ELEMENT);for(let t=0;t<h.length;t+=1)h[t]+=l;return s=Be(s,h,{canReturnB:!0}),r+(n+2)*Float64Array.BYTES_PER_ELEMENT},0);const r=new Uint32Array(s);this.QN=this.ZB.sO(r,this.QN),this.KN=r.length,this.qN=e.length/2-1}const d=this.Fz.polygonStyleSolid(i),f=this.Fz.polygonStylePaletted(i),g=this.Fz.polygonStyleIndividual(i),p=this.Fz.polygonStyleRadialGradient(i),m=this.Fz.polygonStyleLinearGradient(i),y=this.Fz.polygonStyleImage(i),x=d||f||m||p||y||g,v=this.Fz.lineStyleSolid(c),A=this.Fz.lineStyleDashed(i),S=v||A,b=this.Fz.lineStyleFilled(c),M=b,E=S&&Math.max(S.getThickness(),0);if((i||c||e)&&(this.DV.fill=x?{shader:this.ZB.SE(vp["2D"],d&&vp.Color({dataType:"uniform"}),m&&vp.Color({dataType:["gradient",m]}),p&&vp.Color({dataType:["gradient",p]}),f&&vp.Color({dataType:["lookup",f.getLookUpProperty(),f.lut]}),g&&vp.Color({dataType:"attribute"}),y&&vp.Color({dataType:["image",y]}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),vp.AttributeHighlight),mousePicking:t?{shader:this.ZB.SE(vp["2D"],vp.MousePicking({useAttribute:!0}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),vp.AttributeHighlight)}:void 0,fillStyleSolid:d,fillStyleLinearGradient:m,fillStyleRadialGradient:p,fillStylePaletted:f,fillStyleImage:y,fillStyleIndividual:g}:void 0,this.DV.border=S&&M&&"number"==typeof E&&0!==E?{shader:this.ZB.SE(vp["2D"],vp.Color({dataType:"uniform"}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),this.PV?vp.AliasedEdge:void 0,A&&vp.StippleTextureInstanced,vp.AttributeHighlight),geometry:wm(this.ZB,E),mousePicking:t?{shader:this.ZB.SE(vp["2D"],vp.MousePicking({useAttribute:!0}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),A&&vp.StippleTextureInstanced,vp.AttributeHighlight)}:void 0,fillStyleSolid:b,lineStyleDashed:A,thickness:E}:void 0),s||r){const t=u.reduce((t,e)=>t+e.hu.length+2,0),e=new Float32Array(t);let i=0;u.forEach(t=>{const s=t.hu.length+2;for(let r=i;r<i+s;r+=1)e[r]=t.gi;i+=s}),this.tG=this.ZB.mR(e,!0,this.tG)}if(t){if(r){const t=u.reduce((t,e)=>t+e.hu.length+2,0),e=new Float32Array(t);let i=0;u.forEach(t=>{const s=t.hu.length+2;for(let r=i;r<i+s;r+=1)e[r]=t.JN;i+=s}),this.iG=this.ZB.mR(e,!1,this.iG)}}else this.iG&&(this.ZB.BR(this.iG),this.iG=void 0);if(n||r&&f&&"value"===f.getLookUpProperty()){const t=u.reduce((t,e)=>t+e.hu.length+2,0),e=new Float32Array(t);let i=0;const s={min:ni,max:oi};u.forEach(t=>{const r=void 0!==t.M?t.M:Dt,n=t.hu.length+2;for(let t=i;t<i+n;t+=1)e[t]=r;i+=n,void 0!==t.M&&(s.min=Math.min(s.min,r),s.max=Math.max(s.max,r))}),this.sG=s,this.eG=this.ZB.mR(e,!1,this.eG)}if(a||r&&g){const t=u.reduce((t,e)=>t+e.hu.length+2,0),e=new Uint32Array(t);let i=0;const s=g?g.getFallbackColor().toUint32():C.toUint32();u.forEach(t=>{const r=void 0!==t.ZN?t.ZN:s,n=t.hu.length+2;for(let t=i;t<i+n;t+=1)e[t]=r;i+=n}),this.rG=this.ZB.mR(e,!1,this.rG,Uint32Array)}if(p?this.Rz=Qp(this.Ai||this.nu,this.ai,p.getPosition(),p.getExtent(),p.getShape(),this.ZB.hR()):m?this.Oz=tm(this.Ai||this.nu,this.ai,m.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0),A){if(r){const t=u.reduce((t,e)=>t+e.hu.length,2*u.length),e=new Float32Array(2*t);let i=0;u.forEach(t=>{let s=t.hu[0],r=0,n=0;for(const o of t.hu)r+=Math.abs(o.x-s.x),n+=Math.abs(o.y-s.y),e[i]=r,e[i+1]=n,i+=2,s=o;e[i+0]=r+Math.abs(t.hu[0].x-s.x),e[i+1]=n+Math.abs(t.hu[0].y-s.y),e[i+2]=Number.NaN,e[i+3]=Number.NaN,i+=4}),this.EV=this.ZB.mR(e,!1,this.EV)}this.RV=this.ZB.HO(A.getPattern())}else this.EV&&(this.ZB.BR(this.EV),this.EV=void 0),this.RV=void 0;return this.hG=this.ZB.QO(this,this.hG,y,void 0,r||h||this.ai.ei(),(t,e,i)=>this.nG(t,e,i,u)),this.jN=!1,this.HN=!1,this.$N=!1,this.UN=!1,this.YN=!1,this.ui.u=!1,this.fl(this.Ze),this.yl(l),this}_i(){return this.sG}wc(t,e){var i,s;const{fill:r,border:n}=this.DV,o=this.BV,a=this.tG,h=this.iG;if(!o||!a)return{};if(r){const{fillStyleSolid:s,fillStyleLinearGradient:n,fillStyleRadialGradient:l,fillStylePaletted:c,fillStyleImage:u,fillStyleIndividual:d}=r,f=this.QN,g=this.KN,p=1===t?null===(i=r.mousePicking)||void 0===i?void 0:i.shader:r.shader;p&&o&&f&&void 0!==g&&this.ZB.Kc(p).SR(p,(i,r,p,m)=>{if(this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(m("uScaleStart_highpart"),this.bD.tz()).MR(m("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(m("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(m("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(m("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(m("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(i("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(i("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),this.ZB.RO(p,o,this.ai.zt(),void 0).lO(f).aO(r("aIsHighlighted"),a).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),1===t){if(this.ZB.ZR(i("uFirstId"),e),!h)return!1;this.ZB.aO(r("aPickingIdOffset"),h)}else if(s)this.ZB.UI(i("uColor"),s.getColor());else if(l){if(!this.Rz)return!1;this.ZB.PO(p,this.Rz,l)}else if(n){if(!this.Oz)return!1;this.ZB.BO(p,this.Oz,n)}else if(c){const t=Er(c,this,this.sG);if(!t&&c.lut.percentageValues)return!1;if(this.ZB.JO(p,c.lut,t),"value"===c.getLookUpProperty()){if(!this.eG)return!1;this.ZB.aO(r("aLookupValue"),this.eG)}}else if(u){if(!this.hG)return!1;this.ZB.UI(m("uColor"),u.getSurroundingColor()).wR(i(Gg),this.hG.texture.sR()||this.hG.sourceMissingTexture,0).bR(this.hG.texCoordsBuffer,void 0,{location:r("aTextureCoord"),size:2}).JR(u.fitMode)}else if(d){if(!this.rG)return!1;const t=r("aColor");this.ZB.gl.bindBuffer(this.ZB.gl.ARRAY_BUFFER,this.rG),this.ZB.gl.vertexAttribPointer(t,4,this.ZB.gl.UNSIGNED_BYTE,!0,0,0),this.ZB.gl.enableVertexAttribArray(t)}return this.ZB.cO(g,void 0,void 0,this.ZB.gl.UNSIGNED_INT),!0})}if(n){const{geometry:i,fillStyleSolid:r,thickness:l,lineStyleDashed:c}=n,u=this.qN,d=1===t?null===(s=n.mousePicking)||void 0===s?void 0:s.shader:n.shader;d&&o&&u&&this.ZB.Kc(d).SR(d,(s,n,d,f)=>{if(this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(s("uScale"),this.bD.kR()).MR(s("uDisp"),this.bD.CR()).MR(f("uScaleStart_highpart"),this.bD.tz()).MR(f("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(f("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(f("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(f("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(f("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(s("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(s("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),this.ZB.bR(a,1,{location:n("aIsHighlighted"),size:1}).UI(s("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(s("uRenderEffectMask"),2===t?1:0),1===t){if(this.ZB.ZR(s("uFirstId"),e),!h)return!1;this.ZB.aO(n("aPickingIdOffset"),h,1)}else r&&this.ZB.UI(s("uColor"),r.getColor());if(c){if(!this.RV||!this.EV)return!1;Cm.CV(this.ZB,d,this.EV,n("aLengthSoFarA"),n("aLengthSoFarB"),2,2,0),this.ZB.MR(s("uStippleCount"),[this.pi.kt().x/this.RV.ZO,this.pi.kt().y/this.RV.ZO])._R(f("uStippleTextureWidthLimiter"),this.RV.XO/this.RV.ZO)._R(s("uStippleScale"),c.getPatternScale()).wR(s("uStippleTexture"),this.RV.WO,1)}return Cm.kV(this.ai.zt(),this.ZB,o,d,this.ai.zt()?4:2,0),Cm.wc(this.Sz,i,d,this.PV&&1!==t,1===t,l,u),!0})}return{idCount:this.Wd.length}}nG(t,e,i,s){const r=tt({x:this.nu.min.x,y:this.nu.min.y},this.ai,this.pi.ai),n=tt({x:this.nu.max.x,y:this.nu.max.y},this.ai,this.pi.ai),o={x:Math.abs(r.x-n.x),y:Math.abs(r.y-n.y)},a=rm(t,e,o.x,o.y,i),h=a[1],l=a[4],c=a[6],u=a[7],d=s.reduce((t,e)=>t+e.hu.length+2,0),f=new Float32Array(2*d),g=this.nu.max.x-this.nu.min.x,p=this.nu.max.y-this.nu.min.y,m=l-c,y=u-h;let x=0;for(const t of s){for(const e of t.hu){const t=c+m*((e.x-this.nu.min.x)/g),i=h+y*((e.y-this.nu.min.y)/p);f[x]=t,f[x+1]=i,x+=2}const e=c+m*((t.hu[0].x-this.nu.min.x)/g),i=h+y*((t.hu[0].y-this.nu.min.y)/p);f[x]=e,f[x+1]=i,x+=2,f[x]=Number.NaN,f[x+1]=Number.NaN,x+=2}return f}kc(t,e,i,s,r){return{collectionMember:this.Wd.find(i=>e+i.JN===t)}}_c(){return this.QN&&(this.ZB.BR(this.QN),this.QN=void 0),this.BV&&(this.ZB.BR(this.BV),this.BV=void 0),this.tG&&(this.ZB.BR(this.tG),this.tG=void 0),this.iG&&(this.ZB.BR(this.iG),this.iG=void 0),this.eG&&(this.ZB.BR(this.eG),this.eG=void 0),this.rG&&(this.ZB.BR(this.rG),this.rG=void 0),this.EV&&(this.ZB.BR(this.EV),this.EV=void 0),this.DV={fill:void 0,border:void 0},this.hG=this.ZB.KO(this,this.hG),this}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return We(this.Je)}cu(){return We(this.Je)}}class Um extends bo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.bD=new cm,this.oG=ai,this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStyleRadialGradient:()=>N(this.Ze)&&this.Ze,fillStyleLinearGradient:()=>G(this.Ze)&&this.Ze,fillStyleImage:()=>wt(this.Ze)&&this.Ze,strokeStyleSolid:()=>cr(this.Je)&&this.Je,strokeFillSolid:()=>{const t=this.Je.getFillStyle();return gs(t)&&t},strokeFillLinearGradient:()=>{const t=this.Je.getFillStyle();return G(t)&&t},strokeFillRadialGradient:()=>{const t=this.Je.getFillStyle();return N(t)&&t}}),this.nG=(t,e,i)=>{const s=tt(this.Vl(),this.ai,this.pi.ai),r=Pi(tt(Li(this.Vl(),this.kt()),this.ai,this.pi.ai),s);return rm(t,e,r.x,r.y,i)},this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.bz=e}Nh(){super.Nh();const t=this.ui.T(),e=this.ll(),i=this.Ln.u||this.Y.u||this._l.u||this.Cl.u,s=this.Je,r=this.Al(),n=s.getThickness(),o=this._l.T();this.bD.FR(this.ai);const a=this.ai.ei();if(i){const t=this.Y.T();this.hu=function(t,e,i,s,r){const n=((t,e,i)=>[t,l(t.x+e,t.y),l(t.x+e,t.y+i),l(t.x,t.y+i)])(t,e,i);if(0!==s||s%360!=0){const t=s*Math.PI/180;n[0]=Ci(n[0],r,t),n[1]=Ci(n[1],r,t),n[2]=Ci(n[2],r,t),n[3]=Ci(n[3],r,t)}return n}(this.Ln.T(),t.x,t.y,o,this.Cl.T());const e=pe(this.hu,this.ai.zt());this.Pz=this.ZB.mR(e,!1,this.Pz),this.Dz=this.hu.length,this.oG=bi(this.hu)}const h=this.Fz.fillStyleSolid(e),c=this.Fz.fillStyleRadialGradient(e),u=this.Fz.fillStyleLinearGradient(e),d=this.Fz.fillStyleImage(e),f=h||c||u||d;e&&(this.zz=f?this.ZB.SE(vp["2D"],h&&vp.Color({dataType:"uniform"}),u&&vp.Color({dataType:["gradient",u]}),c&&vp.Color({dataType:["gradient",c]}),d&&vp.Color({dataType:["image",d]}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0),c?this.Rz=Qp(this.Ai||this.oG,this.ai,c.getPosition(),c.getExtent(),c.getShape(),this.ZB.hR()):u?this.Oz=tm(this.Ai||this.oG,this.ai,u.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0),this.hG=this.ZB.QO(this,this.hG,d,void 0,a||i,this.nG);const g=this.Fz.strokeStyleSolid(r),p=this.Fz.strokeFillSolid(r),m=this.Fz.strokeFillLinearGradient(r),y=this.Fz.strokeFillRadialGradient(r),x=g,v=p||m||y;if(x&&(i||r||a&&1!==n)){if(1===n||-1===n)[this.Vz,this.aG]=[this.hu,void 0];else{const t=this.ai;[this.Vz,this.aG]=t instanceof K?((t,e,i)=>{const s=t[0],r=t[1],n=t[2],o=t[3],a=e/2;return[[i.oi(s,r,a,-a),i.oi(r,s,-a,-a),i.oi(o,n,-a,-a),i.oi(n,o,a,-a),i.oi(s,r,-a,a),i.oi(r,s,a,a),i.oi(o,n,a,a),i.oi(n,o,-a,a)],[0,4,5,0,5,1,1,5,7,1,3,7,3,7,6,3,2,6,2,4,0,2,6,4]]})(this.hu,n,t):((t,e,i)=>{const s=t[0],r=t[1],n=t[2],o=t[3],a=l(e.x*i*.5,e.y*i*.5),h=Fi(Bi(r,s)),c=Fi(Bi(o,s)),u=Vi(h),d=Vi(c);return[[Li(s,Li(Ri(u,a.x),Ri(d,a.y))),Li(r,Li(Ri(h,a.x),Ri(d,a.y))),Li(o,Li(Ri(u,a.x),Ri(c,a.y))),Li(n,Li(Ri(h,a.x),Ri(c,a.y))),Li(s,Li(Ri(h,a.x),Ri(c,a.y))),Li(r,Li(Ri(u,a.x),Ri(c,a.y))),Li(o,Li(Ri(h,a.x),Ri(d,a.y))),Li(n,Li(Ri(u,a.x),Ri(d,a.y)))],[0,4,5,0,5,1,1,5,7,1,3,7,3,7,6,3,2,6,2,4,0,2,6,4]]})(this.hu,t.ni(),n)}this.Gz=this.ZB.mR(pe(this.Vz,this.ai.zt()),!1,this.Gz),this.aG?(this.MV=this.ZB.sO(new Uint16Array(this.aG),this.MV),this.Nz=this.aG.length):(this.MV&&this.ZB.BR(this.MV),this.MV=void 0,this.Nz=this.Vz.length)}return r&&(this.Xz=x&&v?this.ZB.SE(vp["2D"],vp.Color({dataType:y?["gradient",y]:m?["gradient",m]:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0),y?this.jz=Qp(this.oG,this.ai,y.getPosition(),y.getExtent(),y.getShape(),this.ZB.hR()):m?this.Wz=tm(this.oG,this.ai,m.getAngle(!0),this.ZB.hR()):(this.jz=void 0,this.Wz=void 0),this.Zz=t&&f?this.Zz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.Jz=t&&this.Je!==Bt?this.Jz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.fl(this.Ze),this.yl(s),this.Ln.u=!1,this._l.u=!1,this.Y.u=!1,this.Cl.u=!1,this}wc(t,e){const i=1===t?this.Zz:this.zz,s=this.Pz,r=this.Dz,n=this.Fz.fillStyleSolid(!1),o=this.Fz.fillStyleRadialGradient(!1),a=this.Fz.fillStyleLinearGradient(!1),h=this.Fz.fillStyleImage(!1);i&&s&&r&&this.Ze!==ls&&(this.ZB.Kc(i),this.ZB.SR(i,(i,l,c,u)=>{if(this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(u("uScaleStart_highpart"),this.bD.tz()).MR(u("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(u("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(u("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(u("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(u("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(i("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(i("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),1===t)this.ZB.ZR(i("uFirstId"),e).UO(c,1);else if(n)this.ZB.UI(i("uColor"),n.getColor());else if(o){if(!this.Rz)return!1;this.ZB.PO(c,this.Rz,o)}else if(a){if(!this.Oz)return!1;this.ZB.BO(c,this.Oz,a)}else if(h){if(!this.hG)return!1;const t=this.hG&&this.hG.texture.sR();this.ZB.UI(u("uColor"),h.getSurroundingColor()).wR(i(Gg),t||this.hG.sourceMissingTexture,0).bR(this.hG.texCoordsBuffer,void 0,{location:l("aTextureCoord"),size:2}).JR(h.fitMode)}return this.ZB._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0).RO(c,s,this.ai.zt(),void 0).Nk(this.ZB.gl.TRIANGLE_FAN,r),!0}));const l=1===t?this.Jz:this.Xz,c=this.Fz.strokeStyleSolid(!1),u=this.Fz.strokeFillSolid(!1),d=this.Fz.strokeFillLinearGradient(!1),f=this.Fz.strokeFillRadialGradient(!1),g=this.Gz;return l&&g&&c&&(this.ZB.Kc(l),this.ZB.SR(l,(i,s,r,n)=>{if(this.ai instanceof q||this.ai instanceof Ar?this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(n("uScaleStart_highpart"),this.bD.tz()).MR(n("uScaleStart_lowpart"),this.bD.iz()):this.ai instanceof K&&this.ZB.MR(n("uScaleStart"),this.bD.MixedScaleXY.uScaleStart).MR(n("uScaleStartLog"),this.bD.MixedScaleXY.uScaleStartLog).MR(n("uScaleInterval"),this.bD.MixedScaleXY.uScaleInterval).MR(n("uScaleIntervalLog"),this.bD.MixedScaleXY.uScaleIntervalLog).MR(i("uViewportStart"),this.bD.MixedScaleXY.uViewportStart).MR(i("uViewportSize"),this.bD.MixedScaleXY.uViewportSize),1===t)this.ZB.ZR(i("uFirstId"),e).UO(r,1);else if(u)this.ZB.UI(i("uColor"),u.getColor());else if(f){if(!this.jz)return!1;this.ZB.PO(r,this.jz,f)}else if(d){if(!this.Wz)return!1;this.ZB.BO(r,this.Wz,d)}return this.ZB._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0).RO(r,g,this.ai.zt(),void 0),this.MV?this.ZB.lO(this.MV).cO(this.Nz):this.ZB.Nk(this.ZB.gl.LINE_LOOP,this.Nz),!0})),{idCount:1}}kc(t,e,i,s,r){return{}}_c(){return this.MV&&(this.ZB.BR(this.MV),this.MV=void 0),this.Pz&&(this.ZB.BR(this.Pz),this.Pz=void 0),this.Gz&&(this.ZB.BR(this.Gz),this.Gz=void 0),this.hG=this.ZB.KO(this,this.hG),this.zz=void 0,this.Xz=void 0,this.Zz=void 0,this.Jz=void 0,this}Wi(){return Math.max(this.Ln.T().x,this.Ln.T().x+this.Y.T().x)}Hi(){return Math.min(this.Ln.T().x,this.Ln.T().x+this.Y.T().x)}Zi(){return Math.max(this.Ln.T().y,this.Ln.T().y+this.Y.T().y)}Xi(){return Math.min(this.Ln.T().y,this.Ln.T().y+this.Y.T().y)}uu(){return We(this.Je)}cu(){return We(this.Je)}}class Gm extends Mo{constructor(t,e,i,s,r){super(t,e,i,s,r),this.bD=new cm,this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStylePaletted:()=>vs(this.Ze)&&this.Ze,fillStyleRadialGradient:()=>N(this.Ze)&&this.Ze,fillStyleLinearGradient:()=>G(this.Ze)&&this.Ze,fillStyleImage:()=>wt(this.Ze)&&this.Ze,strokeLineStyleSolid:()=>cr(this.Je)&&this.Je,strokeLineSolidFill:()=>{const t=this.Je.getFillStyle();return gs(t)&&t},strokeLinearGradientFill:()=>{const t=this.Je.getFillStyle();return G(t)&&t},strokeRadialGradientFill:()=>{const t=this.Je.getFillStyle();return N(t)&&t}}),this.nG=(t,e,i)=>{const s=tt({x:this.nu.min.x,y:this.nu.min.y},this.ai,this.pi.ai),r=tt({x:this.nu.max.x,y:this.nu.max.y},this.ai,this.pi.ai),n={x:Math.abs(s.x-r.x),y:Math.abs(s.y-r.y)},o=rm(t,e,n.x,n.y,i),a=o[1],h=o[4],l=o[6],c=o[7],u=new Float32Array(2*this.hu.length),d=this.nu.max.x-this.nu.min.x,f=this.nu.max.y-this.nu.min.y,g=h-l,p=c-a;let m=0;for(const t of this.hu){const e=l+g*((t.x-this.nu.min.x)/d),i=a+p*((t.y-this.nu.min.y)/f);u[m]=e,u[m+1]=i,m+=2}return u},this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.bz=e}yd(t){let e,i=Number.MAX_VALUE;for(const s of this.hu){const r=yi(tt(s,this.ai,this.pi.ai),t);r<i&&(i=r,e=s)}return e}Nh(){const t=this.ui.T(),e=this.ll(),i=this.ou,s=this.hu.length>=3,r=this.Je,n=this.Al(),a=r.getThickness(),h=this.vl(a);this.bD.FR(this.ai),this.ne=this.ai.ni();const l=this.ai.ei();if(i&&(this.nu=bi(this.hu)),i&&s){const t=pe(this.hu,this.ai.zt());this.Pz=this.ZB.mR(t,!1,this.Pz),this.lG=new Uint16Array(o.default(t)),this.uG=this.ZB.sO(this.lG,this.uG),this.Dz=this.lG.length}const c=this.Fz.fillStyleSolid(e),u=this.Fz.fillStylePaletted(e),d=this.Fz.fillStyleRadialGradient(e),f=this.Fz.fillStyleLinearGradient(e),g=this.Fz.fillStyleImage(e),p=c||u&&"value"!==u.getLookUpProperty()&&u||f||d||g;if(e&&(this.zz=p?this.ZB.SE(vp["2D"],c&&vp.Color({dataType:"uniform"}),f&&vp.Color({dataType:["gradient",f]}),d&&vp.Color({dataType:["gradient",d]}),u&&vp.Color({dataType:["lookup",u.getLookUpProperty(),u.lut]}),g&&vp.Color({dataType:["image",g]}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0),d?this.Rz=Qp(this.Ai||this.nu,this.ai,d.getPosition(),d.getExtent(),d.getShape(),this.ZB.hR()):f?this.Oz=tm(this.Ai||this.nu,this.ai,f.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0),this.hG=this.ZB.QO(this,this.hG,g,void 0,l||i,this.nG),(i||h||l&&1!==a)&&s){const t=1===a||-1===a?this.hu:mm(this.hu,this.ne,a);this.Vz=pe(t,this.ai.zt()),this.Gz=this.ZB.mR(this.Vz,!0,this.Gz),this.Nz=t.length}const m=this.Fz.strokeLineStyleSolid(n),y=this.Fz.strokeLineSolidFill(n),x=this.Fz.strokeLinearGradientFill(n),v=this.Fz.strokeRadialGradientFill(n),A=m,S=y||x||v;return n&&(this.Xz=A&&S?this.ZB.SE(vp["2D"],vp.Color({dataType:v?["gradient",v]:x?["gradient",x]:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0),v?this.jz=Qp(this.Ai||this.nu,this.ai,v.getPosition(),v.getExtent(),v.getShape(),this.ZB.hR()):x?this.Wz=tm(this.Ai||this.nu,this.ai,x.getAngle(!0),this.ZB.hR()):(this.jz=void 0,this.Wz=void 0),this.Zz=t&&p?this.Zz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.Jz=t&&this.Je!==Bt?this.Zz||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})):void 0,this.ou=!1,this.fl(this.Ze),this.yl(r),this}wc(t,e){const i=1===t?this.Zz:this.zz,s=this.Pz,r=this.Dz,n=this.Fz.fillStyleSolid(!1),o=this.Fz.fillStyleRadialGradient(!1),a=this.Fz.fillStyleLinearGradient(!1),h=this.Fz.fillStylePaletted(!1),l=this.Fz.fillStyleImage(!1);i&&s&&r&&this.ZB.Kc(i).SR(i,(i,r,c,u)=>{if(this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).MR(u("uScaleStart_highpart"),this.bD.tz()).MR(u("uScaleStart_lowpart"),this.bD.iz()).RO(c,s,this.ai.zt(),void 0).lO(this.uG)._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),1===t)this.ZB.ZR(i("uFirstId"),e).UO(c,1);else if(n)this.ZB.UI(i("uColor"),n.getColor());else if(o){if(!this.Rz)return!1;this.ZB.PO(c,this.Rz,o)}else if(a){if(!this.Oz)return!1;this.ZB.BO(c,this.Oz,a)}else if(h){const t=Er(h,this,void 0);if(!t&&h.lut.percentageValues)return!1;this.ZB.JO(c,h.lut,t)}else if(l){if(!this.hG)return!1;this.ZB.UI(u("uColor"),l.getSurroundingColor()).wR(i(Gg),this.hG.texture.sR()||this.hG.sourceMissingTexture,0).bR(this.hG.texCoordsBuffer,void 0,{location:r("aTextureCoord"),size:2}).JR(l.fitMode)}return this.ZB.cO(this.Dz),!0});const c=1===t?this.Jz:this.Xz,u=this.Je,d=this.Gz,f=this.Nz;return c&&d&&f&&this.ZB.Kc(c).SR(c,(i,s,r,n)=>{this.ZB._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0).MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()).RO(r,d,this.ai.zt(),void 0);const o=u.getFillStyle();if(1===t)this.ZB.ZR(i("uFirstId"),e).UO(r,1);else if(gs(o))this.ZB.UI(i("uColor"),o.getColor());else if(N(o)){if(!this.jz)return!1;this.ZB.PO(r,this.jz,o)}else if(G(o)){if(!this.Wz)return!1;this.ZB.BO(r,this.Wz,o)}const a=u.getThickness(),h=-1===a||1===a;return this.ZB.Nk(h?this.ZB.gl.LINE_LOOP:this.ZB.gl.TRIANGLE_STRIP,this.Nz),!0}),{idCount:1}}kc(t,e,i,s,r){return{}}_c(){return this.uG&&(this.ZB.BR(this.uG),this.uG=void 0),this.Pz&&(this.ZB.BR(this.Pz),this.Pz=void 0),this.Gz&&(this.ZB.BR(this.Gz),this.Gz=void 0),this.zz=void 0,this.Xz=void 0,this.Zz=void 0,this.Jz=void 0,this.hG=this.ZB.KO(this,this.hG),this}}class Ym extends em{constructor(t){super(t);const{vertices:e,drawMode:i,drawSize:s}=this.SV();this.bV=t.mR(e),this.wV=s,this._V=i}Kc(t){return this.ZB.bR(this.bV,0,{location:t.attribute("aCurveOrBaseline"),size:1},{location:t.attribute("aSegmentSide"),size:1}),this}Nk(t,e,i){return this.ZB.dO(void 0!==e?e:this._V,i||0,this.wV,t),this}SV(){return{vertices:new Float32Array([1,0,0,0,0,1,0,1,1,1,1,0]),drawMode:this.ZB.gl.TRIANGLES,drawSize:6}}$E(){this.ZB.BR(this.bV)}}const Zm=t=>{let e=t.NR.zE.get(void 0);return e||(e=new Ym(t),t.NR.zE.set(void 0,e),e)};class Wm extends em{constructor(t,e,i,s,r){super(t),this._V=i,this.cG=e.length,this.VB=t.mR(pe(e,!1)),this.dG=s,r&&(this.fG={...r,VB:t.mR(r.yM,!1),cG:r.yM.length/4})}AG(t){return t>1}Nk(t,e,i,s,r,n){return"object"==typeof r?e?this.ZB.aO(t.attribute("aOffsetScale"),e,1,i*Float32Array.BYTES_PER_ELEMENT).MR(t.uniform(Yg),[r.width,r.height]):this.ZB._R(t.uniform("uOffsetScale"),r.scale).MR(t.uniform(Yg),[r.width,r.height]):n?e?this.ZB.aO(t.attribute(`${Wm.gG}Amount`),e,1,i*Float32Array.BYTES_PER_ELEMENT):this.ZB._R(t.uniform(`${Wm.gG}Amount`),r):this.ZB._R(t.uniform("uPointSize"),r),n?this.ZB.bR(this.VB,0,{location:t.attribute(Wm.gG),size:2}).dO(this._V,0,this.cG,s):this.ZB.Nk(this.ZB.gl.POINTS,s),this}pG(t,e,i,s,r,n){return!(!this.fG||!r||(e?this.ZB.aO(t.attribute(`${Wm.gG}Amount`),e,1):this.ZB._R(t.uniform(`${Wm.gG}Amount`),s),this.ZB._R(t.uniform(`${Wm.vG}Amount`),n).bR(this.fG.VB,0,{location:t.attribute(Wm.gG),size:2},{location:t.attribute(Wm.vG),size:2}).dO(this.fG._V,0,this.fG.cG,i),0))}$E(){var t;this.ZB.BR(this.VB),this.ZB.BR(null===(t=this.fG)||void 0===t?void 0:t.VB)}}Wm.gG="aFillOffset",Wm.vG="aBorderOffset";const jm=(t,e=0)=>{const i=[l(-.5,-.5),l(.5,-.5),l(.5,.5),l(-.5,.5)];return new Wm(t,i,t.gl.TRIANGLE_FAN,e,{yM:[-.5,-.5,0,0,-.5,-.5,-1,-1,.5,-.5,0,0,.5,-.5,1,-1,.5,.5,0,0,.5,.5,1,1,-.5,.5,0,0,-.5,.5,-1,1,-.5,-.5,0,0,-.5,-.5,-1,-1],_V:t.gl.TRIANGLE_STRIP})},Hm=(t,e=0)=>{const i=.05,s=[l(-.5,-.05),l(.5,-.05),l(.5,i),l(.5,i),l(-.5,i),l(-.5,-.05),l(-.05,-.5),l(i,-.5),l(i,-.05),l(i,-.05),l(-.05,-.05),l(-.05,-.5),l(-.05,.5),l(i,.5),l(i,i),l(i,i),l(-.05,i),l(-.05,.5)];return new Wm(t,s,t.gl.TRIANGLES,e,{yM:[-.05,.5,0,0,-.05,.5,-1,1,i,.5,0,0,i,.5,1,1,i,i,0,0,i,i,1,1,.5,i,0,0,.5,i,1,1,.5,-.05,0,0,.5,-.05,1,-1,i,-.05,0,0,i,-.05,1,-1,i,-.5,0,0,i,-.5,1,-1,-.05,-.5,0,0,-.05,-.5,-1,-1,-.05,-.05,0,0,-.05,-.05,-1,-1,-.5,-.05,0,0,-.5,-.05,-1,-1,-.5,i,0,0,-.5,i,-1,1,-.05,i,0,0,-.05,i,-1,1,-.05,.5,0,0,-.05,.5,-1,1],_V:t.gl.TRIANGLE_STRIP})},$m=(t,i,s)=>{if(yr(t))return $m(e.PointShape.Square,i,s);let r=i.NR.DE.get(t);if(t===e.PointShape.Circle||t===e.PointShape.HollowCircle){const n=s<=3?4:s<=5?8:s<=10?16:24;return t===e.PointShape.Circle?(r=i.NR.EE.get(n)||((t,e,i=0)=>{const s=2*Math.PI/e,r=[],n=[];r.push({x:0,y:0});for(let t=0;t<=e;t+=1){const e=t*s,i=Math.cos(e),o=Math.sin(e),a=.5*i,h=.5*o;r.push({x:a,y:h}),n.push(a,h,0,0,a,h,i,o)}return new Wm(t,r,t.gl.TRIANGLE_FAN,i,{yM:n,_V:t.gl.TRIANGLE_STRIP})})(i,n),i.NR.EE.set(n,r),r):(r=i.NR.RE.get(n)||((t,e,i=0)=>{const s=[],r=2*Math.PI/e;for(let t=0;t<=e;t+=1){const e=t*r,i=Math.cos(e),n=Math.sin(e);s.push({x:.5*i,y:.5*n}),s.push({x:.3*i,y:.3*n})}return new Wm(t,s,t.gl.TRIANGLE_STRIP,i,void 0)})(i,n),i.NR.RE.set(n,r),r)}if(!r){switch(t){case e.PointShape.Triangle:r=((t,e=0)=>{const i=[{x:-.5773502691892515,y:.3333333333333333},{x:0,y:-.6666666666666666},{x:.5773502691892515,y:.3333333333333333}];return new Wm(t,i,t.gl.TRIANGLES,e,{yM:[i[0].x,i[0].y,0,0,i[0].x,i[0].y,2*i[0].x,2*i[0].y,i[1].x,i[1].y,0,0,i[1].x,i[1].y,2*i[1].x,2*i[1].y,i[2].x,i[2].y,0,0,i[2].x,i[2].y,2*i[2].x,2*i[2].y,i[0].x,i[0].y,0,0,i[0].x,i[0].y,2*i[0].x,2*i[0].y],_V:t.gl.TRIANGLE_STRIP})})(i);break;case e.PointShape.Square:r=jm(i);break;case e.PointShape.Plus:r=Hm(i);break;case e.PointShape.Cross:r=Hm(i,45);break;case e.PointShape.Diamond:r=jm(i,45);break;case e.PointShape.Arrow:r=((t,e=0)=>{const i=.05,s=[l(-.05,-.5),l(i,-.5),l(i,.45),l(i,.45),l(-.05,.45),l(-.05,-.5),l(-.5,0),l(-.4,0),l(0,.4),l(0,.4),l(0,.5),l(-.5,0),l(.5,0),l(.4,0),l(0,.4),l(0,.4),l(0,.5),l(.5,0)];return new Wm(t,s,t.gl.TRIANGLES,e,{yM:[-.5,0,0,0,-.5,0,-2,-1,0,.5,0,0,0,.5,0,1,.5,0,0,0,.5,0,2,-1,.4,0,0,0,.4,0,0,-1,i,.355,0,0,i,.355,1,-2,i,-.5,0,0,i,-.5,1,-1,-.05,-.5,0,0,-.05,-.5,-1,-1,-.05,.355,0,0,-.05,.355,-1,-2,-.4,0,0,0,-.4,0,0,-1,-.5,0,0,0,-.5,0,-2,-1],_V:t.gl.TRIANGLE_STRIP})})(i);break;case e.PointShape.Star:r=((t,e=0)=>new Wm(t,[{x:0,y:0},{x:0,y:.5},{x:.1,y:.1},{x:.5,y:.1},{x:.2,y:-.1},{x:.3,y:-.5},{x:0,y:-.25},{x:-.3,y:-.5},{x:-.2,y:-.1},{x:-.5,y:.1},{x:-.1,y:.1},{x:0,y:.5}],t.gl.TRIANGLE_FAN,e,{yM:[0,.5,0,0,0,.5,0,1,.1,.1,0,0,.1,.1,1,1,.5,.1,0,0,.5,.1,2,1,.2,-.1,0,0,.2,-.1,1,-1,.3,-.5,0,0,.3,-.5,1,-2,0,-.25,0,0,0,-.25,0,-1,-.3,-.5,0,0,-.3,-.5,-1,-2,-.2,-.1,0,0,-.2,-.1,-1,-1,-.5,.1,0,0,-.5,.1,-2,1,-.1,.1,0,0,-.1,.1,-1,1,0,.5,0,0,0,.5,0,1],_V:t.gl.TRIANGLE_STRIP}))(i);break;case e.PointShape.Minus:r=((t,e=0)=>{const i=.05,s=[l(-.5,-.05),l(.5,-.05),l(.5,i),l(.5,i),l(-.5,i),l(-.5,-.05)];return new Wm(t,s,t.gl.TRIANGLES,e,{yM:[-.5,-.05,0,0,-.5,-.05,-1,-1,.5,-.05,0,0,.5,-.05,1,-1,.5,i,0,0,.5,i,1,1,-.5,i,0,0,-.5,i,-1,1,-.5,-.05,0,0,-.5,-.05,-1,-1],_V:t.gl.TRIANGLE_STRIP})})(i);break;default:return Ye(0,"LightningChart JS unidentified point shape")}i.NR.DE.set(t,r)}return r};class Xm extends wo{constructor(t,i,s,r){super(t,i,s,r,[{type:"DataPattern",args:{pattern:"ProgressiveX"}}]),this.yG=co.fillStyle,this.mG=m("bottom"),this.xG=co.fillStyle,this.SG=Bt,this.bG=m(e.PointShape.Circle),this.MG=m(5),this.wG=m(0),this._G=m(void 0),this.Dw=!0,this.kG={x:0,y:0}}Xw(t){this.mG.T()!==t&&this.mG.C(t)}Od(t){return this.yG=mo(this.yG,t),this}Vw(){return this.yG}CG(){return yo(this.TG,this.yG)}FG(){return yo(this.IG,this.xG)}LG(){return this.SG!==this.PG}Rd(t){return this.xG=mo(this.xG,t),wt(this.xG)&&(this.Vd(e.PointShape.Square),this.Hd(1)),this}Ud(){return this.xG}Yd(t){return this.SG="function"==typeof t?t(this.SG):t,this}jd(){return this.SG}Vd(t){return this.bG.C(t),yr(this.bG.T())&&this.Hd(1),this}Nd(){return this.bG.T()}Hd(t){return this.MG.C(t),this}Nw(){return this.MG.T()}Gd(t){return this.wG.C(t),this}$d(){return this.wG.T()}YA(t){return this.kG=t,this}Gw(){return this.kG}Bw(t){return this._G.C(t),this}$w(){return this._G.T()}}class qm extends Rm{constructor(t,e){super(t,e),this.eN=!1,this.rN={BG:!1,DG:0},this.nN=t instanceof q?{type:"linear",scale:t}:{type:"unknown"},this.sN.wi("DataPattern",t=>{!1===t.allowDataGrouping&&(this.eN=!0)})}EG(t,e,i){const s=null==t?void 0:t.Kc(e),r=null==s?void 0:s.sd,n=null==s?void 0:s.ed,o=null==t?void 0:t.Pc,a=null==t?void 0:t.Lc,h=null==t?void 0:t.Qc(e);if(!t||this.eN||!h||"linear"!==this.nN.type||!r||!n||void 0===o||void 0===a||!i){const t=this.rN.BG;return this.rN={BG:!1,DG:null!=o?o:0},{cpStateChanged:t,cpActive:!1}}const l=Ns(h),c=t.gd(e),u=t.Ad(e),d=c?c[l]:void 0,f=u?u[l]:void 0;if(o<2||void 0===d||void 0===f||f===d){const t=this.rN.BG;return this.rN={BG:!1,DG:null!=o?o:0},{cpStateChanged:t,cpActive:!1}}const g=this.calculateAvgStepBetweenDataPoints(f,d,o),p=this.nN.scale,m=Math.abs(p.ni()[l]),y=m/g,x=Math.floor(.8*y),v=x*g,A=x>=4,S=this.rN.BG?this.rN.OG/m<1.5:void 0,b=this.rN.BG&&x>this.rN.zG?x/this.rN.zG>=2:void 0;let M;return!0===this.rN.BG?S?b&&(M={BG:!0,OG:v,zG:x,DG:o}):M=A?{BG:!0,OG:v,zG:x,DG:o}:{BG:!1,DG:o}:A&&(M={BG:!0,OG:v,zG:x,DG:o}),this.rN=M||{...this.rN,DG:o},!!M&&this.uN(),{cpStateChanged:!!M,cpActive:this.rN.BG}}VG(t,e){var i,s,r;const n=null==t?void 0:t.Kc(e),o=n.dataPattern,a=n.sd,h=n.ed,l=t.Bc,c=t.Pc,u=t.Lc,d=t.Vc;if(this.eN||!this.rN.BG||!a||!h||void 0===o)return;const f=Ns(o),g=Os(o),p="x"===f?a:h,m="x"===f?h:a,y=p.length,x="x"===f?this.ai.x:this.ai.y,v=this.rN.OG,A=Math.min(x.getInnerStart(),x.getInnerEnd()),S=Math.max(x.getInnerStart(),x.getInnerEnd()),b=Oo(A,S,p,l,c,u,Os(o)?"progressive":"regressive",1);if(!b)return;const M=p[b.iFirstSampleDataArray];if(this.NG){if(this.NG.GG<b.iFirstSample){const t=Math.min(Math.floor((M-this.NG.Cl)/v),this.NG.$G);if(t>0)if(this.NG.$G-=t,this.NG.$G>0){this.NG.UG.splice(0,2*t),this.NG.YG.splice(0,2*t),this.NG.jG&&this.NG.jG.splice(0,2*t),this.NG.HG&&this.NG.HG.splice(0,2*t),this.NG.Cl+=t*v;const e=Uo(this.NG.Cl,Math.max(l-1-y+1,0),l-1,g,t=>p[No(t,l,y)]),i=No(e,l,y);this.NG.GG=p[i]>=this.NG.Cl?e:e+1}else this.NG=void 0}if(void 0!==(null===(i=this.NG)||void 0===i?void 0:i.WG)&&this.NG.WG>b.iLastSample){const t=p[b.iLastSampleDataArray],e=Math.min(Math.floor((this.NG.Cl+this.NG.$G*v-t)/v),this.NG.$G);if(e>0)if(this.NG.$G-=e,this.NG.$G>0){for(let t=0;t<2*e;t+=1)this.NG.UG.pop(),this.NG.YG.pop(),this.NG.jG&&this.NG.jG.pop(),this.NG.HG&&this.NG.HG.pop();const t=Uo(this.NG.Cl+this.NG.$G*v,Math.max(l-1-y+1,0),l-1,g,t=>p[No(t,l,y)]),i=No(t,l,y);this.NG.WG=p[i]<=this.NG.Cl+this.NG.$G*v?t:t-1}else this.NG=void 0}}const E=this.NG||{Cl:M,$G:0,UG:[],YG:[],jG:n.rd?[]:void 0,HG:n.od?[]:void 0,XG:n.nd?[]:void 0,ZG:n.hd?[]:void 0,GG:b.iFirstSample,WG:void 0},k=(t,e,i,s)=>{let r=Math.min(t,t+i*v),n=Math.max(t,t+i*v);const o=[];if(i<0&&r<A||i>0&&n>S)return o;let a=s,h=oi,c=oi,u=-1,f=ni,g=ni,x=-1,M=0;for(;a<=b.iLastSample&&a>=b.iFirstSample;){const s=a%y,b=p[s],k=m[s];if(d&&Number.isNaN(b))a+=e;else if(r<=b&&b<=n)M+=1,d&&Number.isNaN(k)||(k>c&&(h=b,c=k,u=a),k<g&&(f=b,g=k,x=a)),a+=e;else{if(M>0)h=h===oi?Number.NaN:h,c=c===oi?Number.NaN:c,f=f===ni?Number.NaN:f,g=g===ni?Number.NaN:g,u<x?(o.push({iFirst:u,iSecond:x}),e>0?(E.UG.push(h),E.YG.push(c),E.UG.push(f),E.YG.push(g)):(E.UG.unshift(f),E.YG.unshift(g),E.UG.unshift(h),E.YG.unshift(c))):(o.push({iFirst:x,iSecond:u}),e>0?(E.UG.push(f),E.YG.push(g),E.UG.push(h),E.YG.push(c)):(E.UG.unshift(h),E.YG.unshift(c),E.UG.unshift(f),E.YG.unshift(g)));else{const t=e>0?E.WG:E.GG;if(void 0===t)o.push({iFirst:0,iSecond:0}),e>0?(E.UG.push(Number.NaN),E.YG.push(Number.NaN),E.UG.push(Number.NaN),E.YG.push(Number.NaN)):(E.UG.unshift(Number.NaN),E.YG.unshift(Number.NaN),E.UG.unshift(Number.NaN),E.YG.unshift(Number.NaN));else{const i=No(t,l,y),s=p[i],a=m[i],h=$t((s+b)/2,r,n),c=$t((h+b)/2,r,n),u=a+(h-s)/(b-s)*(k-a),d=a+(c-s)/(b-s)*(k-a);o.push({iFirst:t,iSecond:t}),e>0?(E.UG.push(h),E.YG.push(u),E.UG.push(c),E.YG.push(d)):(E.UG.unshift(c),E.YG.unshift(d),E.UG.unshift(h),E.YG.unshift(u))}}if(E.$G+=1,e>0?E.WG=a-1:(E.GG=a+1,E.Cl=i>0?n:r),r=Math.min(t+o.length*i*v,t+(o.length+1)*i*v),n=Math.max(t+o.length*i*v,t+(o.length+1)*i*v),M=0,h=oi,c=oi,u=-1,f=ni,g=ni,x=-1,i<0&&r<A||i>0&&n>S)break}}return o},T=k(E.Cl+(Os(o)?1:-1)*E.$G*v,1,1*(Os(o)?1:-1),void 0!==(null===(s=this.NG)||void 0===s?void 0:s.WG)?this.NG.WG+1:b.iFirstSample),w=k(E.Cl,-1,-1*(Os(o)?1:-1),void 0!==(null===(r=this.NG)||void 0===r?void 0:r.GG)?this.NG.GG-1:b.iFirstSample);if(0===w.length&&0===T.length)return;const C=n.rd&&E.jG?[n.rd,E.jG]:void 0,B=n.od&&E.HG?[n.od,E.HG]:void 0,F=n.nd&&E.XG?[n.nd,E.XG]:void 0,D=n.hd&&E.ZG?[n.hd,E.ZG]:void 0;if(C||B||F||D){for(const t of T){const e=No(t.iFirst,l,y),i=No(t.iSecond,l,y);C&&C[1].push(C[0][e],C[0][i]),B&&B[1].push(B[0][e],B[0][i]),F&&F[1].push(F[0][e],F[0][i]),D&&D[1].push(D[0][e],D[0][i])}for(const t of w){const e=No(t.iFirst,l,y),i=No(t.iSecond,l,y);C&&C[1].unshift(C[0][i],C[0][e]),B&&B[1].unshift(B[0][i],B[0][e]),F&&F[1].unshift(F[0][i],F[0][e]),D&&D[1].unshift(D[0][i],D[0][e])}}return this.NG=E.$G>0?E:void 0,{JG:"x"===f?E.UG:E.YG,QG:"y"===f?E.UG:E.YG,iP:E.jG,KG:E.HG,Y:E.XG,_l:E.ZG}}uN(){this.NG=void 0}gN(){}}class Km extends Xm{constructor(t,e,i,s){super(t,e,i,s),this.bD=new cm,this.PN=new qm(this.ai,this),this.Fz=Mr({lineStyleSolid:()=>cr(this.hc)&&this.hc,lineStyleDashed:()=>gr(this.hc)&&this.hc,strokeFillSolid:()=>{const t=this.hc.getFillStyle();return gs(t)&&t},strokeFillLinearGradient:()=>{const t=this.hc.getFillStyle();return G(t)&&t},strokeFillRadialGradient:()=>{const t=this.hc.getFillStyle();return N(t)&&t},strokeFillIndividual:()=>{const t=this.hc.getFillStyle();return ms(t)&&t},strokeFillPaletted:()=>{const t=this.hc.getFillStyle();return vs(t)&&t},areaFillSolid:()=>gs(this.yG)&&this.yG,areaFillLinearGradient:()=>G(this.yG)&&this.yG,areaFillRadialGradient:()=>N(this.yG)&&this.yG,areaFillIndividual:()=>ms(this.yG)&&this.yG,areaFillPaletted:()=>vs(this.yG)&&this.yG,markerFillSolid:()=>gs(this.xG)&&this.xG,markerFillLinearGradient:()=>G(this.xG)&&this.xG,markerFillRadialGradient:()=>N(this.xG)&&this.xG,markerFillPaletted:()=>vs(this.xG)&&this.xG,markerFillIndividual:()=>ms(this.xG)&&this.xG,markerFillImage:()=>wt(this.xG)&&this.xG,markerShapeIcon:()=>{const t=this.bG.T();return yr(t)&&t},markerStrokeFillSolid:()=>{const t=this.SG.getFillStyle();return gs(t)&&t}}),this.Dd=m(void 0),this.qG=[],this.mu=!1,this.t$=[],this.i$=void 0,this.nG=(t,e,i)=>{var s;const r=null===(s=this.s$)||void 0===s?void 0:s.shapeIcon;let n=t,o=e;return r&&(n=r.kt().x,o=r.kt().y),rm(t,e,n*this.MG.T(),o*this.MG.T(),i)},this.e$=Jm(),this.bz=e,this.DV={type:"none"},this.ZB=t.Mz(),this.Sz=t,this.PV=this.ZB.mO}Ed(t,e){var i;return this.PN.uN(),this.r$=void 0,this.i$=void 0,t&&e?(this.Dd.C(Ke(t,this.Dd.T(),()=>({change:t=>{this.qG.push({min:t.iDataStart,max:t.iDataEnd}),this.r$&&this.t$.length>1e3&&Date.now()-this.r$.h$>5e3&&(this.r$=void 0,this.t$.length=0),this.r$&&this.t$.push({min:t.iDataStart,max:t.iDataEnd})},clear:()=>{this.mu=!0,this.r$=void 0,this.i$=void 0,this.PN.uN()},loop:()=>{this.r$=void 0,this.t$.length=0}}))),this.Rw=e,this):(null===(i=this.Dd.T())||void 0===i||i.qi(),this.Dd.C(void 0),this.Rw=void 0,this)}hl(){var t;const e=null===(t=this.Dd.T())||void 0===t?void 0:t.ts,i=null==e?void 0:e.Qc(this.Rw);return i&&{jw:Ns(i),Hw:()=>this.Qp()}}Qp(){var t,e,i,s,r,n,o,a,h,c,u,d,f,g,p,m,y,x,v,A,S,b,M,E,k,T,w,C,B,F,D,I,R;const L=null===(t=this.Dd.T())||void 0===t?void 0:t.ts,P=this.Dd.u,z=this.Rw,_=null==L?void 0:L.Kc(z),V=null==_?void 0:_.sd,N=null==_?void 0:_.ed;if(!(L&&V&&N&&z))return;const O=_.dataPattern,U=O&&this.ai[Ns(O)],G=_.od,Y=_.rd,Z=_.nd,W=_.hd,j=L.Bc,H=L.Pc,$=L.Lc,X=P||this.Al()||this.CG()||this.FG()||this.LG()||this.mG.u,q=this.Fz.lineStyleSolid(X),K=this.Fz.lineStyleDashed(X),J=q||K,Q=J&&J.getThickness(),tt=this.Fz.strokeFillSolid(X),et=this.Fz.strokeFillLinearGradient(X),it=this.Fz.strokeFillRadialGradient(X),st=this.Fz.strokeFillIndividual(X),rt=this.Fz.strokeFillPaletted(X),nt=tt||et||it||st||rt,ot=this.Fz.areaFillSolid(X),at=this.Fz.areaFillLinearGradient(X),ht=this.Fz.areaFillRadialGradient(X),lt=this.Fz.areaFillIndividual(X),ct=this.Fz.areaFillPaletted(X),ut=ot||at||ht||lt||ct,dt=this.Fz.markerFillSolid(X),ft=this.Fz.markerFillLinearGradient(X),gt=this.Fz.markerFillRadialGradient(X),pt=this.Fz.markerFillPaletted(X),mt=this.Fz.markerFillIndividual(X),yt=this.Fz.markerFillImage(X),xt=dt||ft||gt||pt||mt||yt,vt=this.Fz.markerStrokeFillSolid(X),At=this.bG.T(),St=this.bG.u,bt=this.Fz.markerShapeIcon(St),Mt=this.MG.T(),Et=this.MG.u,kt=this._G.u,Tt=this.qG.length>0||kt,wt=this.mu||P,Ct=wt?[L.dd()]:(t=>{const e=[];for(const i of t){let t=!1;for(const s of e)if(i.min>=s.min&&i.min<=s.max||i.max>=s.min&&i.max<=s.max){s.min=Math.min(s.min,i.min),s.max=Math.min(s.max,i.max),t=!0;break}t||e.push(i)}return e})(this.qG),Bt=!!K,Ft=this.ui.T(),Dt=this.ui.u;P&&Object.entries(z).forEach(([t,e])=>{if(L.Uc&&!L.Uc[e])throw new Error(`LightningChart JS data supply error - key ${e} does not exist in data set. Mapped to '${t}'`)}),(P||X)&&((rt&&"value"===rt.lookUpProperty||ct&&"value"===ct.lookUpProperty||pt&&"value"===pt.lookUpProperty)&&void 0===z.lookupValue&&Ut.console.warn('LightningChart JS warning - using PalettedFill with lookUpProperty=value, but there is no data mapping for "lookupValue"'),(st||lt||mt)&&void 0===z.color&&Ut.console.warn('LightningChart JS warning - using IndividualPointFill, but there is no data mapping for "color"'));const It=this.Dw&&(!!J||!!ut),{cpStateChanged:Rt,cpActive:Lt}=this.PN.EG(L,z,It);if(O&&Lt&&U&&(Rt||wt||Tt||U.rt||X)){const t=this.PN.VG(L,z);if(t){const l=!(Rt||wt||X||P);this.n$=Qm(this.ZB,[t.JG,t.QG],t.iP,t.KG,t.Y,t._l,Bt,this.n$,l,O,1e3,this.ai.zt(),t=>ge(t,this.ai.zt()),L.Vc),this.o$={min:ni,max:oi};const c="x"===Ns(O)?t.QG:t.JG,u=c.length;for(let t=0;t<u;t+=1){const e=c[t];L.Vc&&Number.isNaN(e)||(this.o$.min=Math.min(this.o$.min,e),this.o$.max=Math.max(this.o$.max,e))}(null===(e=this.a$)||void 0===e?void 0:e.bufferX)!==this.n$.bufferX&&(this.ZB.BR(null===(i=this.a$)||void 0===i?void 0:i.bufferX),this.ZB.BR(null===(s=this.a$)||void 0===s?void 0:s.bufferY),this.ZB.BR(null===(r=this.a$)||void 0===r?void 0:r.bufferColors),this.ZB.BR(null===(n=this.a$)||void 0===n?void 0:n.bufferLengthSoFar),this.ZB.BR(null===(o=this.a$)||void 0===o?void 0:o.bufferRotations),this.ZB.BR(null===(a=this.a$)||void 0===a?void 0:a.bufferLookupValues),this.ZB.BR(null===(h=this.a$)||void 0===h?void 0:h.bufferSizes)),this.a$=void 0}}if(O&&U&&!Lt){if(Rt||wt||Tt||U.rt||kt||X){const t=Math.min(U.getInnerStart(),U.getInnerEnd()),e=Math.max(U.getInnerStart(),U.getInnerEnd()),i="x"===Ns(O)?V:N,s="x"===Ns(O)?N:V,r=Oo(t,e,i,j,H,$,Os(O)?"progressive":"regressive",1);if(!this.l$||(null==r?void 0:r.iFirstSample)!==this.l$.iFirstSample||r.iLastSample!==this.l$.iLastSample||wt){const t=this.e$(_,this.l$,r,wt||Rt,i,s,L.Vc);this.o$=t.visibleBoundaries,this.u$=t.avgPointGap}if(this.l$=r,void 0===r)this.ZB.BR(null===(c=this.n$)||void 0===c?void 0:c.bufferX),this.ZB.BR(null===(u=this.n$)||void 0===u?void 0:u.bufferY),this.ZB.BR(null===(d=this.n$)||void 0===d?void 0:d.bufferColors),this.ZB.BR(null===(f=this.n$)||void 0===f?void 0:f.bufferLengthSoFar),this.ZB.BR(null===(g=this.n$)||void 0===g?void 0:g.bufferRotations),this.ZB.BR(null===(p=this.n$)||void 0===p?void 0:p.bufferLookupValues),this.ZB.BR(null===(m=this.n$)||void 0===m?void 0:m.bufferSizes),this.n$=void 0,this.ZB.BR(null===(y=this.a$)||void 0===y?void 0:y.bufferX),this.ZB.BR(null===(x=this.a$)||void 0===x?void 0:x.bufferY),this.ZB.BR(null===(v=this.a$)||void 0===v?void 0:v.bufferColors),this.ZB.BR(null===(A=this.a$)||void 0===A?void 0:A.bufferLengthSoFar),this.ZB.BR(null===(S=this.a$)||void 0===S?void 0:S.bufferRotations),this.ZB.BR(null===(b=this.a$)||void 0===b?void 0:b.bufferLookupValues),this.ZB.BR(null===(M=this.a$)||void 0===M?void 0:M.bufferSizes),this.a$=void 0,this.c$=r;else if(Rt||wt||!this.c$||r.iFirstSample<this.c$.iFirstSample||r.iLastSample>this.c$.iLastSample||X){const t=zo({srcLoopArray:V,dataRanges:r.dataRanges,NewArray:_.qc}),e=zo({srcLoopArray:N,dataRanges:r.dataRanges,NewArray:_.td}),i=Y?zo({srcLoopArray:Y,dataRanges:r.dataRanges,NewArray:Uint32Array}):void 0,s=G?zo({srcLoopArray:G,dataRanges:r.dataRanges,NewArray:Float32Array}):void 0,n=Z?zo({srcLoopArray:Z,dataRanges:r.dataRanges,NewArray:Float32Array}):void 0,o=W?zo({srcLoopArray:W,dataRanges:r.dataRanges,NewArray:Float32Array}):void 0,a=!(Rt||wt||X||P),h=It||this.wi("ApplicationType",t=>"InternalUI"===t.type)?1e3:Math.min(null!==(E=L.getMaxSampleCount())&&void 0!==E?E:1e6,1e6);this.a$=Qm(this.ZB,[t,e],i,s,n,o,Bt,this.a$,a,O,h,this.ai.zt(),t=>ge(t,this.ai.zt()),L.Vc);let c=t,u=e,d=i,f=s;const g=this._G.T();if(g){const r="spline"===g.type?((t,e,i)=>{const s=Ns(i),r="x"===s?t.xValues:t.yValues,n="x"===s?t.yValues:t.xValues,{lookupValues:o,colors:a}=t;if(r.length<=2)return{xValues:Array.from(t.xValues),yValues:Array.from(t.yValues),lookupValues:o?Array.from(o):void 0,colors:a?Array.from(a):void 0};const h=((t,e)=>{const i=1e-5,s=t.length-1,r=Array(s);if(s>1){let n=l(0,0),o=l(0,0),a=l(0,0),h=Fi(Pi({x:t.elementAt(1),y:e.elementAt(1)},{x:t.elementAt(0),y:e.elementAt(0)}));const c=3;let u=0,d=0;for(let f=0;f<s;f+=1){const g=t.elementAt(f),p=t.elementAt(f+1),m=e.elementAt(f),y=e.elementAt(f+1),x=Array(4);x[0]={x:g,y:m},x[1]={x:g,y:m},x[3]={x:p,y},x[2]={x:p,y},a=h,n=o,Number.isNaN(n.y)&&(n=l(0,0));const v=f+2<e.length?e.elementAt(f+2):Number.NaN;if(f+1<s&&!Number.isNaN(v)){const e=t.elementAt(f+2);h=e===p&&v===y?l(0,0):Fi(Pi({x:e,y:v},{x:p,y})),o=Fi(Li(a,h))}else o=l(0,0);if(y===m)u=0,d=0;else{const t=p-g;u=Math.abs(n.x)>i?Math.abs(t/(c*n.x)):1,d=Math.abs(o.x)>i?Math.abs(t/(c*o.x)):1}x[1]=Li(Ri(n,u),x[1]),x[2]=Pi(x[2],Ri(o,d)),r[f]=x}}return r.length>0?r:[]})(r,n),c=h.length,u=[],d=[],f=[],g=[];for(let t=0;t<c;t+=1){const i=h[t];for(let t=0;t<e;t+=1){const s=t/(e-1),r=s*s,n=r*s,o=1-s,a=o*o,h=a*o;u.push(h*i[0].x+3*s*a*i[1].x+3*r*o*i[2].x+n*i[3].x),d.push(h*i[0].y+3*s*a*i[1].y+3*r*o*i[2].y+n*i[3].y)}}if(o)for(let t=0;t<u.length;t+=1){const i=Math.round(t/e),s=o.elementAt(i);g[t]=s}if(a)for(let t=0;t<u.length;t+=1){const i=Math.round(t/e),s=a.elementAt(i);f[t]=s}return{xValues:"x"===s?u:d,yValues:"x"===s?d:u,lookupValues:o?g:void 0,colors:a?f:void 0}})({xValues:t,yValues:e,lookupValues:s,colors:i},g.resolution||20,O):"step"===g.type?((t,e,i)=>{const{lookupValues:s,colors:r}=t,n=Ns(i),o="x"===n?t.xValues:t.yValues,a="x"===n?t.yValues:t.xValues,h=[],l=[],c=[],u=[],d=o.length,f="before"===e?0:"after"===e?1:.5;if(d>0){let t=0,e=o.elementAt(0),i=a.elementAt(0);h[t]=e,l[t]=i,t+=1;for(let s=1;s<d;s+=1){const r=o.elementAt(s),n=a.elementAt(s);if(f<=0)h[t]=e,l[t]=n,t+=1;else{const s=e*(1-f)+r*f;h[t]=s,l[t]=i,t+=1,h[t]=s,l[t]=n,t+=1}h[t]=r,l[t]=n,t+=1,e=r,i=n}}if(s)if("before"===e){u[0]=s.elementAt(0);for(let t=1;t<d;t+=1){const e=s.elementAt(t);u[2*t-1]=e,u[2*t]=e}}else if("middle"===e||"after"===e){u[0]=s.elementAt(0),u[1]=s.elementAt(0);for(let t=1;t<d;t+=1){const e=s.elementAt(t);u[3*t-1]=e,u[3*t]=e,u[3*t+1]=e}}if(r)if("before"===e){c[0]=r.elementAt(0);for(let t=1;t<d;t+=1){const e=r.elementAt(t);c[2*t-1]=e,c[2*t]=e}}else if("middle"===e||"after"===e){c[0]=r.elementAt(0),c[1]=r.elementAt(0);for(let t=1;t<d;t+=1){const e=r.elementAt(t);c[3*t-1]=e,c[3*t]=e,c[3*t+1]=e}}return{xValues:"x"===n?h:l,yValues:"x"===n?l:h,lookupValues:s?u:void 0,colors:r?c:void 0}})({xValues:t,yValues:e,lookupValues:s,colors:i},null!==(k=g.step)&&void 0!==k?k:"middle",O):void 0;c=r?r.xValues:c,u=r?r.yValues:u,d=(null==r?void 0:r.colors)?r.colors:d,f=(null==r?void 0:r.lookupValues)?r.lookupValues:f}this.n$=c===t&&u===e?this.a$:Qm(this.ZB,[c,u],d,f,void 0,void 0,Bt,(null===(T=this.n$)||void 0===T?void 0:T.bufferX)===this.a$.bufferX?void 0:this.n$,!(!a||kt||g),O,1e3,this.ai.zt(),t=>ge(t,this.ai.zt()),L.Vc),this.c$=r}}}else this.l$=void 0;if(!O&&(wt||Tt||X)){if(!this.n$||this.n$.bufferSize<L.Pc||Bt){const t=void 0!==L.Wc?L.Wc:L.Pc;let e,i=0,s=0;if(Bt){const r=ty(V,N,V[0],N[0],0,0,L.Vc);e=this.ZB.KR(2*t,r[0],null===(w=this.n$)||void 0===w?void 0:w.bufferLengthSoFar,Float32Array),i=r[1],s=r[2]}this.n$={bufferX:this.ZB.KR(t*(this.ai.zt()?2:1),ge(V,this.ai.zt()),null===(C=this.n$)||void 0===C?void 0:C.bufferX),bufferY:this.ZB.KR(t*(this.ai.zt()?2:1),ge(N,this.ai.zt()),null===(B=this.n$)||void 0===B?void 0:B.bufferY),bufferColors:Y?this.ZB.KR(t,Y,null===(F=this.n$)||void 0===F?void 0:F.bufferColors,Uint32Array):void 0,bufferLookupValues:G?this.ZB.KR(t,G,null===(D=this.n$)||void 0===D?void 0:D.bufferLookupValues,Float32Array):void 0,bufferSizes:Z?this.ZB.KR(t,Z,null===(I=this.n$)||void 0===I?void 0:I.bufferSizes,Float32Array):void 0,bufferRotations:W?this.ZB.KR(t,W,null===(R=this.n$)||void 0===R?void 0:R.bufferRotations,Float32Array):void 0,bufferLengthSoFar:e,lengthSoFarX:i,lengthSoFarY:s,bufferSize:t,valueCount:L.Pc}}else{const t=this.n$.bufferX,e=this.n$.bufferY;Ct.forEach(i=>{var s,r,n,o;const a=V.subarray(i.min,i.max+1),h=N.subarray(i.min,i.max+1);if(this.ZB.qR(t,i.min*(this.ai.zt()?2:1),ge(a,this.ai.zt())),this.ZB.qR(e,i.min*(this.ai.zt()?2:1),ge(h,this.ai.zt())),Y&&(null===(s=this.n$)||void 0===s?void 0:s.bufferColors)){const t=Y.subarray(i.min,i.max+1);this.ZB.qR(this.n$.bufferColors,i.min,t,Uint32Array)}if(G&&(null===(r=this.n$)||void 0===r?void 0:r.bufferLookupValues)){const t=G.subarray(i.min,i.max+1);this.ZB.qR(this.n$.bufferLookupValues,i.min,t,Float32Array)}if(W&&(null===(n=this.n$)||void 0===n?void 0:n.bufferRotations)){const t=W.subarray(i.min,i.max+1);this.ZB.qR(this.n$.bufferRotations,i.min,t,Float32Array)}if(Z&&(null===(o=this.n$)||void 0===o?void 0:o.bufferSizes)){const t=Z.subarray(i.min,i.max+1);this.ZB.qR(this.n$.bufferSizes,i.min,t,Float32Array)}}),this.n$.valueCount=L.Pc}this.a$=this.n$}if(X||Et||St||Dt){if(nt&&J&&!1!==Q){const t=-1===Q?"primitive":"triangulated",e=rt?["lookup",rt.lookUpProperty,rt.lut]:st?"attribute":et?["gradient",et]:it?["gradient",it]:"uniform";this.DV="primitive"===t?{type:t,shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0}),K&&vp.StippleTexture),lineStyleSolid:q,lineStyleDashed:K,fillStyleSolid:tt,fillStyleLinearGradient:et,fillStyleRadialGradient:it,fillStyleIndividual:st,fillStylePaletted:rt,mousePickingShader:Ft&&this.ZB.SE(vp["2D"],vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0}),K&&vp.StippleTexture,vp.MousePicking({useVertexId:!0}))}:"triangulated"===t?{type:t,shader:this.ZB.SE(vp["2D"],vp.Color({dataType:e}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0}),this.PV?vp.AliasedEdge:void 0,K&&vp.StippleTextureInstanced),geometry:wm(this.ZB,Q),thickness:Q,lineStyleSolid:q,lineStyleDashed:K,fillStyleSolid:tt,fillStyleLinearGradient:et,fillStyleRadialGradient:it,fillStyleIndividual:st,fillStylePaletted:rt,mousePickingShader:Ft&&this.ZB.SE(vp["2D"],vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0}),K&&vp.StippleTextureInstanced,vp.MousePicking())}:{type:"none"}}else this.DV={type:"none"};if(this.d$=ut?{shader:this.ZB.SE(vp["2D"],ct&&vp.Color({dataType:["lookup",ct.lookUpProperty,ct.lut]}),lt&&vp.Color({dataType:"attribute"}),ot&&vp.Color({dataType:"uniform"}),at&&vp.Color({dataType:["gradient",at]}),ht&&vp.Color({dataType:["gradient",ht]}),vp.Area2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0,fill:this.mG.T()})),geometry:Zm(this.ZB),fillStyleSolid:ot,fillStyleLinearGradient:at,fillStyleRadialGradient:ht,fillStyleIndividual:lt,fillStylePaletted:ct,mousePickingShader:Ft&&this.ZB.SE(vp["2D"],vp.Area2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0,fill:this.mG.T()}),vp.MousePicking())}:void 0,xt){const t=!(!yt&&!bt),e=Mt>1||t,i=Z?"attribute":"uniform",s=!e&&vp.PointSize("uniform"),r=vp.VertexLocation({offsets:[e&&!t?{directionVar:Wm.gG,dataType:i,sizeUnit:"px",symmetric:!0,rotation:{dataType:W?"attribute-deg":"uniform"},useAlignment:!0}:e&&t?{directionVar:Wm.gG,dataType:i,sizeUnit:"scale",rotation:{dataType:W?"attribute-deg":"uniform"},useAlignment:!0}:void 0],axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0});this.s$={shader:this.ZB.SE(vp["2D"],s,r,dt&&vp.Color({dataType:"uniform",overrideOpacity:!0,maskTexture:!!bt}),ft&&vp.Color({dataType:["gradient",ft],overrideOpacity:!0,maskTexture:!!bt}),gt&&vp.Color({dataType:["gradient",gt],overrideOpacity:!0,maskTexture:!!bt}),pt&&vp.Color({dataType:["lookup",pt.getLookUpProperty(),pt.getPalette()],overrideOpacity:!0,maskTexture:!!bt}),mt&&vp.Color({dataType:"attribute",overrideOpacity:!0,maskTexture:!!bt}),yt&&vp.Color({dataType:["image",yt],overrideOpacity:!0,maskTexture:!!bt})),geometry:$m(At,this.ZB,"uniform"===i?Mt:25),fillStyleSolid:dt,fillStyleLinearGradient:ft,fillStyleRadialGradient:gt,fillStylePaletted:pt,fillStyleIndividual:mt,fillStyleImage:yt,mousePickingShader:Ft&&this.ZB.SE(vp["2D"],s,r,vp.MousePicking({useVertexId:!e})),shapeIcon:bt,pointSizeAsScale:t,instancedRendering:e,borders:vt&&!t&&{shader:this.ZB.SE(vp["2D"],s,vp.VertexLocation({offsets:[e&&!t?{directionVar:Wm.gG,dataType:i,sizeUnit:"px",symmetric:!0,rotation:{dataType:W?"attribute-deg":"uniform"},useAlignment:!0}:e&&t?{directionVar:Wm.gG,dataType:i,sizeUnit:"scale",rotation:{dataType:W?"attribute-deg":"uniform"},useAlignment:!0}:void 0,{directionVar:Wm.vG,dataType:"uniform",sizeUnit:"px",symmetric:!0,rotation:{dataType:W?"attribute-deg":"uniform"}}],axisWorldTranslation:Sr(this.ai),normalSource:void 0,splitPosAttribute:!0}),vp.Color({dataType:"uniform",overrideOpacity:!0,maskTexture:!!bt})),fillStyleSolid:vt}}}else this.s$=void 0}if((void 0===this.i$||Tt)&&G&&(kr(rt)||kr(ct)||kr(pt))){const t=this.i$?Ct:[L.dd()];let e=this.i$?this.i$.max:oi,i=this.i$?this.i$.min:ni;const s=G;t.forEach(t=>{for(let r=t.min;r<=t.max;r+=1){const t=s[r];i=t<i?t:i,e=t>e?t:e}}),this.i$={min:i,max:e}}this.hG=this.ZB.QO(this,this.hG,yt,bt,Et,this.nG),this.RV=K?this.ZB.HO(K.getPattern()):void 0,this.lc(this.hc),this.TG=this.yG,this.IG=this.xG,this.PG=this.SG,this.bG.u=!1,this.MG.u=!1,this.qG.length=0,this.mu=!1,this._G.u=!1,this.Dd.u=!1,this.ui.u=!1,this.mG.u=!1}Nh(){this.Qp();const t=this.Fz.strokeFillLinearGradient(!1),e=this.Fz.strokeFillRadialGradient(!1),i=this.Fz.areaFillLinearGradient(!1),s=this.Fz.areaFillRadialGradient(!1),r=this.Fz.markerFillLinearGradient(!1),n=this.Fz.markerFillRadialGradient(!1);if(this.bD.FR(this.ai),i||s){let t;const e=this.mG.T();t=po("bottom"===e||"top"===e?{min:{x:this.Hi(!1),y:Math.min(this.ai.y.getInnerStart(),this.ai.y.getInnerEnd(),this.Xi(!1),this.Zi(!1))},max:{x:this.Wi(!1),y:Math.max(this.ai.y.getInnerStart(),this.ai.y.getInnerEnd(),this.Xi(!1),this.Zi(!1))}}:{min:{x:Math.min(this.ai.x.getInnerStart(),this.ai.x.getInnerEnd(),this.Hi(!1),this.Wi(!1)),y:this.Xi(!1)},max:{x:Math.max(this.ai.x.getInnerStart(),this.ai.x.getInnerEnd(),this.Hi(!1),this.Wi(!1)),y:this.Zi(!1)}},{x:this.uu()/2,y:this.cu()/2},this.ai),this.f$=this.ZB.sz(i,this,t),this.A$=this.ZB.ez(s,this,t)}if(t||e||r||n){const i=po({min:{x:this.Hi(!1),y:this.Xi(!1)},max:{x:this.Wi(!1),y:this.Zi(!1)}},{x:this.uu()/2,y:this.cu()/2},this.ai);this.g$=this.ZB.sz(t,this,i),this.p$=this.ZB.ez(e,this,i),this.v$=this.ZB.sz(r,this,i),this.y$=this.ZB.ez(n,this,i)}return this}wc(t,e){var i,s,r,n,o,a,h,l,c,u,d,f,g,p,m,y,x,v,A;const S=this.ZB.gl,b=null===(i=this.n$)||void 0===i?void 0:i.bufferX,M=null===(s=this.n$)||void 0===s?void 0:s.bufferY,E=null===(r=this.n$)||void 0===r?void 0:r.bufferColors,k=null===(n=this.n$)||void 0===n?void 0:n.bufferLookupValues,T=null===(o=this.n$)||void 0===o?void 0:o.valueCount,w=null===(a=this.a$)||void 0===a?void 0:a.valueCount,C=null===(h=this.Dd.T())||void 0===h?void 0:h.ts,B=null==C?void 0:C.Qc(this.Rw),F=Math.max((null===(l=this.n$)||void 0===l?void 0:l.valueCount)||0,(null===(c=this.a$)||void 0===c?void 0:c.valueCount)||0);if(!b||!M||!C)return{};const D=(e,i,s)=>{if(Fm(this.ZB,e,this.ai.zt(),b,"aLocation","X",1,!1,S.FLOAT,Float32Array.BYTES_PER_ELEMENT,void 0),Fm(this.ZB,e,this.ai.zt(),M,"aLocation","Y",1,!1,S.FLOAT,Float32Array.BYTES_PER_ELEMENT,void 0),i&&1!==t){if(!E)return!1;Fm(this.ZB,e,!1,E,"aColor","",4,!0,S.UNSIGNED_BYTE,1,void 0)}if(s&&"value"===s.lookUpProperty&&1!==t){if(!k)return!1;Fm(this.ZB,e,!1,k,"aLookupValue","",1,!1,S.FLOAT,Float32Array.BYTES_PER_ELEMENT,void 0)}return!0},I=1===t?null===(u=this.d$)||void 0===u?void 0:u.mousePickingShader:null===(d=this.d$)||void 0===d?void 0:d.shader;if(this.d$&&I&&void 0!==T&&T>0&&B&&2!==t){const i=this.d$;this.ZB.Kc(I).SR(I,(s,r,n,o)=>!!this.ZB.qO(n,t,this,{uniforms:this.bD,idFirst:e,useInstanceID:1===t?F:void 0,fillStyleSolid:i.fillStyleSolid,fillStyleLinearGradient:i.fillStyleLinearGradient,fillStyleRadialGradient:i.fillStyleRadialGradient,fillStylePaletted:i.fillStylePaletted,linearGradientInfo:this.f$,radialGradientInfo:this.A$,lookupValueRange:i.fillStylePaletted?Er(i.fillStylePaletted,this,this.i$):void 0,lookupValueBuffer:null})&&!!D(n,i.fillStyleIndividual,i.fillStylePaletted)&&(null==i||i.geometry.Kc(n).Nk(T-1),!0))}const R="none"===this.DV.type?void 0:1===t?this.DV.mousePickingShader:this.DV.shader;if("none"!==this.DV.type&&R&&void 0!==T&&T>0){const i=this.DV;this.ZB.Kc(R).SR(R,(s,r,n,o)=>{var a,h;if(!this.n$)return!1;if(!this.ZB.qO(n,t,this,{uniforms:this.bD,idFirst:e,useInstanceID:1===t&&"triangulated"===i.type?F:void 0,useVertexID:1===t&&"primitive"===i.type?F:void 0,fillStyleSolid:i.fillStyleSolid,fillStylePaletted:i.fillStylePaletted,fillStyleLinearGradient:i.fillStyleLinearGradient,fillStyleRadialGradient:i.fillStyleRadialGradient,fillStyleIndividual:i.fillStyleIndividual,linearGradientInfo:this.g$,radialGradientInfo:this.p$,lookupValueRange:i.fillStylePaletted?Er(i.fillStylePaletted,this,this.i$):void 0,lookupValueBuffer:"primitive"===i.type?k:null,colorBuffer:"primitive"===i.type?E:null,coordsX:"primitive"===i.type?b:void 0,coordsY:"primitive"===i.type?M:void 0,coordsHighPrecision:this.ai.zt()}))return!1;if(i.lineStyleDashed){if(!this.RV)return!1;this.ZB.MR(s("uStippleCount"),[this.pi.kt().x/this.RV.ZO,this.pi.kt().y/this.RV.ZO])._R(o("uStippleTextureWidthLimiter"),this.RV.XO/this.RV.ZO)._R(s("uStippleScale"),i.lineStyleDashed.getPatternScale()).wR(s("uStippleTexture"),this.RV.WO,1)}if("primitive"===i.type){if(i.lineStyleDashed){if(!(null===(a=this.n$)||void 0===a?void 0:a.bufferLengthSoFar))return!1;this.ZB.PR(r("aLengthSoFar"),this.n$.bufferLengthSoFar)}Bm.IV(this.Sz,T)}else{if(!D(n,i.fillStyleIndividual,i.fillStylePaletted))return!1;if(i.lineStyleDashed){if(!(null===(h=this.n$)||void 0===h?void 0:h.bufferLengthSoFar))return!1;Fm(this.ZB,n,!1,this.n$.bufferLengthSoFar,"aLengthSoFar","",2,!1,S.FLOAT,Float32Array.BYTES_PER_ELEMENT,void 0)}Cm.wc(this.Sz,i.geometry,n,this.PV&&1!==t,1===t,i.thickness,this.n$.valueCount-1)}return!0})}const L=null===(f=this.a$)||void 0===f?void 0:f.bufferX,P=null===(g=this.a$)||void 0===g?void 0:g.bufferY,z=null===(p=this.a$)||void 0===p?void 0:p.bufferColors,_=null===(m=this.a$)||void 0===m?void 0:m.bufferLookupValues,V=null===(y=this.a$)||void 0===y?void 0:y.bufferSizes,N=null===(x=this.a$)||void 0===x?void 0:x.bufferRotations,O=1===t?null===(v=this.s$)||void 0===v?void 0:v.mousePickingShader:null===(A=this.s$)||void 0===A?void 0:A.shader,U=this.s$;let G=1;if(B&&(I||R)&&void 0!==this.u$&&!Number.isNaN(this.u$)){const t="x"===Ns(B)?this.ai.x:this.ai.y,e=this.u$,i=t.getInnerInterval()/e,s=this.MG.T(),r=t.wt()/s/1,n=2*r;G=i<=r?1:Math.max(1-(i-r)/(n-r),0)}if(O&&U&&L&&P&&G>0&&void 0!==w&&w>0){const i=U,s=i.instancedRendering?1:0;if(U.borders&&0===t){const r=U.borders;this.ZB.Kc(r.shader).SR(r.shader,(n,o,a,h)=>{if(!this.ZB.qO(a,t,this,{uniforms:this.bD,idFirst:e,fillStyleSolid:r.fillStyleSolid}))return!1;if(this.ai.zt()?this.ZB.bR(L,s,{location:o("aPos_highpartX"),size:1},{location:o("aPos_lowpartX"),size:1}).bR(P,s,{location:o("aPos_highpartY"),size:1},{location:o("aPos_lowpartY"),size:1}):this.ZB.aO(o("aPosX"),L,s).aO(o("aPosY"),P,s),this.ZB._R(n("uOpacity"),G),i.instancedRendering)if(N)this.ZB.aO(o("aRotDeg"),N,s)._R(n("uBaseRotDeg"),i.geometry.dG);else{const t=Ui(this.wG.T()+i.geometry.dG),e=Math.sin(t),s=Math.cos(t);this.ZB.MR(n("uRot"),[e,s])}return this.ZB.MR(h("uOffsetAlignment"),[-this.kG.x/2,-this.kG.y/2]),i.geometry.pG(a,V,w,this.MG.T(),i.instancedRendering,this.SG.getThickness())})}this.ZB.Kc(O).SR(O,(r,n,o,a)=>{if(!this.a$)return!1;if(!this.ZB.qO(o,t,this,{uniforms:this.bD,idFirst:e,useInstanceID:i.instancedRendering&&1===t?F:void 0,useVertexID:i.instancedRendering||1!==t?void 0:F,fillStyleSolid:i.fillStyleSolid,fillStyleLinearGradient:i.fillStyleLinearGradient,fillStyleRadialGradient:i.fillStyleRadialGradient,linearGradientInfo:this.v$,radialGradientInfo:this.y$,fillStylePaletted:i.fillStylePaletted,fillStyleIndividual:i.fillStyleIndividual,lookupValueRange:i.fillStylePaletted?Er(i.fillStylePaletted,this,this.i$):void 0,lookupValueBuffer:_,lookupValueAttribDivisor:s,colorBuffer:z,colorAttribDivisor:s,fillStyleImage:i.fillStyleImage,texturedFillGLInfo:this.hG,texCoordAttribDivisor:0,maskTexture:i.shapeIcon&&this.hG,maskTextureCoordsAttribDivisor:0}))return!1;if(this.ai.zt()?this.ZB.bR(L,s,{location:n("aPos_highpartX"),size:1},{location:n("aPos_lowpartX"),size:1}).bR(P,s,{location:n("aPos_highpartY"),size:1},{location:n("aPos_lowpartY"),size:1}):this.ZB.aO(n("aPosX"),L,s).aO(n("aPosY"),P,s),1!==t&&this.ZB._R(r("uOpacity"),G),i.instancedRendering)if(N)this.ZB.aO(n("aRotDeg"),N,s)._R(r("uBaseRotDeg"),i.geometry.dG);else{const t=Ui(this.wG.T()+i.geometry.dG),e=Math.sin(t),s=Math.cos(t);this.ZB.MR(r("uRot"),[e,s])}return this.ZB.MR(a("uOffsetAlignment"),[-this.kG.x/2,-this.kG.y/2]),i.geometry.Nk(o,V,0,this.a$.valueCount,i.pointSizeAsScale&&this.hG?{scale:this.MG.T(),width:i.shapeIcon?i.shapeIcon.kt().x:this.hG.texture.YE,height:i.shapeIcon?i.shapeIcon.kt().y:this.hG.texture.jE}:this.MG.T(),i.instancedRendering),!0})}return{idCount:F}}_i(){return this.i$}kc(t,e,i,s,r){var n;const o=null===(n=this.Dd.T())||void 0===n?void 0:n.ts;if(null==o?void 0:o.Qc(this.Rw))return{};const a=t-e;return{info:{dataPoint:null==o?void 0:o.vd(this.Rw,a)}}}dispose(){var t,e,i,s,r,n,o,a,h,l,c,u,d;return super.dispose(),this.ZB.BR(null===(t=this.n$)||void 0===t?void 0:t.bufferX),this.ZB.BR(null===(e=this.n$)||void 0===e?void 0:e.bufferY),this.ZB.BR(null===(i=this.n$)||void 0===i?void 0:i.bufferColors),this.ZB.BR(null===(s=this.n$)||void 0===s?void 0:s.bufferLookupValues),this.ZB.BR(null===(r=this.n$)||void 0===r?void 0:r.bufferRotations),this.ZB.BR(null===(n=this.n$)||void 0===n?void 0:n.bufferSizes),this.ZB.BR(null===(o=this.a$)||void 0===o?void 0:o.bufferX),this.ZB.BR(null===(a=this.a$)||void 0===a?void 0:a.bufferY),this.ZB.BR(null===(h=this.a$)||void 0===h?void 0:h.bufferColors),this.ZB.BR(null===(l=this.a$)||void 0===l?void 0:l.bufferLookupValues),this.ZB.BR(null===(c=this.a$)||void 0===c?void 0:c.bufferRotations),this.ZB.BR(null===(u=this.a$)||void 0===u?void 0:u.bufferSizes),this.DV={type:"none"},this.d$=void 0,this.s$=void 0,this.PN.uN(),null===(d=this.Dd.T())||void 0===d||d.qi(),this.n$=void 0,this.a$=void 0,this.g$=void 0,this.p$=void 0,this.f$=void 0,this.A$=void 0,this.v$=void 0,this.y$=void 0,this.ZB.KO(this,this.hG),this}_c(){return this.dispose(),this}m$(t){if(!this.Rw)return this.r$||ai;if(!this.r$){const e=t.ld(this.Rw);if(0===e.xValues.length)return ai;this.r$={min:{x:ni,y:ni},max:{x:oi,y:oi},h$:Date.now()};const i=e.xValues.length;for(let t=0;t<i;t+=1){const i=e.xValues[t],s=e.yValues[t];this.r$.min.x=i<this.r$.min.x?i:this.r$.min.x,this.r$.min.y=s<this.r$.min.y?s:this.r$.min.y,this.r$.max.x=i>this.r$.max.x?i:this.r$.max.x,this.r$.max.y=s>this.r$.max.y?s:this.r$.max.y}return this.t$.length=0,this.r$}const e=t.Kc(this.Rw),i=e.sd,s=e.ed;if(this.t$.length>0&&i&&s){for(const t of this.t$){for(let e=t.min;e<=t.max;e+=1){const t=i[e],r=s[e];this.r$.min.x=t<this.r$.min.x?t:this.r$.min.x,this.r$.min.y=r<this.r$.min.y?r:this.r$.min.y,this.r$.max.x=t>this.r$.max.x?t:this.r$.max.x,this.r$.max.y=r>this.r$.max.y?r:this.r$.max.y}this.t$.length=0}return this.r$}return this.r$}Wi(t=!0){var e,i,s,r,n;const o=null===(e=this.Dd.T())||void 0===e?void 0:e.ts;if(!o)return 0;const a=o.Qc(this.Rw);return"ProgressiveX"===a?(null===(i=o.gd(this.Rw))||void 0===i?void 0:i.x)||0:"RegressiveX"===a?(null===(s=o.Ad(this.Rw))||void 0===s?void 0:s.x)||0:"ProgressiveY"===a&&t?(null===(r=this.o$)||void 0===r?void 0:r.max)||0:"RegressiveY"===a&&t?(null===(n=this.o$)||void 0===n?void 0:n.max)||0:this.m$(o).max.x}Hi(t=!0){var e,i,s,r,n;const o=null===(e=this.Dd.T())||void 0===e?void 0:e.ts;if(!o)return 0;const a=o.Qc(this.Rw);return"ProgressiveX"===a?(null===(i=o.Ad(this.Rw))||void 0===i?void 0:i.x)||0:"RegressiveX"===a?(null===(s=o.gd(this.Rw))||void 0===s?void 0:s.x)||0:"ProgressiveY"===a&&t?(null===(r=this.o$)||void 0===r?void 0:r.min)||0:"RegressiveY"===a&&t?(null===(n=this.o$)||void 0===n?void 0:n.min)||0:this.m$(o).min.x}Zi(t=!0){var e,i,s,r,n;const o=null===(e=this.Dd.T())||void 0===e?void 0:e.ts;if(!o)return 0;const a=o.Qc(this.Rw);return"ProgressiveX"===a&&t?qt(null===(i=this.o$)||void 0===i?void 0:i.max,0):"RegressiveX"===a&&t?qt(null===(s=this.o$)||void 0===s?void 0:s.max,0):"ProgressiveY"===a?qt(null===(r=o.gd(this.Rw))||void 0===r?void 0:r.y,0):"RegressiveY"===a?qt(null===(n=o.Ad(this.Rw))||void 0===n?void 0:n.y,0):this.m$(o).max.y}Xi(t=!0){var e,i,s,r,n;const o=null===(e=this.Dd.T())||void 0===e?void 0:e.ts;if(!o)return 0;const a=o.Qc(this.Rw);return"ProgressiveX"===a&&t?qt(null===(i=this.o$)||void 0===i?void 0:i.min,0):"RegressiveX"===a&&t?qt(null===(s=this.o$)||void 0===s?void 0:s.min,0):"ProgressiveY"===a?qt(null===(r=o.Ad(this.Rw))||void 0===r?void 0:r.y,0):"RegressiveY"===a?qt(null===(n=o.gd(this.Rw))||void 0===n?void 0:n.y,0):this.m$(o).min.y}uu(){var t,e;let i=this.MG.T();this.hG&&(i=Math.max(this.hG.texture.YE,this.hG.texture.jE)*this.MG.T());const s=Boolean(null===(t=this.Rw)||void 0===t?void 0:t.size),r=Math.max(We(this.hc),s?25:i),n=null===(e=this.Dd.T())||void 0===e?void 0:e.ts.Qc(this.Rw);return!n||"ProgressiveX"!==n&&"RegressiveX"!==n?r:0}cu(){var t,e;let i=this.MG.T();this.hG&&(i=Math.max(this.hG.texture.YE,this.hG.texture.jE)*this.MG.T());const s=Boolean(null===(t=this.Rw)||void 0===t?void 0:t.size),r=Math.max(We(this.hc),s?25:i),n=null===(e=this.Dd.T())||void 0===e?void 0:e.ts.Qc(this.Rw);return!n||"ProgressiveY"!==n&&"RegressiveY"!==n?r:0}}const Jm=()=>{const t=1e3,e=(t,e,i,s,r)=>{const n={min:ni,max:oi};let o,a=0,h=0;for(let l=s;l<=r;l+=1){const s=l%t.length,r=t[s],c=e[s];i&&Number.isNaN(c)?o=void 0:(n.min=Math.min(n.min,c),n.max=Math.max(n.max,c),void 0!==o&&(a+=1,h+=Math.abs(r-o)),o=r)}return{visibleBoundaries:n,avgPointGap:h/a,sampleMin:s,sampleMax:r,finitePointPairCount:a}};let i;return(s,r,n,o,a,h,l)=>{if(!n)return i=void 0,{visibleBoundaries:void 0,avgPointGap:0};if(n.iLastSample-n.iFirstSample+1<2e3)return e(a,h,l,n.iFirstSample,n.iLastSample);o&&(i=void 0),i||(i={iFirst:n.iFirstSample,chunks:[]});let c=i.iFirst,u=i.iFirst+i.chunks.length*t-1;for(;;){const s=u+1,r=u+t;if(!(n.iLastSample>=r))break;{const t=e(a,h,l,s,r);i.chunks.push(t),u=r}}for(;;){const s=c-1,r=c-t;if(!(n.iFirstSample<=r))break;{const t=e(a,h,l,r,s);i.chunks.unshift(t),i.iFirst=r,c=r}}for(let e=0;e<i.chunks.length&&i.chunks[e].sampleMin<n.iFirstSample;e++)i.chunks.splice(e,1),i.iFirst+=t,e--;for(let t=i.chunks.length-1;t>=0&&i.chunks[t].sampleMax>n.iLastSample;t--)i.chunks.splice(t,1);if(0===i.chunks.length)return i=void 0,{visibleBoundaries:void 0,avgPointGap:0};const d={min:ni,max:oi},f=[];for(const t of i.chunks)d.min=Math.min(t.visibleBoundaries.min,d.min),d.max=Math.max(t.visibleBoundaries.max,d.max),f.push(t.avgPointGap);const g=e(a,h,l,n.iFirstSample,i.iFirst-1),p=e(a,h,l,i.chunks[i.chunks.length-1].sampleMax+1,n.iLastSample);return g.finitePointPairCount>0&&(d.min=Math.min(g.visibleBoundaries.min,d.min),d.max=Math.max(g.visibleBoundaries.max,d.max),f.push(g.avgPointGap)),p.finitePointPairCount>0&&(d.min=Math.min(p.visibleBoundaries.min,d.min),d.max=Math.max(p.visibleBoundaries.max,d.max),f.push(p.avgPointGap)),{visibleBoundaries:d,avgPointGap:f.reduce((t,e)=>t+e/f.length,0)}}},Qm=(t,e,i,s,r,n,o,a,h,l,c,u,d,f)=>{const g=Ns(l),p=Os(l),m=Array.isArray(e[0])?zo(e[0]):e[0],y=Array.isArray(e[1])?zo(e[1]):e[1],x=i&&Array.isArray(i)?zo(i):i,v=s&&Array.isArray(s)?zo(s):s,A=r&&Array.isArray(r)?zo(r):r,S=n&&Array.isArray(n)?zo(n):n,b=m.length,M=m.elementAt(0),E=m.elementAt(b-1),k=y.elementAt(0),T=y.elementAt(b-1),w=u?2:1;if(a&&h&&void 0!==a.firstX&&void 0!==a.lastX&&void 0!==a.firstY&&void 0!==a.lastY&&("ProgressiveX"===l&&M>=a.firstX||"RegressiveX"===l&&M<=a.firstX||"ProgressiveY"===l&&k>=a.firstY||"RegressiveY"===l&&k<=a.firstY)){const e="x"===g?m:y,i="x"===g?a.lastX:a.lastY,s=Uo(i,0,b-1,p,t=>e.elementAt(t));if(e.elementAt(s)===i){const e=a.bufferSize-a.valueCount,i=s+1,r=b-i;if(0===r)return a;if(e>=r){const e=m.toArray(i,i+r-1),s=y.toArray(i,i+r-1);if(t.qR(a.bufferX,a.valueCount*w,d(e),Float32Array),t.qR(a.bufferY,a.valueCount*w,d(s),Float32Array),x&&a.bufferColors){const e=x.toArray(i,i+r-1);t.qR(a.bufferColors,a.valueCount,e,Uint32Array)}if(v&&a.bufferLookupValues){const e=v.toArray(i,i+r-1);t.qR(a.bufferLookupValues,a.valueCount,e,Float32Array)}if(A&&a.bufferSizes){const e=A.toArray(i,i+r-1);t.qR(a.bufferSizes,a.valueCount,e,Float32Array)}if(S&&a.bufferRotations){const e=S.toArray(i,i+r-1);t.qR(a.bufferRotations,a.valueCount,e,Float32Array)}if(o&&a.bufferLengthSoFar){const[i,r,n]=ty(e,s,a.lastX||0,a.lastY||0,a.lengthSoFarX,a.lengthSoFarY,f);t.qR(a.bufferLengthSoFar,2*a.valueCount,i,Float32Array),a.lengthSoFarX=r,a.lengthSoFarY=n}return a.valueCount+=r,a.lastX=E,a.lastY=T,a}}}const C=m.toArray(0,b-1),B=y.toArray(0,b-1),F=b+c,D=t.KR(F*w,d(C),null==a?void 0:a.bufferX,Float32Array),I=t.KR(F*w,d(B),null==a?void 0:a.bufferY,Float32Array),R=x?t.KR(F,x.toArray(0,b-1),null==a?void 0:a.bufferColors,Uint32Array):void 0,L=v?t.KR(F,v.toArray(0,b-1),null==a?void 0:a.bufferLookupValues,Float32Array):void 0,P=A?t.KR(F,A.toArray(0,b-1),null==a?void 0:a.bufferSizes,Float32Array):void 0,z=S?t.KR(F,S.toArray(0,b-1),null==a?void 0:a.bufferRotations,Float32Array):void 0;let _,V=0,N=0;if(o){const e=ty(C,B,C[0],B[0],0,0,f);_=t.KR(2*F,e[0],null==a?void 0:a.bufferLengthSoFar,Float32Array),V=e[1],N=e[2]}return{bufferX:D,bufferY:I,bufferColors:R,bufferLookupValues:L,bufferSizes:P,bufferRotations:z,bufferSize:F,bufferLengthSoFar:_,valueCount:b,firstX:M,lastX:E,firstY:k,lastY:T,lengthSoFarX:V,lengthSoFarY:N}},ty=(t,e,i,s,r,n,o)=>{const a=t.length,h=new Float32Array(2*a);if(0===a)return[h,0,0];let l=0,c=i,u=s,d=r,f=n;if(o)for(let i=0;i<a;i+=1){const s=t[i],r=e[i];Number.isNaN(s)||Number.isNaN(r)||Number.isNaN(c)||Number.isNaN(u)?(d=0,f=0,h[l]=0,h[l+1]=0,l+=2):(d+=Math.abs(c-s),f+=Math.abs(u-r),h[l]=d,h[l+1]=f,l+=2),c=s,u=r}else for(let i=0;i<a;i+=1){const s=t[i],r=e[i];d+=Math.abs(c-s),f+=Math.abs(u-r),h[l]=d,h[l+1]=f,l+=2,c=s,u=r}return[h,d,f]},ey={translation:(t,e)=>[1,0,0,0,1,0,t,e,1],rotation(t){const e=Math.cos(t),i=Math.sin(t);return[e,-i,0,i,e,0,0,0,1]},scaling:(t,e)=>[t,0,0,0,e,0,0,0,1],translate:(t,e,i)=>ey.multiply(t,ey.translation(e,i)),rotate:(t,e)=>ey.multiply(t,ey.rotation(e)),scale:(t,e,i)=>ey.multiply(t,ey.scaling(e,i)),multiply(t,e){const i=t[0],s=t[1],r=t[2],n=t[3],o=t[4],a=t[5],h=t[6],l=t[7],c=t[8],u=e[0],d=e[1],f=e[2],g=e[3],p=e[4],m=e[5],y=e[6],x=e[7],v=e[8];return[u*i+d*n+f*h,u*s+d*o+f*l,u*r+d*a+f*c,g*i+p*n+m*h,g*s+p*o+m*l,g*r+p*a+m*c,y*i+x*n+v*h,y*s+x*o+v*l,y*r+x*a+v*c]},projection:(t,e,i)=>[2/t,0,0,0,-2*i/e,0,-1,1*i,1]};class iy extends So{constructor(t,e,i,s,r){super(t,e,i,s,r),this.x$=[],this.bD=new cm,this.S$=[l(0,0),l(0,0),l(0,0),l(0,0)],this.b$=g(l(0,0),l(0,0)),this.M$=g(l(0,0),l(0,0)),this.w$=l(0,0),this._$=l(0,0),this.k$=l(0,0),this.C$=0,this.T$=0,this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStyleRadialGradient:()=>N(this.Ze)&&this.Ze,fillStyleLinearGradient:()=>G(this.Ze)&&this.Ze}),this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.bz=e,this.UV=t.Da.za}Nh(){const t=this.dl(),e=this.cl(),i=this.ui.T();if(t){const t=this.ll(),s=this.Fz.fillStyleSolid(t),r=this.Fz.fillStyleRadialGradient(t),n=this.Fz.fillStyleLinearGradient(t),o=s||r||n,a=this.ZB,h=this.ZB.hR(),c=h!==this.T$;if(this.T$=h,this.bD.FR(this.ai),this.kl.u||c){this.F$&&this.F$.oD(this),this.font.C(ro(this.kl.T(),h));const t=this.font.T();this.F$=this.ZB.kh(t.properties.family),this.F$.Kc(this)}const u=this.font.u||this.ml.u;if(u&&this.F$){const t=this.font.T();[this.I$,this.M$]=this.F$.lD(this.ml.T(),t,this.Sz.bi.isDark),this.x$.forEach(t=>{t.texCoordBuff&&a.BR(t.texCoordBuff),t.vertexBuff&&a.BR(t.vertexBuff)}),this.x$=this.I$.map(t=>({texCoordBuff:a.mR(t.texCoords,!1),texture:t.texture,info:t})),this.kl.u=!1,this.font.u=!1,this.ml.u=!1}const d=this.ai.ei()||e,f=this.Ln.u||this.Ml.u||this.bl.u||this.wl.u||this.Gn.u||this.ot.u||u||d,g=this.Gn.T(),p=Ri(l(this.Ml.T()+1,this.bl.T()+1),.5);if(f&&this.I$&&(this.w$=l(-(g.left*h+this.M$.max.x-this.M$.min.x+g.right*h)*p.x,-(g.bottom*h+this.M$.max.y-this.M$.min.y+g.top*h)*p.y)),(f||d||this._l.u||this.ll())&&this.Ze!==ls){if(this.I$){const t=Li(this.Ln.T(),this.wl.T()),e=tt(t,this.ai,this.pi.ai),i=Ri(e,h);this.k$=i;const s=Ui(this._l.T());this.C$=s,u&&this.x$.forEach(t=>{const e=t.info;e&&(t.vertexBuffLen=e.vertices.length/2,t.vertexBuff=a.mR(e.vertices,!0,t.vertexBuff))});const r=this.ot.T(),n=[Li(Ci(l((this.M$.min.x+(-r.left-g.left)*h+this.w$.x)/h,(this.M$.max.y+(r.top+g.top)*h+this.w$.y)/h),this.Cl,s),e),Li(Ci(l((this.M$.max.x+(r.right+g.right)*h+this.w$.x)/h,(this.M$.max.y+(r.top+g.top)*h+this.w$.y)/h),this.Cl,s),e),Li(Ci(l((this.M$.max.x+(r.right+g.right)*h+this.w$.x)/h,(this.M$.min.y+(-r.bottom-g.bottom)*h+this.w$.y)/h),this.Cl,s),e),Li(Ci(l((this.M$.min.x+(-r.left-g.left)*h+this.w$.x)/h,(this.M$.min.y+(-r.bottom-g.bottom)*h+this.w$.y)/h),this.Cl,s),e)];this.S$=[tt(n[0],this.pi.ai,this.ai),tt(n[1],this.pi.ai,this.ai),tt(n[2],this.pi.ai,this.ai),tt(n[3],this.pi.ai,this.ai)];const o=bi(n);this._$=l(-(o.max.x-o.min.x)*h*p.x-o.min.x*h+this.k$.x,-(o.max.y-o.min.y)*h*p.y-o.min.y*h+this.k$.y),this.Tr=Pi(o.max,o.min),this._$={x:this._$.x/h,y:this._$.y/h};const c=bi(this.S$),d=this.ai.Qt(c.min,this._$),f=this.ai.Qt(c.max,this._$);this.b$=bi([d,f]),this._$={x:this._$.x*h,y:this._$.y*h}}r?this.Rz=Qp(this.b$,this.ai,r.getPosition(),r.getExtent(),r.getShape(),this.ZB.hR()):n?this.Oz=tm(this.b$,this.ai,n.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0)}this.ll()&&(this._D=o?this.ZB.SE(vp["2D"],vp.VertexLocation({axisWorldTranslation:"matrix",normalSource:void 0,snapToNearestPixel:this.UV}),vp.Color({dataType:r?["gradient",r]:n?["gradient",n]:"uniform",maskTextureText:!0})):void 0),this.L$=!this.Nl||this.Ze===ls||s&&0===s.getColor().getA()?void 0:this.L$||this.ZB.SE(vp["2D"],vp.VertexLocation({axisWorldTranslation:"matrix",normalSource:void 0,snapToNearestPixel:this.UV}),vp.Color({dataType:"uniform",maskTextureText:!0})),this.P$=i&&o?this.P$||this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:"matrix",normalSource:void 0,snapToNearestPixel:this.UV})):void 0,this.Ln.u=!1,this.Ml.u=!1,this.bl.u=!1,this.wl.u=!1,this._l.u=!1,this.fl(this.Ze)}return this.Tl=t,this}wc(t,e){if(this.xl){const t=Math.min(this.S$[0].x,this.S$[1].x),e=Math.max(this.S$[0].x,this.S$[1].x),i=Math.min(this.S$[0].y,this.S$[2].y),s=Math.max(this.S$[0].y,this.S$[2].y);this.Ws.qg();const r=Math.min(this.ai.x.$,this.ai.x.U),n=Math.max(this.ai.x.$,this.ai.x.U),o=Math.min(this.ai.y.$,this.ai.y.U),a=Math.max(this.ai.y.$,this.ai.y.U);if(!(t<=n&&r<=e&&i<=a&&o<=s))return{idCount:1}}if(this.dl()){const i=0===t?this.L$:void 0,s=this.Nl,r=1===t?this.P$:this._D;if(!r||0===this.x$.length)return{};const n=this.Fz.fillStyleSolid(!1),o=this.Fz.fillStyleRadialGradient(!1),a=this.Fz.fillStyleLinearGradient(!1),h=this.pi.qD(),l=h.x,c=h.y;let u=ey.projection(l,c,-1);const d=ey.translation(this.w$.x,this.w$.y),f=ey.translation(this._$.x,this._$.y);u=ey.translate(u,this.k$.x,this.k$.y),u=ey.multiply(u,f),u=ey.rotate(u,this.C$),u=ey.multiply(u,d),1===t&&(u=ey.scale(u,this.M$.max.x,this.M$.max.y)),i&&s&&(u=ey.translate(u,this.Sl.x,this.Sl.y),this.ZB.Kc(i).SR(i,(t,e,i,r)=>(this.ZB.WR(t("uMatrix"),u)._R(t("uIsHighlighted"),0).UI(t("uHighlightColorOffset"),B)._R(t("uRenderEffectMask"),0).UI(t("uColor"),s),this.UV&&this.ZB.MR(r("uViewportSizePx"),[h.x*this.ZB.hR(),h.y*this.ZB.hR()]),this.x$.forEach(i=>{this.ZB.PR(e("aPos"),i.vertexBuff).PR(e("aMaskTextureCoord"),i.texCoordBuff).wR(t("uMaskTexture"),i.texture,0).Nk(this.ZB.gl.TRIANGLES,i.vertexBuffLen)}),!0)),u=ey.translate(u,-this.Sl.x,-this.Sl.y)),this.ZB.Kc(r).SR(r,(i,s,r,l)=>{if(this.ZB.WR(i("uMatrix"),u)._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),this.UV&&this.ZB.MR(l("uViewportSizePx"),[h.x*this.ZB.hR(),h.y*this.ZB.hR()]),1===t)this.ZB.ZR(i("uFirstId"),e).UO(r,1);else if(n)this.ZB.UI(i("uColor"),n.getColor());else if(o&&this.Rz){this.ZB.MR(i("uCenter"),this.Rz.center).MR(i("uDistance"),this.Rz.distance).LR(i("uBounds"),this.Rz.bounds)._R(i("uAspect"),this.Rz.aspectRatio);const t=o.getColorStops();for(let e=0;e<t.length;e+=1)this.ZB.UI(i(`color_${e}`),t[e].color)._R(i(`stop_${e}`),t[e].offset)}else if(a&&this.Oz){this.ZB.MR(i("uStartPoint"),this.Oz.startPoint).MR(i("uEndPoint"),this.Oz.endPoint).LR(i("uBounds"),this.Oz.bounds);const t=a.getColorStops();for(let e=0;e<t.length;e+=1)this.ZB.UI(i(`color_${e}`),t[e].color)._R(i(`stop_${e}`),t[e].offset)}return 1===t&&this.ZB.PR(s("aPos"),this.ZB.kO).Nk(this.ZB.gl.TRIANGLES,6),1!==t&&this.x$.forEach(t=>{this.ZB.PR(s("aPos"),t.vertexBuff).PR(s("aMaskTextureCoord"),t.texCoordBuff).wR(i("uMaskTexture"),t.texture,0).Nk(this.ZB.gl.TRIANGLES,t.vertexBuffLen)}),!0})}return{idCount:1}}kc(t,e,i,s,r){return{}}mc(){return this.dl()?bi(this.S$):ai}bc(){return this.dl()&&this.Tr?this.Tr:l(0,0)}kt(){if(this.dl()&&this.b$){const t=this.b$;return l(t.max.x-t.min.x,t.max.y-t.min.y)}return l(0,0)}_c(){return this.x$.forEach(t=>{t.texCoordBuff&&this.ZB.BR(t.texCoordBuff),t.vertexBuff&&this.ZB.BR(t.vertexBuff)}),this.x$=[],this.F$&&this.F$.oD(this),this._D=void 0,this.L$=void 0,this.P$=void 0,this}Wi(){return this.b$.max.x}Hi(){return this.b$.min.x}Zi(){return this.b$.max.y}Xi(){return this.b$.min.y}uu(){return 0}cu(){return 0}}class sy{constructor(t){this.JV=0,this.B$=null,this.D$=t}E$(){return this.D$}R$(t,e,i,s){for(var r,n,o,a,h,l,c,u,d,f,g=this.B$,p=null,m=null,y=!1,x=!1;g&&(null===p&&(this.O$(t,e,null===(r=g.head)||void 0===r?void 0:r.px,null===(n=g.head)||void 0===n?void 0:n.py)?(p=g,y=!0):this.O$(t,e,null===(o=g.tail)||void 0===o?void 0:o.px,null===(a=g.tail)||void 0===a?void 0:a.py)&&(p=g)),null===m&&(this.O$(i,s,null===(h=g.head)||void 0===h?void 0:h.px,null===(l=g.head)||void 0===l?void 0:l.py)?(m=g,x=!0):this.O$(i,s,null===(c=g.tail)||void 0===c?void 0:c.px,null===(u=g.tail)||void 0===u?void 0:u.py)&&(m=g)),null==m||null==p);)g=g.next;switch((null!=p?1:0)|(null!=m?2:0)){case 0:var v={px:t,py:e,prev:null},A={px:i,py:s,next:null};v.next=A,A.prev=v,p={head:v,tail:A,next:this.B$,prev:null,closed:!1},this.B$&&(this.B$.prev=p),this.B$=p,++this.JV;break;case 1:var S={px:i,py:s};y?(S.next=p.head,S.prev=null,p.head.prev=S,p.head=S):(S.next=null,S.prev=p.tail,p.tail.next=S,p.tail=S);break;case 2:S={px:t,py:e},x?(S.next=m.head,S.prev=null,m.head.prev=S,m.head=S):(S.next=null,S.prev=m.tail,m.tail.next=S,m.tail=S);break;case 3:if(p===m){S={px:null===(d=p.tail)||void 0===d?void 0:d.px,py:null===(f=p.tail)||void 0===f?void 0:f.py,next:p.head,prev:null},p.head.prev=S,p.head=S,p.closed=!0;break}switch((y?1:0)|(x?2:0)){case 0:this.z$(p);case 1:m.tail.next=p.head,p.head.prev=m.tail,m.tail=p.tail,this.V$(p);break;case 3:this.z$(p);case 2:p.tail.next=m.head,m.head.prev=p.tail,p.tail=m.tail,this.V$(m)}}}V$(t){t.prev?t.prev.next=t.next:this.B$=t.next,t.next&&(t.next.prev=t.prev),--this.JV}N$(t,e,i=1e-10){return Math.abs(t-e)<Math.min(Math.abs(t),Math.abs(e))*i}O$(t,e,i,s){return!!(t&&e&&i&&s)&&this.N$(t,i)&&this.N$(e,s)}z$(t){for(var e=t.head;e;){var i=e.next;e.next=e.prev,e.prev=i,e=i}i=t.head,t.head=t.tail,t.tail=i}}class ry{constructor(t){this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5),this.contours={},t&&(this.G$=t)}$$(t,e,i,s){const r=e.length-1,n=i.length-1;var o=this.h,a=this.sh,h=this.xh,l=this.yh;const c=s.length;this.contours={};for(var u,d,f,g,p,m=function(t,e){return(o[e]*h[t]-o[t]*h[e])/(o[e]-o[t])},y=function(t,e){return(o[e]*l[t]-o[t]*l[e])/(o[e]-o[t])},x=0,v=0,A=0,S=0,b=[0,1,1,0],M=[0,0,1,1],E=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],k=n-1;k>=0;k--)for(var T=0;T<r;T++){let r=t(T,k),n=t(T+1,k),D=t(T,k+1),I=t(T+1,k+1);var w=Math.min(D,r),C=Math.min(I,n);if(g=Math.min(w,C),w=Math.max(D,r),C=Math.max(I,n),!((p=Math.max(w,C))<s[0]&&g>s[c-1]))for(var B=0;B<c;B++)if(s[B]>=g&&s[B]<=p){for(var F=4;F>=0;F--)F>0?(o[F]=t(T+b[F-1],k+M[F-1])-s[B],h[F]=e[T+b[F-1]],l[F]=i[k+M[F-1]]):(o[0]=.25*(o[1]+o[2]+o[3]+o[4]),h[0]=.5*(e[T]+e[T+1]),l[0]=.5*(i[k]+i[k+1])),o[F]>1e-10?a[F]=2:o[F]<-1e-10?a[F]=0:a[F]=1;for(F=1;F<=4;F++)if(d=4!=F?F+1:1,0!=(f=E[a[u=F]][a[0]][a[d]])){switch(f){case 1:x=h[u],A=l[u],v=h[0],S=l[0];break;case 2:x=h[0],A=l[0],v=h[d],S=l[d];break;case 3:x=h[d],A=l[d],v=h[u],S=l[u];break;case 4:x=h[u],A=l[u],v=m(0,d),S=y(0,d);break;case 5:x=h[0],A=l[0],v=m(d,u),S=y(d,u);break;case 6:x=h[d],A=l[d],v=m(u,0),S=y(u,0);break;case 7:x=m(u,0),A=y(u,0),v=m(0,d),S=y(0,d);break;case 8:x=m(0,d),A=y(0,d),v=m(d,u),S=y(d,u);break;case 9:x=m(d,u),A=y(d,u),v=m(u,0),S=y(u,0)}this.G$(x,A,v,S,s[B],B)}}}}G$(t,e,i,s,r,n){let o=this.contours[n];o||(o=this.contours[n]=new sy(r)),o.R$(t,e,i,s)}get U$(){var t=[],e=this.contours;for(var i in e)for(var s=e[i].B$,r=e[i].D$;s;){var n=s.head,o=[];for(o.ax=[],o.ay=[],o.level=r,o.k=i;n&&n.px&&n.py;)o.ax.push(n.px),o.ay.push(n.py),n=n.next;t.push(o),s=s.next}return t.sort((t,e)=>t.length-e.length),t}}class ny extends vo{constructor(t,e,i,s,r,n){super(t,e,i,s,r),this.Y$=m("bilinear"),this.j$=m(void 0),this.H$=!0,this.jt={x:0,y:0},this.W$={x:1,y:1},this.Kv=co.lineStyle,this.X$=m(void 0),this.engine=t;const o="columns"===n.dataOrder?n.columns:n.rows,a="columns"===n.dataOrder?n.rows:n.columns;this.Da={...n,primaryDimensionVectorsCount:o,secondaryDimensionVectorsCount:a},this.Z$=new ry}ly(t){return this.Y$.C(t),this}uy(){return this.Y$.T()}xb(t){return this.j$.C(t),this}Sb(){return this.j$.T()}sy(t,e){return this.H$=this.jt!=t||this.W$!=e,this.jt=t,this.W$=e,this}ey(){return{start:this.jt,step:this.W$,end:{x:this.jt.x+this.W$.x*this.Da.columns,y:this.jt.y+this.W$.y*this.Da.rows}}}qv(t){return this.Kv="function"==typeof t?t(this.Kv):t,this}oy(){return this.Kv}hy(t){return this.X$.C(t),this}ny(){return this.X$.T()}}class oy extends ny{constructor(t,e,i,s,r,n){super(t,e,i,s,r,n),this.bD=new cm,this.DV={},this.J$=[],this.Q$=!1,this.mu=!1,this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStylePaletted:()=>vs(this.Ze)&&this.Ze,wireframeStyleLine:()=>cr(this.Kv)&&this.Kv,wireframeStyleFill:()=>{const t=this.Kv&&this.Kv.getFillStyle();return gs(t)&&t}}),this.K$=void 0,this.q$=Yc,this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.bz=e;const o=Math.min(this.ZB.QB,void 0!==n.Ab?n.Ab:2048),a={x:Math.min(o,this.Da.primaryDimensionVectorsCount),y:Math.min(o,this.Da.secondaryDimensionVectorsCount)},h=((t,e,i)=>{const s=[],r=i(t.primaryDimensionVectorsCount,e.x),n=i(t.secondaryDimensionVectorsCount,e.y);let o;return r.forEach(t=>n.forEach(e=>{const i={iFirstVector:{primary:t.start,secondary:e.start},iFirstUniqueVector:{primary:t.startUnique,secondary:e.startUnique},sizeHeatmapDataVectors:{primary:t.sizeData,secondary:e.sizeData},sizeUniqueHeatmapDataVectors:{primary:t.sizeUniqueData,secondary:e.sizeUniqueData}};s.push(i)})),o=[],s.forEach(t=>{let e=o.find(e=>e.sizeHeatmapData.primary===t.sizeHeatmapDataVectors.primary&&e.sizeHeatmapData.secondary===t.sizeHeatmapDataVectors.secondary);e||(e={sizeHeatmapData:t.sizeHeatmapDataVectors,tiles:[]},o.push(e)),e.tiles.push(t)}),{gridTiles:s,gridTileSizes:o}})(this.Da,a,this.q$),l=h.gridTiles.map(t=>({...t,intensityData:void 0,hasIntensityData:!1})),c=h.gridTileSizes.map(t=>({...t,tiles:l.filter(e=>e.sizeHeatmapDataVectors.primary===t.sizeHeatmapData.primary&&e.sizeHeatmapDataVectors.secondary===t.sizeHeatmapData.secondary)}));this.tU={gridTiles:l,gridTileSizes:c},this.sy(this.jt,this.W$),this.iU=[],this.sU=new Th(()=>{const t=new Km(this.Sz,this.bz,this.ai,jt);return t.Od(ls).Rd(ls),t}),this.eU=[],this.rU=new Th(()=>{const t=new iy(this.Sz,this.bz,this.ai,jt,[]);return t.Zl({x:0,y:0}),t})}hU(){return this.ZB.pi.sa.AE}_i(){return this.nU}oU(t){return t.intensityData||(t.intensityData=new Float32Array(t.sizeHeatmapDataVectors.primary*t.sizeHeatmapDataVectors.secondary)),t.intensityData}aU(t,e){return 0<=t&&t<e?t:t<0?t%e+e:t%e}lU(t,e){const i=tt(t,this.ai,this.bz.pi.ai),s=tt(e,this.ai,this.bz.pi.ai);let r=180*Math.atan2(i.y-s.y,s.x-i.x)/Math.PI;return(r<-90||90<r)&&(r+=180),r}uU(t,e,i,s){const r=Zi(t,e,i,s);if(r){let n=Math.min(t.x,e.x,i.x,s.x),o=Math.max(t.x,e.x,i.x,s.x),a=Math.min(t.y,e.y,i.y,s.y),h=Math.max(t.y,e.y,i.y,s.y);if(r.x<=n||o<=r.x||r.y<=a||h<=r.y)return}return r}cU(t,e,i,s){if(e.length<5)return{labelPos:[{x:NaN,y:NaN}],labelAngle:[Number.NaN]};void 0===this.K$&&(this.K$=new iy(this.Sz,this.bz,this.ai,this.yi,[]));const r=t.labelFont;let n=this.K$.tn(s).Th(0).Ch(r).Nh().kt().x;Number.isNaN(n)&&(this.K$.dispose(),this.K$=new iy(this.Sz,this.bz,this.ai,this.yi,[]),n=this.K$.tn(s).Th(0).Ch(r).Nh().kt().x);const o=this.K$,a=this.ai.x.$,h=this.ai.x.U,l=this.ai.y.$,c=this.ai.y.U,u={x:a,y:l},d={x:h,y:c},f=[{x:u.x,y:u.y},{x:u.x,y:d.y}],g=[{x:u.x,y:d.y},{x:d.x,y:d.y}],p=[{x:d.x,y:u.y},{x:d.x,y:d.y}],m=[{x:u.x,y:u.y},{x:d.x,y:u.y}];let y={x:e[0],y:i[0]},x={x:e[1],y:i[1]},v=[];const A=u.x,S=d.x,b=u.y,M=d.y,E=(t,e,i,s)=>{const r=wi(t,u,d),n=wi(e,u,d);if(r&&n)return s?(i.push(t),i.push(e),!1):(i.push(e),!1);{if(!r&&!n&&(t.x<A&&e.x<A||t.y<b&&e.y<b||S<t.x&&S<e.x||M<t.y&&M<e.y))return!(0<i.length&&0==isNaN(i[i.length-1].x)&&(i.push({x:NaN,y:NaN}),0));const o=this.uU(f[0],f[1],t,e),a=this.uU(g[0],g[1],t,e),h=this.uU(p[0],p[1],t,e),l=this.uU(m[0],m[1],t,e),c=[];if(o&&c.push(o),a&&c.push(a),h&&c.push(h),l&&c.push(l),1==c.length){if(r)s&&i.push(t),i.push(e),i.push({x:NaN,y:NaN});else if(n)return i.push(t),i.push(e),!1}else 2==c.length&&(0<i.length&&0==isNaN(i[i.length-1].x)&&i.push({x:NaN,y:NaN}),i.push(c[0]),i.push(c[1]),i.push({x:NaN,y:NaN}));return!0}};let k=E(y,x,v,!0);const T=4*this.ai.x.getPixelSize()/2;for(let t=2;t<e.length;t++)x={x:e[t],y:i[t]},T<=Math.abs(x.x-y.x)+Math.abs(x.y-y.y)&&(k=E(y,x,v,k),y=x);const w=v.length;if(w<2)return{labelPos:[{x:NaN,y:NaN}],labelAngle:[Number.NaN]};y={x:e[e.length-1],y:i[i.length-1]},wi(y,u,d)&&y.x==v[0].x&&y.y==v[0].y&&v.push(v[0]);let C=[];const B=[];let F=0;for(let t=F+1;t<2*w;t++){let e=this.aU(t,w);if(w<t&&n<this.vf(v[e],v[0]))break;let i=this.aU(F,w);if(isNaN(v[i].x)){0<C.length&&(B.push(C),C=[]),++F,t=F;continue}const s=isNaN(v[e].x);let r=0;if(s){0<C.length&&(B.push(C),C=[]),++t,F=t;continue}const o=0;if(v[e].x<u.x+o||d.x-o<v[e].x||v[e].y<u.y+o||d.y-o<v[e].y)++t,F=t;else if(r=this.vf(v[e],v[i]),n<r){const s=v[i],r=v[e];let n=Number.MIN_VALUE;const o=0;for(let e=F+1;e<t-1;e++){const t=this.aU(e,w);if(isNaN(v[t].x))break;if(n!=Number.MIN_VALUE&&(v[t].x<u.x+o||d.x-o<v[t].x||v[t].y<u.y+o||d.y-o<v[t].y))continue;const i=vi({x:v[t].x,y:v[t].y},s,r);n<i&&(n=i)}if(n!=Number.MIN_VALUE&&(C.push({x:n,y:i,z:e}),w<=t&&0<=i))break;++F,t=F}else s&&(++F,t=F)}x={x:0,y:0};let D=-1;const I=[],R=[];B.length<1&&0<C.length&&B.push(C);for(let t=0;t<B.length;t++){C=B[t],C.sort((t,e)=>t.x-e.x),D=C[0].y;let s=0,n=C[0].z;this.eU.forEach((t,a)=>{const h=o.sr({x:t.position.x,y:t.position.y}).Th(t.angle).Ch(t.font).Nh().mc();if(isNaN(h.min.x))return;let l=D,c=n;if(v[l]&&v[c]&&!isNaN(v[l].x)&&!isNaN(v[c].x)){let t=this.lU(v[l],v[c]),n=o.sr({x:e[D],y:i[D]}).Th(t).Ch(r).Nh().mc();for(;ci(h,n)&&s<C.length-1;)if(l=C[++s].y,c=C[s].z,v[l]&&v[c]&&!isNaN(v[l].x)&&!isNaN(v[c].x)){const e=(v[l].x+v[c].x)/2,i=(v[l].y+v[c].y)/2;t=this.lU(v[l],v[c]),n=o.sr({x:e,y:i}).Th(t).Ch(r).Nh().mc()}}}),C.length<=s&&(s=0);let a=C[s].y,h=C[s].z,l=0;l=a<h?h-a:w-a+h,3<l&&(l-=2),D=a;let c=Number.NaN,u=Number.NaN;if(v[0].x==v[v.length-1].x&&v[0].y===v[v.length-1].y){D=a;let t=this.aU(a-1,v.length),e=this.aU(a+l,v.length);c=(v[t].x+v[e].x)/2,u=(v[t].y+v[e].y)/2}else if(a<4){D=3,a=D,h=this.aU(a+l+1,v.length);let t=this.aU(a,v.length),e=this.aU(h,v.length);c=(v[t].x+v[e].x)/2,u=(v[t].y+v[e].y)/2}else{for(D=a-1;D<v.length&&isNaN(v[D].x);)++D;if(D==v.length)for(;D<v.length&&isNaN(v[D].x);)++D;let t=this.aU(D,v.length),e=this.aU(D+l+1,v.length);c=(v[t].x+v[e].x)/2,u=(v[t].y+v[e].y)/2}0<=D&&(y=v[a],x=v[h],I.push({x:c,y:u}),R.push(this.lU(y,x)))}return 0<=I.length?{labelPos:I,labelAngle:R}:{labelPos:[{x:NaN,y:NaN}],labelAngle:[Number.NaN]}}vf(t,e){const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)}dU(t,e){if(!this.tU)return this;if(!t)return this.fU(!0),this.AU(!0),this;if(!e)return(this.ai.x.Lt||this.ai.x.rt||this.ai.y.Lt||this.ai.y.rt)&&this.gU(t),this;if(!this.tU.gridTiles)return this;if(!this.pU)return this;const i=this.pU.boundaries.min.x,s=this.pU.boundaries.min.y,r=this.pU.boundaries.max.x,n=this.pU.boundaries.max.y;if(null==i||null==s||null==r||null==n)return this;const o=this.Da.columns,a=this.Da.rows,h=(r-i)/o,l=(n-s)/a,c=new Array(o).fill(0,0,o).map((t,e)=>i+e*h+h/2),u=new Array(a).fill(0,0,a).map((t,e)=>s+e*l+l/2);let d=[];t.levels.forEach(t=>{d.push(t.value)});const f=(t,e)=>"rows"==this.Da.dataOrder?e:t,g=(t,e)=>"rows"==this.Da.dataOrder?t:e;return this.Z$.$$((t,e)=>this.vU(f(t,e),g(t,e)),c,u,d),this.yU(t),this.gU(t),this}yU(t){this.fU();let e=new Map;return t.levels.forEach(t=>{e.set(t.value,t.strokeStyle)}),this.Z$.U$.forEach(t=>{let i=t.level;const s=e.get(i),r=this.iU.find(t=>t.lineStyle===s);if(r)r.points.appendSample({xValues:NaN,yValues:NaN}),r.points.appendSamples({xValues:t.ax,yValues:t.ay});else{const e=new Vo({warnings:!1,schema:{xValues:{pattern:null},yValues:{pattern:null}}});e.appendSamples({xValues:t.ax,yValues:t.ay});const i={lineStyle:s,points:e};this.iU.push(i)}}),this}gU(t){this.AU();const e=vs(this.Ze)?this.Ze.lut:void 0;return this.Z$.U$.forEach(i=>{var s,r,n;let o=[],a=[];const h=i.k,l=t.levels[h],c=null!==(r=null!==(s=l.label)&&void 0!==s?s:null==e?void 0:e.getFormatter()(l.value,{min:e.min,max:e.max}))&&void 0!==r?r:l.value.toString();if(t.showLabels&&(({labelPos:o,labelAngle:a}=this.cU(t.levels[h],i.ax,i.ay,c)),0<o.length))for(let e=0;e<o.length;e++)this.eU.push({text:c,position:o[e],angle:a[e],font:l.labelFont,fill:l.labelFillStyle,shadow:null!==(n=t.shadows)&&void 0!==n?n:void 0})}),this}Nh(){const t=this.J$,e=this.Ze,i=this.ll(),s=this.Kv,r=s!==this.mU,n=this.Fz.wireframeStyleLine(r),o=this.Fz.wireframeStyleFill(r),a=n&&o&&!this.ai.zt(),h=this.Fz.fillStylePaletted(i),l=this.Fz.fillStyleSolid(i),c=this.Y$.u,u=this.j$.u,d=this.Y$.T(),f=this.mu,g=this.ui.T();this.xU=this.xU||this.SU();const p=this.xU,m=Wc(t,p,f?"intensity":void 0,t=>t.sizeHeatmapDataVectors),y=this.X$.T(),x=y!==this.bU;this.dU(y,x||m.size>0||this.H$),this.bU=this.X$.T(),this.H$=!1,m.size>0&&(qc(this.ZB,m,t=>this.oU(t.tileData),t=>t.intensityDataTexture),this.Q$=!0),this.bD.FR(this.ai);const v=this.DV;if((i||c||u)&&(v.tile=h?{renderMode:"paletted",fillStylePaletted:h,shader:this.ZB.SE(vp["2D"],vp.ColorGrid2D({heatmapType:"intensity",interpolation:"bilinear"===d&&"bilinear",flipXY:"rows"===this.Da.dataOrder,intensityTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN,lut:h.lut,aggregation:this.j$.T()}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}))}:l?{renderMode:"solid",fillStyleSolid:l,shader:this.ZB.SE(vp["2D"],vp.Color({dataType:"uniform"}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}))}:void 0),r&&(v.wireframe=a&&n&&o?-1===n.getThickness()?{renderMode:"primitive",shader:this.ZB.SE(vp["2D"],vp.Color({dataType:"uniform"}),vp.VertexLocation({translation:{dataType:"uniform",sizeUnit:"axis"},scaling:{dataType:"uniform"},flipXY:"rows"===this.Da.dataOrder,axisWorldTranslation:Sr(this.ai),normalSource:void 0})),fillStyleSolid:o}:{renderMode:"triangulated",shader:this.ZB.SE(vp["2D"],vp.Color({dataType:"uniform"}),vp.LineInstanced2D({translation:{dataType:"uniform",sizeUnit:"axis"},scaling:{dataType:"uniform"},flipXY:"rows"===this.Da.dataOrder,axisWorldTranslation:Sr(this.ai),normalSource:void 0})),geometry:wm(this.ZB,1),solidLine:n,fillStyleSolid:o}:void 0,v.wireframe?this.MU=this.MU||this.wU():this.MU&&(this.ZB.BR(this.MU.wireframeCoordinatesBuffer),this.MU=void 0)),v.mousePicking=g?this.DV.mousePicking||{shader:this.ZB.SE(vp["2D"],vp.MousePicking(),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}))}:void 0,this.DV=v,void 0===this.nU&&h&&"value"===h.lookUpProperty&&h.lut.percentageValues){let t=ni,e=oi;this.xU.gridTiles.forEach(i=>{const s=this.oU(i.tileData);for(let i=0;i<s.length;i+=1){const r=s[i];r<t&&(t=r),r>e&&(e=r)}}),this.nU={min:t,max:e}}return this.mu=!1,this.J$.length=0,this.fl(e),this.mU=s,this.Y$.u=!1,this.j$.u=!1,this}SU(){const t=this.tU.gridTiles.map(t=>{const e=Xc(this.ZB,t.sizeHeatmapDataVectors.secondary,t.sizeHeatmapDataVectors.primary);return{...t,intensityDataTexture:e,tileData:t}}),e=this.tU.gridTileSizes.map(e=>({...e,tiles:t.filter(t=>t.sizeHeatmapDataVectors.primary===e.sizeHeatmapData.primary&&t.sizeHeatmapDataVectors.secondary===e.sizeHeatmapData.secondary)})),i=this.ZB.mR(new Float32Array(16)),s=this.ZB.gl.TRIANGLE_STRIP;return{gridTiles:t,gridTileSizes:e,rectangleLocationsBuffer:i,rectangleLocationsDrawMode:s,rectangleLocationsDrawLength:4}}wU(){const t=this.Da.primaryDimensionVectorsCount+1+this.Da.secondaryDimensionVectorsCount+1,e=new Float32Array(4*t);let i=0;for(let t=0;t<this.Da.primaryDimensionVectorsCount+1;t+=1)e[i+0]=t,e[i+1]=0,e[i+2]=t,e[i+3]=this.Da.secondaryDimensionVectorsCount,i+=4;for(let t=0;t<this.Da.secondaryDimensionVectorsCount+1;t+=1)e[i+0]=0,e[i+1]=t,e[i+2]=this.Da.primaryDimensionVectorsCount,e[i+3]=t,i+=4;return{wireframeCoordinatesBuffer:this.ZB.mR(e),wireframeSegmentsLength:t}}sy(t,e){super.sy(t,e);const i=this.Da,s=g({x:Math.min(this.jt.x,this.jt.x+i.columns*this.W$.x),y:Math.min(this.jt.y,this.jt.y+i.rows*this.W$.y)},{x:Math.max(this.jt.x,this.jt.x+i.columns*this.W$.x),y:Math.max(this.jt.y,this.jt.y+i.rows*this.W$.y)}),r=new Map;return this.tU.gridTiles.forEach(t=>{const e="columns"===this.Da.dataOrder?{x:this.jt.x+this.W$.x*t.iFirstVector.primary,y:this.jt.y+this.W$.y*t.iFirstVector.secondary}:{x:this.jt.x+this.W$.x*t.iFirstVector.secondary,y:this.jt.y+this.W$.y*t.iFirstVector.primary},i="columns"===this.Da.dataOrder?{x:this.W$.x*t.sizeHeatmapDataVectors.primary,y:this.W$.y*t.sizeHeatmapDataVectors.secondary}:{x:this.W$.x*t.sizeHeatmapDataVectors.secondary,y:this.W$.y*t.sizeHeatmapDataVectors.primary},s="columns"===this.Da.dataOrder?{x:this.jt.x+this.W$.x*t.iFirstUniqueVector.primary,y:this.jt.y+this.W$.y*t.iFirstUniqueVector.secondary}:{x:this.jt.x+this.W$.x*t.iFirstUniqueVector.secondary,y:this.jt.y+this.W$.y*t.iFirstUniqueVector.primary},n="columns"===this.Da.dataOrder?{x:this.W$.x*t.sizeUniqueHeatmapDataVectors.primary,y:this.W$.y*t.sizeUniqueHeatmapDataVectors.secondary}:{x:this.W$.x*t.sizeUniqueHeatmapDataVectors.secondary,y:this.W$.y*t.sizeUniqueHeatmapDataVectors.primary};r.set(t,{startLocationAxis:e,sizeAxis:i,startRenderLocationAxis:s,renderSizeAxis:n})}),this.pU={boundaries:s,tilesInfo:r},this}wc(t,e){var i,s;const r=this.xU,n=this.pU;if(this.j$.T()&&"bilinear"===this.Y$.T())return Ut.console.warn("LightningChart JS error | heatmap has both bilinear interpolation and aggregation enabled at same time. Disable one of them"),{idCount:0};const o=1===t?null===(i=this.DV.mousePicking)||void 0===i?void 0:i.shader:null===(s=this.DV.tile)||void 0===s?void 0:s.shader;if(this.DV.tile&&o&&r&&n){const i=o,s=this.DV.tile,a={x:(n.boundaries.max.x-n.boundaries.min.x)*Math.sign(this.W$.x),y:(n.boundaries.max.y-n.boundaries.min.y)*Math.sign(this.W$.y)},h={x:a.x/this.Da.columns,y:a.y/this.Da.rows},l=this.ai.ni(),c={x:h.x/l.x,y:h.y/l.y};this.ZB.Kc(i).SR(i,(i,o,a,h)=>{let l=!1;if(!this.ZB.qO(a,t,this,{uniforms:this.bD,idFirst:e,fillStyleSolid:"solid"===s.renderMode&&s.fillStyleSolid}))return!1;if("solid"===s.renderMode||1===t){const t=pe([{x:this.jt.x,y:this.jt.y},{x:this.jt.x+this.W$.x*this.Da.columns,y:this.jt.y},{x:this.jt.x,y:this.jt.y+this.W$.y*this.Da.rows},{x:this.jt.x+this.W$.x*this.Da.columns,y:this.jt.y+this.W$.y*this.Da.rows}],this.ai.zt());this.ZB.qR(r.rectangleLocationsBuffer,0,t),this.ZB.RO(a,r.rectangleLocationsBuffer,this.ai.zt(),void 0).Nk(this.ZB.gl.TRIANGLE_STRIP,4),l=!0}else if("paletted"===s.renderMode){if(this.ZB.JO(a,s.fillStylePaletted.lut,this.nU),this.j$.T()){const t=c.x<1?Math.max(Math.ceil(.5/c.x),1):0,e=c.y<1?Math.max(Math.ceil(.5/c.y),1):0;this.ZB.MR(i("uAggregationWindowSize"),[t,e])}u=t=>{this.ZB.MR(i("uTileDimensions"),["columns"===this.Da.dataOrder?t.sizeHeatmapData.primary:t.sizeHeatmapData.secondary,"columns"===this.Da.dataOrder?t.sizeHeatmapData.secondary:t.sizeHeatmapData.primary])},d=(t,e)=>{const s=n.tilesInfo.get(t.tileData);if(!s)return;let o;const h=this.ZB.hR();if("bilinear"===this.Y$.T()){const t=(this.ai.x.Dt(s.startLocationAxis.x)+c.x/2)*h,e=(this.ai.y.Dt(s.startLocationAxis.y)+c.y/2)*h;o=[t,e,(this.ai.x.Dt(s.startLocationAxis.x+s.sizeAxis.x)-c.x/2)*h-t,(this.ai.y.Dt(s.startLocationAxis.y+s.sizeAxis.y)-c.y/2)*h-e]}else{const t=this.ai.x.Dt(s.startLocationAxis.x)*h,e=this.ai.y.Dt(s.startLocationAxis.y)*h;o=[t,e,this.ai.x.Dt(s.startLocationAxis.x+s.sizeAxis.x)*h-t,this.ai.y.Dt(s.startLocationAxis.y+s.sizeAxis.y)*h-e]}const u=pe([{x:s.startRenderLocationAxis.x,y:s.startRenderLocationAxis.y},{x:s.startRenderLocationAxis.x+s.renderSizeAxis.x,y:s.startRenderLocationAxis.y},{x:s.startRenderLocationAxis.x,y:s.startRenderLocationAxis.y+s.renderSizeAxis.y},{x:s.startRenderLocationAxis.x+s.renderSizeAxis.x,y:s.startRenderLocationAxis.y+s.renderSizeAxis.y}],this.ai.zt());this.ZB.qR(r.rectangleLocationsBuffer,0,u),this.ZB.LR(i("uTileBounds"),o).wR(i("uTileIntensityValues"),t.intensityDataTexture,1).RO(a,r.rectangleLocationsBuffer,this.ai.zt(),void 0).Nk(this.ZB.gl.TRIANGLE_STRIP,4),l=!0},r.gridTileSizes.forEach(t=>{u(t),t.tiles.forEach(t=>{d(t)})})}var u,d;return 1===t&&this.ZB.UO(a,1),l})}const a=this.MU,h=this.DV.wireframe,l=1===t||null==h?void 0:h.shader;if(a&&h&&l&&"primitive"===h.renderMode){const{fillStyleSolid:e}=h;this.ZB.Kc(l).SR(l,(i,s,r)=>((this.ai instanceof q||this.ai instanceof Ar)&&this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR()),this.ZB._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0).UI(i("uColor"),e.getColor()).bR(a.wireframeCoordinatesBuffer,void 0,{location:s("aPos"),size:2}).MR(i("uScaling"),[this.W$.x,this.W$.y]).MR(i("uTranslationAxis"),[this.jt.x,this.jt.y]).Nk(this.ZB.gl.LINES,2*a.wireframeSegmentsLength),!0))}else if(a&&h&&l&&"triangulated"===h.renderMode){const{geometry:e,solidLine:i,fillStyleSolid:s}=h;this.ZB.Kc(l).SR(l,(r,n,o)=>((this.ai instanceof q||this.ai instanceof Ar)&&this.ZB.MR(r("uScale"),this.bD.kR()).MR(r("uDisp"),this.bD.CR()),this.ZB._R(r("uIsHighlighted"),1===t||2===t?0:this.gi).UI(r("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(r("uRenderEffectMask"),2===t?1:0).UI(r("uColor"),s.getColor())._R(r("uThicknessPixels"),i.getThickness()).MR(r("uRatioPxClip"),[2/this.pi.kt().x,2/this.pi.kt().y]).bR(a.wireframeCoordinatesBuffer,1,{location:n("aLocationA"),size:2},{location:n("aLocationB"),size:2}).MR(r("uScaling"),[this.W$.x,this.W$.y]).MR(r("uTranslationAxis"),[this.jt.x,this.jt.y]),e.Kc(o,!1).Nk(a.wireframeSegmentsLength),!0))}if(0===t){const e=this.hU()&&this.eU,i=this.ZB,s=this.ai.x.Yt(),r=this.ai.x.$t(),n=this.ai.y.Yt(),o=this.ai.y.$t(),a=(t,e,i)=>{const a=e.position;return s<a.x&&a.x<r&&n<a.y&&a.y<o&&(i.add().sr(a).qh(e.shadow).tn(e.text).Th(e.angle).Ch(e.font).qe(e.fill).Nh().wc(t,0),!0)},h=this.rU.VA();e&&(((t,e)=>{if(void 0===e)return;const i=t.gl;t.IR(!0),i.clearStencil(1),i.clear(i.STENCIL_BUFFER_BIT),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.stencilMask(255),i.colorMask(!1,!1,!1,!1),e(),i.colorMask(!0,!0,!0,!0)})(i,()=>{this.eU.forEach(t=>{a(1,t,h)})}),i.gl.stencilFunc(i.gl.EQUAL,1,255),i.gl.stencilOp(i.gl.KEEP,i.gl.KEEP,i.gl.KEEP),i.IR(!0));const l=this.sU.VA();if(l){const e=l.add();this.iU.forEach(i=>{e.Ed(i.points,{x:"xValues",y:"yValues"}),e.cr(i.lineStyle),e.Nh(),e.wc(t,0)})}l.finishPlot(),e&&i.IR(!1),this.eU&&this.eU.forEach(e=>{a(t,e,h)}),h.finishPlot()}return{idCount:1}}kc(t,e,i,s,r){return{}}Ay(t){return 0===t.lengthPrimary||0===t.lengthSecondary||(this.J$.push(t),$c(this.tU.gridTiles,t,t=>(t.hasIntensityData=!0,this.oU(t)),(t,e)=>{t.hasIntensityData=!0,t.intensityData=e}),this.nU=void 0),this}Vi(){return this.Q$&&(this.tU.gridTiles.forEach(t=>{t.intensityData&&t.intensityData.fill(0),t.hasIntensityData=!1}),this.mu=!0,this.Q$=!1,this.nU=void 0),this}fU(t=!1){return t&&this.sU.UA(),this.iU.length=0,this}AU(t=!1){return t&&(this.rU.UA(),this.K$&&(this.K$.dispose(),this.K$=void 0)),this.eU.length=0,this}dispose(){super.dispose();const t=this.xU;t&&(t.gridTiles.forEach(t=>{this.ZB.KB(t.intensityDataTexture)}),t.gridTiles.length=0,t.gridTileSizes.forEach(()=>{}),t.gridTileSizes.length=0,this.ZB.BR(t.rectangleLocationsBuffer)),this.xU=void 0;const e=this.MU;return e&&this.ZB.BR(e.wireframeCoordinatesBuffer),this.MU=void 0,this.fU(!0),this.AU(!0),this.DV={},this}_c(){return this.dispose(),this}yd(t){const e=t,i="columns"===this.Da.dataOrder?e.x:e.y,s="columns"===this.Da.dataOrder?e.y:e.x,r="columns"===this.Da.dataOrder?this.jt.x:this.jt.y,n="columns"===this.Da.dataOrder?this.jt.y:this.jt.x;let o=(i-r)/("columns"===this.Da.dataOrder?this.W$.x:this.W$.y),a=(s-n)/("columns"===this.Da.dataOrder?this.W$.y:this.W$.x);o=Math.floor($t(o,0,this.Da.primaryDimensionVectorsCount-1)),a=Math.floor($t(a,0,this.Da.secondaryDimensionVectorsCount-1));const h=this.vU(o,a),l="columns"===this.Da.dataOrder?{x:this.jt.x+(o+.5)*this.W$.x,y:this.jt.y+(a+.5)*this.W$.y}:{x:this.jt.x+(a+.5)*this.W$.x,y:this.jt.y+(o+.5)*this.W$.y},c="columns"===this.Da.dataOrder?o:a,u="columns"===this.Da.dataOrder?a:o;return{x:l.x,y:l.y,column:c,row:u,cellValue:h}}yb(t){const e=this.pU;if(!e||t.x<e.boundaries.min.x||t.x>e.boundaries.max.x||t.y<e.boundaries.min.y||t.y>e.boundaries.max.y)return;const i=t,s="columns"===this.Da.dataOrder?i.x:i.y,r="columns"===this.Da.dataOrder?i.y:i.x,n="columns"===this.Da.dataOrder?this.jt.x:this.jt.y,o="columns"===this.Da.dataOrder?this.jt.y:this.jt.x,a="columns"===this.Da.dataOrder?this.W$.x:this.W$.y,h="columns"===this.Da.dataOrder?this.W$.y:this.W$.x,l=$t((s-n)/a-.5,0,this.Da.primaryDimensionVectorsCount-1),c=$t((r-o)/h-.5,0,this.Da.secondaryDimensionVectorsCount-1),u=$t(Math.ceil(l)-1,0,this.Da.primaryDimensionVectorsCount-1),d=$t(Math.ceil(c)-1,0,this.Da.secondaryDimensionVectorsCount-1),f={point:{x:u,y:d},value:this.vU(u,d)},g={point:{x:u,y:d+1},value:this.vU(u,d+1)},p={point:{x:u+1,y:d},value:this.vU(u+1,d)},m={point:{x:u+1,y:d+1},value:this.vU(u+1,d+1)},y=Gs({x:l,y:c},f,g,p,m);if(void 0===y)return;const x=$t(Math.floor(l+.5),0,this.Da.primaryDimensionVectorsCount-1),v=$t(Math.floor(c+.5),0,this.Da.secondaryDimensionVectorsCount-1),A="columns"===this.Da.dataOrder?x:v,S="columns"===this.Da.dataOrder?v:x,b=t;return{x:b.x,y:b.y,column:A,row:S,cellValue:y}}vU(t,e){for(let i=0;i<this.tU.gridTiles.length;i+=1){const s=this.tU.gridTiles[i];if(t>=s.iFirstVector.primary&&t<=s.iFirstVector.primary+s.sizeHeatmapDataVectors.primary-1&&e>=s.iFirstVector.secondary&&e<=s.iFirstVector.secondary+s.sizeHeatmapDataVectors.secondary-1){if(!s.intensityData)return 0;const i=t-s.iFirstVector.primary,r=e-s.iFirstVector.secondary,n=i*s.sizeHeatmapDataVectors.secondary+r;return s.intensityData[n]}}return 0}Wi(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.boundaries.max.x)||0}Hi(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.boundaries.min.x)||0}Zi(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.boundaries.max.y)||0}Xi(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.boundaries.min.y)||0}uu(){return 0}cu(){return 0}mb(){const t=[];return this.tU.gridTiles.forEach(e=>{if(!e.hasIntensityData||!e.intensityData)return;const i=new Array(e.sizeUniqueHeatmapDataVectors.primary).fill(0).map(t=>new Array(e.sizeUniqueHeatmapDataVectors.secondary).fill(0));for(let t=0;t<e.sizeUniqueHeatmapDataVectors.primary;t+=1){const s=t*e.sizeHeatmapDataVectors.secondary,r=i[t];for(let t=0;t<e.sizeUniqueHeatmapDataVectors.secondary;t+=1){const i=e.intensityData[s+t];r[t]=i}}t.push({type:"intensity",startPrimary:e.iFirstUniqueVector.primary,startSecondary:e.iFirstUniqueVector.secondary,lengthPrimary:e.sizeUniqueHeatmapDataVectors.primary,lengthSecondary:e.sizeUniqueHeatmapDataVectors.secondary,values:i})}),t}}class ay extends vo{constructor(t,e,i,s,r,n){super(t,e,i,s,r),this.jt={x:0,y:0},this.W$={x:1,y:1},this.j$=m(void 0),this.Kv=co.lineStyle,this.gc=m(void 0),this.Y$=m("bilinear"),this.engine=t,this.Da=n}sy(t,e){return this.jt=t,this.W$=e,this}ey(){return{start:this.jt,step:this.W$}}xb(t){return this.j$.C(t),this}Sb(){return this.j$.T()}qv(t){return this.Kv="function"==typeof t?t(this.Kv):t,this}oy(){return this.Kv}wb(t){return this.gc.C(t),this}_U(){return this.gc.T()}ly(t){return this.Y$.C(t),this}uy(){return this.Y$.T()}}class hy extends ay{constructor(t,e,i,s,r,n){super(t,e,i,s,r,n),this.kU=0,this._b=[],this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.bz=e,this.nu="columns"===n.scrollDimension?g({x:this.jt.x,y:this.jt.y},{x:this.jt.x,y:this.jt.y+n.resolution*this.W$.y}):g({x:this.jt.x,y:this.jt.y},{x:this.jt.x+n.resolution*this.W$.x,y:this.jt.y}),this.CU={dataPerSegment:2048}}Nh(){this.EN||(this.mi.push({type:"DataPattern",args:{pattern:"columns"===this.Da.scrollDimension?this.W$.x>0?"ProgressiveX":"RegressiveX":this.W$.y>0?"ProgressiveY":"RegressiveY"}}),this.EN=new Vm(this.ai,this));const t=this.EN.kN(this._b,this.gc.T());if(t>0){for(let e=0;e<t;e+=1)this._b[0].shape.dispose()._c(),this._b.shift();"columns"===this.Da.scrollDimension?this.nu.min.x=this._b.length>0?this._b[0].boundaries.min.x:ni:this.nu.min.y=this._b.length>0?this._b[0].boundaries.min.y:ni}this._b.forEach(t=>t.shape.xb(this.j$.T()).Nh());const e=this._b.reduce((t,e)=>{var i,s;return t.min=Math.min(t.min,qt(null===(i=e.shape.nU)||void 0===i?void 0:i.min,ni)),t.max=Math.max(t.max,qt(null===(s=e.shape.nU)||void 0===s?void 0:s.max,oi)),t},{min:ni,max:oi});return this._b.forEach(t=>{t.shape.nU=e}),this.gc.u=!1,this}wc(t,e){let i=0;return this._b.forEach(s=>{const{idCount:r}=s.shape.wc(t,e+i);void 0!==r&&(i+=r)}),{idCount:i}}_i(){if(0!==this._b.length)return this._b.reduce((t,e)=>{const i=e.shape._i();return i?{min:Math.min(i.min,t.min),max:Math.max(i.max,t.max)}:t},{min:ni,max:oi})}kc(t,e,i,s,r){return{}}xy(t){if(0===t.length)return this;let e=0;const i=this.CU.dataPerSegment,s=t.length;do{let r=this._b[this._b.length-1],n=r?i-(r.existingDataPointsCount+(r.hasJoint?1:0)):0,o=!1;if(!r||0===n){const t={columns:"columns"===this.Da.scrollDimension?i:this.Da.resolution,rows:"rows"===this.Da.scrollDimension?i:this.Da.resolution,heatmapDataType:this.Da.heatmapDataType,dataOrder:this.Da.scrollDimension};let e="columns"===this.Da.scrollDimension?{x:this.jt.x+this.W$.x*this.kU,y:this.jt.y}:{x:this.jt.x,y:this.jt.y+this.W$.y*this.kU};this._b.length>0&&(e="columns"===this.Da.scrollDimension?{x:e.x-1*this.W$.x,y:e.y}:{x:e.x,y:e.y-1*this.W$.y},o=!0);const s=new oy(this.Sz,this.bz,this.ai,jt,[],t).ly(this.Y$.T()).qe(this.Ze).qv(this.Kv).sy(e,this.W$);r={shape:s,existingDataPointsCount:0,existingCoordinatesCount:0,allocatedCoordinatesCount:i,dataStartIndex:this.kU,hasJoint:!1,boundaries:{min:{x:s.Hi(),y:s.Xi()},max:{x:s.Wi(),y:s.Zi()}}},this._b.push(r),n=i-(o?1:0)}const a=s-e,h=Math.min(n,a),l=t.slice(e,e+h),c={type:"intensity",values:l,startPrimary:r.existingDataPointsCount+(r.hasJoint?1:0),startSecondary:0,lengthPrimary:h,lengthSecondary:this.Da.resolution};o&&(c.values.unshift(this.TU),c.lengthPrimary+=1,r.hasJoint=!0),r.shape.Ay(c),r.existingDataPointsCount+=h,r.existingCoordinatesCount+=h+(o?1:0),this.TU=l[l.length-1],this.kU+=h,e+=h}while(e<s);return this.nu.max="columns"===this.Da.scrollDimension?{...this.nu.max,x:this.jt.x+this.kU*this.W$.x}:{...this.nu.max,y:this.jt.y+this.kU*this.W$.y},this}Ay(t,e){if(e.length<=0)return this;const i=t,s=t+e.length-1,r=e[0].length;if(r<=0)return this;this._b.forEach(t=>{const n=t.dataStartIndex,o=t.dataStartIndex+t.existingDataPointsCount-1;if(s<n||i>o)return;const a=Math.max(i,n),h=Math.min(s,o),l=h-a+1,c=e.slice(a-i,h-i+1),u=i-n+(t.hasJoint?1:0),d={type:"intensity",startSecondary:0,lengthSecondary:r,startPrimary:u,lengthPrimary:l,values:c};t.shape.Ay(d)});const n=this.kU-1;if(s>n){const t=s-n,i=e.slice(-t);if(i.length<t){const e=this.TU||new Array(r).fill(0);for(let s=i.length;s<t;s+=1)i.unshift(e)}this.xy(i)}return this}Sy(){return this.kU}Vi(){return this._b.forEach(t=>{t.shape.dispose()._c()}),this._b.length=0,this.nu="columns"===this.Da.scrollDimension?g({x:this.jt.x,y:this.jt.y},{x:this.jt.x,y:this.jt.y+this.Da.resolution*this.W$.y}):g({x:this.jt.x,y:this.jt.y},{x:this.jt.x+this.Da.resolution*this.W$.x,y:this.jt.y}),this.kU=0,this.TU=void 0,this}sy(t,e){return super.sy(t,e),this._b.forEach((i,s)=>{const r={x:t.x+("columns"===this.Da.scrollDimension?i.dataStartIndex*e.x:0),y:t.y+("rows"===this.Da.scrollDimension?i.dataStartIndex*e.y:0)};i.shape.sy(r,e),i.boundaries={min:{x:i.shape.Hi(),y:i.shape.Xi()},max:{x:i.shape.Wi(),y:i.shape.Zi()}}}),this._b.length>0?this.nu=Ei(...this._b.map(t=>t.boundaries)):this.nu="columns"===this.Da.scrollDimension?g({x:this.jt.x,y:this.jt.y},{x:this.jt.x,y:this.jt.y+this.Da.resolution*this.W$.y}):g({x:this.jt.x,y:this.jt.y},{x:this.jt.x+this.Da.resolution*this.W$.x,y:this.jt.y}),this}qe(t){return super.qe(t),this._b.forEach(t=>t.shape.qe(this.Ze)),this}qv(t){return super.qv(t),this._b.forEach(t=>t.shape.qv(this.Kv)),this}ly(t){return super.ly(t),this._b.forEach(e=>e.shape.ly(t)),this}dispose(){return super.dispose(),this._b.forEach(t=>t.shape.dispose()),this}setVisible(t){return super.setVisible(t),this._b.forEach(e=>e.shape.setVisible(t)),this}_c(){return this._b.forEach(t=>t.shape._c()),this}yd(t){const e=tt(t,this.ai,this.engine.ai),i=this._b.reduce((i,s)=>{const r=s.shape.yd(t);if(r){const t=xi(tt(r,this.ai,this.engine.ai),e);if(void 0===i||t<i.distance)return{result:r,distance:t,segment:s}}return i},void 0);if(i&&i.result){const t="columns"===this.Da.scrollDimension?i.result.column+i.segment.dataStartIndex:i.result.column,e="rows"===this.Da.scrollDimension?i.result.row+i.segment.dataStartIndex:i.result.row;if("columns"===this.Da.scrollDimension&&t>=this.kU||"rows"===this.Da.scrollDimension&&e>=this.kU)return;return{x:i.result.x,y:i.result.y,column:t,row:e,cellValue:i.result.cellValue}}}yb(t){const e=tt(t,this.ai,this.engine.ai),i=this._b.reduce((i,s)=>{const r=s.shape.yb(t);if(r){const t=xi(tt(r,this.ai,this.engine.ai),e);if(void 0===i||t<i.distance)return{result:r,distance:t,segment:s}}return i},void 0);if(i&&i.result){const t="columns"===this.Da.scrollDimension?i.result.column+i.segment.dataStartIndex:i.result.column,e="rows"===this.Da.scrollDimension?i.result.row+i.segment.dataStartIndex:i.result.row;if("columns"===this.Da.scrollDimension&&t>=this.kU||"rows"===this.Da.scrollDimension&&e>=this.kU)return;return{x:i.result.x,y:i.result.y,column:t,row:e,cellValue:i.result.cellValue}}}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return 0}cu(){return 0}Ii(t){return super.Ii(t),this._b.forEach(e=>e.shape.Ii(t)),this}}class ly extends vo{constructor(t,e,i,s,r,n){super(t,e,i,s,r),this.Y$=m("bilinear"),this.Kv=co.lineStyle,this.Da=n}ly(t){return this.Y$.C(t),this}uy(){return this.Y$.T()}qv(t){return this.Kv="function"==typeof t?t(this.Kv):t,this}oy(){return this.Kv}}class cy extends ly{constructor(t,e,i,s,r,n){super(t,e,i,s,r,n),this.bD=new cm,this.DV={},this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStylePaletted:()=>vs(this.Ze)&&this.Ze}),this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.bz=e,this.gb=new oy(this.Sz,t.FU,t.ai,jt,[],{columns:n.sectors,rows:n.annuli,heatmapDataType:"intensity",dataOrder:"annuli"===n.dataOrder?"rows":"columns",Ab:this.ZB.QB}).qv(Bt);const o=2*Math.PI/360,a=new Float32Array(724);let h=0;a[h+0]=0,a[h+1]=0,h+=2;for(let t=0;t<=360;t+=1){const e=t*o,i=Math.cos(e),s=Math.sin(e);a[h+0]=i,a[h+1]=s,h+=2}this.IU={vertexBuffer:this.ZB.mR(a),drawMode:this.ZB.gl.TRIANGLE_FAN,drawLength:362}}Nh(){const t=this.ll(),e=this.Ze,i=this.Fz.fillStyleSolid(t),s=this.Fz.fillStylePaletted(t),r=i||s,n=this.Y$.T(),o=this.Y$.u,a=this.ui.T(),h=this.ui.u;return this.bD.FR(this.ai),this.gb.Nh(),this.gb.xU?((t||o)&&(this.DV.fill=r?{shader:this.ZB.SE(vp["2D"],vp.VertexLocation({scaling:{dataType:"uniform"},translation:{dataType:"uniform",sizeUnit:"axis"},axisWorldTranslation:Sr(this.ai),normalSource:void 0}),s&&vp.PolarHeatmap({interpolation:"bilinear"===n&&"bilinear",intensityTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN,flipXY:"sectors"===this.Da.dataOrder,lut:s.lut}),i&&vp.PolarHeatmap({dataType:"uniform"})),fillStylePaletted:s,fillStyleSolid:i}:void 0),h&&(this.DV.mousePicking=a?{shader:this.ZB.SE(vp["2D"],vp.VertexLocation({scaling:{dataType:"uniform"},translation:{dataType:"uniform",sizeUnit:"axis"},axisWorldTranslation:Sr(this.ai),normalSource:void 0}),vp.MousePicking())}:void 0),this.fl(e),this.Y$.u=!1,this.ui.u=!1,this):this}wc(t,e){var i;const{vertexBuffer:s,drawLength:r,drawMode:n}=this.IU,o=this.gb.xU;if(!this.DV.fill||!o)return{};const{fillStylePaletted:a,fillStyleSolid:h}=this.DV.fill,l=1===t?null===(i=this.DV.mousePicking)||void 0===i?void 0:i.shader:this.DV.fill.shader;if(!l)return{};const c=this.ai.le(),u=Math.min(c.start,c.end),d=Math.max(c.start,c.end),f=Math.min(this.Da.amplitudeStart,this.Da.amplitudeStart+(this.Da.annuli-1)*this.Da.amplitudeStep),g=Math.max(this.Da.amplitudeStart,this.Da.amplitudeStart+(this.Da.annuli-1)*this.Da.amplitudeStep);let p;return p=c.end>c.start?Math.min(g,d)-c.start:Math.max(f,u)-c.start,this.ZB.Kc(l).SR(l,(i,l,c,u)=>{if(this.ZB.MR(i("uScale"),this.bD.kR()).MR(i("uDisp"),this.bD.CR())._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0).MR(u("uViewportSize"),[this.Sz.kt().x*this.ZB.hR()/(1===t?this.pi.Da.Ra:1),this.Sz.kt().y*this.ZB.hR()/(1===t?this.pi.Da.Ra:1)]).MR(i("uScaling"),[p,p]).MR(i("uTranslationAxis"),[0,0]).bR(s,void 0,{location:l("aPos"),size:2})._R(u("uAngleOffset"),this.ai.Ae()%(2*Math.PI))._R(u("uAngleDirection"),this.ai.de()?1:-1)._R(u("uSectors"),this.Da.sectors)._R(u("uAnnuli"),this.Da.annuli),1===t)this.ZB.ZR(i("uFirstId"),e).UO(c,1);else{if(a){const t=this.gb.nU;this.ZB._R(i("uAmplitudeStart"),this.Da.amplitudeStart)._R(i("uAmplitudeStep"),this.Da.amplitudeStep)._R(i("uAmplitudeAxisStart"),this.ai.le().start)._R(i("uAmplitudeAxisEnd"),this.ai.le().end).JO(c,a.lut,t).wR(i("uTileIntensityValues"),o.gridTiles[0].intensityDataTexture,0)}h&&this.ZB.UI(i("uColor"),h.getColor())}return this.ZB.Nk(n,r),!0}),{idCount:1}}_i(){return this.gb._i()}kc(t,e,i,s,r){return{}}Ay(t){return this.gb.Ay(t),this}Vi(){return this.gb.Vi(),this}dispose(){return super.dispose(),this.gb.dispose(),this.DV={},this.ZB.BR(this.IU.vertexBuffer),this}_c(){return this.dispose(),this}qe(t){return super.qe(t),this.gb.qe(this.Ze),this}yd(t){const e=this.Da.amplitudeStart,i=this.Da.amplitudeStart+(this.Da.annuli-1)*this.Da.amplitudeStep,s=Math.min(e,i),r=Math.max(e,i);(t.angle<0||t.angle>360||t.amplitude<s||t.amplitude>r)&&(t.angle=$t(t.angle,0,360),t.amplitude=$t(t.amplitude,r,r));let n=Math.round((t.angle-0)/360*this.Da.sectors);n>=this.Da.sectors&&(n=0);const o=Math.round((t.amplitude-e)/(i-e)*(this.Da.annuli-1));return{iAnnulus:o,iSector:n,cellValue:this.vU(o,n),angle:n*(360/this.Da.sectors),amplitude:e+o*(i-e)/(this.Da.annuli-1)}}yb(t){const e=this.Da.amplitudeStart,i=this.Da.amplitudeStart+(this.Da.annuli-1)*this.Da.amplitudeStep,s=Math.min(e,i),r=Math.max(e,i);(t.angle<0||t.angle>360||t.amplitude<s||t.amplitude>r)&&(t.angle=$t(t.angle,0,360),t.amplitude=$t(t.amplitude,r,r));const n=(t.angle-0)/360*this.Da.sectors,o=(t.amplitude-e)/(i-e)*(this.Da.annuli-1),a=Math.floor(n),h=Math.floor(o),l={point:{x:h,y:a},value:this.vU(h,a)},c={point:{x:h,y:a+1},value:this.vU(h,a+1)},u={point:{x:h+1,y:a},value:this.vU(h+1,a)},d={point:{x:h+1,y:a+1},value:this.vU(h+1,a+1)},f=Gs({x:o,y:n},l,c,u,d);if(void 0!==f)return{iAnnulus:h,iSector:a,cellValue:f,angle:t.angle,amplitude:t.amplitude}}vU(t,e){const i="annuli"===this.Da.dataOrder?t:e,s="annuli"===this.Da.dataOrder?e:t;for(let t=0;t<this.gb.tU.gridTiles.length;t+=1){const e=this.gb.tU.gridTiles[t];if(i>=e.iFirstVector.primary&&i<=e.iFirstVector.primary+e.sizeHeatmapDataVectors.primary-1&&s>=e.iFirstVector.secondary&&s<=e.iFirstVector.secondary+e.sizeHeatmapDataVectors.secondary-1){const t=i-e.iFirstVector.primary,r=s-e.iFirstVector.secondary,n=t*e.sizeHeatmapDataVectors.secondary+r;return e.intensityData?e.intensityData[n]:0}}return 0}Wi(){return 0}Hi(){return 0}Zi(){return 0}Xi(){return 0}uu(){return 0}cu(){return 0}}class uy{constructor(t,e,i){this.Ei=new Set,this.LU=t=>(this.Ei.add(t),t),this.PU=t=>(this.Ei.delete(t),t._c(),this),this.pi=t,this.Yn=e,this.BU=i}CB(t){this.Ei.delete(t)&&this.Ei.add(t)}G(){for(const t of this.Ei)t._c().dispose();this.pi.Fa(this.Yn)}Bs(){return this.pi.Bs(),this}Ta(){return this.Yn}}class dy extends uy{constructor(){super(...arguments),this.DU=m(void 0),this.rl=!1}Tm(t){return this.DU.C(t),this}qg(){return this.DU.T()}}class fy extends Ao{constructor(t,e,i,s,r){super(t,e,i,s,r),this.DV={fill:void 0,border:void 0},this.bD=new cm,this.nu=ai,this.EU=!1,this.RU=!1,this.OU=!1,this.zU=!1,this.Wd=[],this.VU=0,this.Fz=Mr({rectangleStyleSolid:()=>gs(this.Ze)&&this.Ze,rectangleStyleImage:()=>wt(this.Ze)&&this.Ze,rectangleStyleRadialGradient:()=>N(this.Ze)&&this.Ze,rectangleStyleLinearGradient:()=>G(this.Ze)&&this.Ze,rectangleStylePaletted:()=>vs(this.Ze)&&this.Ze,rectangleStyleIndividual:()=>ms(this.Ze)&&this.Ze,lineStyleSolid:()=>cr(this.Je)&&this.Je,lineStyleDashed:()=>gr(this.Je)&&this.Je,lineStyleFilled:()=>{const t=this.Je&&this.Je.getFillStyle();return gs(t)&&t}}),this.Sz=t,this.bz=e,this.ZB=t.Mz(),this.PV=this.ZB.mO}Ho(){const t={Fs:e=>this.YV(t,e),Ii:e=>this.jV(t,e),Md:(e,i,s,r)=>this.NU(t,e,i,s,r),bd:e=>this.GU(t,e),Bx:e=>this.XN(t,e),UI:e=>this.WV(t,e),$U:0,UU:0,YU:0,jU:0,M:void 0,ZN:void 0,gi:0,HA:!0,JN:this.Wd.length,HU:void 0};return this.Wd.push(t),t}Vi(){return this.Wd.length=0,this.EU=!0,this.pi.Ci(this),this}Bp(){return this.Wd}Zd(t){const e=this.Wd.indexOf(t);e>=0&&(this.Wd.splice(e,1),this.EU=!0,this.pi.Ci(this,t))}YV(t,e){return t.HA=e,this.EU=!0,t.HA||this.pi.Ci(this,t),t}jV(t,e){return t.gi=e,this.zU=!0,t}NU(t,e,i,s,r){return t.$U=e,t.UU=i,t.YU=s,t.jU=r,this.EU=!0,t}GU(t,e){return t.HU=!0===(null==e?void 0:e.c_x1_y1)||!0===(null==e?void 0:e.c_x1_y2)||(null==e?void 0:e.c_x2_y1)||!0===(null==e?void 0:e.c_x2_y2)?e:void 0,this.EU=!0,t}XN(t,e){return t.M=e,this.RU=!0,t}WV(t,e){return t.ZN=null==e?void 0:e.toUint32(),this.OU=!0,t}Nh(){const t=this.ui.T(),e=this.ui.u,i=this.ll(),s=this.zU;let r=this.EU;const n=this.RU,o=this.OU,a=this.Je,h=this.Al(),l=this.Wd.filter(t=>t.HA),c=void 0!==this.Wd.find(t=>t.HU),u=this.ai.ei();c&&u&&(r=!0);const d=this.Fz.rectangleStyleSolid(i),f=this.Fz.rectangleStylePaletted(i),g=this.Fz.rectangleStyleIndividual(i),p=this.Fz.rectangleStyleRadialGradient(i),m=this.Fz.rectangleStyleLinearGradient(i),y=this.Fz.rectangleStyleImage(i),x=d||f||m||p||y||g,v=this.Fz.lineStyleSolid(h),A=this.Fz.lineStyleDashed(i),S=v||A,b=this.Fz.lineStyleFilled(h),M=b,E=S&&Math.max(S.getThickness(),0);if(this.bD.FR(this.ai),r&&(this.nu=Ei(...l.map(t=>bi([{x:t.$U,y:t.UU},{x:t.YU,y:t.jU}])))),r||h&&A){const t=[],e=[],i=[];let s=0,r=0;const n=[];let o=0;if(c){const a=this.ai instanceof q?this.ai.ni():{x:1e-4,y:1e-4},h=5;this.VU=4+4*h;const c=Math.sign(this.ai.x.U-this.ai.x.$),u=Math.sign(this.ai.y.U-this.ai.y.$);l.forEach(l=>{var d,f,g,p,m;const y=Math.sign(l.YU-l.$U),x=Math.sign(l.jU-l.UU),v={x:y===c?l.$U:l.YU,y:x===u?l.UU:l.jU},A={x:y===c?l.YU:l.$U,y:x===u?l.jU:l.UU},S=s,b=r,M=Math.abs((A.x-v.x)/a.x),E=Math.abs((A.y-v.y)/a.y),k=l.HU&&!0!==l.HU.skipTooSmallCheck&&Math.min(M,E)<2*l.HU.extent;t[S+0]=(l.$U+l.YU)/2,e[S+0]=(l.UU+l.jU)/2,i[b+0]=0,i[b+1]=0,t[S+1]=Number.NaN,e[S+1]=Number.NaN,i[b+2]=0,i[b+3]=0,s+=2,r+=4;for(let a=0;a<=3;a+=1){const c=0===a||3===a?A.x:v.x,u=0===a||1===a?A.y:v.y,y=c===l.$U&&u===l.UU?null===(d=l.HU)||void 0===d?void 0:d.c_x1_y1:c===l.YU&&u===l.UU?null===(f=l.HU)||void 0===f?void 0:f.c_x2_y1:c===l.$U&&u===l.jU?null===(g=l.HU)||void 0===g?void 0:g.c_x1_y2:null===(p=l.HU)||void 0===p?void 0:p.c_x2_y2,x=null===(m=l.HU)||void 0===m?void 0:m.extent;if(y&&x&&!k){const l=.5*a*Math.PI;for(let d=0;d<h;d+=1){const f=l+d/(h-1)*.5*Math.PI;let g,p;0===a?(g=Math.cos(f)-1,p=-1+Math.sin(f)):1===a?(g=1+Math.cos(f),p=Math.sin(f)-1):2===a?(g=1+Math.cos(f),p=1+Math.sin(f)):(g=-1+Math.cos(f),p=1+Math.sin(f)),t[s+0]=c,e[s+0]=u,i[r+0]=g*x,i[r+1]=p*x,s>1&&(n[o+0]=S,n[o+1]=s-1,n[o+2]=s,o+=3),s+=1,r+=2}}else for(let a=0;a<h;a+=1)t[s+0]=c,e[s+0]=u,i[r+0]=0,i[r+1]=0,n[o+0]=S,n[o+1]=s-1,n[o+2]=s,o+=3,s+=1,r+=2}n[o+0]=S,n[o+1]=S+2,n[o+2]=s-1,o+=3,t[s+0]=t[S+2],e[s+0]=e[S+2],i[r+0]=i[b+4],i[r+1]=i[b+5],t[s+1]=Number.NaN,e[s+1]=Number.NaN,i[r+2]=0,i[r+3]=0,s+=2,r+=4})}else this.VU=6,l.forEach(a=>{t[s+0]=a.$U,e[s+0]=a.UU,i[r+0]=0,i[r+1]=0,t[s+1]=a.YU,e[s+1]=a.UU,i[r+2]=0,i[r+3]=0,t[s+2]=a.YU,e[s+2]=a.jU,i[r+4]=0,i[r+5]=0,t[s+3]=a.$U,e[s+3]=a.jU,i[r+6]=0,i[r+7]=0,t[s+4]=a.$U,e[s+4]=a.UU,i[r+8]=0,i[r+9]=0,t[s+5]=Number.NaN,e[s+5]=Number.NaN,i[r+10]=0,i[r+11]=0,n[o+0]=s+0,n[o+1]=s+1,n[o+2]=s+3,n[o+3]=s+1,n[o+4]=s+3,n[o+5]=s+2,s+=6,r+=12,o+=6});if(this.WU=this.ZB.mR(ge(t,this.ai.zt()),void 0,this.WU),this.XU=this.ZB.mR(ge(e,this.ai.zt()),void 0,this.XU),this.ZU=this.ZB.mR(i,void 0,this.ZU),this.JU=this.ZB.sO(new Uint32Array(n),this.JU),this.QU=n.length,this.KU=s-1,A){const i=new Float32Array(2*t.length);let s=0,r=0,n=0,o=t[0],a=e[0];for(let h=0;h<t.length;h+=1){const l=t[h],c=e[h];Number.isNaN(l)||(r+=Math.abs(l-o),n+=Math.abs(c-a),o=l,a=c),i[s]=r,i[s+1]=n,s+=2}this.EV=this.ZB.mR(i,!1,this.EV)}this.qU=[t,e]}if((i||h||e)&&(this.DV.fill=x?{shader:this.ZB.SE(vp["2D"],d&&vp.Color({dataType:"uniform"}),m&&vp.Color({dataType:["gradient",m]}),p&&vp.Color({dataType:["gradient",p]}),f&&vp.Color({dataType:["lookup",f.getLookUpProperty(),f.lut]}),g&&vp.Color({dataType:"attribute"}),y&&vp.Color({dataType:["image",y]}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0,offsets:[{directionVar:"aGeo",sizeUnit:"px",dataType:"attribute",useGeometry:!1}],splitPosAttribute:!0}),vp.AttributeHighlight),mousePicking:t?{shader:this.ZB.SE(vp["2D"],vp.MousePicking({useAttribute:!0}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0,offsets:[{directionVar:"aGeo",sizeUnit:"px",dataType:"attribute",useGeometry:!1}],splitPosAttribute:!0}),vp.AttributeHighlight)}:void 0,fillStyleSolid:d,fillStyleLinearGradient:m,fillStyleRadialGradient:p,fillStylePaletted:f,fillStyleImage:y,fillStyleIndividual:g}:void 0,this.DV.border=S&&M&&"number"==typeof E&&0!==E?{shader:this.ZB.SE(vp["2D"],vp.Color({dataType:"uniform"}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,offsets:[{directionVar:"aGeo",sizeUnit:"px",dataType:"attribute",useGeometry:!1}],splitPosAttribute:!0}),this.PV?vp.AliasedEdge:void 0,A&&vp.StippleTextureInstanced,vp.AttributeHighlight),geometry:wm(this.ZB,E),mousePicking:t?{shader:this.ZB.SE(vp["2D"],vp.MousePicking({useAttribute:!0}),vp.LineInstanced2D({axisWorldTranslation:Sr(this.ai),normalSource:void 0,offsets:[{directionVar:"aGeo",sizeUnit:"px",dataType:"attribute",useGeometry:!1}],splitPosAttribute:!0}),A&&vp.StippleTextureInstanced,vp.AttributeHighlight)}:void 0,fillStyleSolid:b,lineStyleDashed:A,thickness:E}:void 0),s||r){const t=new Float32Array(l.length*this.VU);l.forEach((e,i)=>{for(let s=0;s<this.VU;s+=1)t[i*this.VU+s]=e.gi}),this.tY=this.ZB.mR(t,!0,this.tY)}if(t){if(r||e){const t=new Float32Array(l.length*this.VU);l.forEach((e,i)=>{for(let s=0;s<this.VU;s+=1)t[i*this.VU+s]=e.JN}),this.iY=this.ZB.mR(t,!1,this.iY)}}else this.iY&&(this.ZB.BR(this.iY),this.iY=void 0);if(n||r&&f&&"value"===f.getLookUpProperty()){const t=new Float32Array(l.length*this.VU),e={min:ni,max:oi};l.forEach((i,s)=>{const r=void 0!==i.M?i.M:Dt;for(let e=0;e<this.VU;e+=1)t[s*this.VU+e]=r;void 0!==i.M&&(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}),this.sG=e,this.sY=this.ZB.mR(t,!1,this.sY)}if(o||r&&g){const t=new Uint32Array(l.length*this.VU),e=g?g.getFallbackColor().toUint32():C.toUint32();l.forEach((i,s)=>{const r=void 0!==i.ZN?i.ZN:e;for(let e=0;e<this.VU;e+=1)t[s*this.VU+e]=r}),this.eY=this.ZB.mR(t,!1,this.eY,Uint32Array)}return p?this.Rz=Qp(this.Ai||this.nu,this.ai,p.getPosition(),p.getExtent(),p.getShape(),this.ZB.hR()):m?this.Oz=tm(this.Ai||this.nu,this.ai,m.getAngle(!0),this.ZB.hR()):(this.Rz=void 0,this.Oz=void 0),A?this.RV=this.ZB.HO(A.getPattern()):(this.EV&&(this.ZB.BR(this.EV),this.EV=void 0),this.RV=void 0),this.hG=this.ZB.QO(this,this.hG,y,void 0,r||this.ai.ei(),(t,e,i)=>this.nG(t,e,i,l)),this.zU=!1,this.EU=!1,this.RU=!1,this.OU=!1,this.ui.u=!1,this.fl(this.Ze),this.yl(a),this}wc(t,e){var i,s;const{fill:r,border:n}=this.DV,o=this.WU,a=this.XU,h=this.ZU,l=this.JU,c=this.QU,u=this.KU,d=this.tY,f=this.iY;if(!(d&&o&&a&&h))return{};if(r&&l&&c){const s=1===t?null===(i=r.mousePicking)||void 0===i?void 0:i.shader:r.shader;s&&this.ZB.Kc(s).SR(s,(i,s,n,u)=>!!this.ZB.qO(n,t,this,{uniforms:this.bD,idFirst:e,fillStyleSolid:r.fillStyleSolid,fillStyleLinearGradient:r.fillStyleLinearGradient,fillStyleRadialGradient:r.fillStyleRadialGradient,fillStylePaletted:r.fillStylePaletted,fillStyleImage:r.fillStyleImage,fillStyleIndividual:r.fillStyleIndividual,linearGradientInfo:this.Oz,radialGradientInfo:this.Rz,texturedFillGLInfo:this.hG,colorBuffer:this.eY,lookupValueBuffer:this.sY,lookupValueRange:this.sG,highlightBuffer:d,coordsX:o,coordsY:a,coordsHighPrecision:this.ai.zt(),mousePickingOffsetBuffer:f})&&(this.ZB.bR(h,void 0,{location:s("aGeoAmount"),size:2}).lO(l),this.ZB.cO(c,this.ZB.gl.TRIANGLES,void 0,this.ZB.gl.UNSIGNED_INT),!0))}if(n&&u){const{geometry:i,thickness:r,lineStyleDashed:l}=n,c=1===t?null===(s=n.mousePicking)||void 0===s?void 0:s.shader:n.shader;c&&this.ZB.Kc(c).SR(c,(s,c,g,p)=>{if(!this.ZB.qO(g,t,this,{uniforms:this.bD,idFirst:e,fillStyleSolid:n.fillStyleSolid,highlightBuffer:d,highlightAttribDivisor:1,mousePickingOffsetBuffer:f,mousePickingOffsetAttribDivisor:1}))return!1;if(l){if(!this.RV||!this.EV)return!1;Cm.CV(this.ZB,g,this.EV,c("aLengthSoFarA"),c("aLengthSoFarB"),2,2,0),this.ZB.MR(s("uStippleCount"),[this.pi.kt().x/this.RV.ZO,this.pi.kt().y/this.RV.ZO])._R(p("uStippleTextureWidthLimiter"),this.RV.XO/this.RV.ZO)._R(s("uStippleScale"),l.getPatternScale()).wR(s("uStippleTexture"),this.RV.WO,1)}return Fm(this.ZB,g,this.ai.zt(),o,"aLocation","X",1,!1,this.ZB.gl.FLOAT,Float32Array.BYTES_PER_ELEMENT),Fm(this.ZB,g,this.ai.zt(),a,"aLocation","Y",1,!1,this.ZB.gl.FLOAT,Float32Array.BYTES_PER_ELEMENT),Fm(this.ZB,g,!1,h,"aGeo","",2,!1,this.ZB.gl.FLOAT,Float32Array.BYTES_PER_ELEMENT),Cm.wc(this.Sz,i,g,this.PV&&1!==t,1===t,r,u),!0})}return{idCount:this.Wd.length}}nG(t,e,i,s){if(!this.qU)return new Float32Array;const r=tt({x:this.nu.min.x,y:this.nu.min.y},this.ai,this.pi.ai),n=tt({x:this.nu.max.x,y:this.nu.max.y},this.ai,this.pi.ai),o={x:Math.abs(r.x-n.x),y:Math.abs(r.y-n.y)},a=rm(t,e,o.x,o.y,i),h=a[1],l=a[4],c=a[6],u=a[7],d=this.nu.max.x-this.nu.min.x,f=this.nu.max.y-this.nu.min.y,g=l-c,p=u-h,m=new Float32Array(2*this.qU[0].length);let y=0;for(let t=0;t<this.qU[0].length;t+=1){const e=this.qU[0][t],i=this.qU[1][t],s=c+g*((e-this.nu.min.x)/d),r=h+p*((i-this.nu.min.y)/f);m[y]=s,m[y+1]=r,y+=2}return m}kc(t,e,i,s,r){return{collectionMember:this.Wd.find(i=>e+i.JN===t)}}_c(){return this.WU=this.ZB.BR(this.WU),this.XU=this.ZB.BR(this.XU),this.ZU=this.ZB.BR(this.ZU),this.tY&&(this.ZB.BR(this.tY),this.tY=void 0),this.iY&&(this.ZB.BR(this.iY),this.iY=void 0),this.sY&&(this.ZB.BR(this.sY),this.sY=void 0),this.eY&&(this.ZB.BR(this.eY),this.eY=void 0),this.EV&&(this.ZB.BR(this.EV),this.EV=void 0),this.JU&&(this.ZB.BR(this.JU),this.JU=void 0),this.DV={fill:void 0,border:void 0},this.hG=this.ZB.KO(this,this.hG),this}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}uu(){return We(this.Je)}cu(){return We(this.Je)}}class gy extends dy{constructor(t,e,i){super(t,e,i),this.Sz=t,this.gl=t.Mz(),this.rY=this.Ei}vR(t){const e=t instanceof go&&t;if(!e)return ai;const i=e.Hi(),s=e.Wi(),r=e.Xi(),n=e.Zi();if(i===ni||s===oi||r===ni||n===oi)return ai;const o=e.uu(),a=e.cu(),h=po({min:{x:i,y:r},max:{x:s,y:n}},{x:o,y:a},e.ai),l={min:tt(h.min,e.ai,t.pi.ai),max:tt(h.max,e.ai,t.pi.ai)},c=this.DU.T();let u;if(c){if(u={min:{x:Math.min(l.min.x,c.x),y:Math.min(l.min.y,c.y)},max:{x:Math.max(l.max.x,c.x+c.width),y:Math.max(l.max.y,c.y+c.height)}},u.max.x<u.min.x||u.max.y<u.min.y)return ai}else u=l;return u}dr(t){return this.LU(new Dm(this.Sz,this,t,this.PU,[]))}bA(t){return this.LU(new Im(this.Sz,this,t,this.PU,[]))}Np(t,e,i){return this.LU(new Nm(this.Sz,this,t,this.PU,i,e))}zd(t){return this.LU(new Km(this.Sz,this,t,this.PU))}_n(t,e){return this.pi.xc&&!1!==e?this.LU(this.pi.xc._n(this.Sz,this,t,this.PU)):this.LU(new iy(this.Sz,this,t,this.PU,[]))}Tc(t,e=To.Simple){if(e===To.Simple)return this.LU(new Gm(this.Sz,this,t,this.PU,[]));throw new Error("GlEngine.addPolygon | No such polygon type!")}Yp(t){return this.LU(new Om(this.Sz,this,t,this.PU,[]))}md(t){return this.LU(new fy(this.Sz,this,t,this.PU,[]))}tr(t){return this.LU(new Um(this.Sz,this,t,this.PU,[]))}qb(t){return this.LU(new km(this.Sz,this,t,this.PU,[]))}_d(t){return this.LU(new ym(this.Sz,this,t,this.PU,[]))}Mb(t,e,i){if("intensity"===i.heatmapDataType)return this.LU(new hy(this.Sz,this,t,this.PU,e,i));throw new fg("Unimplemented Heatmap Grid Static type")}pb(t,e,i){return this.LU(new oy(this.Sz,this,t,this.PU,e,i))}Y_(t,e,i){return this.LU(new cy(this.Sz,this,t,this.PU,e,i))}hY(t){return this.LU(new gm(this.Sz,this,this.PU,[],t))}Nh(){if(this.rl){this.rl=!1;const t=Array.from(this.Ei).sort((t,e)=>t.ol()-e.ol());this.Ei.clear();for(const e of t)this.Ei.add(e)}for(const t of this.Ei)t.Nh();return this}wc(t,e,i){var s;const r=this.DU.T();let n;if(r){const t=r.x*this.gl.hR()*e,i=r.y*this.gl.hR()*e,s=Math.ceil(t),o=Math.ceil(i);n=[s,o,Math.floor(t+r.width*this.gl.hR()*e)-s,Math.floor(i+r.height*this.gl.hR()*e)-o],this.gl.yR(n[0],n[1],n[2],n[3])}if(1!==t){for(const i of this.Ei)if(i.getVisible()){if(i.us){const t=i.us.x*this.gl.hR()*e,s=i.us.y*this.gl.hR()*e,r=Math.ceil(t),n=Math.ceil(s),o=Math.floor(t+i.us.width*this.gl.hR()*e)-r,a=Math.floor(s+i.us.height*this.gl.hR()*e)-n;this.gl.yR(r,n,o,a)}i.wc(t,0),i.us&&n&&this.gl.yR(n[0],n[1],n[2],n[3])}}else{let r=((null===(s=i[i.length-1])||void 0===s?void 0:s.idLast)||0)+1;const o=Array.from(this.rY.values());for(let s=0;s<o.length;s+=1){const a=o[s];if(a.getPointerEvents()&&a.getVisible()){if(a.us){const t=a.us.x*this.gl.hR()*e,i=a.us.y*this.gl.hR()*e,s=Math.ceil(t),r=Math.ceil(i),n=Math.floor(t+a.us.width*this.gl.hR()*e)-s,o=Math.floor(i+a.us.height*this.gl.hR()*e)-r;this.gl.yR(s,r,n,o)}const{idCount:o}=a.wc(t,r);a.us&&n&&this.gl.yR(n[0],n[1],n[2],n[3]),void 0!==o&&(i.push({entity:a,layer:this,entityIndex:s,idFirst:r,idCount:o,idLast:r+o-1}),r+=o)}}}return this.gl.dR(!1),this}}class py extends em{constructor(t){super(t)}}class my extends py{constructor(t){super(t),this.nY="attribute";const{vertices:e,drawSize:i,drawMode:s}=yy(t.gl);this.VB=t.mR(e),this.wV=i,this._V=s}Nk(t,e,i,s){return this.ZB.bR(this.VB,0,{location:t.attribute("aInstanceGeo"),size:3},{location:i?t.attribute("aNormal"):void 0,size:3},{location:s?t.attribute("aTriangleBary"):void 0,size:3}).dO(this._V,0,this.wV,e),this}$E(){this.ZB.BR(this.VB)}}const yy=t=>{const e=new Float32Array(324);let i=0;return e[i+0]=-1,e[i+1]=1,e[i+2]=1,e[i+3]=0,e[i+4]=1,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=1,e[i+3]=0,e[i+4]=1,e[i+5]=0,e[i+6]=1,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=-1,e[i+3]=0,e[i+4]=1,e[i+5]=0,e[i+6]=0,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=-1,e[i+3]=0,e[i+4]=1,e[i+5]=0,e[i+6]=0,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=1,e[i+3]=0,e[i+4]=1,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=-1,e[i+3]=0,e[i+4]=1,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=-1,e[i+3]=-1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=1,e[i+3]=-1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=-1,e[i+3]=-1,e[i+4]=0,e[i+5]=0,e[i+6]=0,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=-1,e[i+3]=-1,e[i+4]=0,e[i+5]=0,e[i+6]=0,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=1,e[i+3]=-1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=1,e[i+3]=-1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=1,e[i+3]=1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=-1,e[i+3]=1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=1,e[i+3]=1,e[i+4]=0,e[i+5]=0,e[i+6]=0,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=1,e[i+3]=1,e[i+4]=0,e[i+5]=0,e[i+6]=0,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=-1,e[i+3]=1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=-1,e[i+3]=1,e[i+4]=0,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=1,e[i+3]=0,e[i+4]=0,e[i+5]=1,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=1,e[i+3]=0,e[i+4]=0,e[i+5]=1,e[i+6]=1,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=1,e[i+3]=0,e[i+4]=0,e[i+5]=1,e[i+6]=0,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=1,e[i+3]=0,e[i+4]=0,e[i+5]=1,e[i+6]=0,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=1,e[i+3]=0,e[i+4]=0,e[i+5]=1,e[i+6]=1,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=1,e[i+3]=0,e[i+4]=0,e[i+5]=1,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=-1,e[i+3]=0,e[i+4]=0,e[i+5]=-1,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=-1,e[i+3]=0,e[i+4]=0,e[i+5]=-1,e[i+6]=1,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=-1,e[i+3]=0,e[i+4]=0,e[i+5]=-1,e[i+6]=0,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=1,e[i+1]=1,e[i+2]=-1,e[i+3]=0,e[i+4]=0,e[i+5]=-1,e[i+6]=0,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=-1,e[i+3]=0,e[i+4]=0,e[i+5]=-1,e[i+6]=1,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=-1,e[i+1]=1,e[i+2]=-1,e[i+3]=0,e[i+4]=0,e[i+5]=-1,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=-1,e[i+3]=0,e[i+4]=-1,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=-1,e[i+3]=0,e[i+4]=-1,e[i+5]=0,e[i+6]=1,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=1,e[i+3]=0,e[i+4]=-1,e[i+5]=0,e[i+6]=0,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=-1,e[i+1]=-1,e[i+2]=1,e[i+3]=0,e[i+4]=-1,e[i+5]=0,e[i+6]=0,e[i+7]=1,e[i+8]=0,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=-1,e[i+3]=0,e[i+4]=-1,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=1,i+=9,e[i+0]=1,e[i+1]=-1,e[i+2]=1,e[i+3]=0,e[i+4]=-1,e[i+5]=0,e[i+6]=1,e[i+7]=0,e[i+8]=0,i+=9,{vertices:e,drawSize:i/9,drawMode:t.TRIANGLES}};class xy extends py{constructor(t,e){super(t),this.nY="attribute",this.oY=e;const{vertices:i,indices:s}=vy();this.VB=t.mR(i),this.MV=t.sO(s),this.wV=s.length,this._V=t.gl.TRIANGLES}Nk(t,e,i,s){return this.ZB.bR(this.VB,0,{location:t.attribute("aEdge"),size:3},{location:i?t.attribute("aNormal"):void 0,size:3},{location:t.attribute("aInstanceGeo"),size:3}).lO(this.MV)._R(t.uniform("uEdgeRoundness"),this.oY/2).fO(this._V,this.wV,0,e),this}$E(){this.ZB.BR(this.VB),this.ZB.BR(this.MV)}aY(t){return this.oY=t,this}lY(){return this.oY}}const vy=()=>{const t=[{normal:{x:0,y:1,z:0},perpendA:{x:0,y:0,z:1},perpendB:{x:-1,y:0,z:0}},{normal:{x:0,y:0,z:-1},perpendA:{x:0,y:1,z:0},perpendB:{x:-1,y:0,z:0}},{normal:{x:-1,y:0,z:0},perpendA:{x:0,y:1,z:0},perpendB:{x:0,y:0,z:1}},{normal:{x:1,y:0,z:0},perpendA:{x:0,y:1,z:0},perpendB:{x:0,y:0,z:-1}},{normal:{x:0,y:0,z:1},perpendA:{x:0,y:1,z:0},perpendB:{x:1,y:0,z:0}},{normal:{x:0,y:-1,z:0},perpendA:{x:0,y:0,z:-1},perpendB:{x:-1,y:0,z:0}}],e=[];let i=0;const s=[];let r=0;for(const n of t){const{normal:t,perpendA:o,perpendB:a}=n,h=ri.multiply(o,-1),l=ri.multiply(a,-1),c=i;e[i]={thicknessDirection:ri.addVec(t,o,a),edge:ri.addVec(h,l),normal:t},i+=1;const u=i;e[i]={thicknessDirection:ri.addVec(t,h,a),edge:ri.addVec(o,l),normal:t},i+=1;const d=i;e[i]={thicknessDirection:ri.addVec(t,h,l),edge:ri.addVec(o,a),normal:t},i+=1;const f=i;e[i]={thicknessDirection:ri.addVec(t,o,l),edge:ri.addVec(h,a),normal:t},i+=1,s[r+0]=d,s[r+1]=c,s[r+2]=f,s[r+3]=d,s[r+4]=u,s[r+5]=c,r+=6;const g=[{A:o,B:a},{A:h,B:a},{A:h,B:l},{A:o,B:l}];for(const s of g){s.thicknessDirection=ri.addVec(t,s.A,s.B),s.stripVerticesA=[],s.stripVerticesB=[];const r=[{direction:s.A,other:s.B,vertices:s.stripVerticesA},{direction:s.B,other:s.A,vertices:s.stripVerticesB}];for(const n of r)for(let r=0;r<8;r+=1){const o=.5*r/7,a=ri.normalize(ri.lerp(t,n.direction,o)),h=Math.PI/2-ri.angle(a,t),l=ri.addVec(ri.multiply(ri.multiply(n.direction,-1),1-Math.cos(h)),ri.multiply(ri.multiply(t,-1),1-Math.sin(h)),ri.multiply(n.other,-1)),c=i;e[i]={thicknessDirection:s.thicknessDirection,normal:a,edge:l};const u=e[i];i+=1,n.vertices.push({index:c,vertex:u})}}for(let t=0;t<g.length;t+=1){const e=g[t],i=g[t<g.length-1?t+1:0],n=t%2==0?e.stripVerticesB:e.stripVerticesA,o=t%2==0?i.stripVerticesB:i.stripVerticesA;for(let t=1;t<n.length;t+=1){const e=n[t-1],i=o[t-1],a=n[t],h=o[t];s[r+0]=e.index,s[r+1]=i.index,s[r+2]=h.index,s[r+3]=a.index,s[r+4]=e.index,s[r+5]=h.index,r+=6}}}const n=[{x:-1,y:1,z:-1,flipVertexOrder:!1},{x:-1,y:1,z:1,flipVertexOrder:!0},{x:1,y:1,z:1,flipVertexOrder:!1},{x:1,y:1,z:-1,flipVertexOrder:!0},{x:-1,y:-1,z:-1,flipVertexOrder:!0},{x:-1,y:-1,z:1,flipVertexOrder:!1},{x:1,y:-1,z:1,flipVertexOrder:!0},{x:1,y:-1,z:-1,flipVertexOrder:!1}],o=Math.PI/15,a=2*Math.PI/15;let h=i;for(const t of n){let r=0;e[i]={thicknessDirection:t,normal:{x:0,y:t.y,z:0},edge:{x:-t.x,y:0,z:-t.z}},i+=1,r+=1;for(let s=1;s<8.5;s+=1){const n=15===s?Math.PI:s*o,h=1*Math.cos(n)*t.y,l=Math.sin(n);for(let s=0;s<Math.ceil(3.75)+1;s+=1){const n=15===s?0:s*a,o=l*Math.cos(n)*1*t.x,c=l*Math.sin(n)*1*t.z,u={x:o,y:h,z:c},d=ri.normalize({x:o,y:h,z:c});e[i]={thicknessDirection:t,normal:d,edge:{x:u.x-t.x,y:u.y-t.y,z:u.z-t.z}},i+=1,r+=1}}const n=[];for(let t=1;t<=Math.ceil(3.75);t+=1)n.push(h),15===t?n.push(h+1):n.push(h+t+1),n.push(h+t);const l=h+1,c=Math.ceil(3.75)+1;for(let t=0;t<6.5;t+=1)for(let e=0;e<Math.ceil(3.75);e+=1){let i=0;const s=l+(t+1)*c+e;let r=0;14===e?(i=l+t*c,r=l+(t+1)*c):(i=l+t*c+e+1,r=l+(t+1)*c+e+1),n.push(l+t*c+e),n.push(i),n.push(s),n.push(s),n.push(i),n.push(r)}s.push.apply(s,t.flipVertexOrder?n.reverse():n),h+=r}const l=new Float32Array(9*e.length);let c=0;for(const t of e)l[c+0]=t.edge.x,l[c+1]=t.edge.y,l[c+2]=t.edge.z,l[c+3]=t.normal.x,l[c+4]=t.normal.y,l[c+5]=t.normal.z,l[c+6]=t.thicknessDirection.x,l[c+7]=t.thicknessDirection.y,l[c+8]=t.thicknessDirection.z,c+=9;return{vertices:l,indices:new Uint16Array(s)}},Ay=(t,e)=>{let i=t.NR.GE.get(e);return i||(i=void 0!==e&&e>0?new xy(t,$t(e,0,1)):new my(t),t.NR.GE.set(e,i),i)};class Sy extends om{lp(t){return this.rR=this.sp.T(),this.sp.C(t),this}vy(t){return this.uY=t,this}yy(){return this.uY}}class by extends Sy{constructor(t,e,i){super(t,e,i),this.cY=t,this.Sz=t.Sz,this.ZB=this.Sz.Mz()}}const My=11;class Ey extends by{constructor(t,e,i){super(t,e,i),this.uY="cull-back",this.nu=hi,this.dY={},this.fY=[],this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStyleIndividual:()=>ms(this.Ze)&&this.Ze,fillStylePaletted:()=>vs(this.Ze)&&this.Ze}),this.Ze=co.fillStyle,this.sp.C(Ks)}Nh(t){const e=this.fY,i=this.Ze,s=i!==ls,r=this.AY,n=this.ll()||this.gY!==r,o=this.eR(),a=this.ui.T(),h=this.ui.u;if(s){for(const t of e)t.id=void 0!==t.id?String(t.id):void 0,t.xSize=void 0!==t.xSize&&t.xSize<0?-t.xSize:t.xSize,t.ySize=void 0!==t.ySize&&t.ySize<0?-t.ySize:t.ySize,t.zSize=void 0!==t.zSize&&t.zSize<0?-t.zSize:t.zSize;const t=this.pY||0;let s=t;for(const t of e){const e=t.id;void 0!==e&&void 0!==this.dY[e]||(s+=1)}let r,l=!1,c=!1;if(l=s!==t,c=l,r=!c&&(e.length<100?"chunks":"all"),l){const e=s*My,i=new Float32Array(e);this.vY&&i.set(this.vY),this.vY=i,this.yY=e,this.mY=t*My}const u=ms(i)?i.getFallbackColor():void 0;for(const t of e){const e=t.id,i=void 0!==e&&this.dY[e],s=[t.xCenter,t.yCenter,t.zCenter,t.xSize,t.ySize,t.zSize,t.color?t.color.r:u?u.r:void 0,t.color?t.color.g:u?u.g:void 0,t.color?t.color.b:u?u.b:void 0,t.color?t.color.a:u?u.a:void 0,t.value];if(i){for(let t=0;t<My;t+=1)s[t]=void 0!==s[t]?s[t]:i.buffer[t];i.buffer.set(s)}else{const t=this.mY,i=new Float32Array(this.vY.buffer,t*Float32Array.BYTES_PER_ELEMENT,My);i.set(s),void 0!==e&&(this.dY[e]={location:t,buffer:i}),this.mY+=My}}if(c&&(this.bV=this.ZB.mR(this.vY,!0)),"all"===r)this.ZB.qR(this.bV,0,this.vY);else if("chunks"===r)for(const t of e){const e=t.id;if(void 0!==e){const t=this.dY[e];this.ZB.qR(this.bV,t.location,t.buffer)}}if(n||o||h){const t=this.Fz.fillStyleSolid(n),e=this.Fz.fillStyleIndividual(n),i=this.Fz.fillStylePaletted(n);t||e||i?(this.xY=Ay(this.ZB,this.SY()),this._D=this.ZB.SE(vp["3D"],vp.ColorShaded3D({dataType:e?"attribute":i?["lookup",i.getLookUpProperty(),i.lut]:"uniform",shadingStyle:this.sp.T().type}),vp.VertexLocation({offsets:[{directionVar:"aInstanceGeo",sizeUnit:"axis",dataType:"attribute",halved:!0}],axisWorldTranslation:Sr(this.ai),normalSource:this.xY.nY}),void 0!==this.AY&&vp.RoundedEdges3D),this.P$=a?this.ZB.SE(vp["3D"],vp.VertexLocation({offsets:[{directionVar:"aInstanceGeo",sizeUnit:"axis",dataType:"attribute",halved:!0}],axisWorldTranslation:Sr(this.ai),normalSource:void 0}),vp.MousePicking(),void 0!==this.AY&&vp.RoundedEdges3D):void 0):(this.xY=void 0,this._D=void 0,this.P$=void 0)}if(e.length>0){const t=g({x:ni,y:ni,z:ni},{x:oi,y:oi,z:oi});for(let e=0;e<this.mY;e+=My){const i=this.vY[e+0],s=this.vY[e+3]/2,r=i-s,n=i+s,o=this.vY[e+1],a=this.vY[e+4]/2,h=o-a,l=o+a,c=this.vY[e+2],u=this.vY[e+5]/2,d=c-u,f=c+u;t.min.x=t.min.x<r?t.min.x:r,t.min.y=t.min.y<h?t.min.y:h,t.min.z=t.min.z<d?t.min.z:d,t.max.x=t.max.x>n?t.max.x:n,t.max.y=t.max.y>l?t.max.y:l,t.max.z=t.max.z>f?t.max.z:f}this.nu=t}this.pY=s,this.fY.length=0}return this.fl(i),this.gY=r,this.sp.u=!1,this.ui.u=!1,this}wc(t,e){const i=1===t?this.P$:this._D,s=this.xY,r=this.bV,n=this.Ze,o=this.pY,a=this.sp.T(),h=o||0;return i&&r&&void 0!==o&&this.ZB.SR(i,(l,c,u)=>{let d=!1;const f=c("aPos"),g=c("aOffsetAxis");this.ZB.Kc(i).HR(l("uScale"),this.cY.bD.kR()).HR(l("uDisp"),this.cY.bD.CR()).XR(l("uViewProjectionMatrix"),this.bY)._R(l("uIsHighlighted"),1===t||2===t?0:this.gi).UI(l("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(l("uRenderEffectMask"),2===t?1:0);const p={location:f,size:3},m={location:g,size:3},y={location:void 0,size:4},x={location:void 0,size:1};if(1!==t&&"phong"===a.type&&this.ZB.HR(l("uCameraLoc"),this.MY).HR(l("uLightLoc"),this.wY)._R(l("uAmbientReflection"),a.ambientReflection)._R(l("uSpecularReflection"),a.specularReflection)._R(l("uDiffuseReflection"),a.diffuseReflection)._R(l("uShininess"),a.shininess).UI(l("uLightColor"),a.specularColor).UI(l("uAmbientColor"),a.ambientColor),1===t)this.ZB.ZR(l("uFirstId"),e).UO(u,h);else if(gs(n))this.ZB.UI(l("uColorDiffuse"),n.getColor());else if(ms(n)){const t=c("aColor");y.location=t}else if(vs(n)){const t=Er(n,this,void 0);if(!t&&n.lut.percentageValues)return!1;this.ZB.JO(u,n.lut,t),"value"===n.lookUpProperty&&(x.location=c("aLookupValue"))}return r&&(this.ZB.bR(r,1,p,m,y,x),s.Nk(u,o,"phong"===a.type&&1!==t,!1),d=!0),d}),{idCount:h}}kc(t,e,i,s,r){const n=(t-e)*My;if(!this.vY)return{};const o=this.vY[n+0],a=this.vY[n+1],h=this.vY[n+2],l=this.vY[n+3],c=this.vY[n+4],u=this.vY[n+5],d=qt(this.vY[n+6],void 0),f=qt(this.vY[n+7],void 0),g=qt(this.vY[n+8],void 0),p=qt(this.vY[n+9],void 0),m=qt(this.vY[n+10],void 0);let y;for(const t of Object.keys(this.dY))if(this.dY[t].location===n){y=t;break}return{info:{dataPoint:{x:o,y:a,z:h,xSize:l,ySize:c,zSize:u,r:d,g:f,b:g,a:p,intensity:m,id:y}}}}dispose(){return super.dispose(),this.bV&&(this.ZB.BR(this.bV),this.bV=void 0),this._D=void 0,this}_c(){return this.dispose(),this}mp(t){this.fY=Be(this.fY,t,{canReturnB:!0})}Vi(){this.bV&&(this.ZB.BR(this.bV),this.bV=void 0),this.vY=void 0,this.yY=0,this.mY=0,this.dY={},this.pY=0,this.fY=[],this.nu=hi}qe(t){return this.Ze=mo(this.Ze,t),this}Mh(){return this.Ze}pp(t){return this.AY=void 0!==t&&t>0?$t(t,0,1):void 0,this}SY(){return this.AY}Wi(){return this.nu.max.x}Hi(){return this.nu.min.x}Zi(){return this.nu.max.y}Xi(){return this.nu.min.y}ye(){return this.nu.max.z}ve(){return this.nu.min.z}uu(){return 0}cu(){return 0}fp(){return 0}ll(){return yo(this.ul,this.Ze)}fl(t){this.ul=t}}class ky extends em{constructor(t,e){super(t),this.nY="custom",this.xV=e;const{vertices:i,drawSize:s}=this.SV();this.bV=t.mR(i),this.wV=s}Kc(t){return this.ZB.bR(this.bV,0,{location:t.attribute("aSegmentPosition"),size:1},{location:t.attribute("aPerpendHorizontal"),size:1},{location:t.attribute("aPerpendVertical"),size:1}),this}Nk(t){return this.ZB.dO(this.ZB.gl.TRIANGLE_STRIP,0,this.wV,t),this}SV(){const t=this.xV,e=new Float32Array(2*(t+1)*3);let i=0;for(let s=0;s<=t;s+=1){const r=2*Math.PI*s/t,n=Math.cos(r),o=Math.sin(r);for(const t of[0,1])e[i+0]=t,e[i+1]=n,e[i+2]=o,i+=3}return{vertices:e,drawSize:i/3}}$E(){this.ZB.BR(this.bV)}}const Ty=(t,e=16)=>{let i=t.NR.VE.get(e);return i||(i=new ky(t,e),t.NR.VE.set(e,i),i)};class wy extends by{constructor(t,e,i){super(t,e,i),this.uY="cull-back",this._Y=hi,this.kY=[],this.CY=!1,this.hc=co.lineStyle,this.sp.C(Xs)}Nh(t){const e=this.CY,i=this.hc,s=this.oc!==i,r=this.eR(),n=e;if(e){const t=me(this.kY);this.TY=this.ZB.mR(t,!1,this.TY)}if(n&&(this._Y=Mi(this.kY)),s||r){const t=8,e=cr(i)&&i.getFillStyle(),s=1===i.getThickness()?"primitive":"instanced";this.DV=void 0,gs(e)&&("primitive"===s?this.DV={type:s,shader:this.ZB.SE(vp["3D"],vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}),vp.Color({dataType:"uniform"})),fillStyle:e}:"instanced"===s&&(this.DV={type:s,shader:this.ZB.SE(vp["3D"],vp.ColorShaded3D({dataType:"uniform",shadingStyle:this.sp.T().type}),vp.LineInstanced3D({axisWorldTranslation:Sr(this.ai)})),geometry:Ty(this.ZB,t),fillStyle:e}))}return this.CY=!1,this.oc=i,this.sp.u=!1,this}wc(t,e){if(1===t)return{};const i=this.ZB.gl,s=this.DV,r=this.TY,n=this.hc,o=this.sp.T();if(s&&r&&cr(n))switch(s.type){case"instanced":{const e=.5*this.Ws.Hp(n.thickness),a=s.fillStyle.getColor(),h=s.shader,l=s.geometry;this.ZB.SR(h,(s,n,c)=>{this.ZB.Kc(h).HR(s("uScale"),this.cY.bD.kR()).HR(s("uDisp"),this.cY.bD.CR()).XR(s("uViewProjectionMatrix"),this.bY).UI(s("uColorDiffuse"),a)._R(s("uOffsetWU"),e)._R(s("uIsHighlighted"),this.gi).UI(s("uHighlightColorOffset"),2===t?B:this.Si)._R(s("uRenderEffectMask"),2===t?1:0),"phong"===o.type&&this.ZB.HR(s("uCameraLoc"),this.MY).HR(s("uLightLoc"),this.wY)._R(s("uAmbientReflection"),o.ambientReflection)._R(s("uSpecularReflection"),o.specularReflection)._R(s("uDiffuseReflection"),o.diffuseReflection)._R(s("uShininess"),o.shininess).UI(s("uLightColor"),o.specularColor).UI(s("uAmbientColor"),o.ambientColor),i.bindBuffer(i.ARRAY_BUFFER,r);const u=n("aLocationA"),d=n("aLocationB");return i.vertexAttribPointer(u,3,i.FLOAT,!1,6*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(u,1),i.enableVertexAttribArray(u),i.vertexAttribPointer(d,3,i.FLOAT,!1,6*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(d,1),i.enableVertexAttribArray(d),l.Kc(c).Nk(this.kY.length/2),!0});break}case"primitive":{const e=cr(n)?n.getFillStyle():void 0,o=e&&gs(e)?e.getColor():void 0;if(o){const e=s.shader;this.ZB.SR(e,(s,n)=>(this.ZB.Kc(e).HR(s("uScale"),this.cY.bD.kR()).HR(s("uDisp"),this.cY.bD.CR()).XR(s("uViewProjectionMatrix"),this.bY).UI(s("uColor"),o)._R(s("uIsHighlighted"),this.gi).UI(s("uHighlightColorOffset"),2===t?B:this.Si)._R(s("uRenderEffectMask"),2===t?1:0).bR(r,void 0,{location:n("aPos"),size:3}).Nk(i.LINES,this.kY.length),!0))}break}}return{idCount:this.kY.length}}kc(t,e,i,s,r){return{}}bu(t){for(let e=0;e<t.length-1;e+=1){const i=t[e],s=t[e+1];this.kY.push(i),this.kY.push(s)}return this.CY=!0,{Ii(){return this},Fs(){return this}}}Vi(){return this.kY.length=0,this.CY=!0,this}Bp(){return[]}Zd(t){}cr(t){return this.hc="function"==typeof t?t(this.hc):t,this}do(){return this.hc}_c(){return this.TY&&(this.ZB.BR(this.TY),this.TY=void 0),this}Wi(){return this._Y.max.x}Hi(){return this._Y.min.x}Zi(){return this._Y.max.y}Xi(){return this._Y.min.y}ye(){return this._Y.max.z}ve(){return this._Y.min.z}uu(){const t=this.hc;return t===Bt?0:t.getThickness()}cu(){const t=this.hc;return t===Bt?0:t.getThickness()}fp(){const t=this.hc;return t===Bt?0:t.getThickness()}}class Cy extends em{constructor(t,e,i){super(t),this.nY="gpu-calculate",this.FY=e,this.IY=i;const{vertices:s,drawSize:r}=this.SV();this.bV=t.mR(s),this.wV=r}Nk(t,e,i,s){return this.ZB.bR(this.bV,0,{location:t.attribute("aInstanceGeo"),size:3},{location:s?t.attribute("aTriangleBary"):void 0,size:3}).dO(this.ZB.gl.TRIANGLES,0,this.wV,e),this}SV(){const t=this.IY,e=this.FY,i=new Float32Array(6*(6*e+6*(t-2)*e));let s=0;const r=2*Math.PI/e,n=Math.PI/t,o=(t,e,o,a,h)=>{const l=e*r,c=Math.PI/2-t*n,u=Math.cos(c),d=u*Math.cos(l),f=u*Math.sin(l),g=Math.sin(c);i[s]=d,i[s+1]=g,i[s+2]=f,i[s+3]=o,i[s+4]=a,i[s+5]=h,s+=6};for(let i=0;i<t;i+=1)for(let s=0;s<e;s+=1)i>0&&(o(i,s,1,0,0),o(i,s+1,1,1,0),o(i+1,s,0,0,1)),i<t-1&&(o(i,s+1,1,1,0),o(i+1,s+1,0,1,0),o(i+1,s,0,0,1));return s!==i.length&&_e(0,()=>{this.ZB.Pg.Ea&&s>i.length&&Ut.console.warn("LightningChart JS unexpected error scenario, sphere geometry buffer size mismatch.\nA point series 3D component might have missing points.\n\nThis warning can be omitted with LightningChartOptions.warnings")}),{vertices:i,drawSize:s/6}}$E(){this.ZB.BR(this.bV)}}const By=(t,e)=>{const i=Math.round(e);i<3&&_e(0,jt);const s=i;let r=t.NR.NE.get(Array.from(t.NR.NE.keys()).find(t=>t.sectors===i&&t.stacks===s));return r||(r=new Cy(t,i,s),t.NR.NE.set({sectors:i,stacks:s},r),r)};class Fy extends by{constructor(t,e,i,s){super(t,e,i),this.uY="cull-back",this._b=[],this.DV={},this.DN=new _m(this._b,t=>t.vertexBuffer&&this.ZB.BR(t.vertexBuffer),!0),this.fc=[],this.Ac=0,this.pu=[],this.LY=0,this.nu=hi,this.PY=hi,this.Fz=Mr({lineStyleSolid:()=>{const t=this.hc;return cr(t)&&t},lineFillSolid:()=>{const t=this.hc.getFillStyle();return gs(t)&&t},lineFillPaletted:()=>{const t=this.hc.getFillStyle();return vs(t)&&t},jointStyleTriangulatedPoints:()=>sr(this.ov)&&this.ov,jointSizeTriangulated:()=>{const t=this.ov;return sr(t)&&t.getSize()},jointFillSolid:()=>{const t=this.ov.getFillStyle();return gs(t)&&t},jointFillPaletted:()=>{const t=this.ov.getFillStyle();return vs(t)&&t},wireframeLineStyleSolid:()=>{const t=sr(this.ov)&&this.ov.getWireframeStyle();return cr(t)&&t},wireframeFillSolid:()=>{const t=sr(this.ov)&&this.ov.getWireframeStyle(),e=t&&t.getFillStyle();return gs(e)&&e}}),this.nU=m(void 0),this.mu=!1,this.Da=s,this.hc=co.lineStyle,this.ov=co.pointStyle3D,this.sp.C(Ks);const r=!0===(null==s?void 0:s.individualLookupValuesEnabled);let n,o=0;o+=3,r&&(n=o,o+=1);const a=ye(!1,!1,r,!1);this.VN={attributeOffsetCoordinate:0,individualLookupValuesEnabled:r,attributesPerVertex:o,attributeOffsetLookUpValue:n,prepareRenderData:(t,e)=>a(t,void 0,this.hc.getFillStyle())}}_i(){return this.nU.T()||this.nU._}kc(t,e,i,s,r){return{info:{dataPoint:this.fc[t-e]}}}Nh(t){const e=this.mu,i=this.pu,s=this.LY,r=s>0,n=this.hc,o=n!==this.oc,a=this.ov,h=a!==this.BY,l=this.eR(),c=this.ui.u,u=this.ui.T();this.PY&&(this.nu=ki(this.nu,this.PY),this.PY=void 0),r&&(this.fc=Be(this.fc,i,{canReturnB:!0}),this.Ac+=s);let d=i,f=s;if(e&&(this._b.forEach(t=>{t.existingCoordinatesCount=0,t.existingDataPointsCount=0,t.boundaries=hi}),this.DN.wN(),d=this.fc,f=this.Ac),f>0){const t=1e5,e=Math.floor(this.Sz.DY/(this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT)),i=this.wi("ApplicationType",t=>"UserSeries"===t.type)?f:1e3,s=$t(i,t,e);this.DN.xN(d,s,(t,e,i,s)=>({existingDataPointsCount:i-s,existingCoordinatesCount:i,allocatedCoordinatesCount:t,jointPointsCount:s,lastDataPoint:e[i-1],boundaries:hi,vertexBuffer:this.ZB.KR(t*this.VN.attributesPerVertex,this.VN.prepareRenderData(e,i))}),(t,e,i,s)=>{this.ZB.qR(t.vertexBuffer,t.existingCoordinatesCount*this.VN.attributesPerVertex,this.VN.prepareRenderData(e,i)),t.existingDataPointsCount+=i-s,t.existingCoordinatesCount+=i,t.jointPointsCount+=s,t.lastDataPoint=e[i-1]})}const g=this.Fz.lineStyleSolid(o),p=this.Fz.lineFillSolid(o),m=this.Fz.lineFillPaletted(o),y=p||m;if(o||h||l||c){const t={},e=this.Fz.jointStyleTriangulatedPoints(h),i=this.Fz.jointSizeTriangulated(h),s=this.Fz.jointFillSolid(h),r=this.Fz.jointFillPaletted(h),o=s||r,a=this.Fz.wireframeLineStyleSolid(h),l=this.Fz.wireframeFillSolid(h),c=this.VN.individualLookupValuesEnabled,d=n.getThickness()<0||1===n.getThickness()&&this.wi("ApplicationType",t=>"InternalUI"===t.type)?"primitive":"instanced",f=m?["lookup",m.getLookUpProperty(),m.lut]:"uniform";if(m&&"value"===m.getLookUpProperty()&&!c){const t='LCJS misusage error: Series individualLookupValuesEnabled flag must be set if using PalettedFill with lookUpProperty="value" !';throw Ut.alert(t),new Error(t)}if("primitive"===d&&y?t.lines={type:"primitive",fillStyleSolid:p,fillStylePaletted:m,shader:this.ZB.SE(vp["3D"],vp.Color({dataType:f}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})),mousePicking:u?{shader:this.ZB.SE(vp["3D"],vp.MousePicking({useVertexId:!0}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}))}:void 0}:"instanced"===d&&g&&y&&(t.lines={type:"instanced",lineStyleSolid:g,fillStyleSolid:p,fillStylePaletted:m,shader:this.ZB.SE(vp["3D"],vp.ColorShaded3D({dataType:f,shadingStyle:this.sp.T().type}),vp.LineInstanced3D({axisWorldTranslation:Sr(this.ai)})),geometry:Dy(this.ZB,g.getThickness()),mousePicking:u?{shader:this.ZB.SE(vp["3D"],vp.MousePicking(),vp.LineInstanced3D({axisWorldTranslation:Sr(this.ai)}))}:void 0}),t.markers=void 0,o&&e){const n=we(e.getShape(),{cube:()=>Ay(this.ZB),sphere:()=>Iy(this.ZB,e)});t.markers={geometry:n,pointStyle:e,pointSizeNWU:"number"==typeof i&&i,pointSizeAxis:"object"==typeof i&&i,fillStyleSolid:s,fillStylePaletted:r,shader:this.ZB.SE(vp["3D"],vp.ColorShaded3D({dataType:r?["lookup",r.getLookUpProperty(),r.lut]:"uniform",shadingStyle:this.sp.T().type,wireframe:!1!==l}),vp.VertexLocation({offsets:[{directionVar:"aInstanceGeo",dataType:"uniform",sizeUnit:"number"==typeof i?"nwu":"axis",symmetric:"number"==typeof i,halved:!0}],axisWorldTranslation:Sr(this.ai),normalSource:n.nY})),mousePicking:u?{shader:this.ZB.SE(vp["3D"],vp.MousePicking(),vp.VertexLocation({offsets:[{directionVar:"aInstanceGeo",dataType:"uniform",sizeUnit:"number"==typeof i?"nwu":"axis",symmetric:"number"==typeof i,halved:!0}],axisWorldTranslation:Sr(this.ai),normalSource:void 0}))}:void 0,wireframe:a&&l&&{thickness:a.getThickness(),fillStyleSolid:l}}}this.DV=t}if(void 0===this.nU.T()&&m&&"value"===m.lookUpProperty&&m.lut.percentageValues){let t=oi,e=ni;for(let i=0;i<this.fc.length;i+=1){const s=this.fc[i];void 0!==s.value&&s.value<e&&(e=s.value),void 0!==s.value&&s.value>t&&(t=s.value)}this.nU.C({min:e,max:t})}return this.nU._=void 0,this.mu=!1,this.pu=[],this.LY=0,this.oc=n,this.BY=a,this.sp.u=!1,this.ui.u=!1,this}wc(t,e){var i,s;const r=this.ZB.gl,{lines:n,markers:o}=this.DV,a=this.sp.T(),h=this.Ac,l=1===t?null===(i=null==n?void 0:n.mousePicking)||void 0===i?void 0:i.shader:null==n?void 0:n.shader;if(n&&l&&"instanced"===n.type){const i=l,{geometry:s,lineStyleSolid:o,fillStyleSolid:h,fillStylePaletted:c}=n;this.ZB.SR(i,(n,l,u)=>{let d=!1;if(this.ZB.Kc(i).HR(n("uScale"),this.cY.bD.kR()).HR(n("uDisp"),this.cY.bD.CR()).XR(n("uViewProjectionMatrix"),this.bY)._R(n("uOffsetWU"),this.Ws.Hp(o.getThickness()))._R(n("uIsHighlighted"),1===t||2===t?0:this.gi).UI(n("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(n("uRenderEffectMask"),2===t?1:0),1!==t&&"phong"===a.type&&this.ZB.HR(n("uCameraLoc"),this.MY).HR(n("uLightLoc"),this.wY)._R(n("uAmbientReflection"),a.ambientReflection)._R(n("uSpecularReflection"),a.specularReflection)._R(n("uDiffuseReflection"),a.diffuseReflection)._R(n("uShininess"),a.shininess).UI(n("uLightColor"),a.specularColor).UI(n("uAmbientColor"),a.ambientColor),1===t);else if(h)this.ZB.UI(n("uColorDiffuse"),h.getColor());else if(c){const t=Er(c,this,this.nU.T());if(!t&&c.lut.percentageValues)return!1;this.ZB.JO(u,c.lut,t)}const f=ti(e);return this._b.forEach(e=>{if(1===t){const[t,i]=f.ss(e.existingDataPointsCount);this.ZB.ZR(n("uFirstId"),t).UO(u,i)}r.bindBuffer(r.ARRAY_BUFFER,e.vertexBuffer);const i=l("aLocationA"),o=l("aLocationB");if(r.vertexAttribPointer(i,3,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetCoordinate*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(i,1),r.enableVertexAttribArray(i),r.vertexAttribPointer(o,3,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,(this.VN.attributeOffsetCoordinate+this.VN.attributesPerVertex)*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(o,1),r.enableVertexAttribArray(o),c&&"value"===c.getLookUpProperty()&&void 0!==this.VN.attributeOffsetLookUpValue&&1!==t){const t=l("aLookupValue");r.vertexAttribPointer(t,1,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetLookUpValue*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(t,1),r.enableVertexAttribArray(t)}s.Kc(u).Nk(e.existingCoordinatesCount-1),d=!0}),d})}if(n&&l&&"primitive"===n.type){const i=l,{fillStyleSolid:s,fillStylePaletted:o}=n;this.ZB.SR(i,(n,a,h)=>{let l=!1;if(this.ZB.Kc(i).HR(n("uScale"),this.cY.bD.kR()).HR(n("uDisp"),this.cY.bD.CR()).XR(n("uViewProjectionMatrix"),this.bY)._R(n("uIsHighlighted"),1===t||2===t?0:this.gi).UI(n("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(n("uRenderEffectMask"),2===t?1:0),1===t);else if(s)this.ZB.UI(n("uColor"),s.getColor());else if(o){const t=Er(o,this,this.nU.T());if(!t&&o.lut.percentageValues)return!1;this.ZB.JO(h,o.lut,t)}const c=ti(e);return this._b.forEach(e=>{if(1===t){const[t,i]=c.ss(e.existingDataPointsCount);this.ZB.ZR(n("uFirstId"),t).GO(h,i)}r.bindBuffer(r.ARRAY_BUFFER,e.vertexBuffer);const i=a("aPos");if(r.vertexAttribPointer(i,3,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetCoordinate*Float32Array.BYTES_PER_ELEMENT),r.enableVertexAttribArray(i),o&&"value"===o.getLookUpProperty()&&void 0!==this.VN.attributeOffsetLookUpValue&&1!==t){const t=a("aLookupValue");r.vertexAttribPointer(t,1,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetLookUpValue*Float32Array.BYTES_PER_ELEMENT),r.enableVertexAttribArray(t)}this.ZB.Nk(r.LINE_STRIP,e.existingCoordinatesCount),l=!0}),l})}const c=1===t?null===(s=null==o?void 0:o.mousePicking)||void 0===s?void 0:s.shader:null==o?void 0:o.shader;if(o&&c){const i=c,{geometry:s,fillStyleSolid:n,fillStylePaletted:h,pointSizeAxis:l,pointSizeNWU:u,wireframe:d}=o;this.ZB.SR(i,(o,c,f,g)=>{let p=!1;if(this.ZB.Kc(i).HR(o("uScale"),this.cY.bD.kR()).HR(o("uDisp"),this.cY.bD.CR()).XR(o("uViewProjectionMatrix"),this.bY)._R(g("uRatioNwuWu"),this.cY.EY())._R(o("uIsHighlighted"),1===t||2===t?0:this.gi).UI(o("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(o("uRenderEffectMask"),2===t?1:0),1!==t&&"phong"===a.type&&this.ZB.HR(o("uCameraLoc"),this.MY).HR(o("uLightLoc"),this.wY)._R(o("uAmbientReflection"),a.ambientReflection)._R(o("uSpecularReflection"),a.specularReflection)._R(o("uDiffuseReflection"),a.diffuseReflection)._R(o("uShininess"),a.shininess).UI(o("uLightColor"),a.specularColor).UI(o("uAmbientColor"),a.ambientColor),1===t);else if(n)this.ZB.UI(o("uColorDiffuse"),n.getColor());else if(h){const t=Er(h,this,this.nU.T());if(!t&&h.lut.percentageValues)return!1;this.ZB.JO(f,h.lut,t)}d&&1!==t&&this.ZB._R(o("uWireframeThickness"),d.thickness).UI(o("uWireframeColor"),d.fillStyleSolid.getColor()),!1!==l&&this.ZB.HR(o("uOffsetAxis"),[l.x,l.y,l.z]),!1!==u&&this.ZB._R(o("uOffsetNWU"),u);const m=ti(e);return this._b.forEach(e=>{if(1===t){const[t,i]=m.ss(e.existingDataPointsCount);this.ZB.ZR(o("uFirstId"),t).UO(f,i)}r.bindBuffer(r.ARRAY_BUFFER,e.vertexBuffer);const i=c("aPos");if(r.vertexAttribPointer(i,3,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetCoordinate*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(i,1),r.enableVertexAttribArray(i),h&&"value"===h.getLookUpProperty()&&void 0!==this.VN.attributeOffsetLookUpValue&&1!==t){const t=c("aLookupValue");r.vertexAttribPointer(t,1,r.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetLookUpValue*Float32Array.BYTES_PER_ELEMENT),this.ZB.hO(t,1),r.enableVertexAttribArray(t)}s.Nk(f,e.existingCoordinatesCount,"phong"===a.type&&1!==t,Boolean(d)&&1!==t),p=!0}),p})}return{idCount:h}}bu(t,e){Array.isArray(t)||(t=[t]),this.pu=Be(this.pu,t,{canReturnB:!0}),this.LY+=t.length;const i=e||Mi(t);return this.PY=this.PY?ki(this.PY,i):i,this}cr(t){return this.hc="function"==typeof t?t(this.hc):t,this}do(){return this.hc}Vp(t){return this.ov="function"==typeof t?t(this.ov):t,this}RY(){return this.ov}Wi(){return this.PY?Math.max(this.PY.max.x,this.nu.max.x):this.nu.max.x}Hi(){return this.PY?Math.min(this.PY.min.x,this.nu.min.x):this.nu.min.x}Zi(){return this.PY?Math.max(this.PY.max.y,this.nu.max.y):this.nu.max.y}Xi(){return this.PY?Math.min(this.PY.min.y,this.nu.min.y):this.nu.min.y}ye(){return this.PY?Math.max(this.PY.max.z,this.nu.max.z):this.nu.max.z}ve(){return this.PY?Math.min(this.PY.min.z,this.nu.min.z):this.nu.min.z}uu(){return We(this.hc)}cu(){return We(this.hc)}fp(){return We(this.hc)}Mu(){return this.fc}wu(){return this.pu}Cu(){return this.Ac}Tu(){return this.LY}Vi(){return this.mu=!0,this.fc.length=0,this.Ac=0,this.pu=[],this.LY=0,this.nu=hi,this.PY=void 0,this}dispose(){return super.dispose(),this.DN._N(),this.DV={},this}_c(){return this.dispose(),this}}const Dy=(t,e)=>Ty(t,e>50?20:e>20?16:e>10?12:e>5?8:6),Iy=(t,e)=>{const i=e.getSize();return By(t,"number"==typeof i?i>50?20:i>20?16:i>10?12:i>5?8:6:20)};class Ry extends by{constructor(t,e,i){super(t,e,i),this.uY="disabled",this.OY=!1,this.zY=!1,this.VY={x:1,y:1,z:1},this.ky={x:0,y:0,z:0},this._y={x:0,y:0,z:0},this.NY={x:0,y:0,z:0},this.Ty={x:0,y:0,z:0,w:1},this.Fy={x:1,y:1,z:1},this.GY=M(255,255,255),this.$Y=Jp.projectionOrthographic(-1,1,-1,1,1,-1),this.UY=Jp.projectionOrthographic(-1,1,-1,1,1,-1),this.YY=!1,this.isEulerRotation=!0,this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStyleValuePalette:()=>vs(this.Ze)&&"value"===this.Ze.lookUpProperty&&this.Ze}),this.Ze=co.fillStyle,this.sp.C(Ks)}Nh(t){var e;const i=this.eR(),s=this.ui.T(),r=this.ui.u,n=this.ll();this.Fz.fillStyleSolid(n);const o=this.Fz.fillStyleValuePalette(n),a=this.NY,h=this.Fy;if(this.OY&&this.jY&&(this.bV=this.ZB.mR(this.jY.vertices,void 0,this.bV),this.MV=this.ZB.sO(this.jY.indices,this.MV),this.HY=this.jY.indices.length),"phong"===this.sp.T().type&&(i||this.OY)&&(null===(e=this.jY)||void 0===e?void 0:e.normals)&&(this.WY=this.ZB.mR(this.jY.normals,void 0,this.WY)),!this.ZY&&o&&"value"===o.lookUpProperty&&this.jY&&(this.ZY=new Float32Array(this.jY.vertices.length/3),this.zY=!0),this.ZY&&this.zY&&(this.JY=this.ZB.mR(this.ZY,void 0,this.JY)),i||n||r){if(o&&"value"!==o.lookUpProperty)throw new Error("LightningChart JS MeshModel3D does not support look up by x/y/z. Must be value");this._D=this.ZB.SE(vp["3D"],vp.ColorShaded3D({dataType:o?["lookup","value",o.lut]:"uniform",shadingStyle:this.sp.T().type,wireframe:!1}),vp.Model3D({normalSource:"phong"===this.sp.T().type?"attribute":void 0})),this.P$=s?this.ZB.SE(vp["3D"],vp.MousePicking({useVertexId:!0}),vp.Model3D({normalSource:void 0})):void 0}if(this.YY){const t=Jp.projectionOrthographic(-1,1,-1,1,1,-1);if(this.isEulerRotation)this.UY=Jp.rotateXYZ(t,a),this.$Y=Jp.translate(t,h.x/2,h.y/2,h.z/2),this.$Y=Jp.rotateXYZ(this.$Y,a),this.$Y=Jp.translate(this.$Y,-h.x/2,-h.y/2,-h.z/2);else{const e=[-this.Ty.x,-this.Ty.y,-this.Ty.z,this.Ty.w];this.UY=Jp.quaternionToRotationMatrix(e),this.$Y=Jp.translate(t,h.x/2,h.y/2,h.z/2),this.$Y=Jp.multiply(this.$Y,this.UY),this.$Y=Jp.translate(this.$Y,-h.x/2,-h.y/2,-h.z/2)}this.YY=!1}return this.sp.u=!1,this.fl(this.Ze),this.ui.u=!1,this.OY=!1,this.zY=!1,this}wc(t,e){var i;const s=1===t?this.P$:this._D,r=1===t,n=this.MV,o=this.bV,a=this.WY,h=this.JY,l=this.ky,c=this._y,u=this.VY,d=this.Fy,f=this.$Y,g=this.UY,p=this.Fz.fillStyleValuePalette(!1),m=this.Fz.fillStyleSolid(!1),y=this.sp.T(),x={location:void 0,size:1};let v=this.HY;if(!(s&&o&&n&&this.jY))return{};const A=this.jY?null===(i=this.jY)||void 0===i?void 0:i.parts.length:0;if(A<1)return{};const S=this.jY.vertices.length;return this.ZB.SR(s,(i,b,M,E)=>{var k;this.ZB.Kc(s).HR(i("uScale"),this.cY.bD.kR()).HR(i("uDisp"),this.cY.bD.CR()).XR(i("uViewProjectionMatrix"),this.bY)._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),this.Si)._R(i("uRenderEffectMask"),2===t?1:0).XR(i("uModelRotation"),f).HR(i("uModelScale"),[u.x,u.y,u.z]).HR(i("uLocationAxis"),[l.x,l.y,l.z]).HR(i("uModelAlignment"),[c.x,c.y,c.z]).HR(i("uModelSize"),[d.x,d.y,d.z]).bR(o,0,{location:M.attribute("aGeoPos"),size:3}).lO(n);let T=!1;if(r)this.ZB.ZR(i("uFirstId"),e).GO(M,S);else{if(this.Ze===ls&&S<1)return!1;if(m)this.ZB.UI(i("uColorDiffuse"),m.getColor());else if(p){if(!h)return!1;const t=p.getPalette();x.location=b("aLookupValue"),this.ZB.JO(M,t,void 0).bR(h,void 0,x),T=!0}}"phong"!==y.type||r||(this.ZB.HR(i("uCameraLoc"),this.MY).HR(i("uLightLoc"),this.wY)._R(i("uAmbientReflection"),y.ambientReflection)._R(i("uSpecularReflection"),y.specularReflection)._R(i("uDiffuseReflection"),y.diffuseReflection)._R(i("uShininess"),y.shininess).UI(i("uLightColor"),y.specularColor).UI(i("uAmbientColor"),y.ambientColor).XR(i("uModelRotationNormals"),g),a&&this.ZB.bR(a,void 0,{location:M.attribute("aNormal"),size:3}));let w=!1;for(let t=0;t<A;t+=1){v=0;let e=this.GY,s=0,n=0,o=0,a=!0;this.jY&&this.jY.parts&&this.jY.parts[t].material&&(e=this.jY.parts[t].material.specular,v=this.jY.parts[t].count,n=this.jY.parts[t].count,o=this.jY.parts[t].offset,a=this.jY.parts[t].useIndexBuffer,s=this.jY.parts[t].indexStart,r||m||T||this.ZB.UI(i("uColorDiffuse"),this.jY.parts[t].material.diffuse)),(v>0||n>0)&&("phong"!==y.type||r||(this.ZB.UI(i("uLightColor"),e),g?this.ZB.XR(i("uModelRotationNormals"),g):this.ZB.UI(i("uLightColor"),y.specularColor)),a?this.ZB.cO(v,this.ZB.gl.TRIANGLES,s,(null===(k=this.jY)||void 0===k?void 0:k.indices)instanceof Uint32Array?this.ZB.gl.UNSIGNED_INT:this.ZB.gl.UNSIGNED_SHORT):this.ZB.Nk(this.ZB.gl.TRIANGLES,n,o),w=!0)}return w}),{idCount:S}}QY(t){if(this.KY)return this.KY;const e=this.ky,i=this._y,s=this.VY,r=this.Fy,n=this.NY,o=this.Ty,a=this.cY.ix(e),h=[],l=Jp.projectionOrthographic(-1,1,-1,1,1,-1);let c;if(this.isEulerRotation)c=Jp.translate(l,r.x/2,r.y/2,r.z/2),c=Jp.rotateXYZ(c,n),c=Jp.translate(c,-r.x/2,-r.y/2,-r.z/2);else{const t=[-o.x,-o.y,-o.z,o.w];c=Jp.translate(l,r.x/2,r.y/2,r.z/2),c=Jp.multiply(c,Jp.quaternionToRotationMatrix(t)),c=Jp.translate(c,-r.x/2,-r.y/2,-r.z/2)}const u=(i.x+1)*(r.x/2),d=(i.y+1)*(r.y/2),f=(i.z+1)*(r.z/2);for(let e=0;e<t.vertices.length;e+=3){const i=Jp.multiply(c,[t.vertices[e],t.vertices[e+1],t.vertices[e+2],1]),r={x:a.x+(i[0]-u)*s.x,y:a.y+(i[1]-d)*s.y,z:a.z+(i[2]-f)*s.z};h.push(r)}return this.KY=h,this.KY}Ry(t){const e=this.jY;if(!e)return;const i=this.QY(e),s=t(i);0!==s.length&&(s.length!==i.length&&!0===this.pi.Da.Ea&&Ut.console.warn("LightningChart JS warning - MeshModel3D.setVertexValues returned array length is not equal to vertex locations array length.\nThis is most likely an application error."),this.ZY=s instanceof Float32Array?s:new Float32Array(s),this.zY=!0)}kc(t,e,i,s,r){return{info:{iVertex:t-e}}}By(t,e){const i=this.jY;if(!i||void 0===(null==t?void 0:t.iVertex))return;if(i.indices.length>0){const s=[];for(let e=0;e<i.indices.length;e+=3){const r=i.indices[e],n=i.indices[e+1],o=i.indices[e+2];r!==t.iVertex&&n!==t.iVertex&&o!==t.iVertex||s.push([r,n,o])}const r=this.QY(i),n=this.pi.hr(e.clientX,e.clientY),o=s.map(t=>t.map(t=>{const e={x:i.vertices[3*t],y:i.vertices[3*t+1],z:i.vertices[3*t+2]},s=r[t],o=this.cY.sx(s),a=this.cY.Xp(o);return{index:t,vertex:e,world:s,axis:o,dist:a?xi(a,n):ni}})).flat();o.sort((t,e)=>t.dist-e.dist);const a=o[0];if(!a)return;const h=this.ZY?this.ZY[a.index]:void 0;return{coordModel:a.vertex,coordAxis:a.axis,index:a.index,value:h}}const s=t.iVertex,r=this.ZY?this.ZY[s]:void 0,n={x:i.vertices[3*s],y:i.vertices[3*s+1],z:i.vertices[3*s+2]},o=this.QY(i)[s];return{coordModel:n,coordAxis:this.cY.sx(o),index:s,value:r}}dispose(){return super.dispose(),this.bV&&(this.ZB.BR(this.bV),this.bV=void 0),this.MV&&(this.ZB.BR(this.MV),this.MV=void 0),this.WY&&(this.ZB.BR(this.WY),this.WY=void 0),this.JY&&(this.ZB.BR(this.JY),this.JY=void 0),this._D=void 0,this.P$=void 0,this.jY=void 0,this.ZY=void 0,this}_c(){return this.dispose(),this}Dy(t){return this.jY=t,this.OY=!0,this.Fy=t.modelSize,this}qe(t){return this.Ze=mo(this.Ze,t),this}Mh(){return this.Ze}Oy(t){return this.VY=t,this.KY=void 0,this}kR(){return this.VY}zy(t){return this.ky=t,this.KY=void 0,this}Vy(t){return this._y=t,this.KY=void 0,this}Ny(t){return this.NY=t,this.YY=!0,this.isEulerRotation=!0,this.KY=void 0,this}Gy(t){return this.Ty=t,this.YY=!0,this.isEulerRotation=!1,this.KY=void 0,this}$y(t){return this.uY=t,this}Uy(){return this.uY}Wi(){return oi}Hi(){return ni}Zi(){return oi}Xi(){return ni}ye(){return oi}ve(){return ni}uu(){return 0}cu(){return 0}fp(){return 0}ll(){return yo(this.ul,this.Ze)}fl(t){this.ul=t}}class Ly extends by{constructor(t,e,i,s){super(t,e,i),this.uY="cull-back",this._b=[],this.DN=new _m(this._b,t=>t.vertexBuffer&&this.ZB.BR(t.vertexBuffer),!1),this.fc=[],this.Ac=0,this.pu=[],this.LY=0,this.nu=hi,this.PY=hi,this.mu=!1,this.Fz=Mr({fillStyleSolid:()=>{const t=this.uv.getFillStyle();return gs(t)&&t},fillStyleIndividual:()=>{const t=this.uv.getFillStyle();return ms(t)&&t},fillStylePalette:()=>{const t=this.uv.getFillStyle();return vs(t)&&t},triangulatedPointStyle:()=>{const t=this.uv;return sr(t)&&t},wireframeLineStyleSolid:()=>{const t=sr(this.uv)&&this.uv,e=t&&t.getWireframeStyle();return cr(e)&&e},wireframeFillStyleSolid:()=>{const t=sr(this.uv)&&this.uv,e=t&&t.getWireframeStyle(),i=e&&e.getFillStyle();return gs(i)&&i}}),this.nU=m(void 0),this.Da=s,this.uv=co.pointStyle3D,this.sp.C(Ks);const r=!0===(null==s?void 0:s.individualPointColorEnabled),n=!0===(null==s?void 0:s.individualPointSizeEnabled),o=!0===(null==s?void 0:s.individualLookupValuesEnabled),a=!0===(null==s?void 0:s.individualPointSizeAxisEnabled);let h,l,c,u,d=0;d+=3,r&&(h=d,d+=4),n&&(l=d,d+=1),o&&(c=d,d+=1),a&&(u=d,d+=3);const f=ye(r,n,o,a);this.VN={individualPointColorEnabled:r,individualPointSizeEnabled:n,individualLookupValuesEnabled:o,individualPointSizeAxisEnabled:a,attributesPerVertex:d,attributeOffsetCoordinate:0,attributeOffsetColor:h,attributeOffsetSize:l,attributeOffsetLookUpValue:c,attributeOffsetPointSize3D:u,prepareRenderData:(t,e)=>f(t,this.uv,this.uv.fillStyle)}}_i(){return this.nU.T()||this.nU._}kc(t,e,i,s,r){return{info:{dataPoint:this.fc[t-e]}}}Nh(t){const e=this.mu,i=this.pu,s=this.LY,r=s>0,n=this.uv,o=this.uv!==this.qY,a=this.ui.T(),h=this.ui.u,l=this.eR();this.PY&&(this.nu=ki(this.nu,this.PY),this.PY=void 0),r&&(this.fc=Be(this.fc,i,{canReturnB:!0}),this.Ac+=s);let c=i,u=s;if(e&&(this._b.forEach(t=>{t.existingDataPointsCount=0,t.existingCoordinatesCount=0,t.boundaries=hi}),this.DN.wN(),c=this.fc,u=this.Ac),u>0){const t=Math.floor(this.Sz.DY/(this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT)),e=$t(u,1e5,t);this.DN.xN(c,e,(t,e,i)=>({existingDataPointsCount:i,existingCoordinatesCount:i,allocatedCoordinatesCount:t,boundaries:hi,vertexBuffer:this.ZB.KR(t*this.VN.attributesPerVertex,this.VN.prepareRenderData(e,i))}),(t,e,i)=>{this.ZB.qR(t.vertexBuffer,t.existingCoordinatesCount*this.VN.attributesPerVertex,this.VN.prepareRenderData(e,i)),t.existingDataPointsCount+=i,t.existingCoordinatesCount=t.existingDataPointsCount})}const d=n.getFillStyle(),f=this.Fz.fillStyleSolid(o),g=this.Fz.fillStyleIndividual(o),p=this.Fz.fillStylePalette(o),m=d===ls&&ls;if(o||l||h){let t;const e=n.getSize(),i=this.VN.individualPointColorEnabled,s=this.VN.individualPointSizeEnabled,r=this.VN.individualPointSizeAxisEnabled,h=this.VN.individualLookupValuesEnabled;if(g&&!i){const t="LCJS misusage error: Series individualPointColorEnabled flag must be set if using IndividualPointFill !";throw Ut.alert(t),new Error(t)}if(p&&"value"===p.getLookUpProperty()&&!h){const t='LCJS misusage error: Series individualLookupValuesEnabled flag must be set if using PalettedFill with lookUpProperty="value" !';throw Ut.alert(t),new Error(t)}const l=this.Fz.wireframeLineStyleSolid(o),c=this.Fz.wireframeFillStyleSolid(o);if(f||g||p||c){const i=g?"attribute":p?["lookup",p.getLookUpProperty(),p.lut]:"uniform",o=s&&"number"==typeof e,h=r&&"object"==typeof e,u=o||h?"attribute":"uniform";if(sr(n)){const r=we(n.getShape(),{cube:()=>Ay(this.ZB),sphere:()=>Py(this.ZB,n,s)});t={type:"instanced",shader:this.ZB.SE(vp["3D"],vp.ColorShaded3D({dataType:i,shadingStyle:this.sp.T().type,wireframe:!1!==c}),vp.VertexLocation({offsets:[{directionVar:"aInstanceGeo",dataType:u,sizeUnit:"number"==typeof e?"nwu":"axis",halved:!0,symmetric:"number"==typeof e}],axisWorldTranslation:Sr(this.ai),normalSource:r.nY})),pointStyle:n,useIndividualPointSize:o,useIndividualPointSize3D:h,pointSizeNWU:"number"==typeof e&&e,pointSizeAxis:"object"==typeof e&&e,fillStyleSolid:f,fillStyleIndividual:g,fillStylePaletted:p,fillStyleEmpty:m,mousePickingShader:a&&this.ZB.SE(vp["3D"],vp.MousePicking(),vp.VertexLocation({offsets:[{directionVar:"aInstanceGeo",dataType:u,sizeUnit:"number"==typeof e?"nwu":"axis",halved:!0,symmetric:"number"==typeof e}],axisWorldTranslation:Sr(this.ai),normalSource:void 0})),geometry:r,wireframe:l&&c&&{thickness:l.getThickness()<0?1:l.getThickness(),fillStyleSolid:c}}}else or(n)&&"number"==typeof e&&(t={type:"primitive",shader:this.ZB.SE(vp["3D"],vp.PointSize(u),vp.Color({dataType:i}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0})),pointStyle:n,pointSizePixels:e,useIndividualPointSize:o,fillStyleSolid:f,fillStyleIndividual:g,fillStylePaletted:p,mousePickingShader:a&&this.ZB.SE(vp["3D"],vp.PointSize(u),vp.MousePicking({useVertexId:!0}),vp.VertexLocation({axisWorldTranslation:Sr(this.ai),normalSource:void 0}))})}this.DV=t}if(void 0===this.nU.T()&&p&&"value"===p.lookUpProperty&&p.lut.percentageValues){let t=oi,e=ni;for(let i=0;i<this.fc.length;i+=1){const s=this.fc[i];void 0!==s.value&&s.value<e&&(e=s.value),void 0!==s.value&&s.value>t&&(t=s.value)}this.nU.C({min:e,max:t})}return this.nU._=void 0,this.mu=!1,this.pu=[],this.LY=0,this.qY=n,this.sp.u=!1,this}wc(t,e){const i=this.ZB.gl,s=this.DV,r=this.Ac;if(!s)return{};const n=1===t?s.mousePickingShader:s.shader;if(!n)return{};const o=this.sp.T(),{fillStyleSolid:a,fillStylePaletted:h,useIndividualPointSize:l}=s,c="instanced"===s.type&&s.useIndividualPointSize3D,u="instanced"===s.type&&s.wireframe;return this.ZB.SR(n,(r,d,f,g)=>{let p=!1;if(this.ZB.Kc(n).HR(r("uScale"),this.cY.bD.kR()).HR(r("uDisp"),this.cY.bD.CR()).XR(r("uViewProjectionMatrix"),this.bY)._R(r("uIsHighlighted"),1===t||2===t?0:this.gi).UI(r("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(r("uRenderEffectMask"),2===t?1:0),"instanced"===s.type){const{pointSizeAxis:t,pointSizeNWU:e}=s;!1!==t&&!1===c&&this.ZB.HR(r("uOffsetAxis"),[t.x,t.y,t.z]),!1!==e&&!1===l&&this.ZB._R(r("uOffsetNWU"),e)._R(g("uRatioNwuWu"),this.cY.EY())}else if("primitive"===s.type){const{pointSizePixels:t}=s;l||this.ZB._R(r("uPointSize"),t)._R(r("uDevicePixelRatio"),this.ZB.hR())}if(1===t);else if("instanced"===s.type?("phong"===o.type&&this.ZB.HR(r("uCameraLoc"),this.MY).HR(r("uLightLoc"),this.wY)._R(r("uAmbientReflection"),o.ambientReflection)._R(r("uSpecularReflection"),o.specularReflection)._R(r("uDiffuseReflection"),o.diffuseReflection)._R(r("uShininess"),o.shininess).UI(r("uLightColor"),o.specularColor).UI(r("uAmbientColor"),o.ambientColor),u&&this.ZB._R(r("uWireframeThickness"),u.thickness).UI(r("uWireframeColor"),u.fillStyleSolid.getColor()),a&&this.ZB.UI(r("uColorDiffuse"),a.getColor()),s.fillStyleEmpty&&this.ZB.UI(r("uColorDiffuse"),B)):"primitive"===s.type&&a&&this.ZB.UI(r("uColor"),a.getColor()),h){const t=Er(h,this,this.nU.T());if(!t&&h.lut.percentageValues)return!1;this.ZB.JO(f,h.lut,t)}const m=ti(e);return this._b.forEach(e=>{if(1===t){const[t,i]=m.ss(e.existingDataPointsCount);this.ZB.ZR(r("uFirstId"),t),"instanced"===s.type?this.ZB.UO(f,i):this.ZB.GO(f,i)}i.bindBuffer(i.ARRAY_BUFFER,e.vertexBuffer);const n=d("aPos");if(i.vertexAttribPointer(n,3,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetCoordinate*Float32Array.BYTES_PER_ELEMENT),"instanced"===s.type&&this.ZB.hO(n,1),i.enableVertexAttribArray(n),s.fillStyleIndividual&&void 0!==this.VN.attributeOffsetColor&&1!==t){const t=d("aColor");i.vertexAttribPointer(t,4,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetColor*Float32Array.BYTES_PER_ELEMENT),"instanced"===s.type&&this.ZB.hO(t,1),i.enableVertexAttribArray(t)}if(l&&void 0!==this.VN.attributeOffsetSize){"instanced"===s.type?this.ZB._R(g("uRatioNwuWu"),this.cY.EY()):"primitive"===s.type&&this.ZB._R(r("uDevicePixelRatio"),this.ZB.hR());const t=d("instanced"===s.type?"aOffsetNWU":"aPointSize");i.vertexAttribPointer(t,1,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetSize*Float32Array.BYTES_PER_ELEMENT),"instanced"===s.type&&this.ZB.hO(t,1),i.enableVertexAttribArray(t)}if(c&&void 0!==this.VN.attributeOffsetPointSize3D&&"instanced"===s.type){const t=d("aOffsetAxis");i.vertexAttribPointer(t,3,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetPointSize3D*Float32Array.BYTES_PER_ELEMENT),"instanced"===s.type&&this.ZB.hO(t,1),i.enableVertexAttribArray(t)}if(s.fillStylePaletted&&"value"===s.fillStylePaletted.getLookUpProperty()&&void 0!==this.VN.attributeOffsetLookUpValue&&1!==t){const t=d("aLookupValue");i.vertexAttribPointer(t,1,i.FLOAT,!1,this.VN.attributesPerVertex*Float32Array.BYTES_PER_ELEMENT,this.VN.attributeOffsetLookUpValue*Float32Array.BYTES_PER_ELEMENT),"instanced"===s.type&&this.ZB.hO(t,1),i.enableVertexAttribArray(t)}"instanced"===s.type?(s.geometry.Nk(f,e.existingCoordinatesCount,"phong"===o.type&&1!==t,Boolean(u)&&1!==t),p=!0):"primitive"===s.type&&(this.ZB.Nk(i.POINTS,e.existingCoordinatesCount),p=!0)}),p}),{idCount:r}}bu(t,e){Array.isArray(t)||(t=[t]),this.pu=Be(this.pu,t,{canReturnB:!0}),this.LY+=t.length;const i=e||Mi(t);return this.PY=this.PY?ki(this.PY,i):i,this.nU.C(void 0),this}cv(t){return this.uv="function"==typeof t?t(this.uv):t,this}tj(){return this.uv}Wi(){return this.PY?Math.max(this.PY.max.x,this.nu.max.x):this.nu.max.x}Hi(){return this.PY?Math.min(this.PY.min.x,this.nu.min.x):this.nu.min.x}Zi(){return this.PY?Math.max(this.PY.max.y,this.nu.max.y):this.nu.max.y}Xi(){return this.PY?Math.min(this.PY.min.y,this.nu.min.y):this.nu.min.y}ye(){return this.PY?Math.max(this.PY.max.z,this.nu.max.z):this.nu.max.z}ve(){return this.PY?Math.min(this.PY.min.z,this.nu.min.z):this.nu.min.z}uu(){const t=this.uv,e=t.getSize();return"number"==typeof e?sr(t)?e/2:or(t)?5:0:0}cu(){return this.uu()}fp(){return this.uu()}Mu(){return this.fc}wu(){return this.pu}Cu(){return this.Ac}Tu(){return this.LY}Vi(){return this.mu=!0,this.fc.length=0,this.Ac=0,this.pu=[],this.LY=0,this.nu=hi,this.PY=void 0,this.nU.C(void 0),this}dispose(){return super.dispose(),this.DN._N(),this.DV=void 0,this}_c(){return this.dispose(),this}}const Py=(t,e,i)=>{const s=e.getSize();return By(t,"number"==typeof s?i||s>=50?20:s>=10?10:s>=3?5:3:32)};class zy extends by{constructor(t,e,i,s){super(t,e,i),this.uY="disabled",this.Ze=co.fillStyle,this.Kv=co.lineStyle,this.Y$=m("bilinear"),this.ij=new Qs,this.sj=new Js.Simple,this.ej=[],this.rj=void 0,this.DV={},this.hj=!1,this.Fz=Mr({fillStyleSolid:()=>gs(this.Ze)&&this.Ze,fillStylePaletted:()=>vs(this.Ze)&&this.Ze,wireframeStyleLine:()=>cr(this.Kv)&&this.Kv,wireframeStyleFill:()=>{const t=this.Kv&&this.Kv.getFillStyle();return gs(t)&&t}}),this.X$=m(void 0),this.jt={x:0,z:0},this.W$={x:1,z:1},this.H$=!1,this.sp.C(Xs);const r="columns"===s.dataOrder?s.columns:s.rows,n="columns"===s.dataOrder?s.rows:s.columns;this.Da={...s,primaryDimensionVectorsCount:r,secondaryDimensionVectorsCount:n},this.nj=new Array(this.Da.primaryDimensionVectorsCount).fill(void 0),this.gb=new oy(this.Sz,t.Sz.FU,t.pi.ai,jt,[],this.Da).qv(Bt),this.gb.q$=Zc;const o=this.gb.tU.gridTiles.map(t=>{const e=t.sizeHeatmapDataVectors,i=t.sizeUniqueHeatmapDataVectors,s=t.iFirstVector,r=t.iFirstUniqueVector,n=new Float32Array(t.sizeHeatmapDataVectors.primary*t.sizeHeatmapDataVectors.secondary),o={primary:t.sizeHeatmapDataVectors.primary-1,secondary:t.sizeHeatmapDataVectors.secondary-1};return{iFirstVector:t.iFirstVector,iFirstUniqueVector:t.iFirstUniqueVector,sizeHeatmapDataVectors:t.sizeHeatmapDataVectors,sizeUniqueHeatmapDataVectors:t.sizeUniqueHeatmapDataVectors,iFirstGeometryVector:s,iFirstGeometryUniqueVector:r,sizeGeometryDataVectors:e,sizeUniqueGeometryDataVectors:i,heightmapData:n,normalmapSize:o}}),a=this.gb.tU.gridTileSizes.map(t=>{const e=o.filter(e=>e.sizeHeatmapDataVectors.primary===t.sizeHeatmapData.primary&&e.sizeHeatmapDataVectors.secondary===t.sizeHeatmapData.secondary),i=e[0].sizeGeometryDataVectors;return{...t,tiles:e,sizeGeometryData:i}}),h=o.reduce((t,e)=>{const i=e.sizeHeatmapDataVectors.primary,s=e.sizeHeatmapDataVectors.secondary,r=i*s;return r>t.cells?{primary:i,secondary:s,cells:r}:t},{primary:0,secondary:0,cells:0});this.oj={gridTiles:o,gridTileSizes:a,largestGridTileSize:h},this.sy(this.jt,this.W$),this.Z$=new ry,this.sU=[]}hy(t){return this.X$.C(t),this}ny(){return this.X$.T()}kc(t,e,i,s,r){const n=t-e,o=n%(this.Da.secondaryDimensionVectorsCount-1),a=Math.floor(n/(this.Da.secondaryDimensionVectorsCount-1)),h="columns"===this.Da.dataOrder?a:o,l="rows"===this.Da.dataOrder?a:o,c=[{x:this.jt.x+h*this.W$.x,z:this.jt.z+l*this.W$.z,y:this.aj(a,o),intensity:this.lj(a,o),column:"columns"===this.Da.dataOrder?a:o,row:"columns"===this.Da.dataOrder?o:a},{x:this.jt.x+(h+("columns"===this.Da.dataOrder?1:0))*this.W$.x,z:this.jt.z+(l+("rows"===this.Da.dataOrder?1:0))*this.W$.z,y:this.aj(a+1,o),intensity:this.lj(a+1,o),column:"columns"===this.Da.dataOrder?a+1:o,row:"columns"===this.Da.dataOrder?o:a+1},{x:this.jt.x+(h+1)*this.W$.x,z:this.jt.z+(l+1)*this.W$.z,y:this.aj(a+1,o+1),intensity:this.lj(a+1,o+1),column:"columns"===this.Da.dataOrder?a+1:o+1,row:"columns"===this.Da.dataOrder?o+1:a+1},{x:this.jt.x+(h+("columns"===this.Da.dataOrder?0:1))*this.W$.x,z:this.jt.z+(l+("rows"===this.Da.dataOrder?0:1))*this.W$.z,y:this.aj(a,o+1),intensity:this.lj(a,o+1),column:"columns"===this.Da.dataOrder?a:o+1,row:"columns"===this.Da.dataOrder?o+1:a}],u=c.map(t=>this.cY.Xp(t)).map(t=>void 0===t?ni:xi(t,{x:s,y:r})).map((t,e)=>({i:e,dist:t}));return u.sort((t,e)=>t.dist-e.dist),{info:{dataPoint:{...c[u[0].i]}}}}aj(t,e){for(let i=0;i<this.oj.gridTiles.length;i+=1){const s=this.oj.gridTiles[i];if(t>=s.iFirstVector.primary&&t<=s.iFirstVector.primary+s.sizeHeatmapDataVectors.primary-1&&e>=s.iFirstVector.secondary&&e<=s.iFirstVector.secondary+s.sizeHeatmapDataVectors.secondary-1){const i=t-s.iFirstVector.primary,r=e-s.iFirstVector.secondary,n=i*s.sizeHeatmapDataVectors.secondary+r;return s.heightmapData[n]}}return 0}lj(t,e){if(this.gb.Q$)for(let i=0;i<this.gb.tU.gridTiles.length;i+=1){const s=this.gb.tU.gridTiles[i];if(t>=s.iFirstVector.primary&&t<=s.iFirstVector.primary+s.sizeHeatmapDataVectors.primary-1&&e>=s.iFirstVector.secondary&&e<=s.iFirstVector.secondary+s.sizeHeatmapDataVectors.secondary-1){const i=t-s.iFirstVector.primary,r=e-s.iFirstVector.secondary,n=i*s.sizeHeatmapDataVectors.secondary+r;return s.intensityData?s.intensityData[n]:void 0}}}uj(t){this.cj=t,this.rj=void 0}sy(t,e){this.H$=this.H$||this.jt!=t||this.W$!=e,this.jt=t,this.W$=e;const i=this.Da,s={min:{x:Math.min(this.jt.x,this.jt.x+(i.columns-1)*this.W$.x),z:Math.min(this.jt.z,this.jt.z+(i.rows-1)*this.W$.z)},max:{x:Math.max(this.jt.x,this.jt.x+(i.columns-1)*this.W$.x),z:Math.max(this.jt.z,this.jt.z+(i.rows-1)*this.W$.z)}},r=new Map;return this.oj.gridTiles.forEach(t=>{const e="columns"===this.Da.dataOrder?{x:this.W$.x*(t.sizeHeatmapDataVectors.primary-1),z:this.W$.z*(t.sizeHeatmapDataVectors.secondary-1)}:{x:this.W$.x*(t.sizeHeatmapDataVectors.secondary-1),z:this.W$.z*(t.sizeHeatmapDataVectors.primary-1)},i="columns"===this.Da.dataOrder?{x:this.jt.x+this.W$.x*t.iFirstVector.primary,z:this.jt.z+this.W$.z*t.iFirstVector.secondary}:{x:this.jt.x+this.W$.x*t.iFirstVector.secondary,z:this.jt.z+this.W$.z*t.iFirstVector.primary};r.set(t,{sizeAxis:e,startLocationAxis:i})}),this.pU={dj:s,tilesInfo:r},this}ey(){return{start:this.jt,step:this.W$,end:{x:this.jt.x+this.W$.x*this.Da.columns,z:this.jt.z+this.W$.z*this.Da.rows}}}dU(t,e){if(!this.oj)return this;if(!t)return this.fj(),this;if(!e)return this.sU.forEach(t=>{t.bY=this.bY,t.Nh(!0)}),this;if(!this.oj.gridTiles)return this;if(!this.pU)return this;const i=this.pU.dj.min.x,s=this.pU.dj.min.z,r=this.pU.dj.max.x,n=this.pU.dj.max.z;if(null==i||null==s||null==r||null==n)return this;const o=this.Da.columns,a=this.Da.rows,h=(r-i)/(o-1),l=(n-s)/(a-1),c=new Array(o).fill(0,0,o).map((t,e)=>i+e*h),u=new Array(a).fill(0,0,a).map((t,e)=>s+e*l);let d=[];const f=[];t.levels.forEach(t=>{d.push(t.value),f.push({level:t.value,width:t.strokeStyle.getThickness(),fill:t.strokeStyle.getFillStyle()})});const g=(t,e)=>"rows"==this.Da.dataOrder?e:t,p=(t,e)=>"rows"==this.Da.dataOrder?t:e;let m,y;const x=r-i,v=n-s;switch(t.valueSource){case"y":m=(t,e)=>this.aj(g(t,e),p(t,e)),y=(t,e,i,s)=>{e.push({x:t.ax[i],y:s,z:t.ay[i]})};break;case"intensity":m=(t,e)=>this.lj(g(t,e),p(t,e)),y=(t,e,r,n)=>{const c=t.ax[r],u=t.ay[r],d=Math.floor((c-i)/x*(o-1)),f=Math.floor((u-s)/v*(a-1)),m=i+d*h,y=s+f*l,A=Gs({x:c,y:u},{point:{x:m,y},value:this.aj(g(d,f),p(d,f))},{point:{x:m,y:y+l},value:this.aj(g(d,f+1),p(d,f+1))},{point:{x:m+h,y},value:this.aj(g(d+1,f),p(d+1,f))},{point:{x:m+h,y:y+l},value:this.aj(g(d+1,f+1),p(d+1,f+1))});e.push({x:c,y:A,z:u})}}return this.Z$.$$(m,c,u,d),this.fj(),this.Z$.U$.forEach(e=>{var i,s;const r=[];e.ax.forEach((t,i)=>{y(e,r,i,e.level)}),e.ax[0]==e.ax[e.ax.length-1]&&e.ay[0]==e.ay[e.ay.length-1]&&y(e,r,e.ax.length-1,e.level);const n=null===(i=t.levels.find(t=>t.value==e.level))||void 0===i?void 0:i.strokeStyle;if(0<this.sU.length){const t=this.sU.find(t=>t.do()===n);if(t)return t.bu({x:Number.NaN,y:Number.NaN,z:Number.NaN}),void t.bu(r)}const o=n.getThickness(),a=new Fy(this.cY,this.yi,this.mi,void 0);1<o?a.Vp(new ir({shape:"sphere",size:o,fillStyle:null===(s=f.find(t=>t.level==e.level))||void 0===s?void 0:s.fill})):a.Vp(this.ij),a.cr(n),a.bu(r),a.lp(this.sj),this.sU.push(a)}),this}Nh(t){const e=this.ej,i=yo(this.ul,this.Ze),s=this.Fz.fillStyleSolid(i),r=this.Fz.fillStylePaletted(i),n=this.Kv,o=this.Kv!==this.mU,a=this.Fz.wireframeStyleLine(o),h=this.Fz.wireframeStyleFill(o),l=!1!==h,c=this.Y$.u,u=this.Y$.T(),d=this.sp.T(),f=this.eR(),g=this.ui.T();this.gb.Nh();const p=this.gb.xU;if(!p)return this;this.Aj=this.Aj||this.gj(p);const m=this.Aj;this.pj(m);const y=Wc(e,m,void 0,t=>t.sizeGeometryDataVectors);if(y.size>0&&(qc(this.ZB,y,t=>t.heightmapData,t=>t.heightmapDataTexture),this.hj=!0),"phong"===d.type&&(y.size>0||f)){const t=this.ZB.gl,e=this.ZB.SE(vp["2D"],vp.DrawToNormalTexture({flipXZ:"rows"===this.Da.dataOrder,vertexIdSource:this.ZB.NO(),normalTextureType:this.ZB.gl2?"uint":"ubyte",heightmapTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN}));m.gridTileSizes.forEach(i=>{i.tiles.forEach(s=>{var r;const n=s.normalmapTexture,o=null===(r=this.pU)||void 0===r?void 0:r.tilesInfo.get(s.tileData);if(!n||!o)return;const a={x:s.normalmapSize.secondary,y:s.normalmapSize.primary},h=a.x*a.y;this.ZB.MO.wc(()=>{this.ZB.SR(e,(r,n,a,l)=>(this.ZB.Kc(e).GO(a,h).MR(r("uTileDimensionsXZ"),["columns"===this.Da.dataOrder?i.sizeHeatmapData.primary:i.sizeHeatmapData.secondary,"columns"===this.Da.dataOrder?i.sizeHeatmapData.secondary:i.sizeHeatmapData.primary]).jR(r("uTileDimensions"),[i.sizeHeatmapData.primary,i.sizeHeatmapData.secondary]).MR(r("uTileStartLocationAxisXZ"),[o.startLocationAxis.x,o.startLocationAxis.z]).MR(r("uTileSizeAxisXZ"),[o.sizeAxis.x,o.sizeAxis.z]).wR(r("uHeightmapTexture"),s.heightmapDataTexture,1).Nk(t.POINTS,h),!0))},n,a,void 0,this.pi.Ma(),0)})})}const x=this.DV;if(i||o||c){const t=a&&h?{wireframeSolid:a,wireframeFillSolid:h}:void 0;s?x.surface={shader:this.ZB.SE(vp["3D"],vp.SurfaceGrid({axisWorldTranslation:Sr(this.ai),fillColor:"uniform",interpolation:"bilinear"===u&&"bilinear",flipXZ:"rows"===this.Da.dataOrder,shadingStyle:d.type,wireframe:l,normalTextureType:this.ZB.gl2?"uint":"ubyte",intensityTextureType:this.ZB.pE?"float":"ubyte",heightmapTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN})),fill:{fillMode:"solid",fillStyleSolid:s},wireframe:t}:r&&"value"===r.getLookUpProperty()?x.surface={shader:this.ZB.SE(vp["3D"],vp.SurfaceGrid({axisWorldTranslation:Sr(this.ai),fillColor:["lookup","value",r.lut],interpolation:"bilinear"===u&&"bilinear",flipXZ:"rows"===this.Da.dataOrder,shadingStyle:d.type,wireframe:l,normalTextureType:this.ZB.gl2?"uint":"ubyte",intensityTextureType:this.ZB.pE?"float":"ubyte",heightmapTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN})),fill:{fillMode:"intensity",fillStylePaletted:r},wireframe:t}:r?x.surface={shader:this.ZB.SE(vp["3D"],vp.SurfaceGrid({axisWorldTranslation:Sr(this.ai),fillColor:["lookup",r.getLookUpProperty(),r.lut],interpolation:"bilinear"===u&&"bilinear",flipXZ:"rows"===this.Da.dataOrder,shadingStyle:d.type,wireframe:l,normalTextureType:this.ZB.gl2?"uint":"ubyte",intensityTextureType:this.ZB.pE?"float":"ubyte",heightmapTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN})),fill:{fillMode:"xyz",fillStylePaletted:r},wireframe:t}:l&&(x.surface={shader:this.ZB.SE(vp["3D"],vp.SurfaceGrid({axisWorldTranslation:Sr(this.ai),fillColor:void 0,interpolation:"bilinear"===u&&"bilinear",flipXZ:"rows"===this.Da.dataOrder,shadingStyle:d.type,wireframe:l,normalTextureType:this.ZB.gl2?"uint":"ubyte",intensityTextureType:this.ZB.pE?"float":"ubyte",heightmapTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN})),fill:void 0,wireframe:t})}x.mousePicking=g?this.DV.mousePicking||{shader:this.ZB.SE(vp["3D"],vp.MousePicking(),vp.SurfaceGrid({axisWorldTranslation:Sr(this.ai),fillColor:void 0,interpolation:"bilinear"===u&&"bilinear",flipXZ:"rows"===this.Da.dataOrder,shadingStyle:"simple",wireframe:!1,normalTextureType:this.ZB.gl2?"uint":"ubyte",intensityTextureType:this.ZB.pE?"float":"ubyte",heightmapTextureType:this.ZB.pE?"float":"ubyte",littleEndian:this.ZB.IS_MACHINE_LITTLE_ENDIAN}))}:void 0,this.DV=x,this.ej.length=0,this.ul=this.Ze,this.mU=n,this.sp.u=!1;const v=this.X$.T(),A=v!==this.bU;return this.dU(v,A||y.size>0||this.H$),this.H$=!1,this.bU=this.X$.T(),this}gj(t){const e=this.oj.gridTiles.map(e=>{const i=Xc(this.ZB,e.sizeHeatmapDataVectors.secondary,e.sizeHeatmapDataVectors.primary),s=t.gridTiles.find(t=>t.iFirstUniqueVector.primary===e.iFirstUniqueVector.primary&&t.iFirstUniqueVector.secondary===e.iFirstUniqueVector.secondary);if(!s)throw new Error("Internal LC JS error prepare surface data 2D render data not found");return{...e,intensityDataTexture:s.intensityDataTexture,heightmapDataTexture:i,normalmap:void 0,tileData:e}}),i=this.oj.gridTileSizes.map(t=>{const i=e.filter(e=>e.sizeHeatmapDataVectors.primary===t.sizeHeatmapData.primary&&e.sizeHeatmapDataVectors.secondary===t.sizeHeatmapData.secondary);return{...t,tiles:i}}),s=this.ZB.mR([0,0,1,0,0,1,0,1,1,0,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,0]),r=this.ZB.gl.TRIANGLES;return{gridTiles:e,gridTileSizes:i,rectangleLocationsBuffer:s,rectangleLocationsDrawLength:6,rectangleLocationsDrawMode:r}}pj(t){var e;if("phong"===this.sp.T().type)for(let i=0;i<t.gridTiles.length;i+=1){const s=t.gridTiles[i];if(s.normalmapTexture)return;let r;const n=null===(e=this.ZB.gl2)||void 0===e?void 0:e.ctx;if(n)r=this.ZB.ub(null,n.RGBA_INTEGER,!1,!0,{x:s.normalmapSize.secondary,y:s.normalmapSize.primary},!1,n.UNSIGNED_INT,n.RGBA32UI);else{const t=this.ZB.gl;r=this.ZB.ub(null,t.RGBA,!1,!0,{x:s.normalmapSize.secondary,y:s.normalmapSize.primary},!1,t.UNSIGNED_BYTE)}s.normalmapTexture=r}else t.gridTiles.forEach(t=>{t.normalmapTexture&&(this.ZB.KB(t.normalmapTexture),t.normalmapTexture=void 0)})}wc(t,e){var i,s,r,n;const o=this.ZB.gl,a=this.Aj;if(!a)return{};const h=this.sp.T(),l=this.DV,c=1===t?null===(i=l.mousePicking)||void 0===i?void 0:i.shader:null===(s=l.surface)||void 0===s?void 0:s.shader;if(!c)return{};const u=1!==t?null===(r=l.surface)||void 0===r?void 0:r.wireframe:void 0,d=1!==t?null===(n=l.surface)||void 0===n?void 0:n.fill:void 0;return this.ZB.SR(c,(i,s,r,n)=>{let l=!1;if(this.ZB.Kc(c).UO(r,this.oj.largestGridTileSize.cells).HR(i("uScale"),this.cY.bD.kR()).HR(i("uDisp"),this.cY.bD.CR()).XR(i("uViewProjectionMatrix"),this.bY)._R(i("uIsHighlighted"),1===t||2===t?0:this.gi).UI(i("uHighlightColorOffset"),1===t||2===t?B:this.Si)._R(i("uRenderEffectMask"),2===t?1:0),1!==t&&("phong"===h.type&&this.ZB.HR(i("uCameraLoc"),this.MY).HR(i("uLightLoc"),this.wY)._R(i("uAmbientReflection"),h.ambientReflection)._R(i("uSpecularReflection"),h.specularReflection)._R(i("uDiffuseReflection"),h.diffuseReflection)._R(i("uShininess"),h.shininess).UI(i("uLightColor"),h.specularColor).UI(i("uAmbientColor"),h.ambientColor),u)){const{wireframeFillSolid:t,wireframeSolid:e}=u,s=e.getThickness()<0?1:e.getThickness();this.ZB.UI(i("uWireframeColor"),t.getColor())._R(i("uWireframeThickness"),s)}return 1===t||"solid"===(null==d?void 0:d.fillMode)&&this.ZB.UI(i("uColorDiffuse"),d.fillStyleSolid.getColor()),a.gridTileSizes.forEach(n=>{this.ZB.MR(i("uTileDimensionsXZ"),["columns"===this.Da.dataOrder?n.sizeHeatmapData.primary:n.sizeHeatmapData.secondary,"columns"===this.Da.dataOrder?n.sizeHeatmapData.secondary:n.sizeHeatmapData.primary]).jR(i("uTileDimensions"),[n.sizeHeatmapData.primary,n.sizeHeatmapData.secondary]),n.tiles.forEach(h=>{var c;const f=null===(c=this.pU)||void 0===c?void 0:c.tilesInfo.get(h.tileData);if(!f)return;let p=0,m=(h.sizeHeatmapDataVectors.primary-1)*(h.sizeHeatmapDataVectors.secondary-1);if(this.cj){const t=this.cj.fill.iFirstPrimary,e=this.cj.fill.iFirstPrimary+this.cj.fill.amountPrimary-1,i=h.iFirstVector.primary,s=h.iFirstVector.primary+h.sizeHeatmapDataVectors.primary-1;if(i>e||s<t)return;const r=((t,e,i,s)=>g(Math.max(t,i),Math.min(e,s)))(t,e,i,s);p=(r.min-h.iFirstVector.primary)*(n.sizeGeometryData.secondary-1),m=(r.max-r.min)*(n.sizeGeometryData.secondary-1)}if(!(p<0||m<=0)){if("intensity"===(null==d?void 0:d.fillMode)){const{fillStylePaletted:t}=d,e=this.gb.nU;this.ZB.JO(r,t.lut,e).wR(i("uTileIntensityValues"),h.intensityDataTexture,2).LR(i("uTileBoundsAxisXZ"),[f.startLocationAxis.x,f.startLocationAxis.z,f.sizeAxis.x,f.sizeAxis.z])}if("xyz"===(null==d?void 0:d.fillMode)){const{fillStylePaletted:t}=d,e="x"===t.getLookUpProperty()?{min:this.Hi(),max:this.Wi()}:"y"===t.getLookUpProperty()?{min:this.Xi(),max:this.Zi()}:"z"===t.getLookUpProperty()?{min:this.ve(),max:this.ye()}:void 0;if(!e&&t.lut.percentageValues)return;this.ZB.JO(r,t.lut,e)}1!==t&&"phong"===this.sp.T().type&&h.normalmapTexture&&this.ZB.wR(i("uNormalmapTexture"),h.normalmapTexture,3),1===t&&this.ZB.ZR(i("uFirstId"),e+p),this.ZB.bR(a.rectangleLocationsBuffer,0,{location:s("aGeoCellOffset"),size:2},{location:u?s("aTriangleBary"):void 0,size:3}).ZR(i("uBaseInstance"),p).MR(i("uTileStartLocationAxisXZ"),[f.startLocationAxis.x,f.startLocationAxis.z]).MR(i("uTileSizeAxisXZ"),[f.sizeAxis.x,f.sizeAxis.z]).wR(i("uHeightmapTexture"),h.heightmapDataTexture,0).dO(a.rectangleLocationsDrawMode,0,a.rectangleLocationsDrawLength,m),l=!0,o.bindBuffer(o.ARRAY_BUFFER,null)}})}),l}),1!==t&&this.sU.forEach(e=>{e.bY||(e.bY=this.cY.bY),e.MY||(e.MY=[this.cY.MY.x,this.cY.MY.y,this.cY.MY.z]),e.wY||(e.wY=[this.cY.MY.x,this.cY.MY.y,this.cY.MY.z]),e.Nh(!0),e.wc(t,0)}),{idCount:this.Da.columns*this.Da.rows}}_i(){return this.gb._i()}fj(){return this.sU.forEach(t=>t.dispose()),this.sU.length=0,this}dispose(){return super.dispose(),this.gb.dispose(),this.Aj&&(this.Aj.gridTileSizes.forEach(t=>{}),this.Aj.gridTiles.forEach(t=>{this.ZB.KB(t.heightmapDataTexture),t.normalmapTexture&&this.ZB.KB(t.normalmapTexture)}),this.ZB.BR(this.Aj.rectangleLocationsBuffer),this.Aj=void 0),this.fj(),this.DV={},this}_c(){return this.dispose(),this.gb._c(),this}Ay(t){return this.gb.Ay(t),this}gy(t){this.ej.push(t),$c(this.oj.gridTiles,t,t=>t.heightmapData,(t,e)=>{t.heightmapData=e});for(let e=t.startPrimary;e<t.startPrimary+t.lengthPrimary;e+=1)this.nj[e]=void 0;return this.rj=void 0,this}ly(t){return this.Y$.C(t),this}uy(){return this.Y$.T()}qe(t){return this.Ze=mo(this.Ze,t),this.gb.qe(this.Ze),this}Mh(){return this.Ze}qv(t){return this.Kv="function"==typeof t?t(this.Kv):t,this}oy(){return this.Kv}Wi(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.dj.max.x)||0}Hi(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.dj.min.x)||0}Zi(){const t=this.rj||this.vj();return this.rj=t,t.max}Xi(){const t=this.rj||this.vj();return this.rj=t,t.min}ye(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.dj.max.z)||0}ve(){var t;return(null===(t=this.pU)||void 0===t?void 0:t.dj.min.z)||0}uu(){return 0}cu(){return 0}fp(){return 0}vj(){if(this.rj)return this.rj;const t=this.cj?this.cj.fill.iFirstPrimary:0,e=this.cj?t+this.cj.fill.amountPrimary-1:this.Da.primaryDimensionVectorsCount-1;let i=ni,s=oi;return this.oj.gridTiles.forEach(r=>{for(let n=Math.max(t,r.iFirstUniqueVector.primary);n<=Math.min(e,r.iFirstUniqueVector.primary+r.sizeUniqueHeatmapDataVectors.primary-1);n+=1){const t=(n-r.iFirstUniqueVector.primary)*r.sizeHeatmapDataVectors.secondary;let e=this.nj[n];if(e)i=i<e.min?i:e.min,s=s>e.max?s:e.max;else{e={min:ni,max:oi},this.nj[n]=e;for(let n=0;n<r.sizeHeatmapDataVectors.secondary;n+=1){const o=r.heightmapData[t+n];i=i<o?i:o,s=s>o?s:o,e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}}}}),this.rj={min:i,max:s},this.rj}}class _y extends by{constructor(t,e,i,s){super(t,e,i),this.uY="disabled",this.kU=0,this.TU={},this.yj=new Map,this.jt={x:0,z:0},this.W$={x:1,z:1},this.Da={...s,scrollDimensionSize:"columns"===s.scrollDimension?s.columns:s.rows,staticDimensionSize:"columns"===s.scrollDimension?s.rows:s.columns},this.dj={min:{x:this.jt.x,z:this.jt.z},max:{x:"rows"===s.scrollDimension?this.jt.x+(s.columns-1)*this.W$.x:this.jt.x,z:"columns"===s.scrollDimension?this.jt.z+(s.rows-1)*this.W$.z:this.jt.z}};const r=()=>({shape:new zy(this.cY,jt,this.mi,{columns:s.columns+("columns"===s.scrollDimension?1:0),rows:s.rows+("rows"===s.scrollDimension?1:0),dataOrder:s.scrollDimension,heatmapDataType:"intensity"}).setVisible(!1),hasData:!1});this._b=[r(),r()]}Nh(t){this._b.forEach(e=>{e.shape.Nh(t)});const e=this._b.reduce((t,e)=>{var i,s;return t.min=Math.min(t.min,qt(null===(i=e.shape.gb.nU)||void 0===i?void 0:i.min,ni)),t.max=Math.max(t.max,qt(null===(s=e.shape.gb.nU)||void 0===s?void 0:s.max,oi)),t},{min:ni,max:oi}),i=this._b.reduce((t,e)=>{var i,s;return t.min=Math.min(t.min,qt(null===(i=e.shape.rj)||void 0===i?void 0:i.min,ni)),t.max=Math.max(t.max,qt(null===(s=e.shape.rj)||void 0===s?void 0:s.max,oi)),t},{min:ni,max:oi});return this._b.forEach(t=>{t.shape.gb.nU=e,t.shape.rj=i}),this}wc(t,e){let i=0,s=e;return this._b.forEach(e=>{if(!e.hasData)return;e.shape.bY=this.bY,e.shape.MY=this.MY,e.shape.wY=this.wY;const{idCount:r}=e.shape.wc(t,s);void 0!==r&&(1===t&&this.yj.set(e,{idFirst:s,idCount:r}),i+=r,s+=r)}),{idCount:i}}kc(t,e,i,s,r){const n=Array.from(this.yj).find(e=>mi(t,e[1].idFirst,e[1].idFirst+e[1].idCount-1));return n?n[0].shape.kc(t,n[1].idFirst,n[1].idCount,s,r):{}}sy(t,e){return this.jt=t,this.W$=e,this._b.forEach(t=>{t.shape.sy("columns"===this.Da.scrollDimension?{x:t.shape.ey().start.x,z:this.jt.z}:{x:this.jt.x,z:t.shape.ey().start.z},this.W$)}),"columns"===this.Da.scrollDimension?(this.dj.min.z=t.z,this.dj.max.z=this.jt.z+(this.Da.rows-1)*this.W$.z):(this.dj.min.x=t.x,this.dj.max.x=this.jt.x+(this.Da.columns-1)*this.W$.x),this}ey(){return{start:this.jt,step:this.W$}}Vi(){return this.kU=0,this.TU={},this.dj={min:{x:this.jt.x,z:this.jt.z},max:{x:"rows"===this.Da.scrollDimension?this.jt.x+(this.Da.columns-1)*this.W$.x:this.jt.x,z:"columns"===this.Da.scrollDimension?this.jt.z+(this.Da.rows-1)*this.W$.z:this.jt.z}},this._b.forEach(t=>{t.shape.setVisible(!1),t.shape.hj=!1,t.hasData=!1}),this}xy(t){var e;const i=this._b[0],s=this._b[1],r=t.heightMapValues?t.heightMapValues.length:null===(e=t.intensityValues)||void 0===e?void 0:e.length;let n=0;if(!r)return this;do{const e=Math.floor(this.kU/this.Da.scrollDimensionSize)%this._b.length,o=this._b[e],a=this.kU%this.Da.scrollDimensionSize,h=this.Da.scrollDimensionSize-a,l=0===a,c=Math.min(h,r),u=a+c,d=a,f=d+1,g=n,p=n+c,m=this.kU>=this.Da.scrollDimensionSize&&u<=this.Da.scrollDimensionSize-1,y=l;l&&(o.shape.sy("columns"===this.Da.scrollDimension?{x:this.jt.x+(this.kU-1)*this.W$.x,z:this.jt.z}:{x:this.jt.x,z:this.jt.z+(this.kU-1)*this.W$.z},this.W$),o.shape.setVisible(!0));const x=m?0:1,v=u+(m?1:0);o.shape.uj({fill:{iFirstPrimary:x,amountPrimary:v},wireframe:{iFirstPrimary:x,amountPrimary:v,connectNext:!1}});const A=o===i?s:i,S=u+1,b=1+this.Da.scrollDimensionSize-S;A.shape.uj({fill:{iFirstPrimary:S,amountPrimary:b},wireframe:{iFirstPrimary:S,amountPrimary:b-1,connectNext:!0}});const M={};if(t.heightMapValues){const e=t.heightMapValues.slice(g,p);let i=!1;y&&this.TU.yValues&&(i=!0,e.splice(0,0,this.TU.yValues));const s={startPrimary:i?d:f,startSecondary:0,lengthPrimary:e.length,lengthSecondary:this.Da.staticDimensionSize,values:e,type:"y"};o.shape.gy(s),o.hasData=!0,M.yValues=Array.from(e[c-1])}if(t.intensityValues){const e=t.intensityValues.slice(g,p);let i=!1;y&&this.TU.intensityValues&&(i=!0,e.splice(0,0,this.TU.intensityValues));const s={startPrimary:i?d:f,startSecondary:0,lengthPrimary:e.length,lengthSecondary:this.Da.staticDimensionSize,values:e,type:"intensity"};o.shape.Ay(s),o.hasData=!0,M.intensityValues=Array.from(e[c-1])}this.kU+=c,n+=c,this.TU=M}while(n<r);return"columns"===this.Da.scrollDimension?(this.dj.min.x=this.jt.x+Math.max(this.kU-this.Da.scrollDimensionSize,0)*this.W$.x,this.dj.max.x=this.jt.x+(this.kU-1)*this.W$.x):(this.dj.min.z=this.jt.z+Math.max(this.kU-this.Da.scrollDimensionSize,0)*this.W$.z,this.dj.max.z=this.jt.z+(this.kU-1)*this.W$.z),this}Ay(t){var e;const{iSample:i,yValues:s,intensityValues:r}=t,n=s||r;if(!n)return this;const o=i,a=i+n.length-1,h=n[0].length;this._b.forEach((t,e)=>{const i=Math.floor(this.kU/this.Da.scrollDimensionSize)%this._b.length,n=this.kU%this.Da.scrollDimensionSize;let l,c;if(e===i?0===n?(c=-1,l=-1):(c=this.kU-1,l=c-n+1):(c=this.kU-n-1,l=c-this.Da.scrollDimensionSize+1),a<l||o>c)return;const u=Math.max(o,l),d=Math.min(a,c),f=d-u+1,g=r&&r.slice(u-o,d-o+1),p=s&&s.slice(u-o,d-o+1),m=g&&{type:"intensity",startSecondary:0,lengthSecondary:h,startPrimary:u+1,lengthPrimary:f,values:g},y=p&&{type:"y",startSecondary:0,lengthSecondary:h,startPrimary:u+1,lengthPrimary:f,values:p};m&&t.shape.Ay(m),y&&t.shape.gy(y),d===this.kU-1&&(this.TU={yValues:p?Array.from(p[p.length-1]):void 0,intensityValues:g?Array.from(g[g.length-1]):void 0})});const l=this.kU-1;if(a>l){const t=a-l,i=s&&s.slice(-t).map(t=>Array.isArray(t)?t:Array.from(t)),n=r&&r.slice(-t).map(t=>Array.isArray(t)?t:Array.from(t)),o=i?i.length:null!==(e=null==n?void 0:n.length)&&void 0!==e?e:0;if(o<t){const e=this.TU||new Array(h).fill(0);for(let s=o;s<t;s+=1)i&&e.yValues&&i.unshift(e.yValues),n&&e.intensityValues&&n.unshift(e.intensityValues)}this.xy({heightMapValues:i,intensityValues:n,lengthPrimary:o,lengthSecondary:h})}return this}Sy(){return this.kU}ly(t){return this._b.forEach(e=>e.shape.ly(t)),this}uy(){return this._b[0].shape.uy()}qe(t){return this._b.forEach(e=>e.shape.qe(t)),this}Mh(){return this._b[0].shape.Mh()}qv(t){return this._b.forEach(e=>e.shape.qv(t)),this}oy(){return this._b[0].shape.oy()}_c(){return this.dispose(),this._b.forEach(t=>t.shape._c()),this}dispose(){return super.dispose(),this._b.forEach(t=>t.shape.dispose()),this}setVisible(t){return super.setVisible(t),this._b.forEach(e=>e.shape.setVisible(t&&e.hasData)),this}lp(t){return super.lp(t),this._b.forEach(e=>e.shape.lp(t)),this}Wi(){return this.dj.max.x}Hi(){return this.dj.min.x}Zi(){return Math.max(this._b[0].shape.Zi(),this._b[1].shape.Zi())}Xi(){return Math.min(this._b[0].shape.Xi(),this._b[1].shape.Xi())}ye(){return this.dj.max.z}ve(){return this.dj.min.z}uu(){return 0}cu(){return 0}fp(){return 0}Ii(t){return super.Ii(t),this._b.forEach(e=>e.shape.Ii(t)),this}}class Vy extends uy{constructor(t,e,i,s){super(t,e,i),this.MY=d(0,0,1),this.mj=d(0,0,-1),this.xj=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],this.sp=new $s,this.ai=s}Cm(){const{cellIndex:t,cellSpan:e,cellsAmount:i}=this.ai,s=e.x/i.x,r=e.y/i.y,n=t.x/i.x,o=t.y/i.y,a=this.pi.kt();return{x:n*a.x,y:o*a.y,width:s*a.x,height:r*a.y}}setCameraLocation(t){return this.MY=t,this}getCameraLocation(){return this.MY}setCameraDirection(t){return this.mj=ri.normalize(t),this}getCameraDirection(){return this.mj}setLightLocation(t){return this.wY=t,this}getLightLocation(){return this.wY}Sj(){return d(this.xj[0],this.xj[1],this.xj[2])}bj(){return d(this.xj[4],this.xj[5],this.xj[6])}}class Ny extends Vy{constructor(t,e,i,s){super(t,e,i,s),this.bD=new um,this.Mj=!0,this.wj=()=>{this.Mj=!0},this._j="perspective",this.Sz=t,this.gl=t.Mz(),this.rY=this.Ei,this.pi.O("resize",this.wj),s.addEventListener("cellresize",this.wj)}vR(t){const e=t.Hi(),i=t.Xi(),s=t.ve(),r=t.Wi(),n=t.Zi(),o=t.ye();if(e===ni||r===oi||i===ni||n===oi||s===ni||o===oi)return ai;const a=t.uu(),h=t.cu(),l=t.fp(),c=Math.abs(t.Ws.Hp(a)*t.ai.x.tt()),u=Math.abs(t.Ws.Hp(h)*t.ai.y.tt()),d=Math.abs(t.Ws.Hp(l)*t.ai.z.tt()),f=e-c,g=r+c,p=i-u,m=n+u,y=s-d,x=o+d;let v;return[{x:f,y:p,z:y},{x:g,y:p,z:y},{x:f,y:m,z:y},{x:g,y:m,z:y},{x:f,y:p,z:x},{x:g,y:p,z:x},{x:f,y:m,z:x},{x:g,y:m,z:x}].map(e=>t.Ws.Xp(e)).forEach(t=>{if(!t)return;const e={min:t,max:t};v=v?Ei(v,{min:t,max:t}):e}),v||ai}Xp(t){if(this.kj(),this.Cj(),!this.bY)return;const e=this.bD.CR(),i=d(e[0],e[1],e[2]),s=this.bD.kR(),r=d(s[0],s[1],s[2]),n=ri.divideVec(ri.subtractVec(t,i),r),o=this.bY,a=Jp.multiply(o,[n.x,n.y,n.z,1]),h=l(a[0]/a[3],a[1]/a[3]),c=this.pi.kt();return{x:.5*(1+h.x)*c.x,y:.5*(1+h.y)*c.y}}ix(t){const e=this.bD.CR(),i=this.bD.kR(),s=ri.divideVec(ri.subtractVec(t,{x:e[0],y:e[1],z:e[2]}),{x:i[0],y:i[1],z:i[2]});return{...t,x:s.x,y:s.y,z:s.z}}sx(t){const e=this.bD.CR(),i=this.bD.kR(),s=ri.addVec(ri.multiplyVec(t,{x:i[0],y:i[1],z:i[2]}),{x:e[0],y:e[1],z:e[2]});return{...t,x:s.x,y:s.y,z:s.z}}Hp(t){return t/1e3}EY(){return.001}Nh(){const t=this.MY,e=this.wY,i=this.ai.x.u||this.ai.y.u||this.ai.z.u;if(!e)throw _e(0,()=>Ve());const{viewProjectionMatrix:s}=this.kj();this.Cj();const r=[t.x,t.y,t.z],n=[e.x,e.y,e.z];return this.Ei.forEach(t=>{t.bY=s,t.MY=r,t.wY=n,t.Nh(i)}),this}Km(t){this._j!==t&&(this._j=t,this.Mj=!0)}qm(){return this._j}kj(){if(!this.Mj&&this.bY)return{viewProjectionMatrix:this.bY};const t=this.Cm(),e=t.width/t.height;if("perspective"===this._j)this.Tj=Jp.projectionPerspective(45,e,.1,100);else{let t,i;const s=.5*ri.length(this.MY);e>1?(t=s,i=t/e):(i=s,t=i*e),this.Tj=Jp.projectionOrthographic(-t,t,-i,i,-400,100)}const i=this.MY;this.xj[12]=i.x,this.xj[13]=i.y,this.xj[14]=i.z;const s=this.mj,r=d(0,1,0),n=ri.multiply(s,-1),o=ri.normalize(ri.cross(r,n)),a=ri.normalize(ri.cross(n,o));this.xj[0]=o.x,this.xj[1]=o.y,this.xj[2]=o.z,this.xj[4]=a.x,this.xj[5]=a.y,this.xj[6]=a.z,this.xj[8]=n.x,this.xj[9]=n.y,this.xj[10]=n.z,this.Fj=Jp.inverse(this.xj);const{cellIndex:h,cellSpan:l,cellsAmount:c}=this.ai,u=l.x/c.x,f=l.y/c.y,g=(h.x+l.x/2)/c.x,p=(h.y+l.y/2)/c.y,m=Jp.multiply(Jp.translation(Us(-1,1,g),Us(-1,1,p),0),Jp.scaling(u,f,1));return this.bY=Jp.multiply(m,Jp.multiply(this.Tj,this.Fj)),this.Ij=Jp.inverse(this.bY),this.Mj=!1,{viewProjectionMatrix:this.bY}}Cj(){this.bD.Az(this.ai.x),this.bD.gz(this.ai.y),this.bD.pz(this.ai.z)}wc(t,e,i){var s;const r=this.gl.hR(),n=this.Cm(),o={x:n.x*r*e,y:n.y*r*e,width:n.width*r*e,height:n.height*r*e};this.gl.yR(o.x,o.y,o.width,o.height);let a=((null===(s=i[i.length-1])||void 0===s?void 0:s.idLast)||0)+1;const h=Array.from(this.rY.values());for(let e=0;e<h.length;e+=1){const s=h[e];if(s.getVisible())if(this.gl.cR(s.uY),this.gl.up(s.hp),1!==t)s.wc(t,0);else if(1===t&&s.getPointerEvents()){const{idCount:r}=s.wc(t,a);void 0!==r&&(i.push({entity:s,layer:this,entityIndex:e,idFirst:a,idCount:r,idLast:a+r-1}),a+=r)}}return this.gl.cR("disabled"),this.gl.up(!1),this.gl.dR(!1),this}setCameraLocation(t){return this.MY.x===t.x&&this.MY.y===t.y&&this.MY.z===t.z||(this.Mj=!0),super.setCameraLocation(t),this}setCameraDirection(t){return this.mj.x===t.x&&this.mj.y===t.y&&this.mj.z===t.z||(this.Mj=!0),super.setCameraDirection(t),this}G(){super.G(),this.pi.N("resize",this.wj),this.ai.removeEventListener("cellresize",this.wj)}dv(t){return this.LU(new Ly(this,this.PU,[],t))}Np(t,e){return this.LU(new Fy(this,this.PU,t,e))}vp(){return this.LU(new Ey(this,this.PU,[]))}Py(){return this.LU(new Ry(this,this.PU,[]))}bA(){return this.LU(new wy(this,this.PU,[]))}ty(t){return this.LU(new zy(this,this.PU,[],t))}my(t){return this.LU(new _y(this,this.PU,[],t))}}class Oy{constructor(t,e){this.Lj=[],this.Pj=[],this.Bj=(t,e)=>{const i=this.Lj.find(e=>e.vc===t);i&&("pointerenter"!==e.type&&"pointermove"!==e.type||this.pi.Ga(i,!0,e.timeStamp),"pointerleave"===e.type&&this.pi.Ga(i,!1,e.timeStamp))},this.pi=t,this.Sc="init"in e?e.init({engine:t.Dg,handleEvent:this.Bj}):e,this.Dj=0,this.Ej=String(Math.round(1e6*Math.random()))}_n(t,e,i,s){const r=new Do(t,e,i,s,`${this.Ej}-${this.Dj}`);return this.Lj.push(r),r.addEventListener("dispose",()=>{var t;const e=this.Lj.indexOf(r);e>=0&&this.Lj.splice(e,1),(null===(t=this.pi.$a)||void 0===t?void 0:t.entity)===r&&this.pi.Ga(void 0,!1,Ut.performance.now())}),this.Dj+=1,r}Ko(){const t=this.Lj.filter(t=>t.getVisible()&&t.rn().length>0&&gs(t.Ze)).map(t=>t.yc()),e=this.Pj;this.Sc.update({textList:t,engine:this.pi.Dg,obstructingOverlays:e}),this.Pj.length=0}G(){const t=this.Lj.filter(t=>t.getVisible()&&t.rn().length>0&&gs(t.Ze)).map(t=>t.yc());this.Sc.dispose&&this.Sc.dispose({textList:t,engine:this.pi.Dg})}FA(t){this.Pj.push(t)}}class Uy extends uo{constructor(t,e,i,s=hm){if(super(t,e,i),this.Y=c(1,1),this.Rj=!1,this.Oj=0,this.zj=!0,this.Vj=0,this.DY=8388608,this.nE=[null,null],this.Nj=null,this.Gj=null,this.$j=0,this.Cg=!1,this.Uj=0,this.Bs=(t=!1)=>(this.ci||this.fa||Rp(this.ZB.gl)||(t&&(this.Rj=!0),this.oa=!0,this.Yj||this.sa.xE(t)),this),this.Yj=!1,this._E=t=>{if(this.ci||this.fa)return;const e=t-this.Oj;if(e>=this.Na||-1===this.Na){this.Yj=!0,this.Oj=t,this.Rj=!1;const i=e>50?1e3/60:e;this.aa&&this.aa(i),this.Ms.Nh(e),this._a(),this.ka(),this.oa=!1,-1!==this.Na&&this.Rj&&(this.sa.xE(this.Rj),this.oa=!0),this.la&&this.la(),this.Yj=!1,this.D.R("renderframe",{}),this.oa&&this.Bs(this.Rj)}else this.oa=!0,this.sa.xE()},this.jj=new Map,this.Mz=()=>this.ZB,this.Hj=()=>{var t,e;const i=this.Ia(),s=this.zj,r=Ut.performance.now(),n=null===(t=this.Wj)||void 0===t?void 0:t.Xj.reduce((t,e)=>t?e.Zj&&t.Zj&&e.Zj>t.Zj?e:t:e,void 0),o=null==n?void 0:n.Zj,a=null===(e=this.va)||void 0===e?void 0:e.timeStamp,h=this.Jj;return s?(this.Bs(!0),!1):void 0===n||(void 0===n||!n.Qj)&&(void 0!==o&&void 0===i?r-o>=1e3:!(void 0!==o&&void 0!==a&&r-a>=2e3&&(void 0===h||r-h>=2e3))||r-o>=1e3)},this.Kj=()=>{var t,e;this.qj=void 0;const i=null===(e=null===(t=this.Wj)||void 0===t?void 0:t.tH)||void 0===e?void 0:e.iH;void 0===i||i>=this.Vj||this.sH()},this.ka=()=>{if(this.ci||this.fa)return this;const t=this.ZB.gl,e=Ut.performance.now();this.ZB.gR(t.FRAMEBUFFER,this.sa.AE?this.nE[0]:null);const i=this.Y,s=i.x>0&&i.y>0,r=this.ZB.hR();if(this.ba.u&&this.ZB.gO(this.ba.T()),this.sa.dE&&this.iE&&(this.iE.canvas.width=i.x*r,this.iE.canvas.height=i.y*r),t.resize&&s&&t.resize(i.x*r,i.y*r),this.ZB.pR(0,0,i.x*r,i.y*r),this.ZB.yR(0,0,i.x*r,i.y*r),this.ZB.Vi(),s)for(const t of this.ra.values())t.wc(0,1,[]);if(this.xc&&this.xc.Ko(),this.Da.Oa&&s&&(this.qj&&(Ut.clearTimeout(this.qj),this.qj=void 0),this.Hj()?(this.sH(),this.ZB.gR(t.FRAMEBUFFER,this.sa.AE?this.nE[0]:null)):this.qj=Ut.setTimeout(this.Kj,500)),this.j(),this.ta(),Array.from(this.ga.values()).forEach(t=>{t.lastEvent.isLcjsArtificialEvent=!0,this.pa("pointermove",t.lastEvent)}),this.sa.AE){const e=this.ZB.gl2.ctx;e.bindFramebuffer(e.READ_FRAMEBUFFER,this.nE[0]),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this.nE[1]),e.clearBufferfv(e.COLOR,0,[1,1,1,1]),e.blitFramebuffer(0,0,this.Y.x*r,this.Y.y*r,0,0,this.Y.x*r,this.Y.y*r,t.COLOR_BUFFER_BIT,t.LINEAR)}else t.bindTexture(t.TEXTURE_2D,this.tE),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,this.Y.x*r,this.Y.y*r,0),t.bindTexture(t.TEXTURE_2D,null);return this.ZB.gR(t.FRAMEBUFFER,null),Rp(this.ZB.gl)?this.sa.KD(0,0,this.Y.x*r,this.Y.y*r,[this]):this.sa.xE(),this.zj=!1,this.Vj=e,this},this._a=()=>{if("use-window"===this.eH.mode){const t=Ut.devicePixelRatio||1;this.ZB.TO(t)}const t=this.Y;if(0===t.x||0===t.y)return this;this.Za.Z(t);for(const t of this.ra.values())t.Nh();return this.j(),this},this.sa=t,this.sa.dE){this.rH=Ut.document.createElement("canvas"),this.rH.style.width="100%",this.rH.style.height="100%",this.rH.style.display="block",this.rH.style.boxSizing="content-box",this.rH.style.position="absolute";const t=this.rH.getContext("2d",{willReadFrequently:!1,alpha:!0,desynchronized:!1});if(!t)throw new fg("No Canvas context available.");this.iE=t,this.zn.appendChild(this.rH)}this.sa.TE(this);const r={preserveDrawingBuffer:!0,antialias:e?e.antialias:void 0,alpha:!0,lineAntialias:!e||(!0===e.lineAntiAlias||!1===e.lineAntiAlias?e.lineAntiAlias:!1!==e.antialias)};let n;if(this.sa.AE&&t.gl2&&(n=new s(this,this.Da,{type:"webgl2",ctx:t.gl2.ctx,antialias:r.antialias,lineAntialias:r.lineAntialias},this.bi.isDark)),n||this.sa.AE||(n=new s(this,this.Da,{type:"webgl1",ctx:t.gl,antialias:r.antialias,lineAntialias:r.lineAntialias},this.bi.isDark)),!n)throw new fg("No WebGL context available");if(this.ZB=n,"number"==typeof(null==e?void 0:e.devicePixelRatio))this.eH={mode:"fixed",value:e.devicePixelRatio},this.ZB.TO(e.devicePixelRatio);else{const t=Ut.document.head.querySelector('meta[name="viewport"]'),i=!0===e.devicePixelRatio||(null==t?void 0:t.content.includes("width=device-width")),s=Ut.devicePixelRatio||1;this.eH=i?{mode:"use-window"}:{mode:"fixed",value:s},this.ZB.TO(s)}const o=e?e.width:void 0,a=e?e.height:void 0;this.Ha=this.hH(o),this.Xa=this.hH(a),this.nH(this.Ha,this.Xa),this.FU=this.zP("engine offscreen",1e6),this.oH=this.zP("engine bg",0);const h="function"==typeof this.bi.lcjsBackgroundFillStyle?Ot({resourcesBaseUrl:this.Da.me,styleFactory:this.bi.lcjsBackgroundFillStyle,apply:t=>this.setBackgroundFillStyle(t)}):this.bi.lcjsBackgroundFillStyle;this.Za=this.oH.tr(this.ai).qe(h).Ke(this.bi.lcjsBackgroundStrokeStyle).setPointerEvents(!1).sr({x:0,y:0});const l=this.zP("engine effects",200001).hY(this.bi.effect);this.vs=l;const u=this.sa.AE,d=this.kt();u&&(this.nE=[n.RR(),n.RR()]);const f=this.ZB.gl;u&&(this.Nj=f.createRenderbuffer(),this.Gj=f.createRenderbuffer()),this.tE=f.createTexture();const g=d.x*this.ZB.hR(),p=d.y*this.ZB.hR();if(u){f.bindRenderbuffer(f.RENDERBUFFER,this.Nj);const t=this.ZB.gl2.ctx;this.$j=this.sa.jD&&!1!==e.antialias?t.getParameter(t.MAX_SAMPLES):0,t.renderbufferStorageMultisample(t.RENDERBUFFER,this.$j,t.RGBA8,g,p),f.bindRenderbuffer(f.RENDERBUFFER,this.Gj),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.$j,t.DEPTH24_STENCIL8,g,p)}u&&(this.ZB.gR(f.FRAMEBUFFER,this.nE[0]),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.RENDERBUFFER,this.Nj),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,this.Gj)),f.bindTexture(f.TEXTURE_2D,this.tE),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,g,p,0,f.RGBA,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),u&&(this.ZB.gR(f.FRAMEBUFFER,this.nE[1]),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,this.tE,0)),this.ZB.gR(f.FRAMEBUFFER,null),this.xa(),this.ta(),this.Dg=no(this),this.Mc={bi:this.bi,Ms:this.Ms,ai:this.ai,Bs:t=>this.Bs(t),A_:()=>this.oa,Ia:()=>this.Ia(),Ls:t=>(this.Jj=Ut.performance.now(),this.Ls({x:t.clientX,y:t.clientY})),mF:t=>this.mF(t),Da:this.Da,La:t=>this.La(t),vs:this.vs,il:t=>this.il(t),sl:t=>this.sl(t),th:{Tr:(t,e,i)=>{const s=this.ZB.kh(e.family).aD(t,e,i,this.bi.isDark);return this.xc?{x:s.x,y:s.y,isEstimate:!1}:s}},$s:()=>this.ga.size>0,Us:(t,e)=>void 0!==Array.from(this.ga.values()).find(i=>!(void 0!==t&&i.entity!==t||void 0!==e&&e!==i.collectionMember))},e.textRenderer&&(this.xc=new Oy(this,e.textRenderer));const m=()=>{this.G()};Ut.addEventListener("unload",m),this.ua.push(()=>{Ut.removeEventListener("unload",m)})}get aH(){return this.ra}ea(t,e){let i=this.jj.get(t);if(!i){const e=this.ZB.DO(t),s=new Set,r=t=>{s.add(t)},n=i=>{s.delete(i)&&0===s.size&&(e.unbindResources(),this.jj.delete(t))},o=[];i={imageTexture:e,instances:s,handleNewInstance:r,handleInstanceDisposed:n,sharedEngineReference:{xF:()=>e.WE,SF:t=>{e.WE?t():o.push(t)}}},this.jj.set(t,i),e.Kc(this),e.tR(()=>{o.forEach(t=>{t()}),o.length=0})}const s=new mr(t,i.handleNewInstance,i.handleInstanceDisposed,e);return i.handleNewInstance(s),s}mF(t){const e=Array.from(this.jj.values()).find(e=>e.instances.has(t));if(!e)throw _e(0,()=>new Error("LightningChart JS error, attempted to use Icon that is disposed. Please check that you are not disposing an Icon that is still in use, or attempting to use a previously disposed Icon!"));return e.sharedEngineReference}Ls(t){var e;if(this.$a&&this.$a.entity.getPointerEvents()){if(this.$a.pointed||!(Ut.performance.now()-this.$a.timestamp>=50))return{entity:this.$a.entity,collectionMember:void 0,info:void 0};this.$a=void 0}const i=null===(e=this.Wj)||void 0===e?void 0:e.tH;if(!i)return;(!this.ma||Ut.performance.now()-this.ma>100)&&this.ta();const s=this.hr(t.x,t.y),r=Math.round(s.x*this.ZB.hR()),n=Math.round(s.y*this.ZB.hR());return[[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1],[0,-1],[0,0]].map(t=>this.lH(i,r+t[0]/i.uH,n+t[1]/i.uH)).reduce((t,e)=>{if(void 0===e)return t||void 0;const i=1e6*e.layerIndex+e.entityIndex;return!t||i>t.zIndexForComparison?{zIndexForComparison:i,entity:e.entity,collectionMember:e.collectionMember,info:e.info}:t},void 0)}lH(t,e,i){const s=Math.round(e*t.uH),r=Math.round(i*t.uH);if(s<0||s>=t.Y.x||r<0||r>=t.Y.y)return;const n=4*(s+r*t.Y.x),o=t.cH[n+0],a=t.cH[n+1],h=t.cH[n+2],l=t.cH[n+3];if(void 0===o||void 0===a||void 0===h||void 0===l)return;if(0===o&&0===a&&0===h&&0===l)return;const c=16777216*o+65536*a+256*h+l,u=t.dH.find(t=>c>=t.idFirst&&c<=t.idLast);if(!u)return;const{collectionMember:d,info:f}=u.entity.kc(c,u.idFirst,u.idCount,e,i);return{entity:u.entity,collectionMember:d,entityIndex:u.entityIndex,layerIndex:u.layer.Ta(),info:f}}Qo(t,e,i,s=1){const r=1!==s,n=this.ZB.gl;let o,a=!this.sa.AE||r||!this.Cg;if(this.xc){const t=this.xc;this.xc=void 0;const e=[],i=[];this.ra.forEach(t=>{t.Ei.forEach(t=>{t.getVisible()&&t instanceof Do&&i.push(t)})}),i.forEach(t=>{const i=t.Ws._n(t.ai);e.push(i),i.sr(t.Vl()).tn(t.rn()).Ch(t.kh()).qe(t.Mh()).Zl(t.Hl()).Mn(t.Jl()).wn(t.Ql()).Th(t.Fh()).qh(t.Gl()).nl(t.ol()).setPointerEvents(!1)}),o={ctr:t,temporaryWebglTextObjects:e},a=!0}const h=this.Y;r&&this.xa({x:h.x*s,y:h.y*s}),a&&(r&&this.aa&&this.aa(0),this._a(),this.ka()),this.sa.AE?(this.ZB.gR(n.FRAMEBUFFER,this.nE[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.tE,0)):this.ZB.gR(n.FRAMEBUFFER,null);const l=this.qD(),c=l.x,u=l.y,d=new Uint8Array(c*u*4);n.readPixels(0,0,c,u,n.RGBA,n.UNSIGNED_BYTE,d),o&&(o.temporaryWebglTextObjects.forEach(t=>t.dispose()),this.xc=o.ctr,this.ka());const f=new ImageData(new Uint8ClampedArray(d),c,u),g=document.createElement("canvas"),p=g.getContext("2d");if(!p)throw new Error("Failed to create 2D context for saving image.");g.width=c,g.height=u,p.putImageData(f,0,0),p.translate(0,u),p.scale(1,-1),p.drawImage(g,0,0),this.sa.AE&&(this.ZB.gR(n.FRAMEBUFFER,this.nE[0]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,this.Nj),this.ZB.gR(n.FRAMEBUFFER,this.nE[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.tE,0)),this.ZB.gR(n.FRAMEBUFFER,null);const m=g.toDataURL(t,e);return r&&this.xa(h),i?m:(t=>{const e=t.split(",")[0].split(":")[1].split(";")[0],i=Ut.atob(t.split(",")[1]),s=new Uint8Array(i.length);for(let t=0;t<i.length;t+=1)s[t]=i.charCodeAt(t);return new Ut.Blob([s.buffer],{type:e})})(m)}Ko(t,e,i=!1){this.xa(l(Math.round(t),Math.round(e))),this.wa();const s=this.ZB.gl.drawingBufferWidth,r=this.ZB.gl.drawingBufferHeight,n=new Uint8Array(s*r*4);if(this.ZB.gl.readPixels(0,0,s,r,this.ZB.gl.RGBA,this.ZB.gl.UNSIGNED_BYTE,n),!i){const t=r/2|0,e=4*s,i=new Uint8Array(4*s);for(let s=0;s<t;s+=1){const t=s*e,o=(r-s-1)*e;i.set(n.subarray(t,t+e)),n.copyWithin(t,o,o+e),n.set(i,o)}}return this.na={x:0,y:e},n}dB(t){return void 0!==this.Ha?this.Ha[0]=t:this.Ha=[t,void 0],this.zn.style.minWidth=`${this.Ha[0]}px`,this.xa(),this}AB(t){return void 0!==this.Ha?this.Ha[1]=t:this.Ha=[void 0,t],this.zn.style.maxWidth=`${this.Ha[1]}px`,this.xa(),this}pB(t){return void 0!==this.Xa?this.Xa[0]=t:this.Xa=[t,void 0],this.zn.style.minHeight=`${this.Xa[0]}px`,this.xa(),this}yB(t){return void 0!==this.Xa?this.Xa[1]=t:this.Xa=[void 0,t],this.zn.style.maxHeight=`${this.Xa[1]}px`,this.xa(),this}nH(t,e){return this.Ha=t,this.Xa=e,this.zn.style.minWidth=`${this.Ha[0]}px`,this.zn.style.maxWidth=`${this.Ha[1]}px`,this.zn.style.minHeight=`${this.Xa[0]}px`,this.zn.style.maxHeight=`${this.Xa[1]}px`,this.xa(),this}QD(t){return this.Cg!==t&&(this.D.R("inviewchanged",{isInView:t}),this.Cg=t),this}JD(){return this.Cg}FE(t){this.Uj=t}CE(){return this.Uj}zP(t,e=this.tl()){const i=this.qa(e);if(i){if(_e(0,()=>{}),!(i instanceof gy))throw new Error("Unexpected Engine Layer error");return i}return this.Ca(new gy(this,e,t))}GP(t,e,i){const s=this.qa(e);if(s){if(_e(0,()=>{}),!(s instanceof Ny))throw new Error("Unexpected Engine Layer error");return s}return this.Ca(new Ny(this,e,t,i))}kt(){return this.Y}qD(){const t=this.ZB.hR();return{x:Math.round(this.Y.x*t),y:Math.round(this.Y.y*t)}}hH(t){return t instanceof Array||(t=[t,t]),t}fH(){return this.sa.sE}AH(){return Rp(this.ZB.gl)}sH(){var t;const e=this.ZB.gl,i=Ut.performance.now(),s=this.Da.Ra,r={x:Math.ceil(this.Y.x*this.ZB.hR()*s),y:Math.ceil(this.Y.y*this.ZB.hR()*s)};this.Wj||(this.Wj={uH:s,gH:r,Xj:[],tH:void 0});let n=this.Wj.Xj.find(t=>!t.Qj),o=!1;n||(o=!0,n={Qj:!1,Y:r,WO:e.createTexture(),pH:this.ZB.RR(),Gj:this.ZB.OR(),vH:new Uint8Array,Zj:void 0},this.Wj.Xj.push(n));const a=n;(o||a.Y.x!==r.x||a.Y.y!==r.y)&&(e.bindTexture(e.TEXTURE_2D,a.WO),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.x,r.y,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.ZB.gR(e.FRAMEBUFFER,a.pH),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a.WO,0),e.bindRenderbuffer(e.RENDERBUFFER,a.Gj),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.x,r.y),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,a.Gj),a.vH=new Uint8Array(r.x*r.y*4),a.Y=r),a.Qj=!0,a.Zj=i,this.ZB.gR(e.FRAMEBUFFER,a.pH),e.clearDepth(1),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.disable(e.BLEND),e.resize&&e.resize(r.x,r.y),this.ZB.pR(0,0,r.x,r.y);const h=[];for(const t of this.ra.values())t.wc(1,s,h);this.ZB.gR(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.enable(e.BLEND);const l=null===(t=this.ZB.gl2)||void 0===t?void 0:t.ctx,c=()=>{if(this.Wj){const t=this.Wj.tH;if(t&&t.iH>i)return;this.Wj.tH={iH:i,uH:s,Y:r,cH:a.vH,dH:h}}};l?this.ZB.YO(l,a.pH,0,0,r.x,r.y,e.RGBA,e.UNSIGNED_BYTE,a.vH).then(()=>{this.ci||(a.Qj=!1,c())}).catch(t=>{this.ci||(a.Qj=!1,Ut.console.warn("LightningChart JS mouse picking failed unexpectedly. This could mean that user interactions on charts are compromised.\nPlease report this issue to https://lightningchart.com/js-charts/docs/contact"))}):(this.ZB.jO(a.pH,0,0,r.x,r.y,e.RGBA,e.UNSIGNED_BYTE,a.vH),a.Qj=!1,c())}xa(t){const e=this.ZB.hR();if("use-window"===this.eH.mode){const t=Ut.devicePixelRatio||1;this.ZB.TO(t)}const i=this.Y.x,s=this.Y.y,r=t||{x:this.zn.offsetWidth,y:this.zn.offsetHeight},n=this.ZB.hR();if(0!==r.x&&0!==r.y&&(r.x!==i||r.y!==s||e!==n)){this.Y=r,this.ai.x.W(0,r.x).Z(r.x),this.ai.y.W(0,r.y).Z(r.y);const t=r.x*n,e=r.y*n,i=this.ZB.gl,s=this.sa.AE;if(this.tE&&(i.bindTexture(i.TEXTURE_2D,this.tE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null)),s){const s=this.ZB.gl2.ctx;this.Nj&&(i.bindRenderbuffer(i.RENDERBUFFER,this.Nj),s.renderbufferStorageMultisample(s.RENDERBUFFER,this.$j,s.RGBA8,t,e)),this.Gj&&(i.bindRenderbuffer(i.RENDERBUFFER,this.Gj),s.renderbufferStorageMultisample(s.RENDERBUFFER,this.$j,s.DEPTH24_STENCIL8,t,e))}i.bindRenderbuffer(i.RENDERBUFFER,null),this.D.R("resize",{engineWidth:this.Y.x,engineHeight:this.Y.y,width:this.Y.x,height:this.Y.y})}}G(){var t;this.ci||(super.G(),this.xc&&this.xc.G(),this.qj&&(Ut.clearTimeout(this.qj),this.qj=void 0),Array.from(this.ZB.ED.entries()).forEach(([t,e])=>{e._c(!1),this.ZB.ED.delete(t)}),Array.from(this.ZB.GR.values()).forEach(t=>{t.unbindResources()}),this.ZB.GR.clear(),this.ZB.NR.$E(),this.ZB.wO.G(),this.ZB.BR(this.ZB._O),this.ZB.BR(this.ZB.kO),this.ZB.xO.forEach((t,e)=>{this.ZB.gl.deleteBuffer(e)}),this.ZB.xO.clear(),this.ZB.VO&&(this.ZB.BR(this.ZB.VO.buffer),this.ZB.VO=void 0),this.ZB.VR(this.nE[0]),this.ZB.VR(this.nE[1]),this.ZB.zR(this.Nj),this.ZB.KB(this.tE),this.ZB.zR(this.Gj),this.Wj&&(this.Wj.Xj.forEach(t=>{this.ZB.zR(t.Gj),this.ZB.VR(t.pH),this.ZB.KB(t.WO)}),this.Wj=void 0),this.ZB.vO.forEach(t=>this.ZB.BR(t)),this.jj.clear(),this.sa.IE(this),this.rH&&(null===(t=this.rH.parentElement)||void 0===t||t.removeChild(this.rH),this.rH=void 0),this.iE&&(this.iE=void 0),this.ZB.gl=void 0)}}var Gy="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{},Yy={exports:{}};!function(t,e){function i(t,e){if(!t)throw new Error(e||"Assertion failed")}function s(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}function r(t,e,i){if(r.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(i=e,e=10),this.qE(t||0,e||10,i||"be"))}var n;"object"==typeof Yy?Yy.exports=r:e.BN=r,r.BN=r,r.wordSize=26;try{n=(void 0).Buffer}catch(t){}function o(t,e,s){for(var r=0,n=Math.min(t.length,s),o=0,a=e;a<n;a++){var h,l=t.charCodeAt(a)-48;r<<=4,r|=h=l>=49&&l<=54?l-49+10:l>=17&&l<=22?l-17+10:l,o|=h}return i(!(240&o),"Invalid character in "+t),r}function a(t,e,s,r){for(var n=0,o=0,a=Math.min(t.length,s),h=e;h<a;h++){var l=t.charCodeAt(h)-48;n*=r,o=l>=49?l-49+10:l>=17?l-17+10:l,i(l>=0&&o<r,"Invalid character"),n+=o}return n}function h(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(r.isBN=function(t){return t instanceof r||null!==t&&"object"==typeof t&&t.constructor.wordSize===r.wordSize&&Array.isArray(t.words)},r.max=function(t,e){return t.cmp(e)>0?t:e},r.min=function(t,e){return t.cmp(e)<0?t:e},r.prototype.qE=function(t,e,s){if("number"==typeof t)return this.yH(t,e,s);if("object"==typeof t)return this.mH(t,e,s);"hex"===e&&(e=16),i(e===(0|e)&&e>=2&&e<=36);var r=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&r++,16===e?this.xH(t,r):this.SH(t,e,r),"-"===t[0]&&(this.negative=1),this.bH(),"le"===s&&this.mH(this.toArray(),e,s)},r.prototype.yH=function(t,e,s){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(i(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===s&&this.mH(this.toArray(),e,s)},r.prototype.mH=function(t,e,s){if(i("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var n,o,a=0;if("be"===s)for(r=t.length-1,n=0;r>=0;r-=3)o=t[r]|t[r-1]<<8|t[r-2]<<16,this.words[n]|=o<<a&67108863,this.words[n+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,n++);else if("le"===s)for(r=0,n=0;r<t.length;r+=3)o=t[r]|t[r+1]<<8|t[r+2]<<16,this.words[n]|=o<<a&67108863,this.words[n+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,n++);return this.bH()},r.prototype.xH=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,r,n=0;for(i=t.length-6,s=0;i>=e;i-=6)r=o(t,i,i+6),this.words[s]|=r<<n&67108863,this.words[s+1]|=r>>>26-n&4194303,(n+=24)>=26&&(n-=26,s++);i+6!==e&&(r=o(t,e,i+6),this.words[s]|=r<<n&67108863,this.words[s+1]|=r>>>26-n&4194303),this.bH()},r.prototype.SH=function(t,e,i){this.words=[0],this.length=1;for(var s=0,r=1;r<=67108863;r*=e)s++;s--,r=r/e|0;for(var n=t.length-i,o=n%s,h=Math.min(n,n-o)+i,l=0,c=i;c<h;c+=s)l=a(t,c,c+s,e),this.imuln(r),this.words[0]+l<67108864?this.words[0]+=l:this.MH(l);if(0!==o){var u=1;for(l=a(t,c,t.length,e),c=0;c<o;c++)u*=e;this.imuln(u),this.words[0]+l<67108864?this.words[0]+=l:this.MH(l)}},r.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},r.prototype.wH=function(t){h(t,this)},r.prototype.clone=function(){var t=new r(null);return this.copy(t),t},r.prototype._H=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},r.prototype.bH=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this.kH()},r.prototype.kH=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{r.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(t){r.prototype.inspect=l}else r.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(t,e,i){i.negative=e.negative^t.negative;var s=t.length+e.length|0;i.length=s,s=s-1|0;var r=0|t.words[0],n=0|e.words[0],o=r*n,a=67108863&o,h=o/67108864|0;i.words[0]=a;for(var l=1;l<s;l++){for(var c=h>>>26,u=67108863&h,d=Math.min(l,e.length-1),f=Math.max(0,l-t.length+1);f<=d;f++){var g=l-f|0;c+=(o=(r=0|t.words[g])*(n=0|e.words[f])+u)/67108864|0,u=67108863&o}i.words[l]=0|u,h=0|c}return 0!==h?i.words[l]=0|h:i.length--,i.bH()}r.prototype.toString=function(t,e){var s;if(e=0|e||1,16===(t=t||10)||"hex"===t){s="";for(var r=0,n=0,o=0;o<this.length;o++){var a=this.words[o],h=(16777215&(a<<r|n)).toString(16);s=0!=(n=a>>>24-r&16777215)||o!==this.length-1?c[6-h.length]+h+s:h+s,(r+=2)>=26&&(r-=26,o--)}for(0!==n&&(s=n.toString(16)+s);s.length%e!=0;)s="0"+s;return 0!==this.negative&&(s="-"+s),s}if(t===(0|t)&&t>=2&&t<=36){var l=u[t],f=d[t];s="";var g=this.clone();for(g.negative=0;!g.isZero();){var p=g.modrn(f).toString(t);s=(g=g.idivn(f)).isZero()?p+s:c[l-p.length]+p+s}for(this.isZero()&&(s="0"+s);s.length%e!=0;)s="0"+s;return 0!==this.negative&&(s="-"+s),s}i(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},r.prototype.toJSON=function(){return this.toString(16,2)},n&&(r.prototype.toBuffer=function(t,e){return this.toArrayLike(n,t,e)}),r.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},r.prototype.toArrayLike=function(t,e,s){this.bH();var r=this.byteLength(),n=s||Math.max(1,r);i(r<=n,"byte array longer than desired length"),i(n>0,"Requested array length <= 0");var o=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,n);return this["_toArrayLike"+("le"===e?"LE":"BE")](o,r),o},r.prototype.CH=function(t,e){for(var i=0,s=0,r=0,n=0;r<this.length;r++){var o=this.words[r]<<n|s;t[i++]=255&o,i<t.length&&(t[i++]=o>>8&255),i<t.length&&(t[i++]=o>>16&255),6===n?(i<t.length&&(t[i++]=o>>24&255),s=0,n=0):(s=o>>>24,n+=2)}if(i<t.length)for(t[i++]=s;i<t.length;)t[i++]=0},r.prototype.TH=function(t,e){for(var i=t.length-1,s=0,r=0,n=0;r<this.length;r++){var o=this.words[r]<<n|s;t[i--]=255&o,i>=0&&(t[i--]=o>>8&255),i>=0&&(t[i--]=o>>16&255),6===n?(i>=0&&(t[i--]=o>>24&255),s=0,n=0):(s=o>>>24,n+=2)}if(i>=0)for(t[i--]=s;i>=0;)t[i--]=0},Math.clz32?r.prototype.FH=function(t){return 32-Math.clz32(t)}:r.prototype.FH=function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},r.prototype.IH=function(t){if(0===t)return 26;var e=t,i=0;return 8191&e||(i+=13,e>>>=13),127&e||(i+=7,e>>>=7),15&e||(i+=4,e>>>=4),3&e||(i+=2,e>>>=2),1&e||i++,i},r.prototype.bitLength=function(){var t=this.words[this.length-1],e=this.FH(t);return 26*(this.length-1)+e},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this.IH(this.words[e]);if(t+=i,26!==i)break}return t},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},r.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return 0!==this.negative},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.bH()},r.prototype.ior=function(t){return i(!(this.negative|t.negative)),this.iuor(t)},r.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},r.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},r.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this.bH()},r.prototype.iand=function(t){return i(!(this.negative|t.negative)),this.iuand(t)},r.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},r.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},r.prototype.iuxor=function(t){var e,i;this.length>t.length?(e=this,i=t):(e=t,i=this);for(var s=0;s<i.length;s++)this.words[s]=e.words[s]^i.words[s];if(this!==e)for(;s<e.length;s++)this.words[s]=e.words[s];return this.length=e.length,this.bH()},r.prototype.ixor=function(t){return i(!(this.negative|t.negative)),this.iuxor(t)},r.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},r.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},r.prototype.inotn=function(t){i("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),s=t%26;this._H(e),s>0&&e--;for(var r=0;r<e;r++)this.words[r]=67108863&~this.words[r];return s>0&&(this.words[r]=~this.words[r]&67108863>>26-s),this.bH()},r.prototype.notn=function(t){return this.clone().inotn(t)},r.prototype.setn=function(t,e){i("number"==typeof t&&t>=0);var s=t/26|0,r=t%26;return this._H(s+1),this.words[s]=e?this.words[s]|1<<r:this.words[s]&~(1<<r),this.bH()},r.prototype.iadd=function(t){var e,i,s;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this.kH();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e.kH();this.length>t.length?(i=this,s=t):(i=t,s=this);for(var r=0,n=0;n<s.length;n++)e=(0|i.words[n])+(0|s.words[n])+r,this.words[n]=67108863&e,r=e>>>26;for(;0!==r&&n<i.length;n++)e=(0|i.words[n])+r,this.words[n]=67108863&e,r=e>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;n<i.length;n++)this.words[n]=i.words[n];return this},r.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},r.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e.kH()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this.kH();var i,s,r=this.cmp(t);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,s=t):(i=t,s=this);for(var n=0,o=0;o<s.length;o++)n=(e=(0|i.words[o])-(0|s.words[o])+n)>>26,this.words[o]=67108863&e;for(;0!==n&&o<i.length;o++)n=(e=(0|i.words[o])+n)>>26,this.words[o]=67108863&e;if(0===n&&o<i.length&&i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this.length=Math.max(this.length,o),i!==this&&(this.negative=1),this.bH()},r.prototype.sub=function(t){return this.clone().isub(t)};var g=function(t,e,i){var s,r,n,o=t.words,a=e.words,h=i.words,l=0,c=0|o[0],u=8191&c,d=c>>>13,f=0|o[1],g=8191&f,p=f>>>13,m=0|o[2],y=8191&m,x=m>>>13,v=0|o[3],A=8191&v,S=v>>>13,b=0|o[4],M=8191&b,E=b>>>13,k=0|o[5],T=8191&k,w=k>>>13,C=0|o[6],B=8191&C,F=C>>>13,D=0|o[7],I=8191&D,R=D>>>13,L=0|o[8],P=8191&L,z=L>>>13,_=0|o[9],V=8191&_,N=_>>>13,O=0|a[0],U=8191&O,G=O>>>13,Y=0|a[1],Z=8191&Y,W=Y>>>13,j=0|a[2],H=8191&j,$=j>>>13,X=0|a[3],q=8191&X,K=X>>>13,J=0|a[4],Q=8191&J,tt=J>>>13,et=0|a[5],it=8191&et,st=et>>>13,rt=0|a[6],nt=8191&rt,ot=rt>>>13,at=0|a[7],ht=8191&at,lt=at>>>13,ct=0|a[8],ut=8191&ct,dt=ct>>>13,ft=0|a[9],gt=8191&ft,pt=ft>>>13;i.negative=t.negative^e.negative,i.length=19;var mt=(l+(s=Math.imul(u,U))|0)+((8191&(r=(r=Math.imul(u,G))+Math.imul(d,U)|0))<<13)|0;l=((n=Math.imul(d,G))+(r>>>13)|0)+(mt>>>26)|0,mt&=67108863,s=Math.imul(g,U),r=(r=Math.imul(g,G))+Math.imul(p,U)|0,n=Math.imul(p,G);var yt=(l+(s=s+Math.imul(u,Z)|0)|0)+((8191&(r=(r=r+Math.imul(u,W)|0)+Math.imul(d,Z)|0))<<13)|0;l=((n=n+Math.imul(d,W)|0)+(r>>>13)|0)+(yt>>>26)|0,yt&=67108863,s=Math.imul(y,U),r=(r=Math.imul(y,G))+Math.imul(x,U)|0,n=Math.imul(x,G),s=s+Math.imul(g,Z)|0,r=(r=r+Math.imul(g,W)|0)+Math.imul(p,Z)|0,n=n+Math.imul(p,W)|0;var xt=(l+(s=s+Math.imul(u,H)|0)|0)+((8191&(r=(r=r+Math.imul(u,$)|0)+Math.imul(d,H)|0))<<13)|0;l=((n=n+Math.imul(d,$)|0)+(r>>>13)|0)+(xt>>>26)|0,xt&=67108863,s=Math.imul(A,U),r=(r=Math.imul(A,G))+Math.imul(S,U)|0,n=Math.imul(S,G),s=s+Math.imul(y,Z)|0,r=(r=r+Math.imul(y,W)|0)+Math.imul(x,Z)|0,n=n+Math.imul(x,W)|0,s=s+Math.imul(g,H)|0,r=(r=r+Math.imul(g,$)|0)+Math.imul(p,H)|0,n=n+Math.imul(p,$)|0;var vt=(l+(s=s+Math.imul(u,q)|0)|0)+((8191&(r=(r=r+Math.imul(u,K)|0)+Math.imul(d,q)|0))<<13)|0;l=((n=n+Math.imul(d,K)|0)+(r>>>13)|0)+(vt>>>26)|0,vt&=67108863,s=Math.imul(M,U),r=(r=Math.imul(M,G))+Math.imul(E,U)|0,n=Math.imul(E,G),s=s+Math.imul(A,Z)|0,r=(r=r+Math.imul(A,W)|0)+Math.imul(S,Z)|0,n=n+Math.imul(S,W)|0,s=s+Math.imul(y,H)|0,r=(r=r+Math.imul(y,$)|0)+Math.imul(x,H)|0,n=n+Math.imul(x,$)|0,s=s+Math.imul(g,q)|0,r=(r=r+Math.imul(g,K)|0)+Math.imul(p,q)|0,n=n+Math.imul(p,K)|0;var At=(l+(s=s+Math.imul(u,Q)|0)|0)+((8191&(r=(r=r+Math.imul(u,tt)|0)+Math.imul(d,Q)|0))<<13)|0;l=((n=n+Math.imul(d,tt)|0)+(r>>>13)|0)+(At>>>26)|0,At&=67108863,s=Math.imul(T,U),r=(r=Math.imul(T,G))+Math.imul(w,U)|0,n=Math.imul(w,G),s=s+Math.imul(M,Z)|0,r=(r=r+Math.imul(M,W)|0)+Math.imul(E,Z)|0,n=n+Math.imul(E,W)|0,s=s+Math.imul(A,H)|0,r=(r=r+Math.imul(A,$)|0)+Math.imul(S,H)|0,n=n+Math.imul(S,$)|0,s=s+Math.imul(y,q)|0,r=(r=r+Math.imul(y,K)|0)+Math.imul(x,q)|0,n=n+Math.imul(x,K)|0,s=s+Math.imul(g,Q)|0,r=(r=r+Math.imul(g,tt)|0)+Math.imul(p,Q)|0,n=n+Math.imul(p,tt)|0;var St=(l+(s=s+Math.imul(u,it)|0)|0)+((8191&(r=(r=r+Math.imul(u,st)|0)+Math.imul(d,it)|0))<<13)|0;l=((n=n+Math.imul(d,st)|0)+(r>>>13)|0)+(St>>>26)|0,St&=67108863,s=Math.imul(B,U),r=(r=Math.imul(B,G))+Math.imul(F,U)|0,n=Math.imul(F,G),s=s+Math.imul(T,Z)|0,r=(r=r+Math.imul(T,W)|0)+Math.imul(w,Z)|0,n=n+Math.imul(w,W)|0,s=s+Math.imul(M,H)|0,r=(r=r+Math.imul(M,$)|0)+Math.imul(E,H)|0,n=n+Math.imul(E,$)|0,s=s+Math.imul(A,q)|0,r=(r=r+Math.imul(A,K)|0)+Math.imul(S,q)|0,n=n+Math.imul(S,K)|0,s=s+Math.imul(y,Q)|0,r=(r=r+Math.imul(y,tt)|0)+Math.imul(x,Q)|0,n=n+Math.imul(x,tt)|0,s=s+Math.imul(g,it)|0,r=(r=r+Math.imul(g,st)|0)+Math.imul(p,it)|0,n=n+Math.imul(p,st)|0;var bt=(l+(s=s+Math.imul(u,nt)|0)|0)+((8191&(r=(r=r+Math.imul(u,ot)|0)+Math.imul(d,nt)|0))<<13)|0;l=((n=n+Math.imul(d,ot)|0)+(r>>>13)|0)+(bt>>>26)|0,bt&=67108863,s=Math.imul(I,U),r=(r=Math.imul(I,G))+Math.imul(R,U)|0,n=Math.imul(R,G),s=s+Math.imul(B,Z)|0,r=(r=r+Math.imul(B,W)|0)+Math.imul(F,Z)|0,n=n+Math.imul(F,W)|0,s=s+Math.imul(T,H)|0,r=(r=r+Math.imul(T,$)|0)+Math.imul(w,H)|0,n=n+Math.imul(w,$)|0,s=s+Math.imul(M,q)|0,r=(r=r+Math.imul(M,K)|0)+Math.imul(E,q)|0,n=n+Math.imul(E,K)|0,s=s+Math.imul(A,Q)|0,r=(r=r+Math.imul(A,tt)|0)+Math.imul(S,Q)|0,n=n+Math.imul(S,tt)|0,s=s+Math.imul(y,it)|0,r=(r=r+Math.imul(y,st)|0)+Math.imul(x,it)|0,n=n+Math.imul(x,st)|0,s=s+Math.imul(g,nt)|0,r=(r=r+Math.imul(g,ot)|0)+Math.imul(p,nt)|0,n=n+Math.imul(p,ot)|0;var Mt=(l+(s=s+Math.imul(u,ht)|0)|0)+((8191&(r=(r=r+Math.imul(u,lt)|0)+Math.imul(d,ht)|0))<<13)|0;l=((n=n+Math.imul(d,lt)|0)+(r>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,s=Math.imul(P,U),r=(r=Math.imul(P,G))+Math.imul(z,U)|0,n=Math.imul(z,G),s=s+Math.imul(I,Z)|0,r=(r=r+Math.imul(I,W)|0)+Math.imul(R,Z)|0,n=n+Math.imul(R,W)|0,s=s+Math.imul(B,H)|0,r=(r=r+Math.imul(B,$)|0)+Math.imul(F,H)|0,n=n+Math.imul(F,$)|0,s=s+Math.imul(T,q)|0,r=(r=r+Math.imul(T,K)|0)+Math.imul(w,q)|0,n=n+Math.imul(w,K)|0,s=s+Math.imul(M,Q)|0,r=(r=r+Math.imul(M,tt)|0)+Math.imul(E,Q)|0,n=n+Math.imul(E,tt)|0,s=s+Math.imul(A,it)|0,r=(r=r+Math.imul(A,st)|0)+Math.imul(S,it)|0,n=n+Math.imul(S,st)|0,s=s+Math.imul(y,nt)|0,r=(r=r+Math.imul(y,ot)|0)+Math.imul(x,nt)|0,n=n+Math.imul(x,ot)|0,s=s+Math.imul(g,ht)|0,r=(r=r+Math.imul(g,lt)|0)+Math.imul(p,ht)|0,n=n+Math.imul(p,lt)|0;var Et=(l+(s=s+Math.imul(u,ut)|0)|0)+((8191&(r=(r=r+Math.imul(u,dt)|0)+Math.imul(d,ut)|0))<<13)|0;l=((n=n+Math.imul(d,dt)|0)+(r>>>13)|0)+(Et>>>26)|0,Et&=67108863,s=Math.imul(V,U),r=(r=Math.imul(V,G))+Math.imul(N,U)|0,n=Math.imul(N,G),s=s+Math.imul(P,Z)|0,r=(r=r+Math.imul(P,W)|0)+Math.imul(z,Z)|0,n=n+Math.imul(z,W)|0,s=s+Math.imul(I,H)|0,r=(r=r+Math.imul(I,$)|0)+Math.imul(R,H)|0,n=n+Math.imul(R,$)|0,s=s+Math.imul(B,q)|0,r=(r=r+Math.imul(B,K)|0)+Math.imul(F,q)|0,n=n+Math.imul(F,K)|0,s=s+Math.imul(T,Q)|0,r=(r=r+Math.imul(T,tt)|0)+Math.imul(w,Q)|0,n=n+Math.imul(w,tt)|0,s=s+Math.imul(M,it)|0,r=(r=r+Math.imul(M,st)|0)+Math.imul(E,it)|0,n=n+Math.imul(E,st)|0,s=s+Math.imul(A,nt)|0,r=(r=r+Math.imul(A,ot)|0)+Math.imul(S,nt)|0,n=n+Math.imul(S,ot)|0,s=s+Math.imul(y,ht)|0,r=(r=r+Math.imul(y,lt)|0)+Math.imul(x,ht)|0,n=n+Math.imul(x,lt)|0,s=s+Math.imul(g,ut)|0,r=(r=r+Math.imul(g,dt)|0)+Math.imul(p,ut)|0,n=n+Math.imul(p,dt)|0;var kt=(l+(s=s+Math.imul(u,gt)|0)|0)+((8191&(r=(r=r+Math.imul(u,pt)|0)+Math.imul(d,gt)|0))<<13)|0;l=((n=n+Math.imul(d,pt)|0)+(r>>>13)|0)+(kt>>>26)|0,kt&=67108863,s=Math.imul(V,Z),r=(r=Math.imul(V,W))+Math.imul(N,Z)|0,n=Math.imul(N,W),s=s+Math.imul(P,H)|0,r=(r=r+Math.imul(P,$)|0)+Math.imul(z,H)|0,n=n+Math.imul(z,$)|0,s=s+Math.imul(I,q)|0,r=(r=r+Math.imul(I,K)|0)+Math.imul(R,q)|0,n=n+Math.imul(R,K)|0,s=s+Math.imul(B,Q)|0,r=(r=r+Math.imul(B,tt)|0)+Math.imul(F,Q)|0,n=n+Math.imul(F,tt)|0,s=s+Math.imul(T,it)|0,r=(r=r+Math.imul(T,st)|0)+Math.imul(w,it)|0,n=n+Math.imul(w,st)|0,s=s+Math.imul(M,nt)|0,r=(r=r+Math.imul(M,ot)|0)+Math.imul(E,nt)|0,n=n+Math.imul(E,ot)|0,s=s+Math.imul(A,ht)|0,r=(r=r+Math.imul(A,lt)|0)+Math.imul(S,ht)|0,n=n+Math.imul(S,lt)|0,s=s+Math.imul(y,ut)|0,r=(r=r+Math.imul(y,dt)|0)+Math.imul(x,ut)|0,n=n+Math.imul(x,dt)|0;var Tt=(l+(s=s+Math.imul(g,gt)|0)|0)+((8191&(r=(r=r+Math.imul(g,pt)|0)+Math.imul(p,gt)|0))<<13)|0;l=((n=n+Math.imul(p,pt)|0)+(r>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,s=Math.imul(V,H),r=(r=Math.imul(V,$))+Math.imul(N,H)|0,n=Math.imul(N,$),s=s+Math.imul(P,q)|0,r=(r=r+Math.imul(P,K)|0)+Math.imul(z,q)|0,n=n+Math.imul(z,K)|0,s=s+Math.imul(I,Q)|0,r=(r=r+Math.imul(I,tt)|0)+Math.imul(R,Q)|0,n=n+Math.imul(R,tt)|0,s=s+Math.imul(B,it)|0,r=(r=r+Math.imul(B,st)|0)+Math.imul(F,it)|0,n=n+Math.imul(F,st)|0,s=s+Math.imul(T,nt)|0,r=(r=r+Math.imul(T,ot)|0)+Math.imul(w,nt)|0,n=n+Math.imul(w,ot)|0,s=s+Math.imul(M,ht)|0,r=(r=r+Math.imul(M,lt)|0)+Math.imul(E,ht)|0,n=n+Math.imul(E,lt)|0,s=s+Math.imul(A,ut)|0,r=(r=r+Math.imul(A,dt)|0)+Math.imul(S,ut)|0,n=n+Math.imul(S,dt)|0;var wt=(l+(s=s+Math.imul(y,gt)|0)|0)+((8191&(r=(r=r+Math.imul(y,pt)|0)+Math.imul(x,gt)|0))<<13)|0;l=((n=n+Math.imul(x,pt)|0)+(r>>>13)|0)+(wt>>>26)|0,wt&=67108863,s=Math.imul(V,q),r=(r=Math.imul(V,K))+Math.imul(N,q)|0,n=Math.imul(N,K),s=s+Math.imul(P,Q)|0,r=(r=r+Math.imul(P,tt)|0)+Math.imul(z,Q)|0,n=n+Math.imul(z,tt)|0,s=s+Math.imul(I,it)|0,r=(r=r+Math.imul(I,st)|0)+Math.imul(R,it)|0,n=n+Math.imul(R,st)|0,s=s+Math.imul(B,nt)|0,r=(r=r+Math.imul(B,ot)|0)+Math.imul(F,nt)|0,n=n+Math.imul(F,ot)|0,s=s+Math.imul(T,ht)|0,r=(r=r+Math.imul(T,lt)|0)+Math.imul(w,ht)|0,n=n+Math.imul(w,lt)|0,s=s+Math.imul(M,ut)|0,r=(r=r+Math.imul(M,dt)|0)+Math.imul(E,ut)|0,n=n+Math.imul(E,dt)|0;var Ct=(l+(s=s+Math.imul(A,gt)|0)|0)+((8191&(r=(r=r+Math.imul(A,pt)|0)+Math.imul(S,gt)|0))<<13)|0;l=((n=n+Math.imul(S,pt)|0)+(r>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,s=Math.imul(V,Q),r=(r=Math.imul(V,tt))+Math.imul(N,Q)|0,n=Math.imul(N,tt),s=s+Math.imul(P,it)|0,r=(r=r+Math.imul(P,st)|0)+Math.imul(z,it)|0,n=n+Math.imul(z,st)|0,s=s+Math.imul(I,nt)|0,r=(r=r+Math.imul(I,ot)|0)+Math.imul(R,nt)|0,n=n+Math.imul(R,ot)|0,s=s+Math.imul(B,ht)|0,r=(r=r+Math.imul(B,lt)|0)+Math.imul(F,ht)|0,n=n+Math.imul(F,lt)|0,s=s+Math.imul(T,ut)|0,r=(r=r+Math.imul(T,dt)|0)+Math.imul(w,ut)|0,n=n+Math.imul(w,dt)|0;var Bt=(l+(s=s+Math.imul(M,gt)|0)|0)+((8191&(r=(r=r+Math.imul(M,pt)|0)+Math.imul(E,gt)|0))<<13)|0;l=((n=n+Math.imul(E,pt)|0)+(r>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,s=Math.imul(V,it),r=(r=Math.imul(V,st))+Math.imul(N,it)|0,n=Math.imul(N,st),s=s+Math.imul(P,nt)|0,r=(r=r+Math.imul(P,ot)|0)+Math.imul(z,nt)|0,n=n+Math.imul(z,ot)|0,s=s+Math.imul(I,ht)|0,r=(r=r+Math.imul(I,lt)|0)+Math.imul(R,ht)|0,n=n+Math.imul(R,lt)|0,s=s+Math.imul(B,ut)|0,r=(r=r+Math.imul(B,dt)|0)+Math.imul(F,ut)|0,n=n+Math.imul(F,dt)|0;var Ft=(l+(s=s+Math.imul(T,gt)|0)|0)+((8191&(r=(r=r+Math.imul(T,pt)|0)+Math.imul(w,gt)|0))<<13)|0;l=((n=n+Math.imul(w,pt)|0)+(r>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,s=Math.imul(V,nt),r=(r=Math.imul(V,ot))+Math.imul(N,nt)|0,n=Math.imul(N,ot),s=s+Math.imul(P,ht)|0,r=(r=r+Math.imul(P,lt)|0)+Math.imul(z,ht)|0,n=n+Math.imul(z,lt)|0,s=s+Math.imul(I,ut)|0,r=(r=r+Math.imul(I,dt)|0)+Math.imul(R,ut)|0,n=n+Math.imul(R,dt)|0;var Dt=(l+(s=s+Math.imul(B,gt)|0)|0)+((8191&(r=(r=r+Math.imul(B,pt)|0)+Math.imul(F,gt)|0))<<13)|0;l=((n=n+Math.imul(F,pt)|0)+(r>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,s=Math.imul(V,ht),r=(r=Math.imul(V,lt))+Math.imul(N,ht)|0,n=Math.imul(N,lt),s=s+Math.imul(P,ut)|0,r=(r=r+Math.imul(P,dt)|0)+Math.imul(z,ut)|0,n=n+Math.imul(z,dt)|0;var It=(l+(s=s+Math.imul(I,gt)|0)|0)+((8191&(r=(r=r+Math.imul(I,pt)|0)+Math.imul(R,gt)|0))<<13)|0;l=((n=n+Math.imul(R,pt)|0)+(r>>>13)|0)+(It>>>26)|0,It&=67108863,s=Math.imul(V,ut),r=(r=Math.imul(V,dt))+Math.imul(N,ut)|0,n=Math.imul(N,dt);var Rt=(l+(s=s+Math.imul(P,gt)|0)|0)+((8191&(r=(r=r+Math.imul(P,pt)|0)+Math.imul(z,gt)|0))<<13)|0;l=((n=n+Math.imul(z,pt)|0)+(r>>>13)|0)+(Rt>>>26)|0,Rt&=67108863;var Lt=(l+(s=Math.imul(V,gt))|0)+((8191&(r=(r=Math.imul(V,pt))+Math.imul(N,gt)|0))<<13)|0;return l=((n=Math.imul(N,pt))+(r>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,h[0]=mt,h[1]=yt,h[2]=xt,h[3]=vt,h[4]=At,h[5]=St,h[6]=bt,h[7]=Mt,h[8]=Et,h[9]=kt,h[10]=Tt,h[11]=wt,h[12]=Ct,h[13]=Bt,h[14]=Ft,h[15]=Dt,h[16]=It,h[17]=Rt,h[18]=Lt,0!==l&&(h[19]=l,i.length++),i};function p(t,e,i){i.negative=e.negative^t.negative,i.length=t.length+e.length;for(var s=0,r=0,n=0;n<i.length-1;n++){var o=r;r=0;for(var a=67108863&s,h=Math.min(n,e.length-1),l=Math.max(0,n-t.length+1);l<=h;l++){var c=n-l,u=(0|t.words[c])*(0|e.words[l]),d=67108863&u;a=67108863&(d=d+a|0),r+=(o=(o=o+(u/67108864|0)|0)+(d>>>26)|0)>>>26,o&=67108863}i.words[n]=a,s=o,o=r}return 0!==s?i.words[n]=s:i.length--,i.bH()}function m(t,e,i){return p(t,e,i)}Math.imul||(g=f),r.prototype.mulTo=function(t,e){var i=this.length+t.length;return 10===this.length&&10===t.length?g(this,t,e):i<63?f(this,t,e):i<1024?p(this,t,e):m(this,t,e)},r.prototype.mul=function(t){var e=new r(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},r.prototype.mulf=function(t){var e=new r(null);return e.words=new Array(this.length+t.length),m(this,t,e)},r.prototype.imul=function(t){return this.clone().mulTo(t,this)},r.prototype.imuln=function(t){var e=t<0;e&&(t=-t),i("number"==typeof t),i(t<67108864);for(var s=0,r=0;r<this.length;r++){var n=(0|this.words[r])*t,o=(67108863&n)+(67108863&s);s>>=26,s+=n/67108864|0,s+=o>>>26,this.words[r]=67108863&o}return 0!==s&&(this.words[r]=s,this.length++),e?this.ineg():this},r.prototype.muln=function(t){return this.clone().imuln(t)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),i=0;i<e.length;i++){var s=i/26|0,r=i%26;e[i]=t.words[s]>>>r&1}return e}(t);if(0===e.length)return new r(1);for(var i=this,s=0;s<e.length&&0===e[s];s++,i=i.sqr());if(++s<e.length)for(var n=i.sqr();s<e.length;s++,n=n.sqr())0!==e[s]&&(i=i.mul(n));return i},r.prototype.iushln=function(t){i("number"==typeof t&&t>=0);var e,s=t%26,r=(t-s)/26,n=67108863>>>26-s<<26-s;if(0!==s){var o=0;for(e=0;e<this.length;e++){var a=this.words[e]&n,h=(0|this.words[e])-a<<s;this.words[e]=h|o,o=a>>>26-s}o&&(this.words[e]=o,this.length++)}if(0!==r){for(e=this.length-1;e>=0;e--)this.words[e+r]=this.words[e];for(e=0;e<r;e++)this.words[e]=0;this.length+=r}return this.bH()},r.prototype.ishln=function(t){return i(0===this.negative),this.iushln(t)},r.prototype.iushrn=function(t,e,s){var r;i("number"==typeof t&&t>=0),r=e?(e-e%26)/26:0;var n=t%26,o=Math.min((t-n)/26,this.length),a=67108863^67108863>>>n<<n,h=s;if(r-=o,r=Math.max(0,r),h){for(var l=0;l<o;l++)h.words[l]=this.words[l];h.length=o}if(0===o);else if(this.length>o)for(this.length-=o,l=0;l<this.length;l++)this.words[l]=this.words[l+o];else this.words[0]=0,this.length=1;var c=0;for(l=this.length-1;l>=0&&(0!==c||l>=r);l--){var u=0|this.words[l];this.words[l]=c<<26-n|u>>>n,c=u&a}return h&&0!==c&&(h.words[h.length++]=c),0===this.length&&(this.words[0]=0,this.length=1),this.bH()},r.prototype.ishrn=function(t,e,s){return i(0===this.negative),this.iushrn(t,e,s)},r.prototype.shln=function(t){return this.clone().ishln(t)},r.prototype.ushln=function(t){return this.clone().iushln(t)},r.prototype.shrn=function(t){return this.clone().ishrn(t)},r.prototype.ushrn=function(t){return this.clone().iushrn(t)},r.prototype.testn=function(t){i("number"==typeof t&&t>=0);var e=t%26,s=(t-e)/26,r=1<<e;return!(this.length<=s||!(this.words[s]&r))},r.prototype.imaskn=function(t){i("number"==typeof t&&t>=0);var e=t%26,s=(t-e)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=s)return this;if(0!==e&&s++,this.length=Math.min(s,this.length),0!==e){var r=67108863^67108863>>>e<<e;this.words[this.length-1]&=r}return this.bH()},r.prototype.maskn=function(t){return this.clone().imaskn(t)},r.prototype.iaddn=function(t){return i("number"==typeof t),i(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this.MH(t)},r.prototype.MH=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},r.prototype.isubn=function(t){if(i("number"==typeof t),i(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.bH()},r.prototype.addn=function(t){return this.clone().iaddn(t)},r.prototype.subn=function(t){return this.clone().isubn(t)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype.LH=function(t,e,s){var r,n,o=t.length+s;this._H(o);var a=0;for(r=0;r<t.length;r++){n=(0|this.words[r+s])+a;var h=(0|t.words[r])*e;a=((n-=67108863&h)>>26)-(h/67108864|0),this.words[r+s]=67108863&n}for(;r<this.length-s;r++)a=(n=(0|this.words[r+s])+a)>>26,this.words[r+s]=67108863&n;if(0===a)return this.bH();for(i(-1===a),a=0,r=0;r<this.length;r++)a=(n=-(0|this.words[r])+a)>>26,this.words[r]=67108863&n;return this.negative=1,this.bH()},r.prototype.PH=function(t,e){var i=(this.length,t.length),s=this.clone(),n=t,o=0|n.words[n.length-1];0!=(i=26-this.FH(o))&&(n=n.ushln(i),s.iushln(i),o=0|n.words[n.length-1]);var a,h=s.length-n.length;if("mod"!==e){(a=new r(null)).length=h+1,a.words=new Array(a.length);for(var l=0;l<a.length;l++)a.words[l]=0}var c=s.clone().LH(n,1,h);0===c.negative&&(s=c,a&&(a.words[h]=1));for(var u=h-1;u>=0;u--){var d=67108864*(0|s.words[n.length+u])+(0|s.words[n.length+u-1]);for(d=Math.min(d/o|0,67108863),s.LH(n,d,u);0!==s.negative;)d--,s.negative=0,s.LH(n,1,u),s.isZero()||(s.negative^=1);a&&(a.words[u]=d)}return a&&a.bH(),s.bH(),"div"!==e&&0!==i&&s.iushrn(i),{div:a||null,mod:s}},r.prototype.divmod=function(t,e,s){return i(!t.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(n=a.div.neg()),"div"!==e&&(o=a.mod.neg(),s&&0!==o.negative&&o.iadd(t)),{div:n,mod:o}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(n=a.div.neg()),{div:n,mod:a.mod}):this.negative&t.negative?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(o=a.mod.neg(),s&&0!==o.negative&&o.isub(t)),{div:a.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new r(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new r(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new r(this.modrn(t.words[0]))}:this.PH(t,e);var n,o,a},r.prototype.div=function(t){return this.divmod(t,"div",!1).div},r.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},r.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},r.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=0!==e.div.negative?e.mod.isub(t):e.mod,s=t.ushrn(1),r=t.andln(1),n=i.cmp(s);return n<0||1===r&&0===n?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},r.prototype.modrn=function(t){var e=t<0;e&&(t=-t),i(t<=67108863);for(var s=(1<<26)%t,r=0,n=this.length-1;n>=0;n--)r=(s*r+(0|this.words[n]))%t;return e?-r:r},r.prototype.modn=function(t){return this.modrn(t)},r.prototype.idivn=function(t){var e=t<0;e&&(t=-t),i(t<=67108863);for(var s=0,r=this.length-1;r>=0;r--){var n=(0|this.words[r])+67108864*s;this.words[r]=n/t|0,s=n%t}return this.bH(),e?this.ineg():this},r.prototype.divn=function(t){return this.clone().idivn(t)},r.prototype.egcd=function(t){i(0===t.negative),i(!t.isZero());var e=this,s=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n=new r(1),o=new r(0),a=new r(0),h=new r(1),l=0;e.isEven()&&s.isEven();)e.iushrn(1),s.iushrn(1),++l;for(var c=s.clone(),u=e.clone();!e.isZero();){for(var d=0,f=1;!(e.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(e.iushrn(d);d-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(c),o.isub(u)),n.iushrn(1),o.iushrn(1);for(var g=0,p=1;!(s.words[0]&p)&&g<26;++g,p<<=1);if(g>0)for(s.iushrn(g);g-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(c),h.isub(u)),a.iushrn(1),h.iushrn(1);e.cmp(s)>=0?(e.isub(s),n.isub(a),o.isub(h)):(s.isub(e),a.isub(n),h.isub(o))}return{a,b:h,gcd:s.iushln(l)}},r.prototype.BH=function(t){i(0===t.negative),i(!t.isZero());var e=this,s=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n,o=new r(1),a=new r(0),h=s.clone();e.cmpn(1)>0&&s.cmpn(1)>0;){for(var l=0,c=1;!(e.words[0]&c)&&l<26;++l,c<<=1);if(l>0)for(e.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);for(var u=0,d=1;!(s.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(s.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);e.cmp(s)>=0?(e.isub(s),o.isub(a)):(s.isub(e),a.isub(o))}return(n=0===e.cmpn(1)?o:a).cmpn(0)<0&&n.iadd(t),n},r.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var s=0;e.isEven()&&i.isEven();s++)e.iushrn(1),i.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=e.cmp(i);if(r<0){var n=e;e=i,i=n}else if(0===r||0===i.cmpn(1))break;e.isub(i)}return i.iushln(s)},r.prototype.invm=function(t){return this.egcd(t).a.umod(t)},r.prototype.isEven=function(){return!(1&this.words[0])},r.prototype.isOdd=function(){return!(1&~this.words[0])},r.prototype.andln=function(t){return this.words[0]&t},r.prototype.bincn=function(t){i("number"==typeof t);var e=t%26,s=(t-e)/26,r=1<<e;if(this.length<=s)return this._H(s+1),this.words[s]|=r,this;for(var n=r,o=s;0!==n&&o<this.length;o++){var a=0|this.words[o];n=(a+=n)>>>26,a&=67108863,this.words[o]=a}return 0!==n&&(this.words[o]=n,this.length++),this},r.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},r.prototype.cmpn=function(t){var e,s=t<0;if(0!==this.negative&&!s)return-1;if(0===this.negative&&s)return 1;if(this.bH(),this.length>1)e=1;else{s&&(t=-t),i(t<=67108863,"Number is too big");var r=0|this.words[0];e=r===t?0:r<t?-1:1}return 0!==this.negative?0|-e:e},r.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},r.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,i=this.length-1;i>=0;i--){var s=0|this.words[i],r=0|t.words[i];if(s!==r){s<r?e=-1:s>r&&(e=1);break}}return e},r.prototype.gtn=function(t){return 1===this.cmpn(t)},r.prototype.gt=function(t){return 1===this.cmp(t)},r.prototype.gten=function(t){return this.cmpn(t)>=0},r.prototype.gte=function(t){return this.cmp(t)>=0},r.prototype.ltn=function(t){return-1===this.cmpn(t)},r.prototype.lt=function(t){return-1===this.cmp(t)},r.prototype.lten=function(t){return this.cmpn(t)<=0},r.prototype.lte=function(t){return this.cmp(t)<=0},r.prototype.eqn=function(t){return 0===this.cmpn(t)},r.prototype.eq=function(t){return 0===this.cmp(t)},r.red=function(t){return new M(t)},r.prototype.toRed=function(t){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),t.convertTo(this).DH(t)},r.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype.DH=function(t){return this.red=t,this},r.prototype.forceRed=function(t){return i(!this.red,"Already a number in reduction context"),this.DH(t)},r.prototype.redAdd=function(t){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},r.prototype.redIAdd=function(t){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},r.prototype.redSub=function(t){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},r.prototype.redISub=function(t){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},r.prototype.redShl=function(t){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},r.prototype.redMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red.EH(this,t),this.red.mul(this,t)},r.prototype.redIMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red.EH(this,t),this.red.imul(this,t)},r.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red.RH(this),this.red.sqr(this)},r.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red.RH(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red.RH(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red.RH(this),this.red.invm(this)},r.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red.RH(this),this.red.neg(this)},r.prototype.redPow=function(t){return i(this.red&&!t.red,"redPow(normalNum)"),this.red.RH(this),this.red.pow(this,t)};var y={k256:null,p224:null,p192:null,p25519:null};function x(t,e){this.name=t,this.p=new r(e,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this.OH()}function v(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function A(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function b(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(t){if("string"==typeof t){var e=r.zH(t);this.m=e.p,this.prime=e}else i(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function E(t){M.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r.BH(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}x.prototype.OH=function(){var t=new r(null);return t.words=new Array(Math.ceil(this.n/13)),t},x.prototype.ireduce=function(t){var e,i=t;do{this.split(i,this.tmp),e=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(e>this.n);var s=e<this.n?-1:i.ucmp(this.p);return 0===s?(i.words[0]=0,i.length=1):s>0?i.isub(this.p):void 0!==i.strip?i.strip():i.bH(),i},x.prototype.split=function(t,e){t.iushrn(this.n,0,e)},x.prototype.imulK=function(t){return t.imul(this.k)},s(v,x),v.prototype.split=function(t,e){for(var i=4194303,s=Math.min(t.length,9),r=0;r<s;r++)e.words[r]=t.words[r];if(e.length=s,t.length<=9)return t.words[0]=0,void(t.length=1);var n=t.words[9];for(e.words[e.length++]=n&i,r=10;r<t.length;r++){var o=0|t.words[r];t.words[r-10]=(o&i)<<4|n>>>22,n=o}n>>>=22,t.words[r-10]=n,0===n&&t.length>10?t.length-=10:t.length-=9},v.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var s=0|t.words[i];e+=977*s,t.words[i]=67108863&e,e=64*s+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},s(A,x),s(S,x),s(b,x),b.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var s=19*(0|t.words[i])+e,r=67108863&s;s>>>=26,t.words[i]=r,e=s}return 0!==e&&(t.words[t.length++]=e),t},r.zH=function(t){if(y[t])return y[t];var e;if("k256"===t)e=new v;else if("p224"===t)e=new A;else if("p192"===t)e=new S;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new b}return y[t]=e,e},M.prototype.RH=function(t){i(0===t.negative,"red works only with positives"),i(t.red,"red works only with red numbers")},M.prototype.EH=function(t,e){i(!(t.negative|e.negative),"red works only with positives"),i(t.red&&t.red===e.red,"red works only with red numbers")},M.prototype.imod=function(t){return this.prime?this.prime.ireduce(t).DH(this):(h(t,t.umod(this.m).DH(this)),t)},M.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t).DH(this)},M.prototype.add=function(t,e){this.EH(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i.DH(this)},M.prototype.iadd=function(t,e){this.EH(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},M.prototype.sub=function(t,e){this.EH(t,e);var i=t.sub(e);return i.cmpn(0)<0&&i.iadd(this.m),i.DH(this)},M.prototype.isub=function(t,e){this.EH(t,e);var i=t.isub(e);return i.cmpn(0)<0&&i.iadd(this.m),i},M.prototype.shl=function(t,e){return this.RH(t),this.imod(t.ushln(e))},M.prototype.imul=function(t,e){return this.EH(t,e),this.imod(t.imul(e))},M.prototype.mul=function(t,e){return this.EH(t,e),this.imod(t.mul(e))},M.prototype.isqr=function(t){return this.imul(t,t.clone())},M.prototype.sqr=function(t){return this.mul(t,t)},M.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(i(e%2==1),3===e){var s=this.m.add(new r(1)).iushrn(2);return this.pow(t,s)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);i(!n.isZero());var a=new r(1).toRed(this),h=a.redNeg(),l=this.m.subn(1).iushrn(1),c=this.m.bitLength();for(c=new r(2*c*c).toRed(this);0!==this.pow(c,l).cmp(h);)c.redIAdd(h);for(var u=this.pow(c,n),d=this.pow(t,n.addn(1).iushrn(1)),f=this.pow(t,n),g=o;0!==f.cmp(a);){for(var p=f,m=0;0!==p.cmp(a);m++)p=p.redSqr();i(m<g);var y=this.pow(u,new r(1).iushln(g-m-1));d=d.redMul(y),u=y.redSqr(),f=f.redMul(u),g=m}return d},M.prototype.invm=function(t){var e=t.BH(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},M.prototype.pow=function(t,e){if(e.isZero())return new r(1).toRed(this);if(0===e.cmpn(1))return t.clone();var i=new Array(16);i[0]=new r(1).toRed(this),i[1]=t;for(var s=2;s<i.length;s++)i[s]=this.mul(i[s-1],t);var n=i[0],o=0,a=0,h=e.bitLength()%26;for(0===h&&(h=26),s=e.length-1;s>=0;s--){for(var l=e.words[s],c=h-1;c>=0;c--){var u=l>>c&1;n!==i[0]&&(n=this.sqr(n)),0!==u||0!==o?(o<<=1,o|=u,(4==++a||0===s&&0===c)&&(n=this.mul(n,i[o]),a=0,o=0)):a=0}h=26}return n},M.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},M.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},r.mont=function(t){return new E(t)},s(E,M),E.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},E.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},E.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),s=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(s).iushrn(this.shift),n=r;return r.cmp(this.m)>=0?n=r.isub(this.m):r.cmpn(0)<0&&(n=r.iadd(this.m)),n.DH(this)},E.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new r(0).DH(this);var i=t.mul(e),s=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(s).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):n.cmpn(0)<0&&(o=n.iadd(this.m)),o.DH(this)},E.prototype.invm=function(t){return this.imod(t.BH(this.m).mul(this.r2)).DH(this)}}(0,Gy);var Zy=Yy.exports;function Wy(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];const i=[];if("string"!=typeof t){for(let e=0;e<t.length;e++)i[e]=0|t[e];return i}if("hex"===e){(t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t=`0${t}`);for(let e=0;e<t.length;e+=2)i.push(parseInt(t[e]+t[e+1],16))}else for(let e=0;e<t.length;e++){const s=t.charCodeAt(e),r=s>>8,n=255&s;r?i.push(r,n):i.push(n)}return i}const jy=function(t,e,i){const s=new Array(Math.max(t.bitLength(),i)+1);s.fill(0);const r=1<<e+1,n=t.clone();for(let t=0;t<s.length;t++){let e;const i=n.andln(r-1);n.isOdd()?(e=i>(r>>1)-1?(r>>1)-i:i,n.isubn(e)):e=0,s[t]=e,n.iushrn(1)}return s},Hy=function(t,e){const i=[[],[]];t=t.clone(),e=e.clone();let s=0,r=0;for(;t.cmpn(-s)>0||e.cmpn(-r)>0;){let n,o,a=t.andln(3)+s&3,h=e.andln(3)+r&3;if(3===a&&(a=-1),3===h&&(h=-1),1&a){const e=t.andln(7)+s&7;n=3!==e&&5!==e||2!==h?a:-a}else n=0;if(i[0].push(n),1&h){const t=e.andln(7)+r&7;o=3!==t&&5!==t||2!==a?h:-h}else o=0;i[1].push(o),2*s===n+1&&(s=1-s),2*r===o+1&&(r=1-r),t.iushrn(1),e.iushrn(1)}return i};class $y{constructor(t,e){this.type=t,this.p=new Zy(e.p,16),this.red=e.prime?Zy.red(e.prime):Zy.mont(this.p),this.zero=new Zy(0).toRed(this.red),this.one=new Zy(1).toRed(this.red),this.two=new Zy(2).toRed(this.red),this.n=e.n&&new Zy(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this.VH=new Array(4),this.NH=new Array(4),this.GH=new Array(4),this.$H=new Array(4),this.UH=this.n?this.n.bitLength():0;const i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this.YH=!0,this.redN=this.n.toRed(this.red))}jH(t,e){const i=t.HH(),s=jy(e,1,this.UH);let r=(1<<i.step+1)-(i.step%2==0?2:1);r/=3;const n=[];for(let t=0;t<s.length;t+=i.step){let e=0;for(let r=t+i.step-1;r>=t;r--)e=(e<<1)+s[r];n.push(e)}let o=this.jpoint(null,null,null),a=this.jpoint(null,null,null);for(let t=r;t>0;t--){for(let e=0;e<n.length;e++){const s=n[e];s===t?a=a.mixedAdd(i.points[e]):s===-t&&(a=a.mixedAdd(i.points[e].neg()))}o=o.add(a)}return o.toP()}WH(t,e){let i=4;const s=t.XH(i);i=s.wnd;const r=s.points,n=jy(e,i,this.UH);let o=this.jpoint(null,null,null);for(let i=n.length-1;i>=0;i--){for(let t=0;i>=0&&0===n[i];i--)t++;if(i>=0&&e++,o=o.dblp(e),i<0)break;const s=n[i];o="affine"===t.type?s>0?o.mixedAdd(r[s-1>>1]):o.mixedAdd(r[-s-1>>1].neg()):s>0?o.add(r[s-1>>1]):o.add(r[-s-1>>1].neg())}return"affine"===t.type?o.toP():o}ZH(t,e,i,s,r){const n=this.VH,o=this.NH,a=this.GH;let h=0;for(let i=0;i<s;i++){const s=e[i].XH(t);n[i]=s.wnd,o[i]=s.points}for(let t=s-1;t>=1;t-=2){const s=t-1,r=t;if(1!==n[s]||1!==n[r]){a[s]=jy(i[s],n[s],this.UH),a[r]=jy(i[r],n[r],this.UH),h=Math.max(a[s].length,h),h=Math.max(a[r].length,h);continue}const l=[e[s],null,null,e[r]];0===e[s].y.cmp(e[r].y)?(l[1]=e[s].add(e[r]),l[2]=e[s].toJ().mixedAdd(e[r].neg())):0===e[s].y.cmp(e[r].y.redNeg())?(l[1]=e[s].toJ().mixedAdd(e[r]),l[2]=e[s].add(e[r].neg())):(l[1]=e[s].toJ().mixedAdd(e[r]),l[2]=e[s].toJ().mixedAdd(e[r].neg()));const c=[-3,-1,-5,-7,0,7,5,1,3],u=Hy(i[s],i[r]);h=Math.max(u[0].length,h),a[s]=new Array(h),a[r]=new Array(h);for(let t=0;t<h;t++){const e=0|u[0][t],i=0|u[1][t];a[s][t]=c[3*(e+1)+(i+1)],a[r][t]=0,o[s]=l}}let l=this.jpoint(null,null,null);const c=this.$H;for(let t=h;t>=0;t--){let e=0;for(;t>=0;){let i=!0;for(let e=0;e<s;e++)c[e]=0|a[e][t],0!==c[e]&&(i=!1);if(!i)break;e++,t--}if(t>=0&&e++,l=l.dblp(e),t<0)break;for(let t=0;t<s;t++){const e=c[t];let i;0!==e&&(e>0?i=o[t][e-1>>1]:e<0&&(i=o[t][-e-1>>1].neg()),l="affine"===i.type?l.mixedAdd(i):l.add(i))}}for(let t=0;t<s;t++)o[t]=null;return r?l:l.toP()}decodePoint(t,e){t=Wy(t,e);const i=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*i)return this.point(t.slice(1,1+i),t.slice(1+i,1+2*i));if((2===t[0]||3===t[0])&&t.length-1===i)return this.pointFromX(t.slice(1,1+i),3===t[0]);throw new Error("Unknown point format")}}class Xy{constructor(t,e){this.curve=t,this.type=e,this.precomputed=null}eq(t){throw new Error("Not implemented")}validate(){return this.curve.validate(this)}encodeCompressed(t){return this.encode(t,!0)}JH(t){const e=this.curve.p.byteLength(),i=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",e))}encode(t,e){return function(t,e){return"hex"===e?function(t){let e="";for(let s=0;s<t.length;s++)e+=1===(i=t[s].toString(16)).length?`0${i}`:i;var i;return e}(t):t}(this.JH(e),t)}precompute(t){if(this.precomputed)return this;const e={doubles:null,naf:null,beta:null};return e.naf=this.XH(8),e.doubles=this.HH(4,t),e.beta=this.QH(),this.precomputed=e,this}KH(t){if(!this.precomputed)return!1;const e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)}HH(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;const i=[this];let s=this;for(let r=0;r<e;r+=t){for(let e=0;e<t;e++)s=s.dbl();i.push(s)}return{step:t,points:i}}XH(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;const e=[this],i=(1<<t)-1,s=1===i?null:this.dbl();for(let t=1;t<i;t++)e[t]=e[t-1].add(s);return{wnd:t,points:e}}QH(){return null}dblp(t){let e=this;for(let i=0;i<t;i++)e=e.dbl();return e}}class qy extends $y{constructor(t){super("short",t),this.a=new Zy(t.a,16).toRed(this.red),this.b=new Zy(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this.qH(t),this.tW=new Array(4),this.iW=new Array(4)}pointFromJSON(t,e){return Ky.fromJSON(this,t,e)}qH(t){if(!this.zeroA||!this.g||!this.n||1!==this.p.modn(3))return;let e,i,s;if(t.beta)e=new Zy(t.beta,16).toRed(this.red);else{const t=this.sW(this.p);e=t[0].cmp(t[1])<0?t[0]:t[1],e=e.toRed(this.red)}if(t.lambda)i=new Zy(t.lambda,16);else{const t=this.sW(this.n);i=0===this.g.mul(t[0]).x.cmp(this.g.x.redMul(e))?t[0]:t[1]}return s=t.basis?t.basis.map(t=>({a:new Zy(t.a,16),b:new Zy(t.b,16)})):this.eW(i),{beta:e,lambda:i,basis:s}}sW(t){const e=t===this.p?this.red:Zy.mont(t),i=new Zy(2).toRed(e).redInvm(),s=i.redNeg(),r=new Zy(3).toRed(e).redNeg().redSqrt().redMul(i);return[s.redAdd(r).fromRed(),s.redSub(r).fromRed()]}eW(t){const e=this.n.ushrn(Math.floor(this.n.bitLength()/2));let i,s,r,n,o,a,h,l,c,u=t,d=this.n.clone(),f=new Zy(1),g=new Zy(0),p=new Zy(0),m=new Zy(1),y=0;for(;0!==u.cmpn(0);){const t=d.div(u);l=d.sub(t.mul(u)),c=p.sub(t.mul(f));const o=m.sub(t.mul(g));if(!r&&l.cmp(e)<0)i=h.neg(),s=f,r=l.neg(),n=c;else if(r&&2==++y)break;h=l,d=u,u=l,p=f,f=c,m=g,g=o}o=l.neg(),a=c;const x=r.sqr().add(n.sqr());return o.sqr().add(a.sqr()).cmp(x)>=0&&(o=i,a=s),r.negative&&(r=r.neg(),n=n.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:r,b:n},{a:o,b:a}]}rW(t){const e=this.endo.basis,i=e[0],s=e[1],r=s.b.mul(t).divRound(this.n),n=i.b.neg().mul(t).divRound(this.n),o=r.mul(i.a),a=n.mul(s.a),h=r.mul(i.b),l=n.mul(s.b);return{k1:t.sub(o).sub(a),k2:h.add(l).neg()}}point(t,e,i){return new Ky(this,t,e,i)}pointFromX(t,e){(t=new Zy(t,16)).red||(t=t.toRed(this.red));const i=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b);let s=i.redSqrt();if(0!==s.redSqr().redSub(i).cmp(this.zero))throw new Error("invalid point");const r=s.fromRed().isOdd();return(e&&!r||!e&&r)&&(s=s.redNeg()),this.point(t,s)}validate(t){if(t.inf)return!0;const e=t.x,i=t.y,s=this.a.redMul(e),r=e.redSqr().redMul(e).redIAdd(s).redIAdd(this.b);return 0===i.redSqr().redISub(r).cmpn(0)}hW(t,e,i){const s=this.tW,r=this.iW;let n=0;for(n=0;n<t.length;n++){const i=this.rW(e[n]);let o=t[n],a=o.QH();i.k1.negative&&(i.k1.ineg(),o=o.neg(!0)),i.k2.negative&&(i.k2.ineg(),a=a.neg(!0)),s[2*n]=o,s[2*n+1]=a,r[2*n]=i.k1,r[2*n+1]=i.k2}const o=this.ZH(1,s,r,2*n,i);for(let t=0;t<2*n;t++)s[t]=null,r[t]=null;return o}jpoint(t,e,i){return new Jy(this,t,e,i)}}class Ky extends Xy{constructor(t,e,i,s){super(t,"affine"),null===e&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new Zy(e,16),this.y=new Zy(i,16),s&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}pointFromX(t,e){throw new Error("Method not implemented.")}point(t,e,i){return new Ky(this,t,e,i)}QH(){if(!this.curve.endo)return;const t=this.precomputed;if(t&&t.beta)return t.beta;const e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){const i=this.curve,s=function(t){return i.point(t.x.redMul(i.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(s)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(s)}}}return e}toJSON(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]}static fromJSON(t,e,i){"string"==typeof e&&(e=JSON.parse(e));const s=t.point(e[0],e[1],i);if(!e[2])return s;function r(e){return t.point(e[0],e[1],i)}const n=e[2];return s.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[s].concat(n.doubles.points.map(r))},naf:n.naf&&{wnd:n.naf.wnd,points:[s].concat(n.naf.points.map(r))}},s}inspect(){return this.isInfinity()?"<EC Point Infinity>":`<EC Point x: ${this.x.fromRed().toString(16,2)} y: ${this.y.fromRed().toString(16,2)}>`}isInfinity(){return this.inf}add(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);let e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));const i=e.redSqr().redISub(this.x).redISub(t.x),s=e.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)}dbl(){if(this.inf)return this;const t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);const e=this.curve.a,i=this.x.redSqr(),s=t.redInvm(),r=i.redAdd(i).redIAdd(i).redIAdd(e).redMul(s),n=r.redSqr().redISub(this.x.redAdd(this.x)),o=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,o)}getX(){return this.x.fromRed()}getY(){return this.y.fromRed()}mul(t){return t=new Zy(t,16),this.isInfinity()?this:this.KH(t)?this.curve.jH(this,t):this.curve.endo?this.curve.hW([this],[t]):this.curve.WH(this,t)}mulAdd(t,e,i){const s=[this,e],r=[t,i];return this.curve.endo?this.curve.hW(s,r):this.curve.ZH(1,s,r,2)}jmulAdd(t,e,i){const s=[this,e],r=[t,i];return this.curve.endo?this.curve.hW(s,r,!0):this.curve.ZH(1,s,r,2,!0)}eq(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))}neg(t){if(this.inf)return this;const e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){const t=this.precomputed,i=function(t){return t.neg()};e.precomputed={naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return e}toJ(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)}}class Jy extends Xy{constructor(t,e,i,s){super(t,"jacobian"),null===e&&null===i&&null===s?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Zy(0)):(this.x=new Zy(e,16),this.y=new Zy(i,16),this.z=new Zy(s,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}getY(){throw new Error("Method not implemented.")}getX(){throw new Error("Method not implemented.")}pointFromX(t,e){throw new Error("Method not implemented.")}point(t,e,i){throw new Error("Method not implemented.")}jpoint(t,e,i){return new Jy(this,t,e,i)}toP(){if(this.isInfinity())return this.curve.point(null,null);const t=this.z.redInvm(),e=t.redSqr(),i=this.x.redMul(e),s=this.y.redMul(e).redMul(t);return this.curve.point(i,s)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(t){if(this.isInfinity())return t;if(t.isInfinity())return this;const e=t.z.redSqr(),i=this.z.redSqr(),s=this.x.redMul(e),r=t.x.redMul(i),n=this.y.redMul(e.redMul(t.z)),o=t.y.redMul(i.redMul(this.z)),a=s.redSub(r),h=n.redSub(o);if(0===a.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();const l=a.redSqr(),c=l.redMul(a),u=s.redMul(l),d=h.redSqr().redIAdd(c).redISub(u).redISub(u),f=h.redMul(u.redISub(d)).redISub(n.redMul(c)),g=this.z.redMul(t.z).redMul(a);return this.curve.jpoint(d,f,g)}mixedAdd(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;const e=this.z.redSqr(),i=this.x,s=t.x.redMul(e),r=this.y,n=t.y.redMul(e).redMul(this.z),o=i.redSub(s),a=r.redSub(n);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();const h=o.redSqr(),l=h.redMul(o),c=i.redMul(h),u=a.redSqr().redIAdd(l).redISub(c).redISub(c),d=a.redMul(c.redISub(u)).redISub(r.redMul(l)),f=this.z.redMul(o);return this.curve.jpoint(u,d,f)}dblp(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();if(this.curve.zeroA||this.curve.threeA){let e=this;for(let i=0;i<t;i++)e=e.dbl();return e}const e=this.curve.a,i=this.curve.tinv;let s=this.x;const r=this.y;let n=this.z,o=n.redSqr().redSqr(),a=r.redAdd(r);for(let i=0;i<t;i++){const r=s.redSqr(),h=a.redSqr(),l=h.redSqr(),c=r.redAdd(r).redIAdd(r).redIAdd(e.redMul(o)),u=s.redMul(h),d=c.redSqr().redISub(u.redAdd(u)),f=u.redISub(d);let g=c.redMul(f);g=g.redIAdd(g).redISub(l);const p=a.redMul(n);i+1<t&&(o=o.redMul(l)),s=d,n=p,a=g}return this.curve.jpoint(s,a.redMul(i),n)}dbl(){return this.isInfinity()?this:this.curve.zeroA?this.nW():this.curve.threeA?this.oW():this.aW()}nW(){let t,e,i;if(this.zOne){const s=this.x.redSqr(),r=this.y.redSqr(),n=r.redSqr();let o=this.x.redAdd(r).redSqr().redISub(s).redISub(n);o=o.redIAdd(o);const a=s.redAdd(s).redIAdd(s),h=a.redSqr().redISub(o).redISub(o);let l=n.redIAdd(n);l=l.redIAdd(l),l=l.redIAdd(l),t=h,e=a.redMul(o.redISub(h)).redISub(l),i=this.y.redAdd(this.y)}else{const s=this.x.redSqr(),r=this.y.redSqr(),n=r.redSqr();let o=this.x.redAdd(r).redSqr().redISub(s).redISub(n);o=o.redIAdd(o);const a=s.redAdd(s).redIAdd(s),h=a.redSqr();let l=n.redIAdd(n);l=l.redIAdd(l),l=l.redIAdd(l),t=h.redISub(o).redISub(o),e=a.redMul(o.redISub(t)).redISub(l),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(t,e,i)}oW(){let t,e,i;if(this.zOne){const s=this.x.redSqr(),r=this.y.redSqr(),n=r.redSqr();let o=this.x.redAdd(r).redSqr().redISub(s).redISub(n);o=o.redIAdd(o);const a=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),h=a.redSqr().redISub(o).redISub(o);t=h;let l=n.redIAdd(n);l=l.redIAdd(l),l=l.redIAdd(l),e=a.redMul(o.redISub(h)).redISub(l),i=this.y.redAdd(this.y)}else{const s=this.z.redSqr(),r=this.y.redSqr(),n=this.x.redMul(r);let o=this.x.redSub(s).redMul(this.x.redAdd(s));o=o.redAdd(o).redIAdd(o);let a=n.redIAdd(n);a=a.redIAdd(a);const h=a.redAdd(a);t=o.redSqr().redISub(h),i=this.y.redAdd(this.z).redSqr().redISub(r).redISub(s);let l=r.redSqr();l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l),e=o.redMul(a.redISub(t)).redISub(l)}return this.curve.jpoint(t,e,i)}aW(){const t=this.curve.a,e=this.x,i=this.y,s=this.z,r=s.redSqr().redSqr(),n=e.redSqr(),o=i.redSqr(),a=n.redAdd(n).redIAdd(n).redIAdd(t.redMul(r));let h=e.redAdd(e);h=h.redIAdd(h);const l=h.redMul(o),c=a.redSqr().redISub(l.redAdd(l)),u=l.redISub(c);let d=o.redSqr();d=d.redIAdd(d),d=d.redIAdd(d),d=d.redIAdd(d);const f=a.redMul(u).redISub(d),g=i.redAdd(i).redMul(s);return this.curve.jpoint(c,f,g)}trpl(){if(!this.curve.zeroA)return this.dbl().add(this);const t=this.x.redSqr(),e=this.y.redSqr(),i=this.z.redSqr(),s=e.redSqr(),r=t.redAdd(t).redIAdd(t),n=r.redSqr();let o=this.x.redAdd(e).redSqr().redISub(t).redISub(s);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(n);const a=o.redSqr();let h=s.redIAdd(s);h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);const l=r.redIAdd(o).redSqr().redISub(n).redISub(a).redISub(h);let c=e.redMul(l);c=c.redIAdd(c),c=c.redIAdd(c);let u=this.x.redMul(a).redISub(c);u=u.redIAdd(u),u=u.redIAdd(u);let d=this.y.redMul(l.redMul(h.redISub(l)).redISub(o.redMul(a)));d=d.redIAdd(d),d=d.redIAdd(d),d=d.redIAdd(d);const f=this.z.redAdd(o).redSqr().redISub(i).redISub(a);return this.curve.jpoint(u,d,f)}mul(t,e){return t=new Zy(t,e),this.curve.WH(this,t)}eq(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;const e=this.z.redSqr(),i=t.z.redSqr();if(0!==this.x.redMul(i).redISub(t.x.redMul(e)).cmpn(0))return!1;const s=e.redMul(this.z),r=i.redMul(t.z);return 0===this.y.redMul(r).redISub(t.y.redMul(s)).cmpn(0)}eqXToP(t){const e=this.z.redSqr(),i=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(i))return!0;const s=t.clone(),r=this.curve.redN.redMul(e);for(;;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(r),0===this.x.cmp(i))return!0}}inspect(){return this.isInfinity()?"<EC JPoint Infinity>":`<EC JPoint x: ${this.x.toString(16,2)} y: ${this.y.toString(16,2)} z: ${this.z.toString(16,2)}>`}isInfinity(){return 0===this.z.cmpn(0)}}class Qy{constructor(t){this.curve=new qy(t),this.g=this.curve.g,this.n=this.curve.n}}const tx={};var ex,ix;tx.PresetCurve=Qy,ex="secp256k1",ix={type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",{doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}]},Object.defineProperty(tx,ex,{configurable:!0,enumerable:!0,get(){const t=new Qy(ix);return Object.defineProperty(tx,ex,{configurable:!0,enumerable:!0,value:t}),t}});class sx{constructor(t,e){this.ec=t,this.priv=null,this.pub=null,e.pub&&this.lW(e.pub,e.pubEnc)}static fromPublic(t,e,i){return e instanceof sx?e:new sx(t,{pub:e,pubEnc:i})}validate(){const t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}}getPublic(t,e){return"string"==typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub}lW(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type||"short"===this.ec.curve.type||this.ec.curve.type,void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)}verify(t,e){return this.ec.verify(t,e,this)}}function rx(t,e){const i=t[e.place++];if(!(128&i))return i;const s=15&i;if(0===s||s>4)return!1;let r=0,n=e.place;for(let e=0;e<s;e++,n++)r<<=8,r|=t[n],r>>>=0;return!(r<=127)&&(e.place=n,r)}class nx{constructor(){this.place=0}}class ox{constructor(t,e){if(t instanceof ox)return t;this.uW(t,e)||(this.r=new Zy(t.r,16),this.s=new Zy(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}uW(t,e){t=Wy(t,e);const i=new nx;if(48!==t[i.place++])return!1;const s=rx(t,i);if(!1===s)return!1;if(s+i.place!==t.length)return!1;if(2!==t[i.place++])return!1;const r=rx(t,i);if(!1===r)return!1;let n=t.slice(i.place,r+i.place);if(i.place+=r,2!==t[i.place++])return!1;const o=rx(t,i);if(!1===o)return!1;if(t.length!==o+i.place)return!1;let a=t.slice(i.place,o+i.place);if(0===n[0]){if(!(128&n[1]))return!1;n=n.slice(1)}if(0===a[0]){if(!(128&a[1]))return!1;a=a.slice(1)}return this.r=new Zy(n),this.s=new Zy(a),this.recoveryParam=null,!0}}class ax{constructor(t){if(!(this instanceof ax))return new ax(t);"string"==typeof t&&(t=tx[t]),t instanceof tx.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1)}keyFromPublic(t,e){return sx.fromPublic(this,t,e)}cW(t,e){const i=8*t.byteLength()-this.n.bitLength();return i>0&&(t=t.ushrn(i)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t}verify(t,e,i,s){t=this.cW(new Zy(t,16)),i=this.keyFromPublic(i,s);const r=(e=new ox(e,"hex")).r,n=e.s;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return!1;if(n.cmpn(1)<0||n.cmp(this.n)>=0)return!1;const o=n.invm(this.n),a=o.mul(t).umod(this.n),h=o.mul(r).umod(this.n);if(!this.curve.YH){const t=this.g.mulAdd(a,i.getPublic(),h);return!t.isInfinity()&&0===t.getX().umod(this.n).cmp(r)}const l=this.g.jmulAdd(a,i.getPublic(),h);return!l.isInfinity()&&l.eqXToP(r)}}var hx,lx={exports:{}},cx={exports:{}};cx.exports=(hx=hx||function(t,e){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&void 0!==Gy&&Gy.crypto&&(i=Gy.crypto),!i)try{i=e}catch(t){}var s=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function t(){}return function(e){var i;return t.prototype=e,i=new t,t.prototype=null,i}}(),n={},o=n.lib={},a=o.Base={extend:function(t){var e=r(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},h=o.WordArray=a.extend({init:function(t,i){t=this.words=t||[],this.sigBytes=i!=e?i:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,i=t.words,s=this.sigBytes,r=t.sigBytes;if(this.clamp(),s%4)for(var n=0;n<r;n++){var o=i[n>>>2]>>>24-n%4*8&255;e[s+n>>>2]|=o<<24-(s+n)%4*8}else for(var a=0;a<r;a+=4)e[s+a>>>2]=i[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],i=0;i<t;i+=4)e.push(s());return new h.init(e,t)}}),l=n.enc={},c=l.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,s=[],r=0;r<i;r++){var n=e[r>>>2]>>>24-r%4*8&255;s.push((n>>>4).toString(16)),s.push((15&n).toString(16))}return s.join("")},parse:function(t){for(var e=t.length,i=[],s=0;s<e;s+=2)i[s>>>3]|=parseInt(t.substr(s,2),16)<<24-s%8*4;return new h.init(i,e/2)}},u=l.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,s=[],r=0;r<i;r++){var n=e[r>>>2]>>>24-r%4*8&255;s.push(String.fromCharCode(n))}return s.join("")},parse:function(t){for(var e=t.length,i=[],s=0;s<e;s++)i[s>>>2]|=(255&t.charCodeAt(s))<<24-s%4*8;return new h.init(i,e)}},d=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},f=o.BufferedBlockAlgorithm=a.extend({reset:function(){this.yM=new h.init,this.dW=0},fW:function(t){"string"==typeof t&&(t=d.parse(t)),this.yM.concat(t),this.dW+=t.sigBytes},AW:function(e){var i,s=this.yM,r=s.words,n=s.sigBytes,o=this.blockSize,a=n/(4*o),l=(a=e?t.ceil(a):t.max((0|a)-this.gW,0))*o,c=t.min(4*l,n);if(l){for(var u=0;u<l;u+=o)this.pW(r,u);i=r.splice(0,l),s.sigBytes-=c}return new h.init(i,c)},clone:function(){var t=a.clone.call(this);return t.yM=this.yM.clone(),t},gW:0});o.Hasher=f.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this.vW()},update:function(t){return this.fW(t),this.AW(),this},finalize:function(t){return t&&this.fW(t),this.yW()},blockSize:16,mW:function(t){return function(e,i){return new t.init(i).finalize(e)}},xW:function(t){return function(e,i){return new g.HMAC.init(t,i).finalize(e)}}});var g=n.algo={};return n}(Math),hx);var ux={exports:{}};ux.exports=function(t){return function(e){var i=t,s=i.lib,r=s.WordArray,n=s.Hasher,o=i.algo,a=[],h=[];!function(){function t(t){for(var i=e.sqrt(t),s=2;s<=i;s++)if(!(t%s))return!1;return!0}function i(t){return 4294967296*(t-(0|t))|0}for(var s=2,r=0;r<64;)t(s)&&(r<8&&(a[r]=i(e.pow(s,.5))),h[r]=i(e.pow(s,1/3)),r++),s++}();var l=[],c=o.SHA256=n.extend({vW:function(){this.SW=new r.init(a.slice(0))},pW:function(t,e){for(var i=this.SW.words,s=i[0],r=i[1],n=i[2],o=i[3],a=i[4],c=i[5],u=i[6],d=i[7],f=0;f<64;f++){if(f<16)l[f]=0|t[e+f];else{var g=l[f-15],p=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,m=l[f-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[f]=p+l[f-7]+y+l[f-16]}var x=s&r^s&n^r&n,v=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),A=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&u)+h[f]+l[f];d=u,u=c,c=a,a=o+A|0,o=n,n=r,r=s,s=A+(v+x)|0}i[0]=i[0]+s|0,i[1]=i[1]+r|0,i[2]=i[2]+n|0,i[3]=i[3]+o|0,i[4]=i[4]+a|0,i[5]=i[5]+c|0,i[6]=i[6]+u|0,i[7]=i[7]+d|0},yW:function(){var t=this.yM,i=t.words,s=8*this.dW,r=8*t.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(r+64>>>9<<4)]=e.floor(s/4294967296),i[15+(r+64>>>9<<4)]=s,t.sigBytes=4*i.length,this.AW(),this.SW},clone:function(){var t=n.clone.call(this);return t.SW=this.SW.clone(),t}});i.SHA256=n.mW(c),i.HmacSHA256=n.xW(c)}(Math),t.SHA256}(cx.exports);var dx=ux.exports;lx.exports=function(t){return i=(e=t).lib.WordArray,s=e.algo,r=s.SHA256,n=s.SHA224=r.extend({vW:function(){this.SW=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},yW:function(){var t=r.yW.call(this);return t.sigBytes-=4,t}}),e.SHA224=r.mW(n),e.HmacSHA224=r.xW(n),t.SHA224;var e,i,s,r,n}(cx.exports);var fx=lx.exports,gx={exports:{}};gx.exports=cx.exports.enc.Hex;var px=gx.exports,mx={exports:{}};mx.exports=cx.exports.enc.Utf8;var yx,xx,vx,Ax=mx.exports,Sx={exports:{}};!function(t){return i=(e=t).lib.WordArray,e.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,s=this.bW;t.clamp();for(var r=[],n=0;n<i;n+=3)for(var o=(e[n>>>2]>>>24-n%4*8&255)<<16|(e[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|e[n+2>>>2]>>>24-(n+2)%4*8&255,a=0;a<4&&n+.75*a<i;a++)r.push(s.charAt(o>>>6*(3-a)&63));var h=s.charAt(64);if(h)for(;r.length%4;)r.push(h);return r.join("")},parse:function(t){var e=t.length,s=this.bW,r=this.MW;if(!r){r=this.MW=[];for(var n=0;n<s.length;n++)r[s.charCodeAt(n)]=n}var o=s.charAt(64);if(o){var a=t.indexOf(o);-1!==a&&(e=a)}return function(t,e,s){for(var r=[],n=0,o=0;o<e;o++)if(o%4){var a=s[t.charCodeAt(o-1)]<<o%4*2|s[t.charCodeAt(o)]>>>6-o%4*2;r[n>>>2]|=a<<24-n%4*8,n++}return i.create(r,n)}(t,e,r)},bW:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},t.enc.Base64;var e,i}(cx.exports),function(t){(function(e){var i=t,s=i.lib,r=s.WordArray,n=s.Hasher,o=i.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var h=o.MD5=n.extend({vW:function(){this.SW=new r.init([1732584193,4023233417,2562383102,271733878])},pW:function(t,e){for(var i=0;i<16;i++){var s=e+i,r=t[s];t[s]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var n=this.SW.words,o=t[e+0],h=t[e+1],f=t[e+2],g=t[e+3],p=t[e+4],m=t[e+5],y=t[e+6],x=t[e+7],v=t[e+8],A=t[e+9],S=t[e+10],b=t[e+11],M=t[e+12],E=t[e+13],k=t[e+14],T=t[e+15],w=n[0],C=n[1],B=n[2],F=n[3];w=l(w,C,B,F,o,7,a[0]),F=l(F,w,C,B,h,12,a[1]),B=l(B,F,w,C,f,17,a[2]),C=l(C,B,F,w,g,22,a[3]),w=l(w,C,B,F,p,7,a[4]),F=l(F,w,C,B,m,12,a[5]),B=l(B,F,w,C,y,17,a[6]),C=l(C,B,F,w,x,22,a[7]),w=l(w,C,B,F,v,7,a[8]),F=l(F,w,C,B,A,12,a[9]),B=l(B,F,w,C,S,17,a[10]),C=l(C,B,F,w,b,22,a[11]),w=l(w,C,B,F,M,7,a[12]),F=l(F,w,C,B,E,12,a[13]),B=l(B,F,w,C,k,17,a[14]),w=c(w,C=l(C,B,F,w,T,22,a[15]),B,F,h,5,a[16]),F=c(F,w,C,B,y,9,a[17]),B=c(B,F,w,C,b,14,a[18]),C=c(C,B,F,w,o,20,a[19]),w=c(w,C,B,F,m,5,a[20]),F=c(F,w,C,B,S,9,a[21]),B=c(B,F,w,C,T,14,a[22]),C=c(C,B,F,w,p,20,a[23]),w=c(w,C,B,F,A,5,a[24]),F=c(F,w,C,B,k,9,a[25]),B=c(B,F,w,C,g,14,a[26]),C=c(C,B,F,w,v,20,a[27]),w=c(w,C,B,F,E,5,a[28]),F=c(F,w,C,B,f,9,a[29]),B=c(B,F,w,C,x,14,a[30]),w=u(w,C=c(C,B,F,w,M,20,a[31]),B,F,m,4,a[32]),F=u(F,w,C,B,v,11,a[33]),B=u(B,F,w,C,b,16,a[34]),C=u(C,B,F,w,k,23,a[35]),w=u(w,C,B,F,h,4,a[36]),F=u(F,w,C,B,p,11,a[37]),B=u(B,F,w,C,x,16,a[38]),C=u(C,B,F,w,S,23,a[39]),w=u(w,C,B,F,E,4,a[40]),F=u(F,w,C,B,o,11,a[41]),B=u(B,F,w,C,g,16,a[42]),C=u(C,B,F,w,y,23,a[43]),w=u(w,C,B,F,A,4,a[44]),F=u(F,w,C,B,M,11,a[45]),B=u(B,F,w,C,T,16,a[46]),w=d(w,C=u(C,B,F,w,f,23,a[47]),B,F,o,6,a[48]),F=d(F,w,C,B,x,10,a[49]),B=d(B,F,w,C,k,15,a[50]),C=d(C,B,F,w,m,21,a[51]),w=d(w,C,B,F,M,6,a[52]),F=d(F,w,C,B,g,10,a[53]),B=d(B,F,w,C,S,15,a[54]),C=d(C,B,F,w,h,21,a[55]),w=d(w,C,B,F,v,6,a[56]),F=d(F,w,C,B,T,10,a[57]),B=d(B,F,w,C,y,15,a[58]),C=d(C,B,F,w,E,21,a[59]),w=d(w,C,B,F,p,6,a[60]),F=d(F,w,C,B,b,10,a[61]),B=d(B,F,w,C,f,15,a[62]),C=d(C,B,F,w,A,21,a[63]),n[0]=n[0]+w|0,n[1]=n[1]+C|0,n[2]=n[2]+B|0,n[3]=n[3]+F|0},yW:function(){var t=this.yM,i=t.words,s=8*this.dW,r=8*t.sigBytes;i[r>>>5]|=128<<24-r%32;var n=e.floor(s/4294967296),o=s;i[15+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),i[14+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),t.sigBytes=4*(i.length+1),this.AW();for(var a=this.SW,h=a.words,l=0;l<4;l++){var c=h[l];h[l]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return a},clone:function(){var t=n.clone.call(this);return t.SW=this.SW.clone(),t}});function l(t,e,i,s,r,n,o){var a=t+(e&i|~e&s)+r+o;return(a<<n|a>>>32-n)+e}function c(t,e,i,s,r,n,o){var a=t+(e&s|i&~s)+r+o;return(a<<n|a>>>32-n)+e}function u(t,e,i,s,r,n,o){var a=t+(e^i^s)+r+o;return(a<<n|a>>>32-n)+e}function d(t,e,i,s,r,n,o){var a=t+(i^(e|~s))+r+o;return(a<<n|a>>>32-n)+e}i.MD5=n.mW(h),i.HmacMD5=n.xW(h)})(Math),t.MD5}(cx.exports),function(t){return i=(e=t).lib,s=i.WordArray,r=i.Hasher,n=e.algo,o=[],a=n.SHA1=r.extend({vW:function(){this.SW=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},pW:function(t,e){for(var i=this.SW.words,s=i[0],r=i[1],n=i[2],a=i[3],h=i[4],l=0;l<80;l++){if(l<16)o[l]=0|t[e+l];else{var c=o[l-3]^o[l-8]^o[l-14]^o[l-16];o[l]=c<<1|c>>>31}var u=(s<<5|s>>>27)+h+o[l];u+=l<20?1518500249+(r&n|~r&a):l<40?1859775393+(r^n^a):l<60?(r&n|r&a|n&a)-1894007588:(r^n^a)-899497514,h=a,a=n,n=r<<30|r>>>2,r=s,s=u}i[0]=i[0]+s|0,i[1]=i[1]+r|0,i[2]=i[2]+n|0,i[3]=i[3]+a|0,i[4]=i[4]+h|0},yW:function(){var t=this.yM,e=t.words,i=8*this.dW,s=8*t.sigBytes;return e[s>>>5]|=128<<24-s%32,e[14+(s+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(s+64>>>9<<4)]=i,t.sigBytes=4*e.length,this.AW(),this.SW},clone:function(){var t=r.clone.call(this);return t.SW=this.SW.clone(),t}}),e.SHA1=r.mW(a),e.HmacSHA1=r.xW(a),t.SHA1;var e,i,s,r,n,o,a}(cx.exports),xx=(yx=cx.exports).lib.Base,vx=yx.enc.Utf8,yx.algo.HMAC=xx.extend({init:function(t,e){t=this.wW=new t.init,"string"==typeof e&&(e=vx.parse(e));var i=t.blockSize,s=4*i;e.sigBytes>s&&(e=t.finalize(e)),e.clamp();for(var r=this._W=e.clone(),n=this.kW=e.clone(),o=r.words,a=n.words,h=0;h<i;h++)o[h]^=1549556828,a[h]^=909522486;r.sigBytes=n.sigBytes=s,this.reset()},reset:function(){var t=this.wW;t.reset(),t.update(this.kW)},update:function(t){return this.wW.update(t),this},finalize:function(t){var e=this.wW,i=e.finalize(t);return e.reset(),e.finalize(this._W.clone().concat(i))}}),function(t){return s=(i=(e=t).lib).Base,r=i.WordArray,o=(n=e.algo).MD5,a=n.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:o,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i,s=this.cfg,n=s.hasher.create(),o=r.create(),a=o.words,h=s.keySize,l=s.iterations;a.length<h;){i&&n.update(i),i=n.update(t).finalize(e),n.reset();for(var c=1;c<l;c++)i=n.finalize(i),n.reset();o.concat(i)}return o.sigBytes=4*h,o}}),e.EvpKDF=function(t,e,i){return a.create(i).compute(t,e)},t.EvpKDF;var e,i,s,r,n,o,a}(cx.exports),function(t){t.lib.Cipher||function(){var e=t,i=e.lib,s=i.Base,r=i.WordArray,n=i.BufferedBlockAlgorithm,o=e.enc;o.Utf8;var a=o.Base64,h=e.algo.EvpKDF,l=i.Cipher=n.extend({cfg:s.extend(),createEncryptor:function(t,e){return this.create(this.TW,t,e)},createDecryptor:function(t,e){return this.create(this.FW,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this.IW=t,this.LW=e,this.reset()},reset:function(){n.reset.call(this),this.vW()},process:function(t){return this.fW(t),this.AW()},finalize:function(t){return t&&this.fW(t),this.yW()},keySize:4,ivSize:4,TW:1,FW:2,mW:function(){function t(t){return"string"==typeof t?x:m}return function(e){return{encrypt:function(i,s,r){return t(s).encrypt(e,i,s,r)},decrypt:function(i,s,r){return t(s).decrypt(e,i,s,r)}}}}()});i.StreamCipher=l.extend({yW:function(){return this.AW(!0)},blockSize:1});var c=e.mode={},u=i.BlockCipherMode=s.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this.PW=t,this.BW=e}}),d=c.CBC=function(){var t=u.extend();function e(t,e,i){var s,r=this.BW;r?(s=r,this.BW=void 0):s=this.DW;for(var n=0;n<i;n++)t[e+n]^=s[n]}return t.Encryptor=t.extend({processBlock:function(t,i){var s=this.PW,r=s.blockSize;e.call(this,t,i,r),s.encryptBlock(t,i),this.DW=t.slice(i,i+r)}}),t.Decryptor=t.extend({processBlock:function(t,i){var s=this.PW,r=s.blockSize,n=t.slice(i,i+r);s.decryptBlock(t,i),e.call(this,t,i,r),this.DW=n}}),t}(),f=(e.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,s=i-t.sigBytes%i,n=s<<24|s<<16|s<<8|s,o=[],a=0;a<s;a+=4)o.push(n);var h=r.create(o,s);t.concat(h)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}};i.BlockCipher=l.extend({cfg:l.cfg.extend({mode:d,padding:f}),reset:function(){var t;l.reset.call(this);var e=this.cfg,i=e.iv,s=e.mode;this.IW==this.TW?t=s.createEncryptor:(t=s.createDecryptor,this.gW=1),this.EW&&this.EW.RW==t?this.EW.init(this,i&&i.words):(this.EW=t.call(s,this,i&&i.words),this.EW.RW=t)},pW:function(t,e){this.EW.processBlock(t,e)},yW:function(){var t,e=this.cfg.padding;return this.IW==this.TW?(e.pad(this.yM,this.blockSize),t=this.AW(!0)):(t=this.AW(!0),e.unpad(t)),t},blockSize:4});var g=i.CipherParams=s.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),p=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,i=t.salt;return(i?r.create([1398893684,1701076831]).concat(i).concat(e):e).toString(a)},parse:function(t){var e,i=a.parse(t),s=i.words;return 1398893684==s[0]&&1701076831==s[1]&&(e=r.create(s.slice(2,4)),s.splice(0,4),i.sigBytes-=16),g.create({ciphertext:i,salt:e})}},m=i.SerializableCipher=s.extend({cfg:s.extend({format:p}),encrypt:function(t,e,i,s){s=this.cfg.extend(s);var r=t.createEncryptor(i,s),n=r.finalize(e),o=r.cfg;return g.create({ciphertext:n,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:s.format})},decrypt:function(t,e,i,s){return s=this.cfg.extend(s),e=this.OW(e,s.format),t.createDecryptor(i,s).finalize(e.ciphertext)},OW:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),y=(e.kdf={}).OpenSSL={execute:function(t,e,i,s){s||(s=r.random(8));var n=h.create({keySize:e+i}).compute(t,s),o=r.create(n.words.slice(e),4*i);return n.sigBytes=4*e,g.create({key:n,iv:o,salt:s})}},x=i.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:y}),encrypt:function(t,e,i,s){var r=(s=this.cfg.extend(s)).kdf.execute(i,t.keySize,t.ivSize);s.iv=r.iv;var n=m.encrypt.call(this,t,e,r.key,s);return n.mixIn(r),n},decrypt:function(t,e,i,s){s=this.cfg.extend(s),e=this.OW(e,s.format);var r=s.kdf.execute(i,t.keySize,t.ivSize,e.salt);return s.iv=r.iv,m.decrypt.call(this,t,e,r.key,s)}})}()}(cx.exports),Sx.exports=function(t){return function(){var e=t,i=e.lib.BlockCipher,s=e.algo,r=[],n=[],o=[],a=[],h=[],l=[],c=[],u=[],d=[],f=[];!function(){for(var t=[],e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;var i=0,s=0;for(e=0;e<256;e++){var g=s^s<<1^s<<2^s<<3^s<<4;g=g>>>8^255&g^99,r[i]=g,n[g]=i;var p=t[i],m=t[p],y=t[m],x=257*t[g]^16843008*g;o[i]=x<<24|x>>>8,a[i]=x<<16|x>>>16,h[i]=x<<8|x>>>24,l[i]=x,x=16843009*y^65537*m^257*p^16843008*i,c[g]=x<<24|x>>>8,u[g]=x<<16|x>>>16,d[g]=x<<8|x>>>24,f[g]=x,i?(i=p^t[t[t[y^p]]],s^=t[t[s]]):i=s=1}}();var g=[0,1,2,4,8,16,32,64,128,27,54],p=s.AES=i.extend({vW:function(){if(!this.zW||this.VW!==this.LW){for(var t=this.VW=this.LW,e=t.words,i=t.sigBytes/4,s=4*((this.zW=i+6)+1),n=this.NW=[],o=0;o<s;o++)o<i?n[o]=e[o]:(l=n[o-1],o%i?i>6&&o%i==4&&(l=r[l>>>24]<<24|r[l>>>16&255]<<16|r[l>>>8&255]<<8|r[255&l]):(l=r[(l=l<<8|l>>>24)>>>24]<<24|r[l>>>16&255]<<16|r[l>>>8&255]<<8|r[255&l],l^=g[o/i|0]<<24),n[o]=n[o-i]^l);for(var a=this.GW=[],h=0;h<s;h++){if(o=s-h,h%4)var l=n[o];else l=n[o-4];a[h]=h<4||o<=4?l:c[r[l>>>24]]^u[r[l>>>16&255]]^d[r[l>>>8&255]]^f[r[255&l]]}}},encryptBlock:function(t,e){this.$W(t,e,this.NW,o,a,h,l,r)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this.$W(t,e,this.GW,c,u,d,f,n),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},$W:function(t,e,i,s,r,n,o,a){for(var h=this.zW,l=t[e]^i[0],c=t[e+1]^i[1],u=t[e+2]^i[2],d=t[e+3]^i[3],f=4,g=1;g<h;g++){var p=s[l>>>24]^r[c>>>16&255]^n[u>>>8&255]^o[255&d]^i[f++],m=s[c>>>24]^r[u>>>16&255]^n[d>>>8&255]^o[255&l]^i[f++],y=s[u>>>24]^r[d>>>16&255]^n[l>>>8&255]^o[255&c]^i[f++],x=s[d>>>24]^r[l>>>16&255]^n[c>>>8&255]^o[255&u]^i[f++];l=p,c=m,u=y,d=x}p=(a[l>>>24]<<24|a[c>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^i[f++],m=(a[c>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&l])^i[f++],y=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[l>>>8&255]<<8|a[255&c])^i[f++],x=(a[d>>>24]<<24|a[l>>>16&255]<<16|a[c>>>8&255]<<8|a[255&u])^i[f++],t[e]=p,t[e+1]=m,t[e+2]=y,t[e+3]=x},keySize:8});e.AES=i.mW(p)}(),t.AES}(cx.exports);var bx=Sx.exports,Mx={exports:{}};Mx.exports=function(t){return t.mode.CTR=(i=(e=t.lib.BlockCipherMode.extend()).Encryptor=e.extend({processBlock:function(t,e){var i=this.PW,s=i.blockSize,r=this.BW,n=this.UW;r&&(n=this.UW=r.slice(0),this.BW=void 0);var o=n.slice(0);i.encryptBlock(o,0),n[s-1]=n[s-1]+1|0;for(var a=0;a<s;a++)t[e+a]^=o[a]}}),e.Decryptor=i,e),t.mode.CTR;var e,i}(cx.exports);var Ex=Mx.exports,kx={exports:{}};kx.exports=function(t){return function(){if("function"==typeof ArrayBuffer){var e=t.lib.WordArray,i=e.init,s=e.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var e=t.byteLength,s=[],r=0;r<e;r++)s[r>>>2]|=t[r]<<24-r%4*8;i.call(this,s,e)}else i.apply(this,arguments)};s.prototype=e}}(),t.lib.WordArray}(cx.exports);var Tx=kx.exports,wx={exports:{}};wx.exports=function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding}(cx.exports);var Cx=wx.exports;const Bx="aHR0cHM6Ly9saWdodG5pbmdjaGFydC5jb20vanMtY2hhcnRzL2RvY3MvbGljZW5zZXMvYXBwLWRlcGxveW1lbnQv",Fx=9e5,Dx={"-4":["MDQxMmQ1MWU5MjFhYTMzODUwMWE4ZGYzN2ViZTE4NTU3ZDViYmRlZDg1Yzk0OGI3YTJkMDBmZTNhZGVlMjdjY2VmNzBiMWVlOWI3MDZjMTIwYTAzZDZlZTNkNmYyOTc5Y2E2NGEzN2Y3YjY4N2E1ZjljZWY2ODYxN2I1NWU5ZmJjMA=="],"-3":["MjAyNTExMjU="],"-2":["aHR0cHM6Ly9qc2xpY2Vuc2luZy5saWdodG5pbmdjaGFydC5jb20vc2Vzc2lvbg==","aHR0cHM6Ly9saWdodG5pbmdjaGFydC5jb20vanMtY2hhcnRzL2RvY3MvdHJvdWJsZXNob290aW5nL3Jlc3RyaWN0ZWQtZmVhdHVyZXMv","aHR0cHM6Ly9saWdodG5pbmdjaGFydC5jb20vanMtY2hhcnRzLw==","aHR0cHM6Ly9saWdodG5pbmdjaGFydC5jb20vcHl0aG9uLWNoYXJ0cy8="],"-1":["WE1MSHR0cFJlcXVlc3Q=","ZG9jdW1lbnQ=","ZGVmYXVsdFZpZXc=","YQ==","Yg==","bGljZW5zZV9leHBpcmF0aW9uX2RhdGU=","bG9jYXRpb24=","aG9zdG5hbWU=","dGVzdF9kb21haW4=","ZG9tYWlucw==","Y3J5cHRv","U2lnbmF0dXJl","RUNEU0E=","U0hBMjI0d2l0aEVDRFNB","YWxn","Y3VydmU=","c2VjcDI1Nmsx","YWRkRXZlbnRMaXN0ZW5lcg==","cmVtb3ZlRXZlbnRMaXN0ZW5lcg==","bG9hZGVuZA==","ZXJyb3I=","YWJvcnQ=","dGltZW91dA==","cmVzcG9uc2VUZXh0","Q29udGVudC1UeXBl","YXBwbGljYXRpb24vanNvbg==","TWVzc2FnZURpZ2VzdA==","c2hhMjU2","Y3J5cHRvanM=","dXBkYXRlU3RyaW5n","ZGlnZXN0","Y29tcGFueQ==","YXBwVGl0bGU=","bGNqcy1zZXNzaW9u","bG9jYWxTdG9yYWdl","Z2V0SXRlbQ==","c2V0SXRlbQ==","ZA==","dA==","bGNqcy1zZXNzaW9uLTI=","aG9zdA==","dG9w"],0:["TGljZW5zZQ==","IA==","a2V5","aGFz","ZXhwaXJlZA==","Lg==","dmVyc2lvbg==","aXM=","dG9v","bmV3","b2xk","b3I=","aW52YWxpZA==","MDAwMQ==","SW52YWxpZA==","bnVtYmVy","b2Y=","ZG9tYWlucw==","ZGVwbG95bWVudA==","aW4=","ZG9tYWlu","RGVwbG95bWVudA==","ZG9tYWlu","dmFsaWRhdGlvbg==","ZmFpbGVk","Og==","UE9TVA==","c2VydmVy","cmVzcG9uZGVk","d2l0aA==","dW5leHBlY3RlZA==","dmFsdWU=","cmVxdWVzdA==","VEVTVA==","REVQTE9ZTUVOVA==","S2V5","VGFtcGVyaW5n","YmVlbg==","ZGV0ZWN0ZWQ=","TWlzc2luZw==","TGljZW5zZQ==","aW5mb3JtYXRpb24=","ZG9lcw==","bm90","aW5jbHVkZQ==","cGVybWlzc2lvbg==","dG8=","dXNl","Q2hhcnQ=","M0Q=","WFk=","RGF0YUdyaWQ=","TWFw","UG9sYXI=","RnVubmVs","R2F1Z2U=","UGll","UHlyYW1pZA==","U3BpZGVy","Zm9y","dGhpcw==","VHJhZGluZw==","ZmVhdHVyZXM=","Q2xpY2s=","aGVyZQ==","bW9yZQ==","c3VwcGxpZWQ=","Z2V0","bGljZW5zZQ==","VHJlZQ==","dW5leHBlY3RlZA==","ZXJyb3I="],1:["aHR0cHM6Ly9qc2xpY2Vuc2luZy5saWdodG5pbmdjaGFydC5jb20vc2FuZGJveA==","aHR0cHM6Ly9qc2xpY2Vuc2luZy5saWdodG5pbmdjaGFydC5jb20vcGx1Z2lu"]},Ix=Ut,Rx=(...t)=>t.slice(1).reduce((e,i)=>e+Ix.atob(Dx[t[0]][i].toString()),"");let Lx,Px,zx,_x=new Uint8Array([]);const Vx=t=>t&&"cGx1Z2lu"in t&&"cHl0aG9u"===t.cGx1Z2lu?Rx(-2,3):Rx(-2,2);class Nx{set e(t){Lx=t}get e(){Px={po:!1,vo:!1,yo:!1,mo:!1,xo:!1,So:!1,bo:!1,Mo:!1,wo:!1,_o:!1,ko:!1,Co:!1,To:!1,Fo:!1,Io:!1,Lo:!1,Po:!1,Bo:!1,Do:!1,Eo:!1,Ro:!1,Oo:!1,zo:!1,Vo:!1,No:!1,Go:!1,$o:!1};const t=_x.length,e=t>=1?_x[0]:void 0,i=t>=2?_x[1]:void 0,s=t>=3?_x[2]:void 0,r=t>=4?_x[3]:void 0;return void 0!==e&&(Px.po=!!(1&e),Px.vo=!!(2&e),Px.yo=!!(4&e),Px.mo=!!(8&e),Px.xo=!!(16&e),Px.So=!!(32&e),Px.bo=!!(64&e),Px.Mo=!!(128&e)),void 0!==i&&(Px.wo=!!(1&i),Px._o=!!(2&i),Px.ko=!!(4&i),Px.Co=!!(8&i),Px.To=!!(16&i),Px.Fo=!!(32&i),Px.Io=!!(64&i),Px.Lo=!!(128&i)),void 0!==s&&(Px.Po=!!(1&s),Px.Bo=!!(2&s),Px.Do=!!(4&s),Px.Eo=!!(8&s),Px.Ro=!!(16&s),Px.Oo=!!(32&s),Px.zo=!!(64&s),Px.Vo=!!(128&s)),void 0!==r&&(Px.No=!!(1&r),Px.Go=!!(2&r),Px.$o=!!(4&r)),Px.So}set l(t){zx=t}get l(){return zx}}let Ox=!1;const Ux=(t,e)=>{const i=new RegExp(`.{${e}}`,"g");return(t.match(i)||[]).map(t=>parseInt(t,16))},Gx=t=>{if(4===t.byteLength)return`${t[0].toString().padStart(2,"0")}${t[1].toString().padStart(2,"0")}${t[2].toString().padStart(2,"0")}${t[3].toString().padStart(2,"0")}`},Yx=t=>t.getFullYear().toString()+(t.getMonth()+1).toString().padStart(2,"0")+t.getDate().toString().padStart(2,"0"),Zx=t=>{const e={},i=t.split("-");if(3!==i.length)return{YW:Rx(0,0,1,7,1,12,5)};let s=0;const r=Uint8Array.from(Ix.atob(i[1]),t=>t.charCodeAt(0));s+=1;const n=r.subarray(s,s+=20),o=new DataView(r.buffer).getUint16(s,!0);s+=2;const a=Uint8Array.from(Array(o));for(let t=0;t<o;t+=1)a[t]=r[t+s]^n[t%n.byteLength];const h=new DataView(a.buffer);e.jW=a,s=0;const l=Uint8Array.from(Array(h.getUint16(s,!0)));s+=2,l.set(a.subarray(s,s+=l.byteLength)),_x=new Uint8Array(l);const c=Gx(a.subarray(s,s+=4)),u=Rx(-3,0);if(!c)return{YW:Rx(0,0,1,7,1,12,5)};if(c<u)return{YW:Rx(0,40,1,2,1,7,1,8,1,10,1,59,1,60,1,6,5)};if(8&l[0]){const t=Gx(a.subarray(s,s+=4)),e=Yx(new Date);if(!t)return{YW:Rx(0,0,1,7,1,12,5)};if(t<e)return{YW:Rx(0,0,1,2,1,3,1,4,5),HW:Vx()}}e.WW=s;const d=`${i[0]}-${i[1]}`,f=Array.prototype.reduce.call(Ix.atob(i[2]),(t,e)=>t+`0${e.charCodeAt(0).toString(16)}`.slice(-2),"");return Hx(d,f)?e:{YW:Rx(0,0,1,7,1,12,5)}},Wx=t=>{const e=t.slice(0,4);let i=t.slice(5);switch(e){case"0001":{i=i.replace(/-/g,"");const t=Uint8Array.from(Ux(i,2)),e=t.slice(36,40),s=new Uint8Array(4),r=(t=>{let e;const i=[];for(let t=0;t<256;t+=1){e=t;for(let t=0;t<8;t+=1)e=1&e?3988292384^e>>>1:e>>>1;i[t]=e}let s=-1;for(let e=0;e<t.length;e+=1)s=s>>>8^i[255&(s^t[e])];return~s>>>0})(t.slice(0,36));new DataView(s.buffer).setUint32(0,r,!0);const n=t.slice(28,34);let o=0;for(let t=n.length-1;t>0;t-=1)o+=n[t]*2**(8*t);const a=new Date(o);if(Yx(a)<Rx(-3,0))return{YW:Rx(0,0,1,2,1,3,1,4,5),HW:Vx()};if(e.every((t,e)=>s[e]===t))return{};break}case"0002":return Zx(t);default:return{YW:Rx(0,0,1,2,1,6,1,7,1,8,1,9,1,11,1,10,5)}}return{YW:Rx(0,0,1,2,1,7,1,12,5)}},jx=t=>{if(!t)return{YW:Rx(0,14,1,15,1,16,1,17,1,19,1,18,1,2,5)};const e=(t[Rx(-1,9)]||t[Rx(-1,37)]).map(t=>(t||"").trim()),i=Ix[Rx(-1,41)];try{if(i&&e.indexOf(i[Rx(-1,6)][Rx(-1,7)])>-1)return{XW:!0}}catch(t){}if(e.indexOf(Ix[Rx(-1,6)][Rx(-1,7)])>-1)return{XW:!0};const s=e.filter(t=>t.indexOf("*")>-1);try{if(i&&Jx(i[Rx(-1,6)][Rx(-1,7)],s))return{XW:!0}}catch(t){}if(Jx(Ix[Rx(-1,6)][Rx(-1,7)],s))return{XW:!0};const r=t[Rx(-1,8)]||t[Rx(-1,38)];if(""!==r&&null!=r){try{if(i&&Jx(i[Rx(-1,6)][Rx(-1,7)],[r]))return{XW:!1}}catch(t){}if(Jx(Ix[Rx(-1,6)][Rx(-1,7)],[r]))return{XW:!1};try{if(i&&r===i[Rx(-1,6)][Rx(-1,7)])return{XW:!1}}catch(t){}if(r===Ix[Rx(-1,6)][Rx(-1,7)])return{XW:!1}}return{YW:Rx(0,14,1,20,5),HW:"aHR0cHM6Ly9saWdodG5pbmdjaGFydC5jb20vanMtY2hhcnRzL2RvY3MvbGljZW5zZXMvd2ViLWRlcGxveW1lbnQv"}},Hx=(t,e)=>{const i=new ax("secp256k1").keyFromPublic(Rx(-4,0),"hex"),s=fx(t).toString();return i.verify(s,e)},$x=t=>{switch(t.slice(0,4)){case"0001":return(t=>{let e,i="";try{const e=t.split("-"),s=e[1],r=e[2],n=e[3];if(!Hx(r,n))return{YW:Rx(0,21,1,2,1,7,1,12,5)};const o=px.parse(r);i=bx.decrypt({ciphertext:px.parse(s)},o,{mode:Ex,padding:Cx,iv:px.parse("00000000000000000000000000000001")}).toString(Ax)}catch(t){return{YW:Rx(0,21,1,2,1,7,1,12,5)}}try{e=JSON.parse(i)}catch(t){return{YW:Rx(0,21,1,2,1,7,1,12,5)}}if(void 0===e[Rx(-1,5)]||null===e[Rx(-1,4)]||!e[Rx(-1,9)])return{YW:Rx(0,21,1,2,1,7,1,12,5)};const s=parseInt(Rx(-3,0),10)||Number(parseInt(Rx(-3,0),10));return e[Rx(-1,5)]<s?{YW:Rx(0,21,1,2,1,3,1,4,5)}:jx(e)})(t);case"0002":return(t=>{const e=Zx(t),i=e.jW,s=e.WW;if(e.YW||void 0===i||void 0===s)return e;let r,n="";try{const t=i.slice(e.WW,s+16),r=new DataView(t.buffer),o=new Int32Array(4);for(let t=0;t<o.length;t+=1)o[t]=r.getInt32(4*t,!1);const a=Tx.create(Array.from(o)),h=s+16,l=i.slice(h,i.length),c=new DataView(l.buffer),u=new Int32Array(Math.floor(l.byteLength/4));for(let t=0;t<u.length;t+=1)u[t]=c.getInt32(4*t,!1);const d=Tx.create(Array.from(u)),f=bx.decrypt({ciphertext:d},a,{mode:Ex,padding:Cx,iv:px.parse("00000000000000000000000000000001")});n=Ix.atob(f.toString(Ax))}catch(t){return{YW:Rx(0,21,1,2,1,7,1,12,5)}}try{r=JSON.parse(n)}catch(t){return{YW:Rx(0,21,1,2,1,7,1,12,5)}}return r[Rx(-1,37)]?jx(r):{YW:Rx(0,21,1,2,1,7,1,12,5)}})(t);default:return{YW:Rx(0,21,1,2,1,6,1,7,1,8,1,9,1,11,1,10,5)}}},Xx=(t,e)=>{switch(t.slice(0,4)){case"0001":return((t,e)=>{if(!e)return{YW:Rx(0,39,1,40,1,41,5),HW:Bx};const i=t.split("-"),s=i[1].slice(1),r=i[2],n=i[3];if(!Hx(`${s}-${r}`,n))return{YW:Rx(0,21,1,2,1,7,1,12,5)};const o=Uint8Array.from(Ux(r,2));let a=0;for(let t=o.length-1;t>0;t-=1)a+=o[t]*2**(8*t);if(a<(parseInt(Rx(-3,0),10)||Number(parseInt(Rx(-3,0),10))))return{YW:Rx(0,21,1,2,1,3,1,4,5)};const h=Int32Array.from(Ux(s,8)),l=dx(e[Rx(-1,31)]).toString(px),c=Int32Array.from(Ux(l,8)),u=dx(e[Rx(-1,32)]).toString(px),d=Int32Array.from(Ux(u,8)),f=new Int32Array(c.length);for(let t=0;t<f.length;t+=1)f[t]=c[t]^d[t];return h.every((t,e)=>f[e]===t)?{}:{YW:Rx(0,21,1,2,1,7,1,12,5)}})(t,e);case"0002":return((t,e)=>{if(!e)return{YW:Rx(0,39,1,40,1,41,5),HW:Bx};const i=Zx(t),s=i.jW,r=i.WW;if(i.YW||void 0===s||void 0===r)return i;const n=s.slice(r,s.length),o=new DataView(n.buffer),a=new Int32Array(8);for(let t=0;t<a.length;t+=1)a[t]=o.getInt32(4*t,!1);const h=dx(e[Rx(-1,31)]).toString(px),l=Int32Array.from(Ux(h,8)),c=dx(e[Rx(-1,32)]).toString(px),u=Int32Array.from(Ux(c,8)),d=new Int32Array(l.length);for(let t=0;t<d.length;t+=1)d[t]=l[t]^u[t];return a.every((t,e)=>d[e]===t)?{}:{YW:Rx(0,21,1,2,1,7,1,12,5)}})(t,e);default:return{YW:Rx(0,21,1,2,1,6,1,7,1,8,1,9,1,11,1,10,5)}}},qx=(t,e,i=!0,s)=>{Ox=!1,e.Ya();const r=e.zn,n=!!r&&(r===Ut.document.body||Ut.document.body.contains(r)),o=r&&n?r:document.body;if(void 0===Array.from(o.children).find(t=>"lcjs-error"===t.id)){const r=Ut.document.createElement("div");r.id="lcjs-error",o.append(r),r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.style.width="100%",r.style.height="100%",r.style.backgroundColor="black",r.style.boxSizing="border-box",r.style.padding="20px",r.style.font="Arial",r.style.fontSize="20px";let n,a=(t||"LICENSE_ERROR").split("_").join(" ");if(a=(i?Rx(0,0,1,2,1,23,1,24,25,1):"")+a.charAt(0).toUpperCase()+a.substr(1),s){const t=Ut.document.createElement("a");t.href=s,n=t}else n=Ut.document.createElement("p1");r.append(n),n.innerHTML=a,n.style.color="red",e.AH()&&Ix.console.error(a)}},Kx=(t,e,i)=>{e?(t[Rx(-1,17)](Rx(-1,19),i),t[Rx(-1,17)](Rx(-1,20),i),t[Rx(-1,17)](Rx(-1,21),i),t[Rx(-1,17)](Rx(-1,22),i)):(t[Rx(-1,18)](Rx(-1,19),i),t[Rx(-1,18)](Rx(-1,20),i),t[Rx(-1,18)](Rx(-1,21),i),t[Rx(-1,18)](Rx(-1,22),i))},Jx=(t,e)=>{const i=t.split(".").reverse();return e.some(t=>{const e=t.split(".").reverse();let s=!1;const r=e.findIndex(t=>"*"===t),n=i.every((t,i)=>{if(!s){if(!(i<e.length))return!1;if(s="*"===e[i]&&i+1>2,!s&&t!==e[i])return!1}return!0});return!(r>i.length-1||!n)})},Qx=new Map;e.AbstractCursor=El,e.Animation=bt,e.AnimationEasings=St,e.Animator=Mt,e.AreaRangeSeries=iu,e.Axis=Ra,e.Axis3D=Xh,e.AxisScrollStrategies=yn,e.AxisTickStrategies=xn,e.Band=un,e.BarChart=Cf,e.BarChartBar=Tf,e.BarChartCategoryAxis=Ef,e.BarChartSorting=Bf,e.BarChartTypes={Horizontal:"horizontal",Vertical:"vertical"},e.BarChartValueAxis=kf,e.BorderedPicture=Ro,e.BoxFigure=wc,e.BoxSeries=Dc,e.BoxSeries3D=Yh,e.Button=va,e.Chart=Oh,e.Chart3D=Rl,e.ChartComponent=Ps,e.ChartWithSeries=hl,e.ChartXY=Cu,e.Color=S,e.ColorCSS=t=>{try{if(t.startsWith("rgba")){const e=t.substr(5).slice(0,-1),i=JSON.parse(`[${e}]`);return M(i[0],i[1],i[2],255*i[3])}if(t.startsWith("rgb")){const e=t.substr(4).slice(0,-1),i=JSON.parse(`[${e}]`);return M(i[0],i[1],i[2])}if(t.startsWith("hsl")){const e=t.substr(4).slice(0,-1).split(",").map(parseFloat),i=((t,e,i)=>{e/=100,i/=100;const s=(1-Math.abs(2*i-1))*e,r=t/60,n=s*(1-Math.abs(r%2-1));let o=[];isNaN(t)?o=[0,0,0]:r<=1?o=[s,n,0]:r<=2?o=[n,s,0]:r<=3?o=[0,s,n]:r<=4?o=[0,n,s]:r<=5?o=[n,0,s]:r<=6&&(o=[s,0,n]);const a=i-.5*s;return[Math.round(255*(o[0]+a)),Math.round(255*(o[1]+a)),Math.round(255*(o[2]+a))]})(e[0],e[1],e[2]);return M(i[0],i[1],i[2])}return t.startsWith("#")||t.startsWith("0x")?E(t):E((t=>{const e=w[t.toLowerCase()];if(e)return e;throw new Error(`Unknown color code: ${t}`)})(t))}catch(t){}return console.warn(`ColorCSS parsing error: ${t}`),E("#fff")},e.ColorHEX=E,e.ColorHSV=k,e.ColorPalettes=Ys,e.ColorRGBA=M,e.ColorShadingStyles=Js,e.ColorUint32=T,e.ConstantLine=dn,e.Cursor2D=Pl,e.Cursor3D=wl,e.CursorBuilder2D=zl,e.CursorBuilder3D=Cl,e.CursorBuilderXY=cu,e.CursorBuilders=ef,e.CursorXY=lu,e.CustomTick=Wn,e.Dashboard=vg,e.DashedLine=fr,e.DataGrid=vf,e.DataSetXY=Vo,e.DateTimeTickStrategy=fh,e.EllipseFigure=Ic,e.EllipseSeries=Rc,e.EmptyFill=hs,e.EmptyTickStrategy=Bn,e.EmptyUIElement=to,e.Eventer=vt,e.Figure=Tc,e.FigureSeries=Fc,e.FontSettings=I,e.FormattingFunctions=Qi,e.FunnelChart=sd,e.FunnelChartTypes=ld,e.FunnelChartWithLabelsInsideSlices=hd,e.FunnelChartWithLabelsOnSides=ad,e.FunnelSlice=Xu,e.GaugeChart=Uf,e.GenericAxis=Rn,e.GlowEffect=vr,e.HeatmapGridSeries=Kc,e.HeatmapGridSeriesIntensityValues=Jc,e.HeatmapScrollingGridSeries=Qc,e.HeatmapScrollingGridSeriesIntensityValues=tu,e.Highlighter=zs,e.Icon=mr,e.ImageFill=Tt,e.IndividualPointFill=ps,e.LUT=rs,e.Legend=zh,e.LegendEntryClickBehaviors=Ph,e.LineAndPointSeries3D=el,e.LineSeries3D=il,e.LinearGradientFill=U,e.LinearGradientFillPalette=(t,e,i,s)=>{const r=t(e+1,s);return t=>new U({stops:[{offset:0,color:r(t).getDarker()},{offset:.5,color:r(t)},{offset:1,color:r(t).getDarker()}],angle:i||90})},e.MapChart=hc,e.MapRegions=tc,e.MapRegionsAfrica=Wl,e.MapRegionsAsia=jl,e.MapRegionsAustralia=Hl,e.MapRegionsCanada=$l,e.MapRegionsEurope=Xl,e.MapRegionsNorthAmerica=Jl,e.MapRegionsSouthAmerica=Ql,e.MapRegionsUSA=Kl,e.MapRegionsWorld=ql,e.MapTypes=ec,e.MeshModel3D=Sl,e.NumericTickStrategy=Sh,e.OHLCSeries=su,e.OHLCSeriesBars=nu,e.OHLCSeriesCandlesticks=ru,e.OHLCSeriesTypes=ou,e.OnScreenMenu=fu,e.OnScreenMenuAnimationsButton=Xr,e.OnScreenMenuButton=Ur,e.OnScreenMenuControlBase=wr,e.OnScreenMenuCustomButton=Kr,e.OnScreenMenuOsmToggleButton=Jr,e.OnScreenMenuToggleButton=Gr,e.OnScreenMenuZoomInButton=Yr,e.OnScreenMenuZoomInXButton=Zr,e.OnScreenMenuZoomInYButton=Wr,e.OnScreenMenuZoomOutButton=jr,e.OnScreenMenuZoomOutXButton=Hr,e.OnScreenMenuZoomOutYButton=$r,e.OnScreenMenuZoomToFitButton=qr,e.PalettedFill=xs,e.Panel=_h,e.ParallelCoordinateAxis=jf,e.ParallelCoordinateChart=$f,e.ParallelCoordinateSeries=Hf,e.PhongShadingStyle=qs,e.Picture=Io,e.PieChart=ng,e.PieChartTypes=lg,e.PieChartWithLabelsInsideSlices=hg,e.PieChartWithLabelsOnSides=ag,e.PieSlice=dd,e.PixelatedPoints3D=nr,e.PointCloudSeries3D=ol,e.PointLineAreaSeries=gu,e.PointLineSeries3D=sl,e.PointSeries3D=nl,e.PointSeriesTypes3D=al,e.PointStyle3D=ar,e.PolarAreaSeries=Mc,e.PolarAreaSeriesInterior=Ec,e.PolarAxis=uc,e.PolarAxisAmplitude=fc,e.PolarAxisTick=dc,e.PolarChart=Wu,e.PolarHeatmapSeries=Vu,e.PolarLineSeries=kc,e.PolarPointLineSeries=zu,e.PolarPointSeries=_u,e.PolarPolygon=pc,e.PolarPolygonSeries=bc,e.PolarSector=Zu,e.PolarSeries=yc,e.PolygonFigure=Lc,e.PolygonSeries=Pc,e.PyramidChart=xd,e.PyramidChartTypes=Ed,e.PyramidChartWithLabelsInsideSlices=Md,e.PyramidChartWithLabelsOnSides=bd,e.PyramidSlice=gd,e.RadialGradientFill=V,e.RadialGradientFillPalette=(t,e,i)=>{const s=t(e+1,i);return t=>new V({stops:[{offset:0,color:s(t)},{offset:1,color:s(t).getDarker()}]})},e.RangeSeries=eu,e.RectangleFigure=zc,e.RectangleSeries=_c,e.SegmentFigure=Vc,e.SegmentSeries=Nc,e.Series2D=mc,e.Series3D=Gh,e.SeriesXY=Cc,e.SimpleShadingStyle=$s,e.Slice=$u,e.SliceLabelFormatters=Qu,e.SliceSorters=Ju,e.SolidFill=fs,e.SolidFillPalette=(t,e,i)=>{const s=t(e,i);return t=>new fs({color:s(t)})},e.SolidLine=lr,e.SpiderAxis=wd,e.SpiderChart=Vd,e.SpiderSeries=Fd,e.StipplePatterns=ur,e.SurfaceGridSeries3D=fl,e.SurfaceScrollingGridSeries3D=gl,e.TextFigure=Uc,e.TextSeries=Gc,e.Themes=yf,e.Tick=Ia,e.TickStyle=Oa,e.TimeFormattingFunctions=Ka,e.TimeTickStrategy=Qa,e.TreeMapChart=Nf,e.TriangulatedPoints3D=ir,e.UIBackgrounds=bl,e.UICircle=Jo,e.UIColumnGrid=class extends na{constructor(){super(...arguments),this.Wd=[]}addColumn(){return this.addElement(ca,void 0)}getColumn(t,e=!1){return e&&this.Wd.length<=t?(this.addColumn(),this.getColumn(t,!0)):this.Wd[t]}},e.UIDiamond=Qo,e.UIElementBuilders=Da,e.UIElementColumn=oa,e.UIElementLine=ra,e.UIElementRow=na,e.UIElementWithBackground=Gn,e.UIEmptyBackground=eo,e.UILabel=Xo,e.UILayoutBuilders=sf,e.UILayoutGap=sa,e.UILegendPanel=qf,e.UIObject=On,e.UIOrigins=tn,e.UIPanel=Nh,e.UIPoint=ea,e.UIPointer=ta,e.UIPolygon=Lo,e.UIRectangle=Ko,e.UIRowGrid=ha,e.VisibleFill=ds,e.ZoomBandChart=Pu,e._translatePoint=tt,e.contoursFromLUT=(t,e)=>{const i=null!=e?e:t=>t;return{levels:t.steps.map(t=>i({value:t.value},t))}},e.defaultAxisIntervalRestrictionsXY=Pa,e.defaultOsmBackgroundColor=ln,e.disableTextShadows=t=>{var e,i,s;return{...t,dataGridTextShadow:void 0,pieChartSliceLabelShadow:void 0,funnelChartSliceLabelShadow:void 0,spiderChartScaleLabelShadow:void 0,pyramidChartSliceLabelShadow:void 0,xAxisTimeTicks:t.xAxisTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),yAxisTimeTicks:t.yAxisTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),xAxis3DTimeTicks:t.xAxis3DTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),yAxis3DTimeTicks:t.yAxis3DTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),zAxis3DTimeTicks:t.zAxis3DTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),xAxisNumericTicks:t.xAxisNumericTicks.setTickStyle(t=>t.setLabelShadow(void 0)),yAxisNumericTicks:t.yAxisNumericTicks.setTickStyle(t=>t.setLabelShadow(void 0)),xAxisDateTimeTicks:t.xAxisDateTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),yAxisDateTimeTicks:t.yAxisDateTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),xAxis3DNumericTicks:t.xAxis3DNumericTicks.setTickStyle(t=>t.setLabelShadow(void 0)),yAxis3DNumericTicks:t.yAxis3DNumericTicks.setTickStyle(t=>t.setLabelShadow(void 0)),zAxis3DNumericTicks:t.zAxis3DNumericTicks.setTickStyle(t=>t.setLabelShadow(void 0)),xAxis3DDateTimeTicks:t.xAxis3DDateTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),yAxis3DDateTimeTicks:t.yAxis3DDateTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),zAxis3DDateTimeTicks:t.zAxis3DDateTimeTicks.setTickStyle(t=>t.setLabelShadow(void 0)),barChartValueAxisTicks:t.barChartValueAxisTicks.setTickStyle(t=>t.setLabelShadow(void 0)),polarAmplitudeAxisNumericTicks:t.polarAmplitudeAxisNumericTicks.setTickStyle(t=>t.setLabelShadow(void 0)),parallelCoordinateAxisTimeTicks:null===(e=t.parallelCoordinateAxisTimeTicks)||void 0===e?void 0:e.setTickStyle(t=>t.setLabelShadow(void 0)),parallelCoordinateAxisNumericTicks:null===(i=t.parallelCoordinateAxisNumericTicks)||void 0===i?void 0:i.setTickStyle(t=>t.setLabelShadow(void 0)),parallelCoordinateAxisDateTimeTicks:null===(s=t.parallelCoordinateAxisDateTimeTicks)||void 0===s?void 0:s.setTickStyle(t=>t.setLabelShadow(void 0))}},e.disableThemeEffects=t=>({...t,effect:void 0}),e.emptyFill=ls,e.emptyLine=Bt,e.emptyPoints3D=tr,e.emptyTick=Ga,e.formatLUTValue=os,e.formatLongitudeLatitude=lc,e.formatNumberAsUnicodeSuperscript=ts,e.htmlTextRenderer=Tr,e.interpolateColor=at,e.isArtificialLCJSEvent=t=>!0===t.isLcjsArtificialEvent,e.isColor=b,e.isCoordinate3D=ml,e.isCoordinateBarChart=wf,e.isCoordinateClient=bs,e.isCoordinatePolar=Yu,e.isCoordinateXY=Es,e.isDashedLine=gr,e.isEmptyFill=cs,e.isEmptyTick=Ya,e.isFontSettings=R,e.isGlowEffect=t=>!(!t||"object"!=typeof t||!("type"in t)||"glow"!==t.type),e.isHitBox=t=>t&&"object"==typeof t&&"figure"in t&&"start"in t&&"end"in t&&"median"in t&&"upperQuartile"in t,e.isHitBox3D=t=>t&&"object"==typeof t&&"xSize"in t&&"ySize"in t&&"zSize"in t,e.isHitEllipse=t=>t&&"object"==typeof t&&"figure"in t&&"x"in t&&"radiusX"in t&&"radiusY"in t,e.isHitHeatmap=it,e.isHitMeshModel=nt,e.isHitOHLC=t=>t&&"object"==typeof t&&"position"in t&&"open"in t&&"high"in t&&"isPacked"in t,e.isHitPolarHeatmap=rt,e.isHitPolygon=t=>t&&"object"==typeof t&&"figure"in t&&"x"in t&&"coordinates"in t,e.isHitRectangle=t=>t&&"object"==typeof t&&"figure"in t&&"positionAndSize"in t,e.isHitSampleXY=ot,e.isHitSegment=t=>t&&"object"==typeof t&&"figure"in t&&"startX"in t&&"endX"in t,e.isHitSurface=st,e.isIcon=yr,e.isImageFill=wt,e.isIndividualPointFill=ms,e.isLUT=ns,e.isLinearGradientFill=G,e.isPalettedFill=vs,e.isPhongShadingStyle=t=>!(!t||"object"!=typeof t||!("type"in t)||"phong"!==t.type),e.isPixelatedPoints3D=or,e.isRadialGradientFill=N,e.isSeriesSupportedByZoomBandChart=t=>t instanceof iu||t instanceof Jc||t instanceof su||t instanceof gu,e.isSimpleShadingStyle=t=>!(!t||"object"!=typeof t||!("type"in t)||"simple"!==t.type),e.isSolidFill=gs,e.isSolidLine=cr,e.isTickStyle=Ua,e.isTriangulatedPoints3D=sr,e.lightningChart=(t,e)=>{let i="object"==typeof t?t.license:t;i&&(i=i.trim());const s="object"==typeof t?t.licenseInformation:e,r="object"==typeof t?t:void 0,n=new Nx;n.e=i;let o=Qx.get(i||"E");return o||(o=((t,e)=>{let i,s,r=!1,n=!1,o=!1,a=!1,h="",l=!1,c=!1,u=!1;try{if(Lx){const s=(()=>{if(!Lx)return;const t=Lx.split("-");if(t.length>0)switch(t[0]){case"0001":return"0001";case"0002":return"0002";case"T001":return"T001";case"P001":return"P001";default:return}})(),h=t&&"cGx1Z2lu"in t;if("0001"===s){_x=new Uint8Array([2]);const e=(()=>{if(!Lx)return;const t=Lx.split("-");return 4===t.length?t[1].startsWith("m")?2:1:0})();if(1===e){const t=$x(Lx);o=!t.XW,i=t,r=!0}else 2===e?(i=Xx(Lx,t),n=!0):(Ox=!0,i=Wx(Lx),a=!0);h&&(i={YW:Rx(0,0,1,7,1,12,5)})}else if("0002"===s){const e=(()=>{if(!Lx)return;const t=Lx.split("-");return t.length>=2?Uint8Array.from(Ix.atob(t[1]),t=>t.charCodeAt(0))[0]:void 0})();if(104===e)Ox=!0,i=Wx(Lx),a=!0;else if(189===e){const t=$x(Lx);o=!t.XW,i=t,r=!0}else 159===e?(i=Xx(Lx,t),n=!0):i={YW:Rx(0,0,1,7,1,12,5)};const s=_x.length>3&&2&_x[3];(s&&!h||!s&&h||s&&h&&"cHl0aG9u"!==t.cGx1Z2lu)&&(i={YW:Rx(0,0,1,7,1,12,5)})}else if("T001"===s){const s=((t,e)=>{const i=Lx.split("-");if(3!==i.length)return{YW:Rx(0,0,1,7,1,12,5)};const s=`${i[1]}`,r=Array.prototype.reduce.call(Ix.atob(i[2]),(t,e)=>t+`0${e.charCodeAt(0).toString(16)}`.slice(-2),"");if(!Hx(s,r))return{YW:Rx(0,0,1,7,1,12,5)};let n=0;const o=Uint8Array.from(Ix.atob(i[1]),t=>t.charCodeAt(n)),a=o.subarray(n,n+=20),h=new DataView(o.buffer).getUint16(n,!0);n+=2;const l=Uint8Array.from(Array(h));for(let t=0;t<h;t+=1)l[t]=o[t+n]^a[t%a.byteLength];n=0;const c=new DataView(l.buffer),u=Gx(l.subarray(n,n+=4)),d=Rx(-3,0);if(!u)return{YW:Rx(0,0,1,7,1,12,5)};if(u<d)return{YW:Rx(0,40,1,2,1,7,1,8,1,10,1,59,1,60,1,6,5)};const f=new Date,g=new Date;f.setDate(f.getDate()+1),g.setDate(g.getDate()-1);const p=Yx(g),m=Yx(f);if(u<p||u>m)return{YW:Rx(0,0,1,2,1,3,1,4,5)};const y=c.getUint16(n,!0),x=l.subarray(n+=2,n+y);if(_x=new Uint8Array(x),e&&"dHJhZGVy"in e&&"dGVjaG5pY2FsIGFuYWx5c2lz"===e.dHJhZGVy)return{ZW:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="};if(e&&"logoGraphic"in e&&e.logoGraphic){const t=e.logoGraphic.split("-");return 3===t.length&&Hx(t[0],t[2])?{ZW:t[0]}:{YW:Rx(0,0,1,7,1,12,5)}}return{YW:Rx(0,0,1,7,1,12,5)}})(0,t);i=s;const n=s.ZW;n&&e?("string"==typeof n&&(e.l=n),r=!0):i={YW:Rx(0,0,1,7,1,12,5)}}else"P001"===s?(i=((t,e)=>{const i=Lx.split("-");if(3!==i.length)return{YW:Rx(0,0,1,7,1,12,5)};const s=`${i[0]}-${i[1]}`,r=Array.prototype.reduce.call(Ix.atob(i[2]),(t,e)=>t+`0${e.charCodeAt(0).toString(16)}`.slice(-2),"");if(!Hx(s,r))return{YW:Rx(0,0,1,7,1,12,5)};let n=0;const o=Uint8Array.from(Ix.atob(i[1]),t=>t.charCodeAt(0));n+=1;const a=o.subarray(n,n+=20),h=new DataView(o.buffer).getUint16(n,!0);n+=2;const l=Uint8Array.from(Array(h));for(let t=0;t<h;t+=1)l[t]=o[t+n]^a[t%a.byteLength];n=0;const c=new DataView(l.buffer).getUint16(n,!0);n+=2;const u=l.subarray(n,c+n),d=new TextDecoder("utf-8").decode(u);return e&&"cGx1Z2lu"in e&&d===Ix.atob(e.cGx1Z2lu)?(_x=new Uint8Array([38]),{}):{YW:Rx(0,0,1,7,1,12,5)}})(0,t),!i.YW&&e&&(r=!0,c=!0)):i={YW:Rx(0,0,1,7,1,12,5)}}else{const e=/^(10\.|172\.(1[6-9]|2[0-9]|3[0-1])|192\.168)\./;["localhost","127.0.0.1","::1"].includes(Ix[Rx(-1,6)][Rx(-1,7)])||e.test(Ix[Rx(-1,6)][Rx(-1,7)])?i={YW:Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68),HW:Vx(t)}:Ix[Rx(-1,6)][Rx(-1,40)]===Ix.atob("c3RhY2tzbmlwcGV0cy5uZXQ=")?(u=!0,l=!1,_x=new Uint8Array([38]),i={}):(u=!0,l=!0,_x=new Uint8Array([38]),i={})}}catch(t){i={YW:Rx(0,0,1,7,1,12,5,1,70,1,71,5)}}try{a&&(s=Ix[Rx(-1,34)][Rx(-1,35)](Rx(-1,39))||void 0)}catch(t){Ix.console.error(t)}let d=!1;if(s){const t=s.split("-");if(2===t.length&&Hx(t[0],t[1])){const[e,i]=t[0].split(":").map(t=>Number(t));Date.now()-i<.95*e*1e3&&(d=!0)}}const f=!(u||l||c||i.YW||r||n||d),g=(()=>{const t=new(Ix[Rx(-1,0)]);return t.open(Rx(0,26),Rx(-2,0)),t.setRequestHeader(Rx(-1,24),Rx(-1,25)),t.withCredentials=!0,t})(),p=new vt;if(f){let t;try{t=parseInt(Lx?Lx.split("-")[1]:Math.floor(1e6*Math.random()).toString(),16)}catch(e){t=Math.floor(1e6*Math.random())}const i=Math.floor(1e6*Math.random());h=(t^i).toString();const s={};let r="",n="",o="";Lx=Lx||"";const a=Rx(-4,0);for(let t=0;t<Lx.length;t+=1){const e=Lx.charCodeAt(t)^a.charCodeAt(t);r+=String.fromCharCode(e)}const l=Rx(-3,0);for(let t=0;t<l.length;t+=1)n+=String.fromCharCode(l.charCodeAt(t)^a.charCodeAt(t));for(let t=0;t<h.length;t+=1)o+=String.fromCharCode(h.charCodeAt(t)^a.charCodeAt(t));s[Rx(-1,3)]=Ix.btoa(r),s[Rx(-1,4)]=Ix.btoa(n),s.h=Ix.btoa(o),s.v=3,s.s=Ix[Rx(-1,34)][Rx(-1,35)](Rx(-1,33))||void 0,g.send(JSON.stringify(s))}return(r,n)=>{const a=[],u={La:t=>{a.indexOf(t)>=0||(a.push(t),d(),Px&&Px.$o&&p.R("logochange",{logoDataURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHwAAAAhCAYAAAAbDs+XAAAACXBIWXMAAAsSAAALEgHS3X78AAAIiUlEQVR4nO2bTWwkVxHHf5uEoHFAkIz5zAxIiIwDSNlBQgibQIKcC8i+ILW3L611TmGXC9LeVssp0t583YjbLC1E4z7aByTwAUWyxc1GIJE5wKEHASJDxAEP7IHNoaqma9rd4xl7vNll5y+N3P36vXrVrz5fvfal+/fvM8fjgyc+aAbmeLB4qqwxTtIFYBVoAsdAfwZz1fXXjcJgZwb05jgDLhVdugr7GrAThUF31hPGSdpGlOmtKAyOdb5WFAaHs57rIhAnaT0Kg1kYwAeCMoFvAIcXIWw3Rxto620b2IrCIKvou6p9+srXYZykrUn5i5P0OpBN6lXiJK0DC54fbbsN3ARuALtRGOxPQu9hQ5nAr0dhcOciJtOFMwHWgR4i7OOK/ivAVeAIeBcYICFmA9jS8Y0oDLrqKey6DqwA+6iAgENyJTtU79JSmjVHYwMJZR0TuiroJiLwdhQG+zpHW2n1dWwbqLm2ps7XNAVx4/qAKe0IX9Ov7OQYieG6AKWWNg3iJP0BkHrXFyfpD4GXXLcBY4StqGm/d8gX8ba2rQMHwBoiiBawGSfpHUTIA30G8A/EQg2rrh/AIE7SPeTd24hS+bVo6nUL2IiTNHNjN+Ik3UYUrK5t68CPgFuOfgvYAX6s9AfA28C33LhV4M0x63FuzDxLj5P0+8BXEYuwtm8yKuxdYG8CbT4A9pCFuK2L1kWEvwU0ECuHXECvocqk4wE+hyjPsf4aiBAHwF2gA6xpHlFDrHvP8WHzmuDXtX0LUbZMaRr9WpykL2sfo78MPEuuxPvAvcK4xinrcW6cWeDOXfm2V4FX9bYVJ2krTtJngZddt+0psvRVZDF39b6JWMOxusZFoK5xfpXcRYIIabnQ1tXfXaWVqattAj33TgsFPryFe3oWOj6m930kdGwD/wP6LtYPgP/q3BkSOj7t+DrUZxeKqQUeJ+kLcZLeAl4vtK8ArwAfds0hYnHP6/2gYDnj5rFt3CYSx7uIxe4gi9xGLOcYETbIQpoyrSOLnOm4LqIATSQf8MIz4VvfTRO+8lFTOk03xzG5F/uT0moBS+QW3/P09fkauSL+0vG1pHxdKEaSNnWZS2UWGCfpp4BvI+7aYs5Njasr2v5ScRzwT+A5vd6LwmBb6a3P9+MPHqWFF484SZ9BLOorwBcYteB2nKQD4MuIhpbhOXd9UNFnjgeESoGroC8jQn5e/xbxHeCPwOcZVYQy9Kr22hXzNxFX2vPJnXP1/XEFkKrx09Ao9D1BZ1o4ngx9JF+ozaruYVvNqrUuE/iTcZJ+DXgReBL4IvDJCvqfAP5T8vyvwGcKbdMWKq4hC30TiZeGdSTmvcX4ku8GUsF7o+TZChJLT6MBcAVR/C1GE7aJ4fbxtcKju0j+0QDK+Jx2niayXTwCSmspZQJ/EfgI8Azixk+z3GK23gP+rDQ+6tonLp1qEaOOaGpRIMfIwmeF/sMtjVpLi3z/O7ROvbdCx4LLzE0YRau3+Xo6dvieZRbvPAKIMtUR5YU88bTkrIckpP0in2eEzVvpScsE/gSyXXjhDBMOEM36BvIyX9L2oynrzya8MsZXAVyyuMGo5fS0qIK23wCIk7Sre/cbru9VRAB1REHQvn1kL24ZdF8rc34scZIOK4Vxkm5qX49dcoPYLSapTtnqRT5VAUbmQ9bxTskzq9rZ/Gtxkq6Zd7N5ojDIygT+WeBDJe2Ge8DTFc92VBC/Aj5OnuRNezBiCeCIwNV6ALr60lcRJbN9+hry8raQtu9eRuoCdcSNX0MU8hfa36p3e8jiLwNLcZLa1H1n3Uazpb+GuuzlkmcZebWvLKQN36eEzz4SRtD3WQUuq/BsfXYRb9VQ3pt6bXt9VBGbSO0iG+7DldAVxgs7A35f8axre+woDO4Bvwb+hrjlaeO3d4keTdf+ml531HKsb+b67RWeLZDnA1khUbIDFs/ror2bo3mo/UwZ7Sh5EIXBVsGKhwpb4eHG8dlEhLlOHoJAvNaQF0TQu5qk1XSu/SgMMpVpXd+5Dgx84cU0pQq/1Rf/N1Ix8hggRZAhojD4O1IrrlKQcfCCrWo3N24C9PGrOL6uPFU+I0/IltzzhrsuxsdiVc57I5vPnyUUq3eQhxEb6xV9E0ku/SELiGcavo8Kd8eN932HglY6Ne/SfUJSxEEUBh3VmFeAvzC6Tdsp0+AoDN6Ok/R3Y+hWwRZ6M07SQ2XWu+p33PUV7WPxK2NUwJCfzEEuoJbmAEVvYvfvFmjata+e2cGO0bvu5reFP0Ky/NvuXUA8SVExjM8GuqUs8DXQfMFX8YARharHSboO7Gt49bH9wFt4nXIcRGHQUcYyZN/tLXzoyssQhcG/lKFmIcstRaFPTZm1cqTx2EPKm2aFa4wuXgNdcEfPL3SfvNZuimOZs9EZunHnGWzBF5S3TOfb1rGXyWO2zddRfv27rCGKN1QMx2em/U3wa46muWlPH+XxGFGuuvYfaHsnCoM39Lc/LK3GSfoTTmIobEOcpE8D3wO+q0TfPKUAsk5e7+7qIu2dt7RaKGIs6Uue4PeiUdwSIjG3hWTvF/YRyVnxFJywKkPp4kVhcC9O0t8AX0eSjUm3W3YkWFWCnRa3Cvdm9Q8aLfJ9Nmi2/zAKG/J9+GKhfaylRGHwXpykP4vC4A8TzpMhLmhxhgcmW+763GXPcyDzvDysgjaYwH38PprELU4hbEMHuBEnqR1DngsPy8Kqh3tkPmo0gZtL7zGjM1k7atXbJSS27SDbv2EmPceDhWXpTfSDQmCxYs84LQZIVrpMvqVaJ/9aZRZzzDElLv3059sLSF3WasImmM5FxMU4/+698yh/3/2owgRONHrm3EQOJTKmr4NXYQEJHYtIoebccXyO6XHiu3SPkgP78+LUDw7muFiMFfgc/3+Y//foY4a5wB8zvA/xX9auz5FT8QAAAABJRU5ErkJggg=="}))},Ba:p},d=()=>{a.forEach(t=>{const e=y(t);if(!e)return;const{JW:i,QW:s}=e,r=s?Rx(-2,1):void 0,n=`${Rx(0,40,1,42,1,43,1,44,1,45,1,46,1,47,1)}${i}${r?Rx(0,5,1,63,1,64,1,59,1,65,1,41,5):""}`;qx(n,x,!1,r)})},m=t=>Ix.atob(t),y=t=>{const e=Object.values(Hn).includes(t)?t:void 0;if(e){switch(t){case Hn.yo:return Px.po||Px.yo?void 0:{JW:m(e),QW:!0};case Hn.bo:return Px.po||Px.bo?void 0:{JW:m(e),QW:!0};case Hn.Mo:return Px.po||Px.vo||Px.Mo?void 0:{JW:m(e),QW:!0};case Hn.vo:return Px.po||Px.vo?void 0:{JW:m(e),QW:!0};case Hn.To:return Px.po||Px.vo||Px.To?void 0:{JW:m(e),QW:!0};case Hn.Lo:return Px.po||Px.vo||Px.Lo?void 0:{JW:m(e),QW:!0};case Hn.Eo:return Px.po||Px.vo||Px.Eo?void 0:{JW:m(e),QW:!0};case Hn.Oo:return Px.po||Px.vo||Px.Oo?void 0:{JW:m(e),QW:!0};case Hn.zo:return Px.po||Px.vo||Px.zo?void 0:{JW:m(e),QW:!0};case Hn.Ro:return Px.po||Px.vo||Px.Ro?void 0:{JW:m(e),QW:!0};case Hn._o:return Px.po||Px.vo||Px._o?void 0:{JW:m(e),QW:!0};case Hn.Io:return Px.po||Px.vo||Px.Io?void 0:{JW:m(e),QW:!0};case Hn.Co:return Px.po||Px.vo||Px.Co?void 0:{JW:m(e),QW:!0};case Hn.Po:return Px.po||Px.vo||Px.Po?void 0:{JW:m(e),QW:!0};case Hn.Do:return Px.po||Px.vo||Px.Do?void 0:{JW:m(e),QW:!0};case Hn.Bo:return Px.po||Px.vo||Px.Bo?void 0:{JW:m(e),QW:!0};case Hn.wo:return Px.po||Px.vo||Px.wo?void 0:{JW:m(e),QW:!0};case Hn.ko:return Px.po||Px.vo||Px.ko?void 0:{JW:m(e),QW:!0};case Hn.Fo:return Px.po||Px.vo||Px.Fo?void 0:{JW:m(e),QW:!0};case Hn.Vo:return Px.po||Px.vo||Px.Vo?void 0:{JW:m(e),QW:!0};case Hn.No:return Px.po||Px.vo||Px.No?void 0:{JW:m(e),QW:!0};case Hn.po:case Hn.mo:case Hn.So:case Hn.xo:case Hn.Go:case Hn.$o:return}return Ye(0,"")}},x=new Uy(n,r,u);Array.from(x.zn.children).forEach(t=>{"lcjs-error"===t.id&&x.zn.removeChild(t)}),(null==i?void 0:i.YW)&&qx(i.YW,x,void 0,i.HW);const v=t=>{if("error"===(null==t?void 0:t.type)&&s){const t=s.split("-");if(2===t.length&&Hx(t[0],t[1])){const[,e]=t[0].split(":").map(t=>Number(t)),i=Date.now();if(e+Fx>i)return Ox=!1,void Kx(g,!1,A)}}if(g.readyState===Ix[Rx(-1,0)].DONE)if(200===g.status){const t=JSON.parse(g[Rx(-1,23)]);if(!Hx(h+Rx(-3,0),t.h)){const t=Rx(0,0,1,27,1,28,1,29,1,30,1,31,5);qx(t,x)}Ix[Rx(-1,34)][Rx(-1,36)](Rx(-1,39),t.t),Ix[Rx(-1,34)][Rx(-1,36)](Rx(-1,33),t.s),Ox=!1}else{let e=Rx(0,0,1,2,1,7,1,12,5);try{e=t&&"loadend"!==t.type?Rx(0,0,1,23,1,32,1,24,5):JSON.parse(g[Rx(-1,23)]).message,Kx(g,!1,A)}catch(t){console.error(t)}qx(e,x,void 0,"aHR0cHM6Ly9saWdodG5pbmdjaGFydC5jb20vanMtY2hhcnRzL2RvY3MvbGljZW5zZXMvZGV2ZWxvcGVyLWxpY2Vuc2Vz")}},A=t=>{v(t)};if(Kx(g,!0,A),f?setTimeout(()=>{if(Ox){let t=!0;if(s){const e=s.split("-");if(2===e.length&&Hx(e[0],e[1])){const[,i]=e[0].split(":").map(t=>Number(t)),s=Date.now();i+Fx>s&&(t=!1)}}t&&qx(Rx(0,25,1,23,1,32,1,24,5),x)}},1e4):Kx(g,!1,A),l){const i=(()=>{const t=new(Ix[Rx(-1,0)]);return t.open(Rx(0,26),Rx(1,0)),t.setRequestHeader("Content-Type","text/plain"),t.withCredentials=!0,t})(),s=Array.from({length:10},()=>String.fromCharCode(Math.floor(256*Math.random()))).join(""),r=r=>{if("error"===(null==r?void 0:r.type)){const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,n)}if(i.readyState===Ix.XMLHttpRequest.DONE){const r=i.getResponseHeader("X-LCJS-SANDBOX-V");if(200!==i.status||r&&"1"!==r){const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,n)}else{const r=JSON.parse(i.responseText);if(!Hx(s,r.s)){const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,n)}void 0!==e&&(e.l=r.l),p.R("logochange",{logoDataURI:r.l})}}else{const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,n)}},n=t=>{r(t)};Kx(i,!0,n),i.send(s),setTimeout(()=>{if(i.readyState<2){const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,n)}},1e4)}if(c){const i=(()=>{const t=new(Ix[Rx(-1,0)]);return t.open(Rx(0,26),Rx(1,1)),t.setRequestHeader(Rx(-1,24),Rx(-1,25)),t.withCredentials=!0,t})();let s;try{s=parseInt(Lx?Lx.split("-")[1]:Math.floor(1e6*Math.random()).toString(),16)}catch(t){s=Math.floor(1e6*Math.random())}const r=Math.floor(1e6*Math.random());h=(s^r).toString();const n={};let o="",a="";Lx=Lx||"";const l=Rx(-4,0);for(let t=0;t<Lx.length;t+=1){const e=Lx.charCodeAt(t)^l.charCodeAt(t);o+=String.fromCharCode(e)}for(let t=0;t<h.length;t+=1)a+=String.fromCharCode(h.charCodeAt(t)^l.charCodeAt(t));n[Rx(-1,3)]=Ix.btoa(o),n.h=Ix.btoa(a),n.v=1,i.send(JSON.stringify(n));const c=s=>{var r;if("error"===(null==s?void 0:s.type)){const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,u)}if(i.readyState===Ix.XMLHttpRequest.DONE)if(200===i.status){const s=JSON.parse(i.responseText);if(!Hx(h,s.h)){const e=Rx(0,0,1,7,1,12,5);qx(e,x,!1,Vx(t)),Kx(g,!1,u)}const r=s.l.split("-"),n=r[0],o=r[1];if(Hx(n,o))void 0!==e&&(e.l=n,p.R("logochange",{logoDataURI:n}));else{const e=Rx(0,0,1,7,1,12,5);qx(e,x,!1,Vx(t))}const a=s.f,l=Uint8Array.from(Ix.atob(a),t=>t.charCodeAt(0));let c=0;const f=l.subarray(c,c+=20),m=new DataView(l.buffer).getUint16(c,!0);c+=2;const y=Uint8Array.from(Array(m));for(let t=0;t<m;t+=1)y[t]=l[t+c]^f[t%f.byteLength];const v=new DataView(y.buffer);c=0;const A=Uint8Array.from(Array(v.getUint16(c,!0)));c+=2,A.set(y.subarray(c,c+=A.byteLength)),_x=new Uint8Array(A),e&&e.e&&d()}else{const e=null!==(r=JSON.parse(i.responseText).message)&&void 0!==r?r:Rx(0,0,1,7,1,12,5);qx(e,x,!1,Vx(t)),Kx(g,!1,u)}else{const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,u)}},u=t=>{c(t)};Kx(i,!0,u),setTimeout(()=>{if(i.readyState<2){const e=Rx(0,0,1,2,1,43,1,66,5,1,63,1,64,1,46,1,67,1,68);qx(e,x,!1,Vx(t)),Kx(g,!1,u)}},1e4)}return o?(t=>{let e;Ox=!1;const i=()=>{e&&(t.Fa(e.Ta()),e=void 0);const i=t.kt();e=t.zP("deployment test"),e._n(t.ai).tn(Rx(0,34,1,33)).sr({x:i.x/2,y:i.y/2}).Ll(50).Th(13).qe(new fs({color:M(128,128,128,100)})).Fl("Arial").Bl(500).setPointerEvents(!1),t._a().ka()};t.O("resize",()=>{i()}),setTimeout(i,0),setInterval(()=>{e&&e.Ta()<t.tl()-1?i():e||i()},1e3)})(x):g.readyState===Ix[Rx(-1,0)].DONE&&v(),x}})(s,n)),((t,e,i,s)=>{var r,n,o,a,h,l,c,u;let d;if(i&&i.license){const t=i.license.split("-");d=t[t.length-1]}const f=null===(r=null==i?void 0:i.webgl)||void 0===r?void 0:r.version,g={sE:null===(n=null==i?void 0:i.sharedContextOptions)||void 0===n?void 0:n.canvas,Ea:null==i?void 0:i.warnings,fE:"webgl1"===f?1:"webgl2"===f?2:void 0,lE:!1!==(null===(o=null==i?void 0:i.sharedContextOptions)||void 0===o?void 0:o.antialias),aE:(null===(a=null==i?void 0:i.sharedContextOptions)||void 0===a?void 0:a.devicePixelRatio)||void 0,bE:(null===(h=null==i?void 0:i.sharedContextOptions)||void 0===h?void 0:h.noCanvasStyles)||void 0,kE:(null===(l=null==i?void 0:i.sharedContextOptions)||void 0===l?void 0:l.noCanvasTransform)||void 0,cE:!1!==(null===(c=null==i?void 0:i.sharedContextOptions)||void 0===c?void 0:c.useStackingOrder),dE:!1!==(null===(u=null==i?void 0:i.sharedContextOptions)||void 0===u?void 0:u.useIndividualCanvas),ME:d||void 0},p=new Lp(g),m=e=>t({...e,textRenderer:e.textRenderer?e.textRenderer:void 0,textPixelSnappingEnabled:void 0!==(null==e?void 0:e.textPixelSnappingEnabled)?e.textPixelSnappingEnabled:!(null==e?void 0:e.textRenderer)&&void 0},p);return{Dashboard:Pp(m,e,i,s),ChartXY:Vp(m,e,i,s),Spider:Np(m,e,i,s),Polar:Op(m,e,i,s),Pie:Up(m,e,i,s),UIPanel:_p(m,e,i,s),Gauge:Gp(m,e,i,s),Funnel:Yp(m,e,i,s),Pyramid:Zp(m,e,i,s),Chart3D:jp(m,e,i,s),Map:Wp(m,e,i,s),DataGrid:Hp(m,e,i,s),BarChart:$p(m,e,i,s),ParallelCoordinateChart:Kp(m,e,i,s),ZoomBandChart:Xp(m,e,i,s),TreeMapChart:qp(m,e,i,s),dispose:p.G.bind(p),layout:p.LE.bind(p)}})(o,n.e,r,n.l)},e.onScreenMenuControlBaseHeight=rn,e.onScreenMenuControlBaseWidth=nn,e.onScreenMenuControlOpacity=on,e.onScreenMenuDefaultButtonShape=hn,e.onScreenMenuSpriteURL=an,e.regularColorSteps=(t,e,i,s)=>{if(!i||0===i.length)throw new Error("Invalid use regularColorSteps 'colorPalette' is undefined or empty");const r=null==s?void 0:s.formatLabels,n=null==s?void 0:s.alpha;return i.map((s,o)=>{const a=t+o/(i.length-1)*(e-t);return{color:void 0!==n?s.setA(n):s,value:a,label:r?r(a):void 0}})},e.saveToFile=bh,e.scaleTheme=(t,e)=>{const i=Object.fromEntries(Object.entries(t).map(([t,i])=>{if(R(i))return[t,i.setSize(i.getSize()*e)];if("panelPadding"===t||"chartXYPadding"===t)return[t,i*e];if("polarRadialAxisTickStyle"===t){const s=i;return[t,s.setTickLength(s.getTickLength()*e).setLabelFont(t=>t.setSize(t.getSize()*e)).setTickPadding(s.getTickPadding()*e)]}if("object"==typeof i&&"setTickStyle"in i)return[t,i.setTickStyle(t=>t.setTickLength(t.getTickLength()*e).setLabelFont(t=>t.setSize(t.getSize()*e)).setTickPadding(t.getTickPadding()*e))];if("barChartValueLabelsAfterBars"===t||"barChartValueLabelsInsideBars"===t||"barChartCategoryLabels"===t){const s=i;return[t,{...s,labelFont:s.labelFont.setSize(s.labelFont.getSize()*e)}]}return[t,i]}));[["uiButtonSize",10],["chartXYTitleMargin",5],["legendPadding",5],["uiTextPadding",5],["legendLUTLabelMargin",7],["legendLUTUnitLabelMargin",7],["legendLUTLengthHorizontal",160],["legendLUTLengthVertical",140],["legendLUTThicknessHorizontal",15],["legendLUTThicknessVertical",25],["dataGridCellPadding",5],["dataGridScrollBarThickness",20],["gaugeChartBarThickness",40],["gaugeChartValueIndicatorThickness",10],["gaugeChartNeedleLength",40],["gaugeChartNeedleThickness",10],["gaugeChartGapBetweenBarAndValueIndicators",10]].forEach(t=>{var s;const r=t[0],n=t[1];i[r]=(null!==(s=i[r])&&void 0!==s?s:n)*e}),i.cursorPointMarkerSize={x:i.cursorPointMarkerSize.x*e,y:i.cursorPointMarkerSize.y*e};const s=i.cursorDynamicBehavior;return s&&(i.cursorDynamicBehavior={...s,pointMarkerSize:s.pointMarkerSize?t=>{if(!s.pointMarkerSize)return{x:0,y:0};const i=s.pointMarkerSize(t);return{x:i.x*e,y:i.y*e}}:void 0}),i},e.synchronizeAxisIntervals=et,e.transparentFill=en,e.transparentLine=sn,e.uint32ColorFromObject=t=>F(255*t.r,255*t.g,255*t.b,255*t.a),e.uint32ColorFromRGBA=F,e.useCursorDataPointColor=Qf,e.useCursorFormatterSeriesOverride=Jf,e.vec3Utils=ri,e.xDimensionStrategy=za,e.yDimensionStrategy=_a},568(t,e,i){i.r(e),i.d(e,{Collection:()=>E,Iterable:()=>Ms,List:()=>ri,Map:()=>Le,OrderedMap:()=>xi,OrderedSet:()=>ns,PairSorting:()=>cs,Range:()=>Gi,Record:()=>us,Repeat:()=>xs,Seq:()=>H,Set:()=>Pi,Stack:()=>Ei,default:()=>Es,fromJS:()=>vs,get:()=>re,getIn:()=>Yi,has:()=>se,hasIn:()=>Wi,hash:()=>ft,is:()=>lt,isAssociative:()=>M,isCollection:()=>x,isImmutable:()=>I,isIndexed:()=>b,isKeyed:()=>A,isList:()=>si,isMap:()=>ot,isOrdered:()=>L,isOrderedMap:()=>at,isOrderedSet:()=>Di,isPlainObject:()=>te,isRecord:()=>D,isSeq:()=>B,isSet:()=>Fi,isStack:()=>Mi,isValueObject:()=>ht,merge:()=>Ae,mergeDeep:()=>be,mergeDeepWith:()=>Me,mergeWith:()=>Se,remove:()=>oe,removeIn:()=>de,set:()=>ae,setIn:()=>ce,update:()=>ge,updateIn:()=>he,version:()=>bs});var s="delete",r=32,n=31,o={};function a(t){t&&(t.value=!0)}function h(){}function l(t){return void 0===t.size&&(t.size=t.__iterate(u)),t.size}function c(t,e){if("number"!=typeof e){var i=e>>>0;if(""+i!==e||4294967295===i)return NaN;e=i}return e<0?l(t)+e:e}function u(){return!0}function d(t,e,i){return(0===t&&!m(t)||void 0!==i&&t<=-i)&&(void 0===e||void 0!==i&&e>=i)}function f(t,e){return p(t,e,0)}function g(t,e){return p(t,e,e)}function p(t,e,i){return void 0===t?i:m(t)?e===1/0?e:0|Math.max(0,e+t):void 0===e||e===t?t:0|Math.min(e,t)}function m(t){return t<0||0===t&&1/t==-1/0}var y="@@__IMMUTABLE_ITERABLE__@@";function x(t){return Boolean(t&&t[y])}var v="@@__IMMUTABLE_KEYED__@@";function A(t){return Boolean(t&&t[v])}var S="@@__IMMUTABLE_INDEXED__@@";function b(t){return Boolean(t&&t[S])}function M(t){return A(t)||b(t)}var E=function(t){return x(t)?t:H(t)},k=function(t){function e(t){return A(t)?t:$(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(E),T=function(t){function e(t){return b(t)?t:X(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(E),w=function(t){function e(t){return x(t)&&!M(t)?t:q(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(E);E.Keyed=k,E.Indexed=T,E.Set=w;var C="@@__IMMUTABLE_SEQ__@@";function B(t){return Boolean(t&&t[C])}var F="@@__IMMUTABLE_RECORD__@@";function D(t){return Boolean(t&&t[F])}function I(t){return x(t)||D(t)}var R="@@__IMMUTABLE_ORDERED__@@";function L(t){return Boolean(t&&t[R])}var P="function"==typeof Symbol&&Symbol.iterator,z="@@iterator",_=P||z,V=function(t){this.next=t};function N(t,e,i,s){var r=0===t?e:1===t?i:[e,i];return s?s.value=r:s={value:r,done:!1},s}function O(){return{value:void 0,done:!0}}function U(t){return!!Array.isArray(t)||!!Z(t)}function G(t){return t&&"function"==typeof t.next}function Y(t){var e=Z(t);return e&&e.call(t)}function Z(t){var e=t&&(P&&t[P]||t[z]);if("function"==typeof e)return e}V.prototype.toString=function(){return"[Iterator]"},V.KEYS=0,V.VALUES=1,V.ENTRIES=2,V.prototype.inspect=V.prototype.toSource=function(){return this.toString()},V.prototype[_]=function(){return this};var W=Object.prototype.hasOwnProperty;function j(t){return!(!Array.isArray(t)&&"string"!=typeof t)||t&&"object"==typeof t&&Number.isInteger(t.length)&&t.length>=0&&(0===t.length?1===Object.keys(t).length:t.hasOwnProperty(t.length-1))}var H=function(t){function e(t){return null==t?et():I(t)?t.toSeq():function(t){var e,i,s=rt(t);if(s)return(i=Z(e=t))&&i===e.entries?s.fromEntrySeq():function(t){var e=Z(t);return e&&e===t.keys}(t)?s.toSetSeq():s;if("object"==typeof t)return new J(t);throw new TypeError("Expected Array or collection object of values, or keyed object: "+t)}(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq {","}")},e.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},e.prototype.__iterate=function(t,e){var i=this._cache;if(i){for(var s=i.length,r=0;r!==s;){var n=i[e?s-++r:r++];if(!1===t(n[1],n[0],this))break}return r}return this.__iterateUncached(t,e)},e.prototype.__iterator=function(t,e){var i=this._cache;if(i){var s=i.length,r=0;return new V(function(){if(r===s)return{value:void 0,done:!0};var n=i[e?s-++r:r++];return N(t,n[0],n[1])})}return this.__iteratorUncached(t,e)},e}(E),$=function(t){function e(t){return null==t?et().toKeyedSeq():x(t)?A(t)?t.toSeq():t.fromEntrySeq():D(t)?t.toSeq():it(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toKeyedSeq=function(){return this},e}(H),X=function(t){function e(t){return null==t?et():x(t)?A(t)?t.entrySeq():t.toIndexedSeq():D(t)?t.toSeq().entrySeq():st(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toIndexedSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq [","]")},e}(H),q=function(t){function e(t){return(x(t)&&!M(t)?t:X(t)).toSetSeq()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toSetSeq=function(){return this},e}(H);H.isSeq=B,H.Keyed=$,H.Set=q,H.Indexed=X,H.prototype[C]=!0;var K=function(t){function e(t){this._array=t,this.size=t.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return this.has(t)?this._array[c(this,t)]:e},e.prototype.__iterate=function(t,e){for(var i=this._array,s=i.length,r=0;r!==s;){var n=e?s-++r:r++;if(!1===t(i[n],n,this))break}return r},e.prototype.__iterator=function(t,e){var i=this._array,s=i.length,r=0;return new V(function(){if(r===s)return{value:void 0,done:!0};var n=e?s-++r:r++;return N(t,n,i[n])})},e}(X),J=function(t){function e(t){var e=Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]);this._object=t,this._keys=e,this.size=e.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},e.prototype.has=function(t){return W.call(this._object,t)},e.prototype.__iterate=function(t,e){for(var i=this._object,s=this._keys,r=s.length,n=0;n!==r;){var o=s[e?r-++n:n++];if(!1===t(i[o],o,this))break}return n},e.prototype.__iterator=function(t,e){var i=this._object,s=this._keys,r=s.length,n=0;return new V(function(){if(n===r)return{value:void 0,done:!0};var o=s[e?r-++n:n++];return N(t,o,i[o])})},e}($);J.prototype[R]=!0;var Q,tt=function(t){function e(t){this._collection=t,this.size=t.length||t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var i=Y(this._collection),s=0;if(G(i))for(var r;!(r=i.next()).done&&!1!==t(r.value,s++,this););return s},e.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var i=Y(this._collection);if(!G(i))return new V(O);var s=0;return new V(function(){var e=i.next();return e.done?e:N(t,s++,e.value)})},e}(X);function et(){return Q||(Q=new K([]))}function it(t){var e=rt(t);if(e)return e.fromEntrySeq();if("object"==typeof t)return new J(t);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+t)}function st(t){var e=rt(t);if(e)return e;throw new TypeError("Expected Array or collection object of values: "+t)}function rt(t){return j(t)?new K(t):U(t)?new tt(t):void 0}var nt="@@__IMMUTABLE_MAP__@@";function ot(t){return Boolean(t&&t[nt])}function at(t){return ot(t)&&L(t)}function ht(t){return Boolean(t&&"function"==typeof t.equals&&"function"==typeof t.hashCode)}function lt(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if((t=t.valueOf())===(e=e.valueOf())||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!!(ht(t)&&ht(e)&&t.equals(e))}var ct="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var i=65535&(t|=0),s=65535&(e|=0);return i*s+((t>>>16)*s+i*(e>>>16)<<16>>>0)|0};function ut(t){return t>>>1&1073741824|3221225471&t}var dt=Object.prototype.valueOf;function ft(t){if(null==t)return gt(t);if("function"==typeof t.hashCode)return ut(t.hashCode(t));var e,i,s,r=(e=t).valueOf!==dt&&"function"==typeof e.valueOf?e.valueOf(e):e;if(null==r)return gt(r);switch(typeof r){case"boolean":return r?1108378657:1108378656;case"number":return function(t){if(t!=t||t===1/0)return 0;var e=0|t;for(e!==t&&(e^=4294967295*t);t>4294967295;)e^=t/=4294967295;return ut(e)}(r);case"string":return r.length>Et?(void 0===(s=wt[i=r])&&(s=pt(i),Tt===kt&&(Tt=0,wt={}),Tt++,wt[i]=s),s):pt(r);case"object":case"function":return function(t){var e;if(At&&void 0!==(e=vt.get(t)))return e;if(void 0!==(e=t[Mt]))return e;if(!yt){if(void 0!==(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Mt]))return e;if(void 0!==(e=function(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return e}if(e=xt(),At)vt.set(t,e);else{if(void 0!==mt&&!1===mt(t))throw new Error("Non-extensible objects are not allowed as keys.");if(yt)Object.defineProperty(t,Mt,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Mt]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Mt]=e}}return e}(r);case"symbol":return function(t){var e=St[t];return void 0!==e||(e=xt(),St[t]=e),e}(r);default:if("function"==typeof r.toString)return pt(r.toString());throw new Error("Value type "+typeof r+" cannot be hashed.")}}function gt(t){return null===t?1108378658:1108378659}function pt(t){for(var e=0,i=0;i<t.length;i++)e=31*e+t.charCodeAt(i)|0;return ut(e)}var mt=Object.isExtensible,yt=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}();function xt(){var t=++bt;return 1073741824&bt&&(bt=0),t}var vt,At="function"==typeof WeakMap;At&&(vt=new WeakMap);var St=Object.create(null),bt=0,Mt="__immutablehash__";"function"==typeof Symbol&&(Mt=Symbol(Mt));var Et=16,kt=255,Tt=0,wt={},Ct=function(t){function e(t,e){this._iter=t,this._useKeys=e,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return this._iter.get(t,e)},e.prototype.has=function(t){return this._iter.has(t)},e.prototype.valueSeq=function(){return this._iter.valueSeq()},e.prototype.reverse=function(){var t=this,e=Lt(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},e.prototype.map=function(t,e){var i=this,s=Rt(this,t,e);return this._useKeys||(s.valueSeq=function(){return i._iter.toSeq().map(t,e)}),s},e.prototype.__iterate=function(t,e){var i=this;return this._iter.__iterate(function(e,s){return t(e,s,i)},e)},e.prototype.__iterator=function(t,e){return this._iter.__iterator(t,e)},e}($);Ct.prototype[R]=!0;var Bt=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.includes=function(t){return this._iter.includes(t)},e.prototype.__iterate=function(t,e){var i=this,s=0;return e&&l(this),this._iter.__iterate(function(r){return t(r,e?i.size-++s:s++,i)},e)},e.prototype.__iterator=function(t,e){var i=this,s=this._iter.__iterator(1,e),r=0;return e&&l(this),new V(function(){var n=s.next();return n.done?n:N(t,e?i.size-++r:r++,n.value,n)})},e}(X),Ft=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.has=function(t){return this._iter.includes(t)},e.prototype.__iterate=function(t,e){var i=this;return this._iter.__iterate(function(e){return t(e,e,i)},e)},e.prototype.__iterator=function(t,e){var i=this._iter.__iterator(1,e);return new V(function(){var e=i.next();return e.done?e:N(t,e.value,e.value,e)})},e}(q),Dt=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.entrySeq=function(){return this._iter.toSeq()},e.prototype.__iterate=function(t,e){var i=this;return this._iter.__iterate(function(e){if(e){Zt(e);var s=x(e);return t(s?e.get(1):e[1],s?e.get(0):e[0],i)}},e)},e.prototype.__iterator=function(t,e){var i=this._iter.__iterator(1,e);return new V(function(){for(;;){var e=i.next();if(e.done)return e;var s=e.value;if(s){Zt(s);var r=x(s);return N(t,r?s.get(0):s[0],r?s.get(1):s[1],e)}}})},e}($);function It(t){var e=jt(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=Ht,e.__iterateUncached=function(e,i){var s=this;return t.__iterate(function(t,i){return!1!==e(i,t,s)},i)},e.__iteratorUncached=function(e,i){if(2===e){var s=t.__iterator(e,i);return new V(function(){var t=s.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(1===e?0:1,i)},e}function Rt(t,e,i){var s=jt(t);return s.size=t.size,s.has=function(e){return t.has(e)},s.get=function(s,r){var n=t.get(s,o);return n===o?r:e.call(i,n,s,t)},s.__iterateUncached=function(s,r){var n=this;return t.__iterate(function(t,r,o){return!1!==s(e.call(i,t,r,o),r,n)},r)},s.__iteratorUncached=function(s,r){var n=t.__iterator(2,r);return new V(function(){var r=n.next();if(r.done)return r;var o=r.value,a=o[0];return N(s,a,e.call(i,o[1],a,t),r)})},s}function Lt(t,e){var i=this,s=jt(t);return s._iter=t,s.size=t.size,s.reverse=function(){return t},t.flip&&(s.flip=function(){var e=It(t);return e.reverse=function(){return t.flip()},e}),s.get=function(i,s){return t.get(e?i:-1-i,s)},s.has=function(i){return t.has(e?i:-1-i)},s.includes=function(e){return t.includes(e)},s.cacheResult=Ht,s.__iterate=function(i,s){var r=this,n=0;return s&&l(t),t.__iterate(function(t,o){return i(t,e?o:s?r.size-++n:n++,r)},!s)},s.__iterator=function(s,r){var n=0;r&&l(t);var o=t.__iterator(2,!r);return new V(function(){var t=o.next();if(t.done)return t;var a=t.value;return N(s,e?a[0]:r?i.size-++n:n++,a[1],t)})},s}function Pt(t,e,i,s){var r=jt(t);return s&&(r.has=function(s){var r=t.get(s,o);return r!==o&&!!e.call(i,r,s,t)},r.get=function(s,r){var n=t.get(s,o);return n!==o&&e.call(i,n,s,t)?n:r}),r.__iterateUncached=function(r,n){var o=this,a=0;return t.__iterate(function(t,n,h){if(e.call(i,t,n,h))return a++,r(t,s?n:a-1,o)},n),a},r.__iteratorUncached=function(r,n){var o=t.__iterator(2,n),a=0;return new V(function(){for(;;){var n=o.next();if(n.done)return n;var h=n.value,l=h[0],c=h[1];if(e.call(i,c,l,t))return N(r,s?l:a++,c,n)}})},r}function zt(t,e,i,s){var r=t.size;if(d(e,i,r))return t;if(void 0===r&&(e<0||i<0))return zt(t.toSeq().cacheResult(),e,i,s);var n,o=f(e,r),a=g(i,r)-o;a==a&&(n=a<0?0:a);var h=jt(t);return h.size=0===n?n:t.size&&n||void 0,!s&&B(t)&&n>=0&&(h.get=function(e,i){return(e=c(this,e))>=0&&e<n?t.get(e+o,i):i}),h.__iterateUncached=function(e,i){var r=this;if(0===n)return 0;if(i)return this.cacheResult().__iterate(e,i);var a=0,h=!0,l=0;return t.__iterate(function(t,i){if(!h||!(h=a++<o))return l++,!1!==e(t,s?i:l-1,r)&&l!==n}),l},h.__iteratorUncached=function(e,i){if(0!==n&&i)return this.cacheResult().__iterator(e,i);if(0===n)return new V(O);var r=t.__iterator(e,i),a=0,h=0;return new V(function(){for(;a++<o;)r.next();if(++h>n)return{value:void 0,done:!0};var t=r.next();return s||1===e||t.done?t:N(e,h-1,0===e?void 0:t.value[1],t)})},h}function _t(t,e,i,s){var r=jt(t);return r.__iterateUncached=function(r,n){var o=this;if(n)return this.cacheResult().__iterate(r,n);var a=!0,h=0;return t.__iterate(function(t,n,l){if(!a||!(a=e.call(i,t,n,l)))return h++,r(t,s?n:h-1,o)}),h},r.__iteratorUncached=function(r,n){var o=this;if(n)return this.cacheResult().__iterator(r,n);var a=t.__iterator(2,n),h=!0,l=0;return new V(function(){var t,n,c;do{if((t=a.next()).done)return s||1===r?t:N(r,l++,0===r?void 0:t.value[1],t);var u=t.value;n=u[0],c=u[1],h&&(h=e.call(i,c,n,o))}while(h);return 2===r?t:N(r,n,c,t)})},r}function Vt(t,e,i){var s=jt(t);return s.__iterateUncached=function(r,n){if(n)return this.cacheResult().__iterate(r,n);var o=0,a=!1;return function t(h,l){h.__iterate(function(n,h){return(!e||l<e)&&x(n)?t(n,l+1):(o++,!1===r(n,i?h:o-1,s)&&(a=!0)),!a},n)}(t,0),o},s.__iteratorUncached=function(s,r){if(r)return this.cacheResult().__iterator(s,r);var n=t.__iterator(s,r),o=[],a=0;return new V(function(){for(;n;){var t=n.next();if(!1===t.done){var h=t.value;if(2===s&&(h=h[1]),e&&!(o.length<e)||!x(h))return i?t:N(s,a++,h,t);o.push(n),n=h.__iterator(s,r)}else n=o.pop()}return{value:void 0,done:!0}})},s}function Nt(t,e,i){e||(e=$t);var s=A(t),r=0,n=t.toSeq().map(function(e,s){return[s,e,r++,i?i(e,s,t):e]}).valueSeq().toArray();return n.sort(function(t,i){return e(t[3],i[3])||t[2]-i[2]}).forEach(s?function(t,e){n[e].length=2}:function(t,e){n[e]=t[1]}),s?$(n):b(t)?X(n):q(n)}function Ot(t,e,i){if(e||(e=$t),i){var s=t.toSeq().map(function(e,s){return[e,i(e,s,t)]}).reduce(function(t,i){return Ut(e,t[1],i[1])?i:t});return s&&s[0]}return t.reduce(function(t,i){return Ut(e,t,i)?i:t})}function Ut(t,e,i){var s=t(i,e);return 0===s&&i!==e&&(null==i||i!=i)||s>0}function Gt(t,e,i,s){var r=jt(t),n=new K(i).map(function(t){return t.size});return r.size=s?n.max():n.min(),r.__iterate=function(t,e){for(var i,s=this.__iterator(1,e),r=0;!(i=s.next()).done&&!1!==t(i.value,r++,this););return r},r.__iteratorUncached=function(t,r){var n=i.map(function(t){return t=E(t),Y(r?t.reverse():t)}),o=0,a=!1;return new V(function(){var i;return a||(i=n.map(function(t){return t.next()}),a=s?i.every(function(t){return t.done}):i.some(function(t){return t.done})),a?{value:void 0,done:!0}:N(t,o++,e.apply(null,i.map(function(t){return t.value})))})},r}function Yt(t,e){return t===e?t:B(t)?e:t.constructor(e)}function Zt(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Wt(t){return A(t)?k:b(t)?T:w}function jt(t){return Object.create((A(t)?$:b(t)?X:q).prototype)}function Ht(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):H.prototype.cacheResult.call(this)}function $t(t,e){return void 0===t&&void 0===e?0:void 0===t?1:void 0===e?-1:t>e?1:t<e?-1:0}function Xt(t,e){e=e||0;for(var i=Math.max(0,t.length-e),s=new Array(i),r=0;r<i;r++)s[r]=t[r+e];return s}function qt(t,e){if(!t)throw new Error(e)}function Kt(t){qt(t!==1/0,"Cannot perform this action with an infinite size.")}function Jt(t){if(j(t)&&"string"!=typeof t)return t;if(L(t))return t.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+t)}Bt.prototype.cacheResult=Ct.prototype.cacheResult=Ft.prototype.cacheResult=Dt.prototype.cacheResult=Ht;var Qt=Object.prototype.toString;function te(t){if(!t||"object"!=typeof t||"[object Object]"!==Qt.call(t))return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;for(var i=e,s=Object.getPrototypeOf(e);null!==s;)i=s,s=Object.getPrototypeOf(i);return i===e}function ee(t){return"object"==typeof t&&(I(t)||Array.isArray(t)||te(t))}function ie(t){try{return"string"==typeof t?JSON.stringify(t):String(t)}catch(e){return JSON.stringify(t)}}function se(t,e){return I(t)?t.has(e):ee(t)&&W.call(t,e)}function re(t,e,i){return I(t)?t.get(e,i):se(t,e)?"function"==typeof t.get?t.get(e):t[e]:i}function ne(t){if(Array.isArray(t))return Xt(t);var e={};for(var i in t)W.call(t,i)&&(e[i]=t[i]);return e}function oe(t,e){if(!ee(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(I(t)){if(!t.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+t);return t.remove(e)}if(!W.call(t,e))return t;var i=ne(t);return Array.isArray(i)?i.splice(e,1):delete i[e],i}function ae(t,e,i){if(!ee(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(I(t)){if(!t.set)throw new TypeError("Cannot update immutable value without .set() method: "+t);return t.set(e,i)}if(W.call(t,e)&&i===t[e])return t;var s=ne(t);return s[e]=i,s}function he(t,e,i,s){s||(s=i,i=void 0);var r=le(I(t),t,Jt(e),0,i,s);return r===o?i:r}function le(t,e,i,s,r,n){var a=e===o;if(s===i.length){var h=a?r:e,l=n(h);return l===h?e:l}if(!a&&!ee(e))throw new TypeError("Cannot update within non-data-structure value in path ["+i.slice(0,s).map(ie)+"]: "+e);var c=i[s],u=a?o:re(e,c,o),d=le(u===o?t:I(u),u,i,s+1,r,n);return d===u?e:d===o?oe(e,c):ae(a?t?je():{}:e,c,d)}function ce(t,e,i){return he(t,e,o,function(){return i})}function ue(t,e){return ce(this,t,e)}function de(t,e){return he(t,e,function(){return o})}function fe(t){return de(this,t)}function ge(t,e,i,s){return he(t,[e],i,s)}function pe(t,e,i){return 1===arguments.length?t(this):ge(this,t,e,i)}function me(t,e,i){return he(this,t,e,i)}function ye(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return ve(this,t)}function xe(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if("function"!=typeof t)throw new TypeError("Invalid merger function: "+t);return ve(this,e,t)}function ve(t,e,i){for(var s=[],r=0;r<e.length;r++){var n=k(e[r]);0!==n.size&&s.push(n)}return 0===s.length?t:0!==t.toSeq().size||t.__ownerID||1!==s.length?t.withMutations(function(t){for(var e=i?function(e,s){ge(t,s,o,function(t){return t===o?e:i(t,e,s)})}:function(e,i){t.set(i,e)},r=0;r<s.length;r++)s[r].forEach(e)}):t.constructor(s[0])}function Ae(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return ke(t,e)}function Se(t,e){for(var i=[],s=arguments.length-2;s-- >0;)i[s]=arguments[s+2];return ke(e,i,t)}function be(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return Ee(t,e)}function Me(t,e){for(var i=[],s=arguments.length-2;s-- >0;)i[s]=arguments[s+2];return Ee(e,i,t)}function Ee(t,e,i){return ke(t,e,function(t){return function e(i,s,r){return ee(i)&&ee(s)&&(n=s,o=H(i),a=H(n),b(o)===b(a)&&A(o)===A(a))?ke(i,[s],e):t?t(i,s,r):s;var n,o,a}}(i))}function ke(t,e,i){if(!ee(t))throw new TypeError("Cannot merge into non-data-structure value: "+t);if(I(t))return"function"==typeof i&&t.mergeWith?t.mergeWith.apply(t,[i].concat(e)):t.merge?t.merge.apply(t,e):t.concat.apply(t,e);for(var s=Array.isArray(t),r=t,n=s?T:k,o=s?function(e){r===t&&(r=ne(r)),r.push(e)}:function(e,s){var n=W.call(r,s),o=n&&i?i(r[s],e,s):e;n&&o===r[s]||(r===t&&(r=ne(r)),r[s]=o)},a=0;a<e.length;a++)n(e[a]).forEach(o);return r}function Te(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Ee(this,t)}function we(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return Ee(this,e,t)}function Ce(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return he(this,t,je(),function(t){return ke(t,e)})}function Be(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return he(this,t,je(),function(t){return Ee(t,e)})}function Fe(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this}function De(){return this.__ownerID?this:this.__ensureOwner(new h)}function Ie(){return this.__ensureOwner()}function Re(){return this.__altered}var Le=function(t){function e(e){return null==e?je():ot(e)&&!L(e)?e:je().withMutations(function(i){var s=t(e);Kt(s.size),s.forEach(function(t,e){return i.set(e,t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return je().withMutations(function(e){for(var i=0;i<t.length;i+=2){if(i+1>=t.length)throw new Error("Missing value for key: "+t[i]);e.set(t[i],t[i+1])}})},e.prototype.toString=function(){return this.__toString("Map {","}")},e.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},e.prototype.set=function(t,e){return He(this,t,e)},e.prototype.remove=function(t){return He(this,t,o)},e.prototype.deleteAll=function(t){var e=E(t);return 0===e.size?this:this.withMutations(function(t){e.forEach(function(e){return t.remove(e)})})},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):je()},e.prototype.sort=function(t){return xi(Nt(this,t))},e.prototype.sortBy=function(t,e){return xi(Nt(this,e,t))},e.prototype.map=function(t,e){var i=this;return this.withMutations(function(s){s.forEach(function(r,n){s.set(n,t.call(e,r,n,i))})})},e.prototype.__iterator=function(t,e){return new Ge(this,t,e)},e.prototype.__iterate=function(t,e){var i=this,s=0;return this._root&&this._root.iterate(function(e){return s++,t(e[1],e[0],i)},e),s},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?We(this.size,this._root,t,this.__hash):0===this.size?je():(this.__ownerID=t,this.__altered=!1,this)},e}(k);Le.isMap=ot;var Pe=Le.prototype;Pe[nt]=!0,Pe[s]=Pe.remove,Pe.removeAll=Pe.deleteAll,Pe.setIn=ue,Pe.removeIn=Pe.deleteIn=fe,Pe.update=pe,Pe.updateIn=me,Pe.merge=Pe.concat=ye,Pe.mergeWith=xe,Pe.mergeDeep=Te,Pe.mergeDeepWith=we,Pe.mergeIn=Ce,Pe.mergeDeepIn=Be,Pe.withMutations=Fe,Pe.wasAltered=Re,Pe.asImmutable=Ie,Pe["@@transducer/init"]=Pe.asMutable=De,Pe["@@transducer/step"]=function(t,e){return t.set(e[0],e[1])},Pe["@@transducer/result"]=function(t){return t.asImmutable()};var ze=function(t,e){this.ownerID=t,this.entries=e};ze.prototype.get=function(t,e,i,s){for(var r=this.entries,n=0,o=r.length;n<o;n++)if(lt(i,r[n][0]))return r[n][1];return s},ze.prototype.update=function(t,e,i,s,r,n,l){for(var c=r===o,u=this.entries,d=0,f=u.length;d<f&&!lt(s,u[d][0]);d++);var g=d<f;if(g?u[d][1]===r:c)return this;if(a(l),(c||!g)&&a(n),!c||1!==u.length){if(!g&&!c&&u.length>=Qe)return function(t,e,i,s){t||(t=new h);for(var r=new Oe(t,ft(i),[i,s]),n=0;n<e.length;n++){var o=e[n];r=r.update(t,0,void 0,o[0],o[1])}return r}(t,u,s,r);var p=t&&t===this.ownerID,m=p?u:Xt(u);return g?c?d===f-1?m.pop():m[d]=m.pop():m[d]=[s,r]:m.push([s,r]),p?(this.entries=m,this):new ze(t,m)}};var _e=function(t,e,i){this.ownerID=t,this.bitmap=e,this.nodes=i};_e.prototype.get=function(t,e,i,s){void 0===e&&(e=ft(i));var r=1<<((0===t?e:e>>>t)&n),o=this.bitmap;return 0===(o&r)?s:this.nodes[Ke(o&r-1)].get(t+5,e,i,s)},_e.prototype.update=function(t,e,i,s,a,h,l){void 0===i&&(i=ft(s));var c=(0===e?i:i>>>e)&n,u=1<<c,d=this.bitmap,f=0!==(d&u);if(!f&&a===o)return this;var g=Ke(d&u-1),p=this.nodes,m=f?p[g]:void 0,y=$e(m,t,e+5,i,s,a,h,l);if(y===m)return this;if(!f&&y&&p.length>=ti)return function(t,e,i,s,n){for(var o=0,a=new Array(r),h=0;0!==i;h++,i>>>=1)a[h]=1&i?e[o++]:void 0;return a[s]=n,new Ve(t,o+1,a)}(t,p,d,c,y);if(f&&!y&&2===p.length&&Xe(p[1^g]))return p[1^g];if(f&&y&&1===p.length&&Xe(y))return y;var x=t&&t===this.ownerID,v=f?y?d:d^u:d|u,A=f?y?Je(p,g,y,x):function(t,e,i){var s=t.length-1;if(i&&e===s)return t.pop(),t;for(var r=new Array(s),n=0,o=0;o<s;o++)o===e&&(n=1),r[o]=t[o+n];return r}(p,g,x):function(t,e,i,s){var r=t.length+1;if(s&&e+1===r)return t[e]=i,t;for(var n=new Array(r),o=0,a=0;a<r;a++)a===e?(n[a]=i,o=-1):n[a]=t[a+o];return n}(p,g,y,x);return x?(this.bitmap=v,this.nodes=A,this):new _e(t,v,A)};var Ve=function(t,e,i){this.ownerID=t,this.count=e,this.nodes=i};Ve.prototype.get=function(t,e,i,s){void 0===e&&(e=ft(i));var r=(0===t?e:e>>>t)&n,o=this.nodes[r];return o?o.get(t+5,e,i,s):s},Ve.prototype.update=function(t,e,i,s,r,a,h){void 0===i&&(i=ft(s));var l=(0===e?i:i>>>e)&n,c=r===o,u=this.nodes,d=u[l];if(c&&!d)return this;var f=$e(d,t,e+5,i,s,r,a,h);if(f===d)return this;var g=this.count;if(d){if(!f&&--g<ei)return function(t,e,i,s){for(var r=0,n=0,o=new Array(i),a=0,h=1,l=e.length;a<l;a++,h<<=1){var c=e[a];void 0!==c&&a!==s&&(r|=h,o[n++]=c)}return new _e(t,r,o)}(t,u,g,l)}else g++;var p=t&&t===this.ownerID,m=Je(u,l,f,p);return p?(this.count=g,this.nodes=m,this):new Ve(t,g,m)};var Ne=function(t,e,i){this.ownerID=t,this.keyHash=e,this.entries=i};Ne.prototype.get=function(t,e,i,s){for(var r=this.entries,n=0,o=r.length;n<o;n++)if(lt(i,r[n][0]))return r[n][1];return s},Ne.prototype.update=function(t,e,i,s,r,n,h){void 0===i&&(i=ft(s));var l=r===o;if(i!==this.keyHash)return l?this:(a(h),a(n),qe(this,t,e,i,[s,r]));for(var c=this.entries,u=0,d=c.length;u<d&&!lt(s,c[u][0]);u++);var f=u<d;if(f?c[u][1]===r:l)return this;if(a(h),(l||!f)&&a(n),l&&2===d)return new Oe(t,this.keyHash,c[1^u]);var g=t&&t===this.ownerID,p=g?c:Xt(c);return f?l?u===d-1?p.pop():p[u]=p.pop():p[u]=[s,r]:p.push([s,r]),g?(this.entries=p,this):new Ne(t,this.keyHash,p)};var Oe=function(t,e,i){this.ownerID=t,this.keyHash=e,this.entry=i};Oe.prototype.get=function(t,e,i,s){return lt(i,this.entry[0])?this.entry[1]:s},Oe.prototype.update=function(t,e,i,s,r,n,h){var l=r===o,c=lt(s,this.entry[0]);return(c?r===this.entry[1]:l)?this:(a(h),l?void a(n):c?t&&t===this.ownerID?(this.entry[1]=r,this):new Oe(t,this.keyHash,[s,r]):(a(n),qe(this,t,e,ft(s),[s,r])))},ze.prototype.iterate=Ne.prototype.iterate=function(t,e){for(var i=this.entries,s=0,r=i.length-1;s<=r;s++)if(!1===t(i[e?r-s:s]))return!1},_e.prototype.iterate=Ve.prototype.iterate=function(t,e){for(var i=this.nodes,s=0,r=i.length-1;s<=r;s++){var n=i[e?r-s:s];if(n&&!1===n.iterate(t,e))return!1}},Oe.prototype.iterate=function(t,e){return t(this.entry)};var Ue,Ge=function(t){function e(t,e,i){this._type=e,this._reverse=i,this._stack=t._root&&Ze(t._root)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var i=e.node,s=e.index++,r=void 0;if(i.entry){if(0===s)return Ye(t,i.entry)}else if(i.entries){if(s<=(r=i.entries.length-1))return Ye(t,i.entries[this._reverse?r-s:s])}else if(s<=(r=i.nodes.length-1)){var n=i.nodes[this._reverse?r-s:s];if(n){if(n.entry)return Ye(t,n.entry);e=this._stack=Ze(n,e)}continue}e=this._stack=this._stack.__prev}return{value:void 0,done:!0}},e}(V);function Ye(t,e){return N(t,e[0],e[1])}function Ze(t,e){return{node:t,index:0,__prev:e}}function We(t,e,i,s){var r=Object.create(Pe);return r.size=t,r._root=e,r.__ownerID=i,r.__hash=s,r.__altered=!1,r}function je(){return Ue||(Ue=We(0))}function He(t,e,i){var s,r;if(t._root){var n={value:!1},a={value:!1};if(s=$e(t._root,t.__ownerID,0,void 0,e,i,n,a),!a.value)return t;r=t.size+(n.value?i===o?-1:1:0)}else{if(i===o)return t;r=1,s=new ze(t.__ownerID,[[e,i]])}return t.__ownerID?(t.size=r,t._root=s,t.__hash=void 0,t.__altered=!0,t):s?We(r,s):je()}function $e(t,e,i,s,r,n,h,l){return t?t.update(e,i,s,r,n,h,l):n===o?t:(a(l),a(h),new Oe(e,s,[r,n]))}function Xe(t){return t.constructor===Oe||t.constructor===Ne}function qe(t,e,i,s,r){if(t.keyHash===s)return new Ne(e,s,[t.entry,r]);var o,a=(0===i?t.keyHash:t.keyHash>>>i)&n,h=(0===i?s:s>>>i)&n,l=a===h?[qe(t,e,i+5,s,r)]:(o=new Oe(e,s,r),a<h?[t,o]:[o,t]);return new _e(e,1<<a|1<<h,l)}function Ke(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,127&(t+=t>>8)+(t>>16)}function Je(t,e,i,s){var r=s?t:Xt(t);return r[e]=i,r}var Qe=8,ti=16,ei=8,ii="@@__IMMUTABLE_LIST__@@";function si(t){return Boolean(t&&t[ii])}var ri=function(t){function e(e){var i=ui();if(null==e)return i;if(si(e))return e;var s=t(e),n=s.size;return 0===n?i:(Kt(n),n>0&&n<r?ci(0,n,5,null,new oi(s.toArray())):i.withMutations(function(t){t.setSize(n),s.forEach(function(e,i){return t.set(i,e)})}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("List [","]")},e.prototype.get=function(t,e){if((t=c(this,t))>=0&&t<this.size){var i=gi(this,t+=this._origin);return i&&i.array[t&n]}return e},e.prototype.set=function(t,e){return function(t,e,i){if((e=c(t,e))!=e)return t;if(e>=t.size||e<0)return t.withMutations(function(t){e<0?pi(t,e).set(0,i):pi(t,0,e+1).set(e,i)});e+=t._origin;var s=t._tail,r=t._root,n={value:!1};return e>=mi(t._capacity)?s=di(s,t.__ownerID,0,e,i,n):r=di(r,t.__ownerID,t._level,e,i,n),n.value?t.__ownerID?(t._root=r,t._tail=s,t.__hash=void 0,t.__altered=!0,t):ci(t._origin,t._capacity,t._level,r,s):t}(this,t,e)},e.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},e.prototype.insert=function(t,e){return this.splice(t,0,e)},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):ui()},e.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(i){pi(i,0,e+t.length);for(var s=0;s<t.length;s++)i.set(e+s,t[s])})},e.prototype.pop=function(){return pi(this,0,-1)},e.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){pi(e,-t.length);for(var i=0;i<t.length;i++)e.set(i,t[i])})},e.prototype.shift=function(){return pi(this,1)},e.prototype.concat=function(){for(var e=arguments,i=[],s=0;s<arguments.length;s++){var r=e[s],n=t("string"!=typeof r&&U(r)?r:[r]);0!==n.size&&i.push(n)}return 0===i.length?this:0!==this.size||this.__ownerID||1!==i.length?this.withMutations(function(t){i.forEach(function(e){return e.forEach(function(e){return t.push(e)})})}):this.constructor(i[0])},e.prototype.setSize=function(t){return pi(this,0,t)},e.prototype.map=function(t,e){var i=this;return this.withMutations(function(s){for(var r=0;r<i.size;r++)s.set(r,t.call(e,s.get(r),r,i))})},e.prototype.slice=function(t,e){var i=this.size;return d(t,e,i)?this:pi(this,f(t,i),g(e,i))},e.prototype.__iterator=function(t,e){var i=e?this.size:0,s=li(this,e);return new V(function(){var r=s();return r===hi?{value:void 0,done:!0}:N(t,e?--i:i++,r)})},e.prototype.__iterate=function(t,e){for(var i,s=e?this.size:0,r=li(this,e);(i=r())!==hi&&!1!==t(i,e?--s:s++,this););return s},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?ci(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):0===this.size?ui():(this.__ownerID=t,this.__altered=!1,this)},e}(T);ri.isList=si;var ni=ri.prototype;ni[ii]=!0,ni[s]=ni.remove,ni.merge=ni.concat,ni.setIn=ue,ni.deleteIn=ni.removeIn=fe,ni.update=pe,ni.updateIn=me,ni.mergeIn=Ce,ni.mergeDeepIn=Be,ni.withMutations=Fe,ni.wasAltered=Re,ni.asImmutable=Ie,ni["@@transducer/init"]=ni.asMutable=De,ni["@@transducer/step"]=function(t,e){return t.push(e)},ni["@@transducer/result"]=function(t){return t.asImmutable()};var oi=function(t,e){this.array=t,this.ownerID=e};oi.prototype.removeBefore=function(t,e,i){if(i===e?1<<e:0===this.array.length)return this;var s=i>>>e&n;if(s>=this.array.length)return new oi([],t);var r,o=0===s;if(e>0){var a=this.array[s];if((r=a&&a.removeBefore(t,e-5,i))===a&&o)return this}if(o&&!r)return this;var h=fi(this,t);if(!o)for(var l=0;l<s;l++)h.array[l]=void 0;return r&&(h.array[s]=r),h},oi.prototype.removeAfter=function(t,e,i){if(i===(e?1<<e:0)||0===this.array.length)return this;var s,r=i-1>>>e&n;if(r>=this.array.length)return this;if(e>0){var o=this.array[r];if((s=o&&o.removeAfter(t,e-5,i))===o&&r===this.array.length-1)return this}var a=fi(this,t);return a.array.splice(r+1),s&&(a.array[r]=s),a};var ai,hi={};function li(t,e){var i=t._origin,s=t._capacity,n=mi(s),o=t._tail;return function t(a,h,l){return 0===h?function(t,a){var h=a===n?o&&o.array:t&&t.array,l=a>i?0:i-a,c=s-a;return c>r&&(c=r),function(){if(l===c)return hi;var t=e?--c:l++;return h&&h[t]}}(a,l):function(n,o,a){var h,l=n&&n.array,c=a>i?0:i-a>>o,u=1+(s-a>>o);return u>r&&(u=r),function(){for(;;){if(h){var i=h();if(i!==hi)return i;h=null}if(c===u)return hi;var s=e?--u:c++;h=t(l&&l[s],o-5,a+(s<<o))}}}(a,h,l)}(t._root,t._level,0)}function ci(t,e,i,s,r,n,o){var a=Object.create(ni);return a.size=e-t,a._origin=t,a._capacity=e,a._level=i,a._root=s,a._tail=r,a.__ownerID=n,a.__hash=o,a.__altered=!1,a}function ui(){return ai||(ai=ci(0,0,5))}function di(t,e,i,s,r,o){var h,l=s>>>i&n,c=t&&l<t.array.length;if(!c&&void 0===r)return t;if(i>0){var u=t&&t.array[l],d=di(u,e,i-5,s,r,o);return d===u?t:((h=fi(t,e)).array[l]=d,h)}return c&&t.array[l]===r?t:(o&&a(o),h=fi(t,e),void 0===r&&l===h.array.length-1?h.array.pop():h.array[l]=r,h)}function fi(t,e){return e&&t&&e===t.ownerID?t:new oi(t?t.array.slice():[],e)}function gi(t,e){if(e>=mi(t._capacity))return t._tail;if(e<1<<t._level+5){for(var i=t._root,s=t._level;i&&s>0;)i=i.array[e>>>s&n],s-=5;return i}}function pi(t,e,i){void 0!==e&&(e|=0),void 0!==i&&(i|=0);var s=t.__ownerID||new h,r=t._origin,o=t._capacity,a=r+e,l=void 0===i?o:i<0?o+i:r+i;if(a===r&&l===o)return t;if(a>=l)return t.clear();for(var c=t._level,u=t._root,d=0;a+d<0;)u=new oi(u&&u.array.length?[void 0,u]:[],s),d+=1<<(c+=5);d&&(a+=d,r+=d,l+=d,o+=d);for(var f=mi(o),g=mi(l);g>=1<<c+5;)u=new oi(u&&u.array.length?[u]:[],s),c+=5;var p=t._tail,m=g<f?gi(t,l-1):g>f?new oi([],s):p;if(p&&g>f&&a<o&&p.array.length){for(var y=u=fi(u,s),x=c;x>5;x-=5){var v=f>>>x&n;y=y.array[v]=fi(y.array[v],s)}y.array[f>>>5&n]=p}if(l<o&&(m=m&&m.removeAfter(s,0,l)),a>=g)a-=g,l-=g,c=5,u=null,m=m&&m.removeBefore(s,0,a);else if(a>r||g<f){for(d=0;u;){var A=a>>>c&n;if(A!==g>>>c&n)break;A&&(d+=(1<<c)*A),c-=5,u=u.array[A]}u&&a>r&&(u=u.removeBefore(s,c,a-d)),u&&g<f&&(u=u.removeAfter(s,c,g-d)),d&&(a-=d,l-=d)}return t.__ownerID?(t.size=l-a,t._origin=a,t._capacity=l,t._level=c,t._root=u,t._tail=m,t.__hash=void 0,t.__altered=!0,t):ci(a,l,c,u,m)}function mi(t){return t<r?0:t-1>>>5<<5}var yi,xi=function(t){function e(t){return null==t?Ai():at(t)?t:Ai().withMutations(function(e){var i=k(t);Kt(i.size),i.forEach(function(t,i){return e.set(i,t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("OrderedMap {","}")},e.prototype.get=function(t,e){var i=this._map.get(t);return void 0!==i?this._list.get(i)[1]:e},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):Ai()},e.prototype.set=function(t,e){return Si(this,t,e)},e.prototype.remove=function(t){return Si(this,t,o)},e.prototype.__iterate=function(t,e){var i=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],i)},e)},e.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},e.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),i=this._list.__ensureOwner(t);return t?vi(e,i,t,this.__hash):0===this.size?Ai():(this.__ownerID=t,this.__altered=!1,this._map=e,this._list=i,this)},e}(Le);function vi(t,e,i,s){var r=Object.create(xi.prototype);return r.size=t?t.size:0,r._map=t,r._list=e,r.__ownerID=i,r.__hash=s,r.__altered=!1,r}function Ai(){return yi||(yi=vi(je(),ui()))}function Si(t,e,i){var s,n,a=t._map,h=t._list,l=a.get(e),c=void 0!==l;if(i===o){if(!c)return t;h.size>=r&&h.size>=2*a.size?(s=(n=h.filter(function(t,e){return void 0!==t&&l!==e})).toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(s.__ownerID=n.__ownerID=t.__ownerID)):(s=a.remove(e),n=l===h.size-1?h.pop():h.set(l,void 0))}else if(c){if(i===h.get(l)[1])return t;s=a,n=h.set(l,[e,i])}else s=a.set(e,h.size),n=h.set(h.size,[e,i]);return t.__ownerID?(t.size=s.size,t._map=s,t._list=n,t.__hash=void 0,t.__altered=!0,t):vi(s,n)}xi.isOrderedMap=at,xi.prototype[R]=!0,xi.prototype[s]=xi.prototype.remove;var bi="@@__IMMUTABLE_STACK__@@";function Mi(t){return Boolean(t&&t[bi])}var Ei=function(t){function e(t){return null==t?Ci():Mi(t)?t:Ci().pushAll(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("Stack [","]")},e.prototype.get=function(t,e){var i=this._head;for(t=c(this,t);i&&t--;)i=i.next;return i?i.value:e},e.prototype.peek=function(){return this._head&&this._head.value},e.prototype.push=function(){var t=arguments;if(0===arguments.length)return this;for(var e=this.size+arguments.length,i=this._head,s=arguments.length-1;s>=0;s--)i={value:t[s],next:i};return this.__ownerID?(this.size=e,this._head=i,this.__hash=void 0,this.__altered=!0,this):wi(e,i)},e.prototype.pushAll=function(e){if(0===(e=t(e)).size)return this;if(0===this.size&&Mi(e))return e;Kt(e.size);var i=this.size,s=this._head;return e.__iterate(function(t){i++,s={value:t,next:s}},!0),this.__ownerID?(this.size=i,this._head=s,this.__hash=void 0,this.__altered=!0,this):wi(i,s)},e.prototype.pop=function(){return this.slice(1)},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Ci()},e.prototype.slice=function(e,i){if(d(e,i,this.size))return this;var s=f(e,this.size);if(g(i,this.size)!==this.size)return t.prototype.slice.call(this,e,i);for(var r=this.size-s,n=this._head;s--;)n=n.next;return this.__ownerID?(this.size=r,this._head=n,this.__hash=void 0,this.__altered=!0,this):wi(r,n)},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?wi(this.size,this._head,t,this.__hash):0===this.size?Ci():(this.__ownerID=t,this.__altered=!1,this)},e.prototype.__iterate=function(t,e){var i=this;if(e)return new K(this.toArray()).__iterate(function(e,s){return t(e,s,i)},e);for(var s=0,r=this._head;r&&!1!==t(r.value,s++,this);)r=r.next;return s},e.prototype.__iterator=function(t,e){if(e)return new K(this.toArray()).__iterator(t,e);var i=0,s=this._head;return new V(function(){if(s){var e=s.value;return s=s.next,N(t,i++,e)}return{value:void 0,done:!0}})},e}(T);Ei.isStack=Mi;var ki,Ti=Ei.prototype;function wi(t,e,i,s){var r=Object.create(Ti);return r.size=t,r._head=e,r.__ownerID=i,r.__hash=s,r.__altered=!1,r}function Ci(){return ki||(ki=wi(0))}Ti[bi]=!0,Ti.shift=Ti.pop,Ti.unshift=Ti.push,Ti.unshiftAll=Ti.pushAll,Ti.withMutations=Fe,Ti.wasAltered=Re,Ti.asImmutable=Ie,Ti["@@transducer/init"]=Ti.asMutable=De,Ti["@@transducer/step"]=function(t,e){return t.unshift(e)},Ti["@@transducer/result"]=function(t){return t.asImmutable()};var Bi="@@__IMMUTABLE_SET__@@";function Fi(t){return Boolean(t&&t[Bi])}function Di(t){return Fi(t)&&L(t)}function Ii(t,e){if(t===e)return!0;if(!x(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||A(t)!==A(e)||b(t)!==b(e)||L(t)!==L(e))return!1;if(0===t.size&&0===e.size)return!0;var i=!M(t);if(L(t)){var s=t.entries();return e.every(function(t,e){var r=s.next().value;return r&&lt(r[1],t)&&(i||lt(r[0],e))})&&s.next().done}var r=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{r=!0;var n=t;t=e,e=n}var a=!0,h=e.__iterate(function(e,s){if(i?!t.has(e):r?!lt(e,t.get(s,o)):!lt(t.get(s,o),e))return a=!1,!1});return a&&t.size===h}function Ri(t,e){var i=function(i){t.prototype[i]=e[i]};return Object.keys(e).forEach(i),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(i),t}function Li(t){if(!t||"object"!=typeof t)return t;if(!x(t)){if(!ee(t))return t;t=H(t)}if(A(t)){var e={};return t.__iterate(function(t,i){e[i]=Li(t)}),e}var i=[];return t.__iterate(function(t){i.push(Li(t))}),i}var Pi=function(t){function e(e){return null==e?Oi():Fi(e)&&!L(e)?e:Oi().withMutations(function(i){var s=t(e);Kt(s.size),s.forEach(function(t){return i.add(t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(t){return this(k(t).keySeq())},e.intersect=function(t){return(t=E(t).toArray()).length?_i.intersect.apply(e(t.pop()),t):Oi()},e.union=function(t){return(t=E(t).toArray()).length?_i.union.apply(e(t.pop()),t):Oi()},e.prototype.toString=function(){return this.__toString("Set {","}")},e.prototype.has=function(t){return this._map.has(t)},e.prototype.add=function(t){return Vi(this,this._map.set(t,t))},e.prototype.remove=function(t){return Vi(this,this._map.remove(t))},e.prototype.clear=function(){return Vi(this,this._map.clear())},e.prototype.map=function(t,e){var i=this,s=!1,r=Vi(this,this._map.mapEntries(function(r){var n=r[1],o=t.call(e,n,n,i);return o!==n&&(s=!0),[o,o]},e));return s?r:this},e.prototype.union=function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];return 0===(e=e.filter(function(t){return 0!==t.size})).length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations(function(i){for(var s=0;s<e.length;s++)"string"==typeof e[s]?i.add(e[s]):t(e[s]).forEach(function(t){return i.add(t)})}):this.constructor(e[0])},e.prototype.intersect=function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];if(0===e.length)return this;e=e.map(function(e){return t(e)});var s=[];return this.forEach(function(t){e.every(function(e){return e.includes(t)})||s.push(t)}),this.withMutations(function(t){s.forEach(function(e){t.remove(e)})})},e.prototype.subtract=function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];if(0===e.length)return this;e=e.map(function(e){return t(e)});var s=[];return this.forEach(function(t){e.some(function(e){return e.includes(t)})&&s.push(t)}),this.withMutations(function(t){s.forEach(function(e){t.remove(e)})})},e.prototype.sort=function(t){return ns(Nt(this,t))},e.prototype.sortBy=function(t,e){return ns(Nt(this,e,t))},e.prototype.wasAltered=function(){return this._map.wasAltered()},e.prototype.__iterate=function(t,e){var i=this;return this._map.__iterate(function(e){return t(e,e,i)},e)},e.prototype.__iterator=function(t,e){return this._map.__iterator(t,e)},e.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):0===this.size?this.__empty():(this.__ownerID=t,this._map=e,this)},e}(w);Pi.isSet=Fi;var zi,_i=Pi.prototype;function Vi(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function Ni(t,e){var i=Object.create(_i);return i.size=t?t.size:0,i._map=t,i.__ownerID=e,i}function Oi(){return zi||(zi=Ni(je()))}_i[Bi]=!0,_i[s]=_i.remove,_i.merge=_i.concat=_i.union,_i.withMutations=Fe,_i.asImmutable=Ie,_i["@@transducer/init"]=_i.asMutable=De,_i["@@transducer/step"]=function(t,e){return t.add(e)},_i["@@transducer/result"]=function(t){return t.asImmutable()},_i.__empty=Oi,_i.__make=Ni;var Ui,Gi=function(t){function e(t,i,s){if(!(this instanceof e))return new e(t,i,s);if(qt(0!==s,"Cannot step a Range by 0"),t=t||0,void 0===i&&(i=1/0),s=void 0===s?1:Math.abs(s),i<t&&(s=-s),this._start=t,this._end=i,this._step=s,this.size=Math.max(0,Math.ceil((i-t)/s-1)+1),0===this.size){if(Ui)return Ui;Ui=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},e.prototype.get=function(t,e){return this.has(t)?this._start+c(this,t)*this._step:e},e.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},e.prototype.slice=function(t,i){return d(t,i,this.size)?this:(t=f(t,this.size),(i=g(i,this.size))<=t?new e(0,0):new e(this.get(t,this._end),this.get(i,this._end),this._step))},e.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step===0){var i=e/this._step;if(i>=0&&i<this.size)return i}return-1},e.prototype.lastIndexOf=function(t){return this.indexOf(t)},e.prototype.__iterate=function(t,e){for(var i=this.size,s=this._step,r=e?this._start+(i-1)*s:this._start,n=0;n!==i&&!1!==t(r,e?i-++n:n++,this);)r+=e?-s:s;return n},e.prototype.__iterator=function(t,e){var i=this.size,s=this._step,r=e?this._start+(i-1)*s:this._start,n=0;return new V(function(){if(n===i)return{value:void 0,done:!0};var o=r;return r+=e?-s:s,N(t,e?i-++n:n++,o)})},e.prototype.equals=function(t){return t instanceof e?this._start===t._start&&this._end===t._end&&this._step===t._step:Ii(this,t)},e}(X);function Yi(t,e,i){for(var s=Jt(e),r=0;r!==s.length;)if((t=re(t,s[r++],o))===o)return i;return t}function Zi(t,e){return Yi(this,t,e)}function Wi(t,e){return Yi(t,e,o)!==o}function ji(){Kt(this.size);var t={};return this.__iterate(function(e,i){t[i]=e}),t}E.isIterable=x,E.isKeyed=A,E.isIndexed=b,E.isAssociative=M,E.isOrdered=L,E.Iterator=V,Ri(E,{toArray:function(){Kt(this.size);var t=new Array(this.size||0),e=A(this),i=0;return this.__iterate(function(s,r){t[i++]=e?[r,s]:s}),t},toIndexedSeq:function(){return new Bt(this)},toJS:function(){return Li(this)},toKeyedSeq:function(){return new Ct(this,!0)},toMap:function(){return Le(this.toKeyedSeq())},toObject:ji,toOrderedMap:function(){return xi(this.toKeyedSeq())},toOrderedSet:function(){return ns(A(this)?this.valueSeq():this)},toSet:function(){return Pi(A(this)?this.valueSeq():this)},toSetSeq:function(){return new Ft(this)},toSeq:function(){return b(this)?this.toIndexedSeq():A(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Ei(A(this)?this.valueSeq():this)},toList:function(){return ri(A(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Yt(this,function(t,e){var i=A(t),s=[t].concat(e).map(function(t){return x(t)?i&&(t=k(t)):t=i?it(t):st(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===s.length)return t;if(1===s.length){var r=s[0];if(r===t||i&&A(r)||b(t)&&b(r))return r}var n=new K(s);return i?n=n.toKeyedSeq():b(t)||(n=n.toSetSeq()),(n=n.flatten(!0)).size=s.reduce(function(t,e){if(void 0!==t){var i=e.size;if(void 0!==i)return t+i}},0),n}(this,t))},includes:function(t){return this.some(function(e){return lt(e,t)})},entries:function(){return this.__iterator(2)},every:function(t,e){Kt(this.size);var i=!0;return this.__iterate(function(s,r,n){if(!t.call(e,s,r,n))return i=!1,!1}),i},filter:function(t,e){return Yt(this,Pt(this,t,e,!0))},partition:function(t,e){return function(t,e,i){var s=A(t),r=[[],[]];t.__iterate(function(n,o){r[e.call(i,n,o,t)?1:0].push(s?[o,n]:n)});var n=Wt(t);return r.map(function(e){return Yt(t,n(e))})}(this,t,e)},find:function(t,e,i){var s=this.findEntry(t,e);return s?s[1]:i},forEach:function(t,e){return Kt(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){Kt(this.size),t=void 0!==t?""+t:",";var e="",i=!0;return this.__iterate(function(s){i?i=!1:e+=t,e+=null!=s?s.toString():""}),e},keys:function(){return this.__iterator(0)},map:function(t,e){return Yt(this,Rt(this,t,e))},reduce:function(t,e,i){return Ki(this,t,e,i,arguments.length<2,!1)},reduceRight:function(t,e,i){return Ki(this,t,e,i,arguments.length<2,!0)},reverse:function(){return Yt(this,Lt(this,!0))},slice:function(t,e){return Yt(this,zt(this,t,e,!0))},some:function(t,e){Kt(this.size);var i=!1;return this.__iterate(function(s,r,n){if(t.call(e,s,r,n))return i=!0,!1}),i},sort:function(t){return Yt(this,Nt(this,t))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return l(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return function(t,e,i){var s=Le().asMutable();return t.__iterate(function(r,n){s.update(e.call(i,r,n,t),0,function(t){return t+1})}),s.asImmutable()}(this,t,e)},equals:function(t){return Ii(this,t)},entrySeq:function(){var t=this;if(t._cache)return new K(t._cache);var e=t.toSeq().map(Qi).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(ts(t),e)},findEntry:function(t,e,i){var s=i;return this.__iterate(function(i,r,n){if(t.call(e,i,r,n))return s=[r,i],!1}),s},findKey:function(t,e){var i=this.findEntry(t,e);return i&&i[0]},findLast:function(t,e,i){return this.toKeyedSeq().reverse().find(t,e,i)},findLastEntry:function(t,e,i){return this.toKeyedSeq().reverse().findEntry(t,e,i)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(t){return this.find(u,null,t)},flatMap:function(t,e){return Yt(this,function(t,e,i){var s=Wt(t);return t.toSeq().map(function(r,n){return s(e.call(i,r,n,t))}).flatten(!0)}(this,t,e))},flatten:function(t){return Yt(this,Vt(this,t,!0))},fromEntrySeq:function(){return new Dt(this)},get:function(t,e){return this.find(function(e,i){return lt(i,t)},void 0,e)},getIn:Zi,groupBy:function(t,e){return function(t,e,i){var s=A(t),r=(L(t)?xi():Le()).asMutable();t.__iterate(function(n,o){r.update(e.call(i,n,o,t),function(t){return(t=t||[]).push(s?[o,n]:n),t})});var n=Wt(t);return r.map(function(e){return Yt(t,n(e))}).asImmutable()}(this,t,e)},has:function(t){return this.get(t,o)!==o},hasIn:function(t){return Wi(this,t)},isSubset:function(t){return t="function"==typeof t.includes?t:E(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:E(t)).isSubset(this)},keyOf:function(t){return this.findKey(function(e){return lt(e,t)})},keySeq:function(){return this.toSeq().map(Ji).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return Ot(this,t)},maxBy:function(t,e){return Ot(this,e,t)},min:function(t){return Ot(this,t?es(t):ss)},minBy:function(t,e){return Ot(this,e?es(e):ss,t)},rest:function(){return this.slice(1)},skip:function(t){return 0===t?this:this.slice(Math.max(0,t))},skipLast:function(t){return 0===t?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,e){return Yt(this,_t(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(ts(t),e)},sortBy:function(t,e){return Yt(this,Nt(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,e){return Yt(this,function(t,e,i){var s=jt(t);return s.__iterateUncached=function(s,r){var n=this;if(r)return this.cacheResult().__iterate(s,r);var o=0;return t.__iterate(function(t,r,a){return e.call(i,t,r,a)&&++o&&s(t,r,n)}),o},s.__iteratorUncached=function(s,r){var n=this;if(r)return this.cacheResult().__iterator(s,r);var o=t.__iterator(2,r),a=!0;return new V(function(){if(!a)return{value:void 0,done:!0};var t=o.next();if(t.done)return t;var r=t.value,h=r[0],l=r[1];return e.call(i,l,h,n)?2===s?t:N(s,h,l,t):(a=!1,{value:void 0,done:!0})})},s}(this,t,e))},takeUntil:function(t,e){return this.takeWhile(ts(t),e)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(t){if(t.size===1/0)return 0;var e=L(t),i=A(t),s=e?1:0;return function(t,e){return e=ct(e,3432918353),e=ct(e<<15|e>>>-15,461845907),e=ct(e<<13|e>>>-13,5),e=ct((e=(e+3864292196|0)^t)^e>>>16,2246822507),e=ut((e=ct(e^e>>>13,3266489909))^e>>>16)}(t.__iterate(i?e?function(t,e){s=31*s+rs(ft(t),ft(e))|0}:function(t,e){s=s+rs(ft(t),ft(e))|0}:e?function(t){s=31*s+ft(t)|0}:function(t){s=s+ft(t)|0}),s)}(this))}});var Hi=E.prototype;Hi[y]=!0,Hi[_]=Hi.values,Hi.toJSON=Hi.toArray,Hi.__toStringMapper=ie,Hi.inspect=Hi.toSource=function(){return this.toString()},Hi.chain=Hi.flatMap,Hi.contains=Hi.includes,Ri(k,{flip:function(){return Yt(this,It(this))},mapEntries:function(t,e){var i=this,s=0;return Yt(this,this.toSeq().map(function(r,n){return t.call(e,[n,r],s++,i)}).fromEntrySeq())},mapKeys:function(t,e){var i=this;return Yt(this,this.toSeq().flip().map(function(s,r){return t.call(e,s,r,i)}).flip())}});var $i=k.prototype;$i[v]=!0,$i[_]=Hi.entries,$i.toJSON=ji,$i.__toStringMapper=function(t,e){return ie(e)+": "+ie(t)},Ri(T,{toKeyedSeq:function(){return new Ct(this,!1)},filter:function(t,e){return Yt(this,Pt(this,t,e,!1))},findIndex:function(t,e){var i=this.findEntry(t,e);return i?i[0]:-1},indexOf:function(t){var e=this.keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return void 0===e?-1:e},reverse:function(){return Yt(this,Lt(this,!1))},slice:function(t,e){return Yt(this,zt(this,t,e,!1))},splice:function(t,e){var i=arguments.length;if(e=Math.max(e||0,0),0===i||2===i&&!e)return this;t=f(t,t<0?this.count():this.size);var s=this.slice(0,t);return Yt(this,1===i?s:s.concat(Xt(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var i=this.findLastEntry(t,e);return i?i[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return Yt(this,Vt(this,t,!1))},get:function(t,e){return(t=c(this,t))<0||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find(function(e,i){return i===t},void 0,e)},has:function(t){return(t=c(this,t))>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Yt(this,function(t,e){var i=jt(t);return i.size=t.size&&2*t.size-1,i.__iterateUncached=function(i,s){var r=this,n=0;return t.__iterate(function(t){return(!n||!1!==i(e,n++,r))&&!1!==i(t,n++,r)},s),n},i.__iteratorUncached=function(i,s){var r,n=t.__iterator(1,s),o=0;return new V(function(){return(!r||o%2)&&(r=n.next()).done?r:o%2?N(i,o++,e):N(i,o++,r.value,r)})},i}(this,t))},interleave:function(){var t=[this].concat(Xt(arguments)),e=Gt(this.toSeq(),X.of,t),i=e.flatten(!0);return e.size&&(i.size=e.size*t.length),Yt(this,i)},keySeq:function(){return Gi(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,e){return Yt(this,_t(this,t,e,!1))},zip:function(){return Yt(this,Gt(this,is,[this].concat(Xt(arguments))))},zipAll:function(){return Yt(this,Gt(this,is,[this].concat(Xt(arguments)),!0))},zipWith:function(t){var e=Xt(arguments);return e[0]=this,Yt(this,Gt(this,t,e))}});var Xi=T.prototype;Xi[S]=!0,Xi[R]=!0,Ri(w,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var qi=w.prototype;function Ki(t,e,i,s,r,n){return Kt(t.size),t.__iterate(function(t,n,o){r?(r=!1,i=t):i=e.call(s,i,t,n,o)},n),i}function Ji(t,e){return e}function Qi(t,e){return[e,t]}function ts(t){return function(){return!t.apply(this,arguments)}}function es(t){return function(){return-t.apply(this,arguments)}}function is(){return Xt(arguments)}function ss(t,e){return t<e?1:t>e?-1:0}function rs(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}qi.has=Hi.includes,qi.contains=qi.includes,qi.keys=qi.values,Ri($,$i),Ri(X,Xi),Ri(q,qi);var ns=function(t){function e(t){return null==t?ls():Di(t)?t:ls().withMutations(function(e){var i=w(t);Kt(i.size),i.forEach(function(t){return e.add(t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(t){return this(k(t).keySeq())},e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},e}(Pi);ns.isOrderedSet=Di;var os,as=ns.prototype;function hs(t,e){var i=Object.create(as);return i.size=t?t.size:0,i._map=t,i.__ownerID=e,i}function ls(){return os||(os=hs(Ai()))}as[R]=!0,as.zip=Xi.zip,as.zipWith=Xi.zipWith,as.zipAll=Xi.zipAll,as.__empty=ls,as.__make=hs;var cs={LeftThenRight:-1,RightThenLeft:1},us=function(t,e){var i;!function(t){if(D(t))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(I(t))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(null===t||"object"!=typeof t)throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}(t);var s=function(n){var o=this;if(n instanceof s)return n;if(!(this instanceof s))return new s(n);if(!i){i=!0;var a=Object.keys(t),h=r._indices={};r._name=e,r._keys=a,r._defaultValues=t;for(var l=0;l<a.length;l++){var c=a[l];h[c]=l,r[c]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+gs(this)+' with property "'+c+'" since that property name is part of the Record API.'):ms(r,c)}}return this.__ownerID=void 0,this._values=ri().withMutations(function(t){t.setSize(o._keys.length),k(n).forEach(function(e,i){t.set(o._indices[i],e===o._defaultValues[i]?void 0:e)})}),this},r=s.prototype=Object.create(ds);return r.constructor=s,e&&(s.displayName=e),s};us.prototype.toString=function(){for(var t,e=gs(this)+" { ",i=this._keys,s=0,r=i.length;s!==r;s++)e+=(s?", ":"")+(t=i[s])+": "+ie(this.get(t));return e+" }"},us.prototype.equals=function(t){return this===t||D(t)&&ps(this).equals(ps(t))},us.prototype.hashCode=function(){return ps(this).hashCode()},us.prototype.has=function(t){return this._indices.hasOwnProperty(t)},us.prototype.get=function(t,e){if(!this.has(t))return e;var i=this._indices[t],s=this._values.get(i);return void 0===s?this._defaultValues[t]:s},us.prototype.set=function(t,e){if(this.has(t)){var i=this._values.set(this._indices[t],e===this._defaultValues[t]?void 0:e);if(i!==this._values&&!this.__ownerID)return fs(this,i)}return this},us.prototype.remove=function(t){return this.set(t)},us.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:fs(this,t)},us.prototype.wasAltered=function(){return this._values.wasAltered()},us.prototype.toSeq=function(){return ps(this)},us.prototype.toJS=function(){return Li(this)},us.prototype.entries=function(){return this.__iterator(2)},us.prototype.__iterator=function(t,e){return ps(this).__iterator(t,e)},us.prototype.__iterate=function(t,e){return ps(this).__iterate(t,e)},us.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._values.__ensureOwner(t);return t?fs(this,e,t):(this.__ownerID=t,this._values=e,this)},us.isRecord=D,us.getDescriptiveName=gs;var ds=us.prototype;function fs(t,e,i){var s=Object.create(Object.getPrototypeOf(t));return s._values=e,s.__ownerID=i,s}function gs(t){return t.constructor.displayName||t.constructor.name||"Record"}function ps(t){return it(t._keys.map(function(e){return[e,t.get(e)]}))}function ms(t,e){try{Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){qt(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}catch(t){}}ds[F]=!0,ds[s]=ds.remove,ds.deleteIn=ds.removeIn=fe,ds.getIn=Zi,ds.hasIn=Hi.hasIn,ds.merge=ye,ds.mergeWith=xe,ds.mergeIn=Ce,ds.mergeDeep=Te,ds.mergeDeepWith=we,ds.mergeDeepIn=Be,ds.setIn=ue,ds.update=pe,ds.updateIn=me,ds.withMutations=Fe,ds.asMutable=De,ds.asImmutable=Ie,ds[_]=ds.entries,ds.toJSON=ds.toObject=Hi.toObject,ds.inspect=ds.toSource=function(){return this.toString()};var ys,xs=function(t){function e(t,i){if(!(this instanceof e))return new e(t,i);if(this._value=t,this.size=void 0===i?1/0:Math.max(0,i),0===this.size){if(ys)return ys;ys=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},e.prototype.get=function(t,e){return this.has(t)?this._value:e},e.prototype.includes=function(t){return lt(this._value,t)},e.prototype.slice=function(t,i){var s=this.size;return d(t,i,s)?this:new e(this._value,g(i,s)-f(t,s))},e.prototype.reverse=function(){return this},e.prototype.indexOf=function(t){return lt(this._value,t)?0:-1},e.prototype.lastIndexOf=function(t){return lt(this._value,t)?this.size:-1},e.prototype.__iterate=function(t,e){for(var i=this.size,s=0;s!==i&&!1!==t(this._value,e?i-++s:s++,this););return s},e.prototype.__iterator=function(t,e){var i=this,s=this.size,r=0;return new V(function(){return r===s?{value:void 0,done:!0}:N(t,e?s-++r:r++,i._value)})},e.prototype.equals=function(t){return t instanceof e?lt(this._value,t._value):Ii(this,t)},e}(X);function vs(t,e){return As([],e||Ss,t,"",e&&e.length>2?[]:void 0,{"":t})}function As(t,e,i,s,r,n){if("string"!=typeof i&&!I(i)&&(j(i)||U(i)||te(i))){if(~t.indexOf(i))throw new TypeError("Cannot convert circular structure to Immutable");t.push(i),r&&""!==s&&r.push(s);var o=e.call(n,s,H(i).map(function(s,n){return As(t,e,s,n,r,i)}),r&&r.slice());return t.pop(),r&&r.pop(),o}return i}function Ss(t,e){return b(e)?e.toList():A(e)?e.toMap():e.toSet()}var bs="4.3.7",Ms=E;const Es={version:bs,Collection:E,Iterable:E,Seq:H,Map:Le,OrderedMap:xi,List:ri,Stack:Ei,Set:Pi,OrderedSet:ns,PairSorting:cs,Record:us,Range:Gi,Repeat:xs,is:lt,fromJS:vs,hash:ft,isImmutable:I,isCollection:x,isKeyed:A,isIndexed:b,isAssociative:M,isOrdered:L,isValueObject:ht,isPlainObject:te,isSeq:B,isList:si,isMap:ot,isOrderedMap:at,isStack:Mi,isSet:Fi,isOrderedSet:Di,isRecord:D,get:re,getIn:Yi,has:se,hasIn:Wi,merge:Ae,mergeDeep:be,mergeWith:Se,mergeDeepWith:Me,remove:oe,removeIn:de,set:ae,setIn:ce,update:ge,updateIn:he}},570(t){function e(t,e,s){s=s||2;var n,o,a,h,u,d,g,p=e&&e.length,m=p?e[0]*s:t.length,y=i(t,0,m,s,!0),x=[];if(!y||y.next===y.prev)return x;if(p&&(y=function(t,e,s,r){var n,o,a,h=[];for(n=0,o=e.length;n<o;n++)(a=i(t,e[n]*r,n<o-1?e[n+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),h.push(f(a));for(h.sort(l),n=0;n<h.length;n++)s=c(h[n],s);return s}(t,e,y,s)),t.length>80*s){n=a=t[0],o=h=t[1];for(var v=s;v<m;v+=s)(u=t[v])<n&&(n=u),(d=t[v+1])<o&&(o=d),u>a&&(a=u),d>h&&(h=d);g=0!==(g=Math.max(a-n,h-o))?32767/g:0}return r(y,x,s,n,o,g,0),x}function i(t,e,i,s,r){var n,o;if(r===T(t,e,i,s)>0)for(n=e;n<i;n+=s)o=M(n,t[n],t[n+1],o);else for(n=i-s;n>=e;n-=s)o=M(n,t[n],t[n+1],o);return o&&y(o,o.next)&&(E(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var i,s=t;do{if(i=!1,s.steiner||!y(s,s.next)&&0!==m(s.prev,s,s.next))s=s.next;else{if(E(s),(s=e=s.prev)===s.next)break;i=!0}}while(i||s!==e);return e}function r(t,e,i,l,c,u,f){if(t){!f&&u&&function(t,e,i,s){var r=t;do{0===r.z&&(r.z=d(r.x,r.y,e,i,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,s,r,n,o,a,h,l=1;do{for(i=t,t=null,n=null,o=0;i;){for(o++,s=i,a=0,e=0;e<l&&(a++,s=s.nextZ);e++);for(h=l;a>0||h>0&&s;)0!==a&&(0===h||!s||i.z<=s.z)?(r=i,i=i.nextZ,a--):(r=s,s=s.nextZ,h--),n?n.nextZ=r:t=r,r.prevZ=n,n=r;i=s}n.nextZ=null,l*=2}while(o>1)}(r)}(t,l,c,u);for(var g,p,m=t;t.prev!==t.next;)if(g=t.prev,p=t.next,u?o(t,l,c,u):n(t))e.push(g.i/i|0),e.push(t.i/i|0),e.push(p.i/i|0),E(t),t=p.next,m=p.next;else if((t=p)===m){f?1===f?r(t=a(s(t),e,i),e,i,l,c,u,2):2===f&&h(t,e,i,l,c,u):r(s(t),e,i,l,c,u,1);break}}}function n(t){var e=t.prev,i=t,s=t.next;if(m(e,i,s)>=0)return!1;for(var r=e.x,n=i.x,o=s.x,a=e.y,h=i.y,l=s.y,c=r<n?r<o?r:o:n<o?n:o,u=a<h?a<l?a:l:h<l?h:l,d=r>n?r>o?r:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,p=s.next;p!==e;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&g(r,a,n,h,o,l,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,i,s){var r=t.prev,n=t,o=t.next;if(m(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,l=o.x,c=r.y,u=n.y,f=o.y,p=a<h?a<l?a:l:h<l?h:l,y=c<u?c<f?c:f:u<f?u:f,x=a>h?a>l?a:l:h>l?h:l,v=c>u?c>f?c:f:u>f?u:f,A=d(p,y,e,i,s),S=d(x,v,e,i,s),b=t.prevZ,M=t.nextZ;b&&b.z>=A&&M&&M.z<=S;){if(b.x>=p&&b.x<=x&&b.y>=y&&b.y<=v&&b!==r&&b!==o&&g(a,c,h,u,l,f,b.x,b.y)&&m(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,M.x>=p&&M.x<=x&&M.y>=y&&M.y<=v&&M!==r&&M!==o&&g(a,c,h,u,l,f,M.x,M.y)&&m(M.prev,M,M.next)>=0)return!1;M=M.nextZ}for(;b&&b.z>=A;){if(b.x>=p&&b.x<=x&&b.y>=y&&b.y<=v&&b!==r&&b!==o&&g(a,c,h,u,l,f,b.x,b.y)&&m(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;M&&M.z<=S;){if(M.x>=p&&M.x<=x&&M.y>=y&&M.y<=v&&M!==r&&M!==o&&g(a,c,h,u,l,f,M.x,M.y)&&m(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function a(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!y(n,o)&&x(n,r,r.next,o)&&S(n,o)&&S(o,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(o.i/i|0),E(r),E(r.next),r=t=o),r=r.next}while(r!==t);return s(r)}function h(t,e,i,n,o,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&p(h,l)){var c=b(h,l);return h=s(h,h.next),c=s(c,c.next),r(h,e,i,n,o,a,0),void r(c,e,i,n,o,a,0)}l=l.next}h=h.next}while(h!==t)}function l(t,e){return t.x-e.x}function c(t,e){var i=function(t,e){var i,s=e,r=t.x,n=t.y,o=-1/0;do{if(n<=s.y&&n>=s.next.y&&s.next.y!==s.y){var a=s.x+(n-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=r&&a>o&&(o=a,i=s.x<s.next.x?s:s.next,a===r))return i}s=s.next}while(s!==e);if(!i)return null;var h,l=i,c=i.x,d=i.y,f=1/0;s=i;do{r>=s.x&&s.x>=c&&r!==s.x&&g(n<d?r:o,n,c,d,n<d?o:r,n,s.x,s.y)&&(h=Math.abs(n-s.y)/(r-s.x),S(s,t)&&(h<f||h===f&&(s.x>i.x||s.x===i.x&&u(i,s)))&&(i=s,f=h)),s=s.next}while(s!==l);return i}(t,e);if(!i)return e;var r=b(i,t);return s(r,r.next),s(i,i.next)}function u(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,i,s,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function g(t,e,i,s,r,n,o,a){return(r-o)*(e-a)>=(t-o)*(n-a)&&(t-o)*(s-a)>=(i-o)*(e-a)&&(i-o)*(n-a)>=(r-o)*(s-a)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&x(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(S(t,e)&&S(e,t)&&function(t,e){var i=t,s=!1,r=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&r<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==t);return s}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,i,s){var r=A(m(t,e,i)),n=A(m(t,e,s)),o=A(m(i,s,t)),a=A(m(i,s,e));return r!==n&&o!==a||!(0!==r||!v(t,i,e))||!(0!==n||!v(t,s,e))||!(0!==o||!v(i,t,s))||!(0!==a||!v(i,e,s))}function v(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function A(t){return t>0?1:t<0?-1:0}function S(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function b(t,e){var i=new k(t.i,t.x,t.y),s=new k(e.i,e.x,e.y),r=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s}function M(t,e,i,s){var r=new k(t,e,i);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,i,s){for(var r=0,n=e,o=i-s;n<i;n+=s)r+=(t[o]-t[n])*(t[n+1]+t[o+1]),o=n;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,i,s){var r=e&&e.length,n=r?e[0]*i:t.length,o=Math.abs(T(t,0,n,i));if(r)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,c=a<h-1?e[a+1]*i:t.length;o-=Math.abs(T(t,l,c,i))}var u=0;for(a=0;a<s.length;a+=3){var d=s[a]*i,f=s[a+1]*i,g=s[a+2]*i;u+=Math.abs((t[d]-t[g])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[g+1]-t[d+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,r=0;r<t.length;r++){for(var n=0;n<t[r].length;n++)for(var o=0;o<e;o++)i.vertices.push(t[r][n][o]);r>0&&(s+=t[r-1].length,i.holes.push(s))}return i}}}]);